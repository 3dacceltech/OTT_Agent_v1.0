/**
 * App version: 1.0.0
 * SDK version: 4.8.3
 * CLI version: 2.14.2
 *
 * Generated: Fri, 28 Feb 2025 12:12:58 GMT
 */

var APP_com_tv2z_opensource = (function () {
  'use strict';

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  const settings = {};
  const subscribers = {};
  const initSettings = (appSettings, platformSettings) => {
    settings['app'] = appSettings;
    settings['platform'] = platformSettings;
    settings['user'] = {};
  };
  const publish = (key, value) => {
    subscribers[key] && subscribers[key].forEach(subscriber => subscriber(value));
  };
  const dotGrab = function () {
    let obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    let key = arguments.length > 1 ? arguments[1] : undefined;
    if (obj === null) return undefined;
    const keys = key.split('.');
    for (let i = 0; i < keys.length; i++) {
      obj = obj[keys[i]] = obj[keys[i]] !== undefined ? obj[keys[i]] : {};
    }
    return typeof obj === 'object' && obj !== null ? Object.keys(obj).length ? obj : undefined : obj;
  };
  var Settings = {
    get(type, key) {
      let fallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
      const val = dotGrab(settings[type], key);
      return val !== undefined ? val : fallback;
    },
    has(type, key) {
      return !!this.get(type, key);
    },
    set(key, value) {
      settings['user'][key] = value;
      publish(key, value);
    },
    subscribe(key, callback) {
      subscribers[key] = subscribers[key] || [];
      subscribers[key].push(callback);
    },
    unsubscribe(key, callback) {
      if (callback) {
        const index = subscribers[key] && subscribers[key].findIndex(cb => cb === callback);
        index > -1 && subscribers[key].splice(index, 1);
      } else {
        if (key in subscribers) {
          subscribers[key] = [];
        }
      }
    },
    clearSubscribers() {
      for (const key of Object.getOwnPropertyNames(subscribers)) {
        delete subscribers[key];
      }
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const prepLog = (type, args) => {
    const colors = {
      Info: 'green',
      Debug: 'gray',
      Warn: 'orange',
      Error: 'red'
    };
    args = Array.from(args);
    return ['%c' + (args.length > 1 && typeof args[0] === 'string' ? args.shift() : type), 'background-color: ' + colors[type] + '; color: white; padding: 2px 4px; border-radius: 2px', args];
  };
  var Log = {
    info() {
      Settings.get('platform', 'log') && console.log.apply(console, prepLog('Info', arguments));
    },
    debug() {
      Settings.get('platform', 'log') && console.debug.apply(console, prepLog('Debug', arguments));
    },
    error() {
      Settings.get('platform', 'log') && console.error.apply(console, prepLog('Error', arguments));
    },
    warn() {
      Settings.get('platform', 'log') && console.warn.apply(console, prepLog('Warn', arguments));
    }
  };

  var executeAsPromise = (function (method) {
    let args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    let context = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    let result;
    if (method && typeof method === 'function') {
      try {
        result = method.apply(context, args);
      } catch (e) {
        result = e;
      }
    } else {
      result = method;
    }

    // if it looks like a duck .. ehm ... promise and talks like a promise, let's assume it's a promise
    if (result !== null && typeof result === 'object' && result.then && typeof result.then === 'function') {
      return result;
    }
    // otherwise make it into a promise
    else {
      return new Promise((resolve, reject) => {
        if (result instanceof Error) {
          reject(result);
        } else {
          resolve(result);
        }
      });
    }
  });

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let sendMetric = (type, event, params) => {
    Log.info('Sending metric', type, event, params);
  };
  const initMetrics = config => {
    sendMetric = config.sendMetric;
  };

  // available metric per category
  const metrics$1 = {
    app: ['launch', 'loaded', 'ready', 'close'],
    page: ['view', 'leave'],
    user: ['click', 'input'],
    media: ['abort', 'canplay', 'ended', 'pause', 'play',
    // with some videos there occur almost constant suspend events ... should investigate
    // 'suspend',
    'volumechange', 'waiting', 'seeking', 'seeked']
  };

  // error metric function (added to each category)
  const errorMetric = function (type, message, code, visible) {
    let params = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
    params = {
      params,
      ...{
        message,
        code,
        visible
      }
    };
    sendMetric(type, 'error', params);
  };
  const Metric = function (type, events) {
    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    return events.reduce((obj, event) => {
      obj[event] = function (name) {
        let params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        params = {
          ...options,
          ...(name ? {
            name
          } : {}),
          ...params
        };
        sendMetric(type, event, params);
      };
      return obj;
    }, {
      error(message, code, params) {
        errorMetric(type, message, code, params);
      },
      event(name, params) {
        sendMetric(type, name, params);
      }
    });
  };
  const Metrics$1 = types => {
    return Object.keys(types).reduce((obj, type) => {
      // media metric works a bit different!
      // it's a function that accepts a url and returns an object with the available metrics
      // url is automatically passed as a param in every metric
      type === 'media' ? obj[type] = url => Metric(type, types[type], {
        url
      }) : obj[type] = Metric(type, types[type]);
      return obj;
    }, {
      error: errorMetric,
      event: sendMetric
    });
  };
  var Metrics$2 = Metrics$1(metrics$1);

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  var events$2 = {
    abort: 'Abort',
    canplay: 'CanPlay',
    canplaythrough: 'CanPlayThrough',
    durationchange: 'DurationChange',
    emptied: 'Emptied',
    encrypted: 'Encrypted',
    ended: 'Ended',
    error: 'Error',
    interruptbegin: 'InterruptBegin',
    interruptend: 'InterruptEnd',
    loadeddata: 'LoadedData',
    loadedmetadata: 'LoadedMetadata',
    loadstart: 'LoadStart',
    pause: 'Pause',
    play: 'Play',
    playing: 'Playing',
    progress: 'Progress',
    ratechange: 'Ratechange',
    seeked: 'Seeked',
    seeking: 'Seeking',
    stalled: 'Stalled',
    // suspend: 'Suspend', // this one is called a looooot for some videos
    timeupdate: 'TimeUpdate',
    volumechange: 'VolumeChange',
    waiting: 'Waiting'
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  var autoSetupMixin = (function (sourceObject) {
    let setup = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};
    let ready = false;
    const doSetup = () => {
      if (ready === false) {
        setup();
        ready = true;
      }
    };
    return Object.keys(sourceObject).reduce((obj, key) => {
      if (typeof sourceObject[key] === 'function') {
        obj[key] = function () {
          doSetup();
          return sourceObject[key].apply(sourceObject, arguments);
        };
      } else if (typeof Object.getOwnPropertyDescriptor(sourceObject, key).get === 'function') {
        obj.__defineGetter__(key, function () {
          doSetup();
          return Object.getOwnPropertyDescriptor(sourceObject, key).get.apply(sourceObject);
        });
      } else if (typeof Object.getOwnPropertyDescriptor(sourceObject, key).set === 'function') {
        obj.__defineSetter__(key, function () {
          doSetup();
          return Object.getOwnPropertyDescriptor(sourceObject, key).set.sourceObject[key].apply(sourceObject, arguments);
        });
      } else {
        obj[key] = sourceObject[key];
      }
      return obj;
    }, {});
  });

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  let timeout = null;
  var easeExecution = (cb, delay) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      cb();
    }, delay);
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  let basePath;
  let proxyUrl;
  const initUtils = config => {
    basePath = ensureUrlWithProtocol(makeFullStaticPath(window.location.pathname, config.path || '/'));
    if (config.proxyUrl) {
      proxyUrl = ensureUrlWithProtocol(config.proxyUrl);
    }
  };
  var Utils = {
    asset(relPath) {
      return basePath + relPath;
    },
    proxyUrl(url) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      return proxyUrl ? proxyUrl + '?' + makeQueryString(url, options) : url;
    },
    makeQueryString() {
      return makeQueryString(...arguments);
    },
    // since imageworkers don't work without protocol
    ensureUrlWithProtocol() {
      return ensureUrlWithProtocol(...arguments);
    }
  };
  const ensureUrlWithProtocol = url => {
    if (/^\/\//.test(url)) {
      return window.location.protocol + url;
    }
    if (!/^(?:https?:)/i.test(url)) {
      return window.location.origin + url;
    }
    return url;
  };
  const makeFullStaticPath = function () {
    let pathname = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';
    let path = arguments.length > 1 ? arguments[1] : undefined;
    // ensure path has traling slash
    path = path.charAt(path.length - 1) !== '/' ? path + '/' : path;

    // if path is URL, we assume it's already the full static path, so we just return it
    if (/^(?:https?:)?(?:\/\/)/.test(path)) {
      return path;
    }
    if (path.charAt(0) === '/') {
      return path;
    } else {
      // cleanup the pathname (i.e. remove possible index.html)
      pathname = cleanUpPathName(pathname);

      // remove possible leading dot from path
      path = path.charAt(0) === '.' ? path.substr(1) : path;
      // ensure path has leading slash
      path = path.charAt(0) !== '/' ? '/' + path : path;
      return pathname + path;
    }
  };
  const cleanUpPathName = pathname => {
    if (pathname.slice(-1) === '/') return pathname.slice(0, -1);
    const parts = pathname.split('/');
    if (parts[parts.length - 1].indexOf('.') > -1) parts.pop();
    return parts.join('/');
  };
  const makeQueryString = function (url) {
    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    let type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'url';
    // add operator as an option
    options.operator = 'metrological'; // Todo: make this configurable (via url?)
    // add type (= url or qr) as an option, with url as the value
    options[type] = url;
    return Object.keys(options).map(key => {
      return encodeURIComponent(key) + '=' + encodeURIComponent('' + options[key]);
    }).join('&');
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const initProfile = config => {
    config.getInfo;
    config.setInfo;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  var Lightning = window.lng;

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const events$1 = ['timeupdate', 'error', 'ended', 'loadeddata', 'canplay', 'play', 'playing', 'pause', 'loadstart', 'seeking', 'seeked', 'encrypted'];
  let mediaUrl$1 = url => url;
  const initMediaPlayer = config => {
    if (config.mediaUrl) {
      mediaUrl$1 = config.mediaUrl;
    }
  };
  class Mediaplayer extends Lightning.Component {
    _construct() {
      this._skipRenderToTexture = false;
      this._metrics = null;
      this._textureMode = Settings.get('platform', 'textureMode') || false;
      Log.info('Texture mode: ' + this._textureMode);
      console.warn(["The 'MediaPlayer'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.", "Please consider using the new 'VideoPlayer'-plugin instead.", 'https://rdkcentral.github.io/Lightning-SDK/#/plugins/videoplayer'].join('\n\n'));
    }
    static _template() {
      return {
        Video: {
          VideoWrap: {
            VideoTexture: {
              visible: false,
              pivot: 0.5,
              texture: {
                type: Lightning.textures.StaticTexture,
                options: {}
              }
            }
          }
        }
      };
    }
    set skipRenderToTexture(v) {
      this._skipRenderToTexture = v;
    }
    get textureMode() {
      return this._textureMode;
    }
    get videoView() {
      return this.tag('Video');
    }
    _init() {
      //re-use videotag if already there
      const videoEls = document.getElementsByTagName('video');
      if (videoEls && videoEls.length > 0) this.videoEl = videoEls[0];else {
        this.videoEl = document.createElement('video');
        this.videoEl.setAttribute('id', 'video-player');
        this.videoEl.style.position = 'absolute';
        this.videoEl.style.zIndex = '1';
        this.videoEl.style.display = 'none';
        this.videoEl.setAttribute('width', '100%');
        this.videoEl.setAttribute('height', '100%');
        this.videoEl.style.visibility = this.textureMode ? 'hidden' : 'visible';
        document.body.appendChild(this.videoEl);
      }
      if (this.textureMode && !this._skipRenderToTexture) {
        this._createVideoTexture();
      }
      this.eventHandlers = [];
    }
    _registerListeners() {
      events$1.forEach(event => {
        const handler = e => {
          if (this._metrics && this._metrics[event] && typeof this._metrics[event] === 'function') {
            this._metrics[event]({
              currentTime: this.videoEl.currentTime
            });
          }
          this.fire(event, {
            videoElement: this.videoEl,
            event: e
          });
        };
        this.eventHandlers.push(handler);
        this.videoEl.addEventListener(event, handler);
      });
    }
    _deregisterListeners() {
      Log.info('Deregistering event listeners MediaPlayer');
      events$1.forEach((event, index) => {
        this.videoEl.removeEventListener(event, this.eventHandlers[index]);
      });
      this.eventHandlers = [];
    }
    _attach() {
      this._registerListeners();
    }
    _detach() {
      this._deregisterListeners();
      this.close();
    }
    _createVideoTexture() {
      const stage = this.stage;
      const gl = stage.gl;
      const glTexture = gl.createTexture();
      gl.bindTexture(gl.TEXTURE_2D, glTexture);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
      this.videoTexture.options = {
        source: glTexture,
        w: this.videoEl.width,
        h: this.videoEl.height
      };
    }
    _startUpdatingVideoTexture() {
      if (this.textureMode && !this._skipRenderToTexture) {
        const stage = this.stage;
        if (!this._updateVideoTexture) {
          this._updateVideoTexture = () => {
            if (this.videoTexture.options.source && this.videoEl.videoWidth && this.active) {
              const gl = stage.gl;
              const currentTime = new Date().getTime();

              // When BR2_PACKAGE_GST1_PLUGINS_BAD_PLUGIN_DEBUGUTILS is not set in WPE, webkitDecodedFrameCount will not be available.
              // We'll fallback to fixed 30fps in this case.
              const frameCount = this.videoEl.webkitDecodedFrameCount;
              const mustUpdate = frameCount ? this._lastFrame !== frameCount : this._lastTime < currentTime - 30;
              if (mustUpdate) {
                this._lastTime = currentTime;
                this._lastFrame = frameCount;
                try {
                  gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source);
                  gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);
                  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.videoEl);
                  this._lastFrame = this.videoEl.webkitDecodedFrameCount;
                  this.videoTextureView.visible = true;
                  this.videoTexture.options.w = this.videoEl.videoWidth;
                  this.videoTexture.options.h = this.videoEl.videoHeight;
                  const expectedAspectRatio = this.videoTextureView.w / this.videoTextureView.h;
                  const realAspectRatio = this.videoEl.videoWidth / this.videoEl.videoHeight;
                  if (expectedAspectRatio > realAspectRatio) {
                    this.videoTextureView.scaleX = realAspectRatio / expectedAspectRatio;
                    this.videoTextureView.scaleY = 1;
                  } else {
                    this.videoTextureView.scaleY = expectedAspectRatio / realAspectRatio;
                    this.videoTextureView.scaleX = 1;
                  }
                } catch (e) {
                  Log.error('texImage2d video', e);
                  this._stopUpdatingVideoTexture();
                  this.videoTextureView.visible = false;
                }
                this.videoTexture.source.forceRenderUpdate();
              }
            }
          };
        }
        if (!this._updatingVideoTexture) {
          stage.on('frameStart', this._updateVideoTexture);
          this._updatingVideoTexture = true;
        }
      }
    }
    _stopUpdatingVideoTexture() {
      if (this.textureMode) {
        const stage = this.stage;
        stage.removeListener('frameStart', this._updateVideoTexture);
        this._updatingVideoTexture = false;
        this.videoTextureView.visible = false;
        if (this.videoTexture.options.source) {
          const gl = stage.gl;
          gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source);
          gl.clearColor(0, 0, 0, 1);
          gl.clear(gl.COLOR_BUFFER_BIT);
        }
      }
    }
    updateSettings() {
      let settings = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      // The Component that 'consumes' the media player.
      this._consumer = settings.consumer;
      if (this._consumer && this._consumer.getMediaplayerSettings) {
        // Allow consumer to add settings.
        settings = Object.assign(settings, this._consumer.getMediaplayerSettings());
      }
      if (!Lightning.Utils.equalValues(this._stream, settings.stream)) {
        if (settings.stream && settings.stream.keySystem) {
          navigator.requestMediaKeySystemAccess(settings.stream.keySystem.id, settings.stream.keySystem.config).then(keySystemAccess => {
            return keySystemAccess.createMediaKeys();
          }).then(createdMediaKeys => {
            return this.videoEl.setMediaKeys(createdMediaKeys);
          }).then(() => {
            if (settings.stream && settings.stream.src) this.open(settings.stream.src);
          }).catch(() => {
            console.error('Failed to set up MediaKeys');
          });
        } else if (settings.stream && settings.stream.src) {
          // This is here to be backwards compatible, will be removed
          // in future sdk release
          if (Settings.get('app', 'hls')) {
            if (!window.Hls) {
              window.Hls = class Hls {
                static isSupported() {
                  console.warn('hls-light not included');
                  return false;
                }
              };
            }
            if (window.Hls.isSupported()) {
              if (!this._hls) this._hls = new window.Hls({
                liveDurationInfinity: true
              });
              this._hls.loadSource(settings.stream.src);
              this._hls.attachMedia(this.videoEl);
              this.videoEl.style.display = 'block';
            }
          } else {
            this.open(settings.stream.src);
          }
        } else {
          this.close();
        }
        this._stream = settings.stream;
      }
      this._setHide(settings.hide);
      this._setVideoArea(settings.videoPos);
    }
    _setHide(hide) {
      if (this.textureMode) {
        this.tag('Video').setSmooth('alpha', hide ? 0 : 1);
      } else {
        this.videoEl.style.visibility = hide ? 'hidden' : 'visible';
      }
    }
    open(url) {
      let settings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
        hide: false,
        videoPosition: null
      };
      // prep the media url to play depending on platform (mediaPlayerplugin)
      url = mediaUrl$1(url);
      this._metrics = Metrics$2.media(url);
      Log.info('Playing stream', url);
      if (this.application.noVideo) {
        Log.info('noVideo option set, so ignoring: ' + url);
        return;
      }
      // close the video when opening same url as current (effectively reloading)
      if (this.videoEl.getAttribute('src') === url) {
        this.close();
      }
      this.videoEl.setAttribute('src', url);

      // force hide, then force show (in next tick!)
      // (fixes comcast playback rollover issue)
      this.videoEl.style.visibility = 'hidden';
      this.videoEl.style.display = 'none';
      setTimeout(() => {
        this.videoEl.style.display = 'block';
        this.videoEl.style.visibility = 'visible';
      });
      this._setHide(settings.hide);
      this._setVideoArea(settings.videoPosition || [0, 0, 1920, 1080]);
    }
    close() {
      // We need to pause first in order to stop sound.
      this.videoEl.pause();
      this.videoEl.removeAttribute('src');

      // force load to reset everything without errors
      this.videoEl.load();
      this._clearSrc();
      this.videoEl.style.display = 'none';
    }
    playPause() {
      if (this.isPlaying()) {
        this.doPause();
      } else {
        this.doPlay();
      }
    }
    get muted() {
      return this.videoEl.muted;
    }
    set muted(v) {
      this.videoEl.muted = v;
    }
    get loop() {
      return this.videoEl.loop;
    }
    set loop(v) {
      this.videoEl.loop = v;
    }
    isPlaying() {
      return this._getState() === 'Playing';
    }
    doPlay() {
      this.videoEl.play();
    }
    doPause() {
      this.videoEl.pause();
    }
    reload() {
      var url = this.videoEl.getAttribute('src');
      this.close();
      this.videoEl.src = url;
    }
    getPosition() {
      return Promise.resolve(this.videoEl.currentTime);
    }
    setPosition(pos) {
      this.videoEl.currentTime = pos;
    }
    getDuration() {
      return Promise.resolve(this.videoEl.duration);
    }
    seek(time) {
      let absolute = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      if (absolute) {
        this.videoEl.currentTime = time;
      } else {
        this.videoEl.currentTime += time;
      }
    }
    get videoTextureView() {
      return this.tag('Video').tag('VideoTexture');
    }
    get videoTexture() {
      return this.videoTextureView.texture;
    }
    _setVideoArea(videoPos) {
      if (Lightning.Utils.equalValues(this._videoPos, videoPos)) {
        return;
      }
      this._videoPos = videoPos;
      if (this.textureMode) {
        this.videoTextureView.patch({
          smooth: {
            x: videoPos[0],
            y: videoPos[1],
            w: videoPos[2] - videoPos[0],
            h: videoPos[3] - videoPos[1]
          }
        });
      } else {
        const precision = this.stage.getRenderPrecision();
        this.videoEl.style.left = Math.round(videoPos[0] * precision) + 'px';
        this.videoEl.style.top = Math.round(videoPos[1] * precision) + 'px';
        this.videoEl.style.width = Math.round((videoPos[2] - videoPos[0]) * precision) + 'px';
        this.videoEl.style.height = Math.round((videoPos[3] - videoPos[1]) * precision) + 'px';
      }
    }
    _fireConsumer(event, args) {
      if (this._consumer) {
        this._consumer.fire(event, args);
      }
    }
    _equalInitData(buf1, buf2) {
      if (!buf1 || !buf2) return false;
      if (buf1.byteLength != buf2.byteLength) return false;
      const dv1 = new Int8Array(buf1);
      const dv2 = new Int8Array(buf2);
      for (let i = 0; i != buf1.byteLength; i++) if (dv1[i] != dv2[i]) return false;
      return true;
    }
    error(args) {
      this._fireConsumer('$mediaplayerError', args);
      this._setState('');
      return '';
    }
    loadeddata(args) {
      this._fireConsumer('$mediaplayerLoadedData', args);
    }
    play(args) {
      this._fireConsumer('$mediaplayerPlay', args);
    }
    playing(args) {
      this._fireConsumer('$mediaplayerPlaying', args);
      this._setState('Playing');
    }
    canplay(args) {
      this.videoEl.play();
      this._fireConsumer('$mediaplayerStart', args);
    }
    loadstart(args) {
      this._fireConsumer('$mediaplayerLoad', args);
    }
    seeked() {
      this._fireConsumer('$mediaplayerSeeked', {
        currentTime: this.videoEl.currentTime,
        duration: this.videoEl.duration || 1
      });
    }
    seeking() {
      this._fireConsumer('$mediaplayerSeeking', {
        currentTime: this.videoEl.currentTime,
        duration: this.videoEl.duration || 1
      });
    }
    durationchange(args) {
      this._fireConsumer('$mediaplayerDurationChange', args);
    }
    encrypted(args) {
      const video = args.videoElement;
      const event = args.event;
      // FIXME: Double encrypted events need to be properly filtered by Gstreamer
      if (video.mediaKeys && !this._equalInitData(this._previousInitData, event.initData)) {
        this._previousInitData = event.initData;
        this._fireConsumer('$mediaplayerEncrypted', args);
      }
    }
    static _states() {
      return [class Playing extends this {
        $enter() {
          this._startUpdatingVideoTexture();
        }
        $exit() {
          this._stopUpdatingVideoTexture();
        }
        timeupdate() {
          this._fireConsumer('$mediaplayerProgress', {
            currentTime: this.videoEl.currentTime,
            duration: this.videoEl.duration || 1
          });
        }
        ended(args) {
          this._fireConsumer('$mediaplayerEnded', args);
          this._setState('');
        }
        pause(args) {
          this._fireConsumer('$mediaplayerPause', args);
          this._setState('Playing.Paused');
        }
        _clearSrc() {
          this._fireConsumer('$mediaplayerStop', {});
          this._setState('');
        }
        static _states() {
          return [class Paused extends this {}];
        }
      }];
    }
  }

  class localCookie {
    constructor(e) {
      return e = e || {}, this.forceCookies = e.forceCookies || !1, !0 === this._checkIfLocalStorageWorks() && !0 !== e.forceCookies ? {
        getItem: this._getItemLocalStorage,
        setItem: this._setItemLocalStorage,
        removeItem: this._removeItemLocalStorage,
        clear: this._clearLocalStorage,
        keys: this._getLocalStorageKeys
      } : {
        getItem: this._getItemCookie,
        setItem: this._setItemCookie,
        removeItem: this._removeItemCookie,
        clear: this._clearCookies,
        keys: this._getCookieKeys
      };
    }
    _checkIfLocalStorageWorks() {
      if ("undefined" == typeof localStorage) return !1;
      try {
        return localStorage.setItem("feature_test", "yes"), "yes" === localStorage.getItem("feature_test") && (localStorage.removeItem("feature_test"), !0);
      } catch (e) {
        return !1;
      }
    }
    _getItemLocalStorage(e) {
      return window.localStorage.getItem(e);
    }
    _setItemLocalStorage(e, t) {
      return window.localStorage.setItem(e, t);
    }
    _removeItemLocalStorage(e) {
      return window.localStorage.removeItem(e);
    }
    _clearLocalStorage() {
      return window.localStorage.clear();
    }
    _getLocalStorageKeys() {
      return Object.keys(window.localStorage);
    }
    _getItemCookie(e) {
      var t = document.cookie.match(RegExp("(?:^|;\\s*)" + function (e) {
        return e.replace(/([.*+?\^${}()|\[\]\/\\])/g, "\\$1");
      }(e) + "=([^;]*)"));
      return t && "" === t[1] && (t[1] = null), t ? t[1] : null;
    }
    _setItemCookie(e, t) {
      var o = new Date(),
        r = new Date(o.getTime() + 15768e7);
      document.cookie = "".concat(e, "=").concat(t, "; expires=").concat(r.toUTCString(), ";");
    }
    _removeItemCookie(e) {
      document.cookie = "".concat(e, "=;Max-Age=-99999999;");
    }
    _clearCookies() {
      document.cookie.split(";").forEach(e => {
        document.cookie = e.replace(/^ +/, "").replace(/=.*/, "=;expires=Max-Age=-99999999");
      });
    }
    _getCookieKeys() {
      return document.cookie.split(";").map(e => e.split("=")[0]);
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let namespace;
  let lc$1;
  const initStorage = () => {
    namespace = Settings.get('platform', 'id');
    // todo: pass options (for example to force the use of cookies)
    lc$1 = new localCookie();
  };
  const namespacedKey = key => namespace ? [namespace, key].join('.') : key;
  var Storage = {
    get(key) {
      try {
        return JSON.parse(lc$1.getItem(namespacedKey(key)));
      } catch (e) {
        return null;
      }
    },
    set(key, value) {
      try {
        lc$1.setItem(namespacedKey(key), JSON.stringify(value));
        return true;
      } catch (e) {
        return false;
      }
    },
    remove(key) {
      lc$1.removeItem(namespacedKey(key));
    },
    clear() {
      if (namespace) {
        lc$1.keys().forEach(key => {
          // remove the item if in the namespace
          key.indexOf(namespace + '.') === 0 ? lc$1.removeItem(key) : null;
        });
      } else {
        lc$1.clear();
      }
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  const hasRegex = /\{\/(.*?)\/([igm]{0,3})\}/g;
  const isWildcard = /^[!*$]$/;
  const hasLookupId = /\/:\w+?@@([0-9]+?)@@/;
  const isNamedGroup = /^\/:/;

  /**
   * Test if a route is part regular expressed
   * and replace it for a simple character
   * @param route
   * @returns {*}
   */
  const stripRegex = function (route) {
    let char = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'R';
    // if route is part regular expressed we replace
    // the regular expression for a character to
    // simplify floor calculation and backtracking
    if (hasRegex.test(route)) {
      route = route.replace(hasRegex, char);
    }
    return route;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /**
   * Create a local request register
   * @param flags
   * @returns {Map<any, any>}
   */
  const createRegister = flags => {
    const reg = new Map()
    // store user defined and router
    // defined flags in register
    ;
    [...Object.keys(flags), ...Object.getOwnPropertySymbols(flags)].forEach(key => {
      reg.set(key, flags[key]);
    });
    return reg;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class Request {
    constructor() {
      let hash = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
      let navArgs = arguments.length > 1 ? arguments[1] : undefined;
      let storeCaller = arguments.length > 2 ? arguments[2] : undefined;
      /**
       * Hash we navigate to
       * @type {string}
       * @private
       */
      this._hash = hash;

      /**
       * Do we store previous hash in history
       * @type {boolean}
       * @private
       */
      this._storeCaller = storeCaller;

      /**
       * Request and navigate data
       * @type {Map}
       * @private
       */
      this._register = new Map();

      /**
       * Flag if the instance is created due to
       * this request
       * @type {boolean}
       * @private
       */
      this._isCreated = false;

      /**
       * Flag if the instance is shared between
       * previous and current request
       * @type {boolean}
       * @private
       */
      this._isSharedInstance = false;

      /**
       * Flag if the request has been cancelled
       * @type {boolean}
       * @private
       */
      this._cancelled = false;

      /**
       * if instance is shared between requests we copy state object
       * from instance before the new request overrides state
       * @type {null}
       * @private
       */
      this._copiedHistoryState = null;

      // if there are arguments attached to navigate()
      // we store them in new request
      if (isObject(navArgs)) {
        this._register = createRegister(navArgs);
      } else if (isBoolean(navArgs)) {
        // if second navigate() argument is explicitly
        // set to false we prevent the calling page
        // from ending up in history
        this._storeCaller = navArgs;
      }
      // @todo: remove because we can simply check
      // ._storeCaller property
      this._register.set(symbols.store, this._storeCaller);
    }
    cancel() {
      Log.debug('[router]:', "cancelled ".concat(this._hash));
      this._cancelled = true;
    }
    get url() {
      return this._hash;
    }
    get register() {
      return this._register;
    }
    get hash() {
      return this._hash;
    }
    set hash(args) {
      this._hash = args;
    }
    get route() {
      return this._route;
    }
    set route(args) {
      this._route = args;
    }
    get provider() {
      return this._provider;
    }
    set provider(args) {
      this._provider = args;
    }
    get providerType() {
      return this._providerType;
    }
    set providerType(args) {
      this._providerType = args;
    }
    set page(args) {
      this._page = args;
    }
    get page() {
      return this._page;
    }
    set isCreated(args) {
      this._isCreated = args;
    }
    get isCreated() {
      return this._isCreated;
    }
    get isSharedInstance() {
      return this._isSharedInstance;
    }
    set isSharedInstance(args) {
      this._isSharedInstance = args;
    }
    get isCancelled() {
      return this._cancelled;
    }
    set copiedHistoryState(v) {
      this._copiedHistoryState = v;
    }
    get copiedHistoryState() {
      return this._copiedHistoryState;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class Route {
    constructor() {
      let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      // keep backwards compatible
      let type = ['on', 'before', 'after'].reduce((acc, type) => {
        return isFunction(config[type]) ? type : acc;
      }, undefined);
      this._cfg = config;
      if (type) {
        this._provider = {
          type,
          request: config[type]
        };
      }
    }
    get path() {
      return this._cfg.path;
    }
    get component() {
      return this._cfg.component;
    }
    get options() {
      return this._cfg.options;
    }
    get widgets() {
      return this._cfg.widgets;
    }
    get cache() {
      return this._cfg.cache;
    }
    get hook() {
      return this._cfg.hook;
    }
    get beforeNavigate() {
      return this._cfg.beforeNavigate;
    }
    get provider() {
      return this._provider;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /**
   * Simple route length calculation
   * @param route {string}
   * @returns {number} - floor
   */
  const getFloor = route => {
    return stripRegex(route).split('/').length;
  };

  /**
   * return all stored routes that live on the same floor
   * @param floor
   * @returns {Array}
   */
  const getRoutesByFloor = floor => {
    const matches = [];
    // simple filter of level candidates
    for (let [route] of routes$1.entries()) {
      if (getFloor(route) === floor) {
        matches.push(route);
      }
    }
    return matches;
  };

  /**
   * return a matching route by provided hash
   * hash: home/browse/12 will match:
   * route: home/browse/:categoryId
   * @param hash {string}
   * @returns {boolean|{}} - route
   */
  const getRouteByHash = hash => {
    // @todo: clean up on handleHash
    hash = hash.replace(/^#/, '');
    const getUrlParts = /(\/?:?[^/]+)/g;
    // grab possible candidates from stored routes
    const candidates = getRoutesByFloor(getFloor(hash));
    // break hash down in chunks
    const hashParts = hash.match(getUrlParts) || [];

    // to simplify the route matching and prevent look around
    // in our getUrlParts regex we get the regex part from
    // route candidate and store them so that we can reference
    // them when we perform the actual regex against hash
    let regexStore = [];
    let matches = candidates.filter(route => {
      let isMatching = true;
      // replace regex in route with lookup id => @@{storeId}@@
      if (hasRegex.test(route)) {
        const regMatches = route.match(hasRegex);
        if (regMatches && regMatches.length) {
          route = regMatches.reduce((fullRoute, regex) => {
            const lookupId = regexStore.length;
            fullRoute = fullRoute.replace(regex, "@@".concat(lookupId, "@@"));
            regexStore.push(regex.substring(1, regex.length - 1));
            return fullRoute;
          }, route);
        }
      }
      const routeParts = route.match(getUrlParts) || [];
      for (let i = 0, j = routeParts.length; i < j; i++) {
        const routePart = routeParts[i];
        const hashPart = hashParts[i];

        // Since we support catch-all and regex driven name groups
        // we first test for regex lookup id and see if the regex
        // matches the value from the hash
        if (hasLookupId.test(routePart)) {
          const routeMatches = hasLookupId.exec(routePart);
          const storeId = routeMatches[1];
          const routeRegex = regexStore[storeId];

          // split regex and modifiers so we can use both
          // to create a new RegExp
          // eslint-disable-next-line
          const regMatches = /\/([^\/]+)\/([igm]{0,3})/.exec(routeRegex);
          if (regMatches && regMatches.length) {
            const expression = regMatches[1];
            const modifiers = regMatches[2];
            const regex = new RegExp("^/".concat(expression, "$"), modifiers);
            if (!regex.test(hashPart)) {
              isMatching = false;
            }
          }
        } else if (isNamedGroup.test(routePart)) {
          // we kindly skip namedGroups because this is dynamic
          // we only need to the static and regex drive parts
          continue;
        } else if (hashPart && routePart.toLowerCase() !== hashPart.toLowerCase()) {
          isMatching = false;
        }
      }
      return isMatching;
    });
    if (matches.length) {
      if (matches.indexOf(hash) !== -1) {
        const match = matches[matches.indexOf(hash)];
        return routes$1.get(match);
      } else {
        // we give prio to static routes over dynamic
        matches = matches.sort(a => {
          return isNamedGroup.test(a) ? -1 : 1;
        });
        // would be strange if this fails
        // but still we test
        if (routeExists(matches[0])) {
          return routes$1.get(matches[0]);
        }
      }
    }
    return false;
  };
  const getValuesFromHash = function () {
    let hash = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
    let path = arguments.length > 1 ? arguments[1] : undefined;
    // replace the regex definition from the route because
    // we already did the matching part
    path = stripRegex(path, '');
    const getUrlParts = /(\/?:?[\w%\s:.-]+)/g;
    const hashParts = hash.match(getUrlParts) || [];
    const routeParts = path.match(getUrlParts) || [];
    const getNamedGroup = /^\/:([\w-]+)\/?/;
    return routeParts.reduce((storage, value, index) => {
      const match = getNamedGroup.exec(value);
      if (match && match.length) {
        storage.set(match[1], decodeURIComponent(hashParts[index].replace(/^\//, '')));
      }
      return storage;
    }, new Map());
  };
  const getOption = (stack, prop) => {
    // eslint-disable-next-line
    if (stack && stack.hasOwnProperty(prop)) {
      return stack[prop];
    }
    // we explicitly return undefined since we're testing
    // for explicit test values
  };

  /**
   * create and return new Route instance
   * @param config
   */
  const createRoute = config => {
    // we need to provide a bit of additional logic
    // for the bootComponent
    if (config.path === '$') {
      let options = {
        preventStorage: true
      };
      if (isObject(config.options)) {
        options = {
          ...config.options,
          ...options
        };
      }
      config.options = options;
      // if configured add reference to bootRequest
      // as router after provider
      if (bootRequest) {
        config.after = bootRequest;
      }
    }
    return new Route(config);
  };

  /**
   * Create a new Router request object
   * @param url
   * @param args
   * @param store
   * @returns {*}
   */
  const createRequest = (url, args, store) => {
    return new Request(url, args, store);
  };
  const getHashByName = obj => {
    if (!obj.to && !obj.name) {
      return false;
    }
    const route = getRouteByName(obj.to || obj.name);
    const hasDynamicGroup = /\/:([\w-]+)\/?/;
    let hash = route;

    // if route contains dynamic group
    // we replace them with the provided params
    if (hasDynamicGroup.test(route)) {
      if (obj.params) {
        const keys = Object.keys(obj.params);
        hash = keys.reduce((acc, key) => {
          return acc.replace(":".concat(key), obj.params[key]);
        }, route);
      }
      if (obj.query) {
        return "".concat(hash).concat(objectToQueryString(obj.query));
      }
    }
    return hash;
  };
  const getRouteByName = name => {
    for (let [path, route] of routes$1.entries()) {
      if (route.name === name) {
        return path;
      }
    }
    return false;
  };
  const keepActivePageAlive = (route, request) => {
    if (isString(route)) {
      const routes = getRoutes();
      if (routes.has(route)) {
        route = routes.get(route);
      } else {
        return false;
      }
    }
    const register = request.register;
    const routeOptions = route.options;
    if (register.has('keepAlive')) {
      return register.get('keepAlive');
    } else if (routeOptions && routeOptions.keepAlive) {
      return routeOptions.keepAlive;
    }
    return false;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  var emit$1 = (function (page) {
    let events = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    if (!isArray(events)) {
      events = [events];
    }
    events.forEach(e => {
      const event = "_on".concat(ucfirst(e));
      if (isFunction(page[event])) {
        page[event](params);
      }
    });
  });

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let activeWidget = null;
  const getReferences = () => {
    if (!widgetsHost) {
      return;
    }
    return widgetsHost.get().reduce((storage, widget) => {
      const key = widget.ref.toLowerCase();
      storage[key] = widget;
      return storage;
    }, {});
  };

  /**
   * update the visibility of the available widgets
   * for the current page / route
   * @param page
   */
  const updateWidgets = (widgets, page) => {
    // force lowercase lookup
    const configured = (widgets || []).map(ref => ref.toLowerCase());
    widgetsHost.forEach(widget => {
      widget.visible = configured.indexOf(widget.ref.toLowerCase()) !== -1;
      if (widget.visible) {
        emit$1(widget, ['activated'], page);
      }
    });
    if (app.state === 'Widgets' && activeWidget && !activeWidget.visible) {
      app._setState('');
    }
  };
  const getWidgetByName = name => {
    name = ucfirst(name);
    return widgetsHost.getByRef(name) || false;
  };

  /**
   * delegate app focus to a on-screen widget
   * @param name - {string}
   */
  const focusWidget = name => {
    const widget = getWidgetByName(name);
    if (widget) {
      setActiveWidget(widget);

      // if app is already in 'Widgets' state we can assume that
      // focus has been delegated from one widget to another so
      // we need to set the new widget reference and trigger a
      // new focus calculation of Lightning's focuspath
      if (app.state === 'Widgets') {
        app.reload(activeWidget);
      } else {
        app._setState('Widgets', [activeWidget]);
      }
    }
  };
  const restoreFocus = () => {
    activeWidget = null;
    app._setState('');
  };
  const getActiveWidget = () => {
    return activeWidget;
  };
  const setActiveWidget = instance => {
    activeWidget = instance;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const createComponent = (stage, type) => {
    return stage.c({
      type,
      visible: false,
      widgets: getReferences()
    });
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /**
   * Simple flat array that holds the visited hashes + state Object
   * so the router can navigate back to them
   * @type {Array}
   */
  let history = [];
  const updateHistory = request => {
    const hash = getActiveHash();
    if (!hash) {
      return;
    }

    // navigate storage flag
    const register = request.register;
    const forceNavigateStore = register.get(symbols.store);

    // test preventStorage on route configuration
    const activeRoute = getRouteByHash(hash);
    const preventStorage = getOption(activeRoute.options, 'preventStorage');

    // we give prio to navigate storage flag
    let store = isBoolean(forceNavigateStore) ? forceNavigateStore : !preventStorage;
    if (store) {
      const toStore = hash.replace(/^\//, '');
      const location = locationInHistory(toStore);
      const stateObject = getStateObject(getActivePage(), request);
      const routerConfig = getRouterConfig();

      // store hash if it's not a part of history or flag for
      // storage of same hash is true
      if (location === -1 || routerConfig.get('storeSameHash')) {
        history.push({
          hash: toStore,
          state: stateObject
        });
      } else {
        // if we visit the same route we want to sync history
        const prev = history.splice(location, 1)[0];
        history.push({
          hash: prev.hash,
          state: stateObject
        });
      }
    }
  };
  const locationInHistory = hash => {
    for (let i = 0; i < history.length; i++) {
      if (history[i].hash === hash) {
        return i;
      }
    }
    return -1;
  };
  const getHistoryState = hash => {
    let state = null;
    if (history.length) {
      // if no hash is provided we get the last
      // pushed history record
      if (!hash) {
        const record = history[history.length - 1];
        // could be null
        state = record.state;
      } else {
        if (locationInHistory(hash) !== -1) {
          const record = history[locationInHistory(hash)];
          state = record.state;
        }
      }
    }
    return state;
  };
  const replaceHistoryState = function () {
    let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    let hash = arguments.length > 1 ? arguments[1] : undefined;
    if (!history.length) {
      return;
    }
    const location = hash ? locationInHistory(hash) : history.length - 1;
    if (location !== -1 && isObject(state)) {
      history[location].state = state;
    }
  };
  const getStateObject = (page, request) => {
    // if the new request shared instance with the
    // previous request we used the copied state object
    if (request.isSharedInstance) {
      if (request.copiedHistoryState) {
        return request.copiedHistoryState;
      }
    } else if (page && isFunction(page.historyState)) {
      return page.historyState();
    }
    return null;
  };
  const getHistory = () => {
    return history.slice(0);
  };
  const setHistory = function () {
    let arr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    if (isArray(arr)) {
      history = arr;
    }
  };

  function getDefaultExportFromCjs (x) {
  	return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;
  }

  var isMergeableObject = function isMergeableObject(value) {
    return isNonNullObject(value) && !isSpecial(value);
  };
  function isNonNullObject(value) {
    return !!value && typeof value === 'object';
  }
  function isSpecial(value) {
    var stringValue = Object.prototype.toString.call(value);
    return stringValue === '[object RegExp]' || stringValue === '[object Date]' || isReactElement(value);
  }

  // see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25
  var canUseSymbol = typeof Symbol === 'function' && Symbol.for;
  var REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;
  function isReactElement(value) {
    return value.$$typeof === REACT_ELEMENT_TYPE;
  }
  function emptyTarget(val) {
    return Array.isArray(val) ? [] : {};
  }
  function cloneUnlessOtherwiseSpecified(value, options) {
    return options.clone !== false && options.isMergeableObject(value) ? deepmerge(emptyTarget(value), value, options) : value;
  }
  function defaultArrayMerge(target, source, options) {
    return target.concat(source).map(function (element) {
      return cloneUnlessOtherwiseSpecified(element, options);
    });
  }
  function getMergeFunction(key, options) {
    if (!options.customMerge) {
      return deepmerge;
    }
    var customMerge = options.customMerge(key);
    return typeof customMerge === 'function' ? customMerge : deepmerge;
  }
  function getEnumerableOwnPropertySymbols(target) {
    return Object.getOwnPropertySymbols ? Object.getOwnPropertySymbols(target).filter(function (symbol) {
      return Object.propertyIsEnumerable.call(target, symbol);
    }) : [];
  }
  function getKeys(target) {
    return Object.keys(target).concat(getEnumerableOwnPropertySymbols(target));
  }
  function propertyIsOnObject(object, property) {
    try {
      return property in object;
    } catch (_) {
      return false;
    }
  }

  // Protects from prototype poisoning and unexpected merging up the prototype chain.
  function propertyIsUnsafe(target, key) {
    return propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,
    && !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,
    && Object.propertyIsEnumerable.call(target, key)); // and also unsafe if they're nonenumerable.
  }
  function mergeObject(target, source, options) {
    var destination = {};
    if (options.isMergeableObject(target)) {
      getKeys(target).forEach(function (key) {
        destination[key] = cloneUnlessOtherwiseSpecified(target[key], options);
      });
    }
    getKeys(source).forEach(function (key) {
      if (propertyIsUnsafe(target, key)) {
        return;
      }
      if (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {
        destination[key] = getMergeFunction(key, options)(target[key], source[key], options);
      } else {
        destination[key] = cloneUnlessOtherwiseSpecified(source[key], options);
      }
    });
    return destination;
  }
  function deepmerge(target, source, options) {
    options = options || {};
    options.arrayMerge = options.arrayMerge || defaultArrayMerge;
    options.isMergeableObject = options.isMergeableObject || isMergeableObject;
    // cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()
    // implementations can use it. The caller may not replace it.
    options.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;
    var sourceIsArray = Array.isArray(source);
    var targetIsArray = Array.isArray(target);
    var sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;
    if (!sourceAndTargetTypesMatch) {
      return cloneUnlessOtherwiseSpecified(source, options);
    } else if (sourceIsArray) {
      return options.arrayMerge(target, source, options);
    } else {
      return mergeObject(target, source, options);
    }
  }
  deepmerge.all = function deepmergeAll(array, options) {
    if (!Array.isArray(array)) {
      throw new Error('first argument should be an array');
    }
    return array.reduce(function (prev, next) {
      return deepmerge(prev, next, options);
    }, {});
  };
  var deepmerge_1 = deepmerge;
  var cjs = deepmerge_1;

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let warned = false;
  const deprecated = function () {
    let force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    if (force === true || warned === false) {
      console.warn(["The 'Locale'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.", "Please consider using the new 'Language'-plugin instead.", 'https://rdkcentral.github.io/Lightning-SDK/#/plugins/language'].join('\n\n'));
    }
    warned = true;
  };
  class Locale {
    constructor() {
      this.__enabled = false;
    }

    /**
     * Loads translation object from external json file.
     *
     * @param {String} path Path to resource.
     * @return {Promise}
     */
    async load(path) {
      if (!this.__enabled) {
        return;
      }
      await fetch(path).then(resp => resp.json()).then(resp => {
        this.loadFromObject(resp);
      });
    }

    /**
     * Sets language used by module.
     *
     * @param {String} lang
     */
    setLanguage(lang) {
      deprecated();
      this.__enabled = true;
      this.language = lang;
    }

    /**
     * Returns reference to translation object for current language.
     *
     * @return {Object}
     */
    get tr() {
      deprecated(true);
      return this.__trObj[this.language];
    }

    /**
     * Loads translation object from existing object (binds existing object).
     *
     * @param {Object} trObj
     */
    loadFromObject(trObj) {
      deprecated();
      const fallbackLanguage = 'en';
      if (Object.keys(trObj).indexOf(this.language) === -1) {
        Log.warn('No translations found for: ' + this.language);
        if (Object.keys(trObj).indexOf(fallbackLanguage) > -1) {
          Log.warn('Using fallback language: ' + fallbackLanguage);
          this.language = fallbackLanguage;
        } else {
          const error = 'No translations found for fallback language: ' + fallbackLanguage;
          Log.error(error);
          throw Error(error);
        }
      }
      this.__trObj = trObj;
      for (const lang of Object.values(this.__trObj)) {
        for (const str of Object.keys(lang)) {
          lang[str] = new LocalizedString(lang[str]);
        }
      }
    }
  }

  /**
   * Extended string class used for localization.
   */
  class LocalizedString extends String {
    /**
     * Returns formatted LocalizedString.
     * Replaces each placeholder value (e.g. {0}, {1}) with corresponding argument.
     *
     * E.g.:
     * > new LocalizedString('{0} and {1} and {0}').format('A', 'B');
     * A and B and A
     *
     * @param  {...any} args List of arguments for placeholders.
     */
    format() {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      const sub = args.reduce((string, arg, index) => string.split("{".concat(index, "}")).join(arg), this);
      return new LocalizedString(sub);
    }
  }
  var Locale$1 = new Locale();

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class VersionLabel extends Lightning.Component {
    static _template() {
      return {
        rect: true,
        color: 0xbb0078ac,
        h: 40,
        w: 100,
        x: w => w - 50,
        y: h => h - 50,
        mount: 1,
        Text: {
          w: w => w,
          h: h => h,
          y: 5,
          x: 20,
          text: {
            fontSize: 22,
            lineHeight: 26
          }
        }
      };
    }
    _firstActive() {
      this.tag('Text').text = "APP - v".concat(this.version, "\nSDK - v").concat(this.sdkVersion);
      this.tag('Text').loadTexture();
      this.w = this.tag('Text').renderWidth + 40;
      this.h = this.tag('Text').renderHeight + 5;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class FpsIndicator extends Lightning.Component {
    static _template() {
      return {
        rect: true,
        color: 0xffffffff,
        texture: Lightning.Tools.getRoundRect(80, 80, 40),
        h: 80,
        w: 80,
        x: 100,
        y: 100,
        mount: 1,
        Background: {
          x: 3,
          y: 3,
          texture: Lightning.Tools.getRoundRect(72, 72, 36),
          color: 0xff008000
        },
        Counter: {
          w: w => w,
          h: h => h,
          y: 10,
          text: {
            fontSize: 32,
            textAlign: 'center'
          }
        },
        Text: {
          w: w => w,
          h: h => h,
          y: 48,
          text: {
            fontSize: 15,
            textAlign: 'center',
            text: 'FPS'
          }
        }
      };
    }
    _setup() {
      this.config = {
        ...{
          log: false,
          interval: 500,
          threshold: 1
        },
        ...Settings.get('platform', 'showFps')
      };
      this.fps = 0;
      this.lastFps = this.fps - this.config.threshold;
      const fpsCalculator = () => {
        this.fps = ~~(1 / this.stage.dt);
      };
      this.stage.on('frameStart', fpsCalculator);
      this.stage.off('framestart', fpsCalculator);
      this.interval = setInterval(this.showFps.bind(this), this.config.interval);
    }
    _firstActive() {
      this.showFps();
    }
    _detach() {
      clearInterval(this.interval);
    }
    showFps() {
      if (Math.abs(this.lastFps - this.fps) <= this.config.threshold) return;
      this.lastFps = this.fps;
      // green
      let bgColor = 0xff008000;
      // orange
      if (this.fps <= 40 && this.fps > 20) bgColor = 0xffffa500;
      // red
      else if (this.fps <= 20) bgColor = 0xffff0000;
      this.tag('Background').setSmooth('color', bgColor);
      this.tag('Counter').text = "".concat(this.fps);
      this.config.log && Log.info('FPS', this.fps);
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let meta = {};
  let translations = {};
  let language = null;
  let dictionary = null;
  const initLanguage = function (file) {
    let language = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    return new Promise((resolve, reject) => {
      fetch(file).then(response => response.json()).then(json => {
        setTranslations(json);
        // set language (directly or in a promise)
        typeof language === 'object' && 'then' in language && typeof language.then === 'function' ? language.then(lang => setLanguage(lang).then(resolve).catch(reject)).catch(e => {
          Log.error(e);
          reject(e);
        }) : setLanguage(language).then(resolve).catch(reject);
      }).catch(() => {
        const error = 'Language file ' + file + ' not found';
        Log.error(error);
        reject(error);
      });
    });
  };
  const setTranslations = obj => {
    if ('meta' in obj) {
      meta = {
        ...obj.meta
      };
      delete obj.meta;
    }
    translations = obj;
  };
  const getLanguage = () => {
    return language;
  };
  const setLanguage = lng => {
    language = null;
    dictionary = null;
    return new Promise((resolve, reject) => {
      if (lng in translations) {
        language = lng;
      } else {
        if ('map' in meta && lng in meta.map && meta.map[lng] in translations) {
          language = meta.map[lng];
        } else if ('default' in meta && meta.default in translations) {
          const error = 'Translations for Language ' + language + ' not found. Using default language ' + meta.default;
          Log.warn(error);
          language = meta.default;
        } else {
          const error = 'Translations for Language ' + language + ' not found.';
          Log.error(error);
          reject(error);
        }
      }
      if (language) {
        Log.info('Setting language to', language);
        const translationsObj = translations[language];
        if (typeof translationsObj === 'object') {
          dictionary = translationsObj;
          resolve();
        } else if (typeof translationsObj === 'string') {
          const url = Utils.asset(translationsObj);
          fetch(url).then(response => response.json()).then(json => {
            // save the translations for this language (to prevent loading twice)
            translations[language] = json;
            dictionary = json;
            resolve();
          }).catch(e => {
            const error = 'Error while fetching ' + url;
            Log.error(error, e);
            reject(error);
          });
        }
      }
    });
  };
  var Language = {
    translate(key) {
      let replacements = [...arguments].slice(1);

      // no replacements so just translated string
      if (replacements.length === 0) {
        return dictionary && dictionary[key] || key;
      } else {
        if (replacements.length === 1 && typeof replacements[0] === 'object') {
          replacements = replacements.pop();
        }
        return Object.keys(
        // maps array input to an object {0: 'item1', 1: 'item2'}
        Array.isArray(replacements) ? Object.assign({}, replacements) : replacements).reduce((text, replacementKey) => {
          return text.replace(new RegExp('{\\s?' + replacementKey + '\\s?}', 'g'), replacements[replacementKey]);
        }, dictionary && dictionary[key] || key);
      }
    },
    translations(obj) {
      setTranslations(obj);
    },
    set(language) {
      return setLanguage(language);
    },
    get() {
      return getLanguage();
    },
    available() {
      const languageKeys = Object.keys(translations);
      return languageKeys.map(key => ({
        code: key,
        name: meta.names && meta.names[key] || key
      }));
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const registry = {
    eventListeners: [],
    timeouts: [],
    intervals: [],
    targets: []
  };
  var Registry = {
    // Timeouts
    setTimeout(cb, timeout) {
      for (var _len = arguments.length, params = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
        params[_key - 2] = arguments[_key];
      }
      const timeoutId = setTimeout(() => {
        registry.timeouts = registry.timeouts.filter(id => id !== timeoutId);
        cb.apply(null, params);
      }, timeout, params);
      Log.info('Set Timeout', 'ID: ' + timeoutId);
      registry.timeouts.push(timeoutId);
      return timeoutId;
    },
    clearTimeout(timeoutId) {
      if (registry.timeouts.indexOf(timeoutId) > -1) {
        registry.timeouts = registry.timeouts.filter(id => id !== timeoutId);
        Log.info('Clear Timeout', 'ID: ' + timeoutId);
        clearTimeout(timeoutId);
      } else {
        Log.error('Clear Timeout', 'ID ' + timeoutId + ' not found');
      }
    },
    clearTimeouts() {
      registry.timeouts.forEach(timeoutId => {
        this.clearTimeout(timeoutId);
      });
    },
    // Intervals
    setInterval(cb, interval) {
      for (var _len2 = arguments.length, params = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {
        params[_key2 - 2] = arguments[_key2];
      }
      const intervalId = setInterval(() => {
        registry.intervals.filter(id => id !== intervalId);
        cb.apply(null, params);
      }, interval, params);
      Log.info('Set Interval', 'ID: ' + intervalId);
      registry.intervals.push(intervalId);
      return intervalId;
    },
    clearInterval(intervalId) {
      if (registry.intervals.indexOf(intervalId) > -1) {
        registry.intervals = registry.intervals.filter(id => id !== intervalId);
        Log.info('Clear Interval', 'ID: ' + intervalId);
        clearInterval(intervalId);
      } else {
        Log.error('Clear Interval', 'ID ' + intervalId + ' not found');
      }
    },
    clearIntervals() {
      registry.intervals.forEach(intervalId => {
        this.clearInterval(intervalId);
      });
    },
    // Event listeners
    addEventListener(target, event, handler) {
      target.addEventListener(event, handler);
      const targetIndex = registry.targets.indexOf(target) > -1 ? registry.targets.indexOf(target) : registry.targets.push(target) - 1;
      registry.eventListeners[targetIndex] = registry.eventListeners[targetIndex] || {};
      registry.eventListeners[targetIndex][event] = registry.eventListeners[targetIndex][event] || [];
      registry.eventListeners[targetIndex][event].push(handler);
      Log.info('Add eventListener', 'Target:', target, 'Event: ' + event, 'Handler:', handler.toString());
    },
    removeEventListener(target, event, handler) {
      const targetIndex = registry.targets.indexOf(target);
      if (targetIndex > -1 && registry.eventListeners[targetIndex] && registry.eventListeners[targetIndex][event] && registry.eventListeners[targetIndex][event].indexOf(handler) > -1) {
        registry.eventListeners[targetIndex][event] = registry.eventListeners[targetIndex][event].filter(fn => fn !== handler);
        Log.info('Remove eventListener', 'Target:', target, 'Event: ' + event, 'Handler:', handler.toString());
        target.removeEventListener(event, handler);
      } else {
        Log.error('Remove eventListener', 'Not found', 'Target', target, 'Event: ' + event, 'Handler', handler.toString());
      }
    },
    // if `event` is omitted, removes all registered event listeners for target
    // if `target` is also omitted, removes all registered event listeners
    removeEventListeners(target, event) {
      if (target && event) {
        const targetIndex = registry.targets.indexOf(target);
        if (targetIndex > -1) {
          registry.eventListeners[targetIndex][event].forEach(handler => {
            this.removeEventListener(target, event, handler);
          });
        }
      } else if (target) {
        const targetIndex = registry.targets.indexOf(target);
        if (targetIndex > -1) {
          Object.keys(registry.eventListeners[targetIndex]).forEach(_event => {
            this.removeEventListeners(target, _event);
          });
        }
      } else {
        Object.keys(registry.eventListeners).forEach(targetIndex => {
          this.removeEventListeners(registry.targets[targetIndex]);
        });
      }
    },
    // Clear everything (to be called upon app close for proper cleanup)
    clear() {
      this.clearTimeouts();
      this.clearIntervals();
      this.removeEventListeners();
      registry.eventListeners = [];
      registry.timeouts = [];
      registry.intervals = [];
      registry.targets = [];
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  const isObject$1 = v => {
    return typeof v === 'object' && v !== null;
  };
  const isString$1 = v => {
    return typeof v === 'string';
  };
  const getRgbaComponents = argb => {
    return {
      r: (argb / 65536 | 0) % 256,
      g: (argb / 256 | 0) % 256,
      b: argb * 1 % 256,
      a: argb / 16777216 | 0
    };
  };
  const mergeColors = (c1, c2, p) => {
    let r1 = (c1 / 65536 | 0) % 256;
    let g1 = (c1 / 256 | 0) % 256;
    let b1 = c1 % 256;
    let a1 = c1 / 16777216 | 0;
    let r2 = (c2 / 65536 | 0) % 256;
    let g2 = (c2 / 256 | 0) % 256;
    let b2 = c2 % 256;
    let a2 = c2 / 16777216 | 0;
    let r = r1 * p + r2 * (1 - p);
    let g = g1 * p + g2 * (1 - p);
    let b = b1 * p + b2 * (1 - p);
    let a = a1 * p + a2 * (1 - p);
    return Math.round(a) * 16777216 + Math.round(r) * 65536 + Math.round(g) * 256 + Math.round(b);
  };
  const calculateAlpha = (argb, p) => {
    if (p > 1) {
      p /= 100;
    } else if (p < 0) {
      p = 0;
    }
    let r = (argb / 65536 | 0) % 256;
    let g = (argb / 256 | 0) % 256;
    let b = argb % 256;
    return (r << 16) + (g << 8) + b + (Math.round(p * 255) | 0) * 16777216;
  };
  const getArgbNumber = rgba => {
    rgba[0] = Math.max(0, Math.min(255, rgba[0]));
    rgba[1] = Math.max(0, Math.min(255, rgba[1]));
    rgba[2] = Math.max(0, Math.min(255, rgba[2]));
    rgba[3] = Math.max(0, Math.min(255, rgba[3]));
    let v = ((rgba[3] | 0) << 24) + ((rgba[0] | 0) << 16) + ((rgba[1] | 0) << 8) + (rgba[2] | 0);
    if (v < 0) {
      v = 0xffffffff + v + 1;
    }
    return v;
  };
  const argbToHSLA = argb => {
    const col = getRgbaComponents(argb);
    const r = col.r / 255;
    const g = col.g / 255;
    const b = col.b / 255;
    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    let h = 0;
    let s = 0;
    const l = (min + max) * 0.5;
    if (l > 0) {
      const maxMin = max - min;
      if (maxMin > 0) {
        const r2 = (max - r) / maxMin;
        const g2 = (max - g) / maxMin;
        const b2 = (max - b) / maxMin;
        if (l < 0.5) {
          s = max + min;
        } else {
          s = 2 - max - min;
        }
        if (r === max && g === min) {
          h = 5.0 + b2;
        } else if (r === max) {
          h = 1.0 - g2;
        } else if (g === max && b === min) {
          h = 1.0 + r2;
        } else if (g === max) {
          h = 3.0 - b2;
        } else if (b === max) {
          h = 3.0 + g2;
        } else {
          h = 5.0 - r2;
        }
        h = h / 6;
      }
    }
    return {
      h: h % 1,
      s,
      l,
      a: col.a
    };
  };
  const hslaToARGB = hsla => {
    let r = 1;
    let g = 1;
    let b = 1;
    let h = hsla.h;
    let s = hsla.s;
    let l = hsla.l;
    if (h < 0) {
      h += 1;
    }
    let max = 0;
    if (l <= 0.5) {
      max = l * (1.0 + s);
    } else {
      max = l + s - l * s;
    }
    if (max > 0) {
      h *= 6.0;
      const min = l + l - max;
      const minMax = (max - min) / max;
      const sextant = Math.floor(h);
      const fract = h - sextant;
      const minMaxFract = max * minMax * fract;
      const mid1 = min + minMaxFract;
      const mid2 = max - minMaxFract;
      if (sextant === 0) {
        r = max;
        g = mid1;
        b = min;
      }
      if (sextant === 1) {
        r = mid2;
        g = max;
        b = min;
      }
      if (sextant === 2) {
        r = min;
        g = max;
        b = mid1;
      }
      if (sextant === 3) {
        r = min;
        g = mid2;
        b = max;
      }
      if (sextant === 4) {
        r = mid1;
        g = min;
        b = max;
      }
      if (sextant === 5) {
        r = max;
        g = min;
        b = mid2;
      }
    }
    return getArgbNumber([Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), hsla.a]);
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let colors$1 = {
    white: '#ffffff',
    black: '#000000',
    red: '#ff0000',
    green: '#00ff00',
    blue: '#0000ff',
    yellow: '#feff00',
    cyan: '#00feff',
    magenta: '#ff00ff'
  };
  const normalizedColors = {
    //store for normalized colors
  };
  const addColors = (colorsToAdd, value) => {
    if (isObject$1(colorsToAdd)) {
      // clean up normalizedColors if they exist in the to be added colors
      Object.keys(colorsToAdd).forEach(color => cleanUpNormalizedColors(color));
      colors$1 = Object.assign({}, colors$1, colorsToAdd);
    } else if (isString$1(colorsToAdd) && value) {
      cleanUpNormalizedColors(colorsToAdd);
      colors$1[colorsToAdd] = value;
    }
  };
  const cleanUpNormalizedColors = color => {
    for (let c in normalizedColors) {
      if (c.indexOf(color) > -1) {
        delete normalizedColors[c];
      }
    }
  };
  const initColors = file => {
    return new Promise((resolve, reject) => {
      if (typeof file === 'object') {
        addColors(file);
        return resolve();
      }
      fetch(file).then(response => response.json()).then(json => {
        addColors(json);
        return resolve();
      }).catch(() => {
        const error = 'Colors file ' + file + ' not found';
        Log.error(error);
        return reject(error);
      });
    });
  };
  const normalizeColorToARGB = color => {
    let targetColor = normalizedColors[color] || colors$1[color] || color;
    if (!targetColor) {
      targetColor = color;
    }
    const check = /^#([0-9A-F]{3}|[0-9A-F]{6})$/i;
    if (isString$1(targetColor) && check.test(targetColor)) {
      let hex = check.exec(targetColor)[1];
      if (hex.length === 3) {
        hex = hex.split('').map(value => {
          return value + value;
        }).join('');
      }
      targetColor = "0xff".concat(hex) * 1;
    }
    if (!normalizedColors[color]) {
      normalizedColors[color] = targetColor;
    }
    return targetColor || 0xffffffff;
  };
  var Colors$1 = color => {
    return Color.generate(color);
  };
  const Color = {
    color: null,
    generate: function () {
      let value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.color;
      if (normalizedColors[value]) {
        this.color = normalizedColors[value];
      } else {
        this.color = normalizeColorToARGB(value);
      }
      return this;
    },
    get() {
      return this.color;
    },
    alpha: function (percentage) {
      this.color = calculateAlpha(this.color, Math.abs(percentage));
      return this;
    },
    darker(percentage) {
      const hsl = argbToHSLA(this.color);
      hsl.l = hsl.l * (1 - percentage);
      this.color = hslaToARGB(hsl);
      return this;
    },
    lighter(percentage) {
      const hsl = argbToHSLA(this.color);
      hsl.l = hsl.l + (1 - hsl.l) * percentage;
      this.color = hslaToARGB(hsl);
      return this;
    },
    saturation(percentage) {
      const hsl = argbToHSLA(this.color);
      hsl.s = percentage;
      this.color = hslaToARGB(hsl);
      return this;
    },
    lightness(percentage) {
      const hsl = argbToHSLA(this.color);
      hsl.l = percentage;
      this.color = hslaToARGB(hsl);
      return this;
    },
    hue(degrees) {
      const hsl = argbToHSLA(this.color);
      hsl.h = degrees;
      this.color = hslaToARGB(hsl);
      return this;
    },
    mix(argb, p) {
      this.color = mergeColors(this.color, argb, p);
      return this;
    }
  };

  var name$1 = "@lightningjs/sdk";
  var version$1 = "4.8.3";
  var license = "Apache-2.0";
  var scripts = {
  	postinstall: "node ./scripts/postinstall.js",
  	lint: "eslint '**/*.js'",
  	release: "npm publish --access public"
  };
  var husky = {
  	hooks: {
  		"pre-commit": "lint-staged"
  	}
  };
  var dependencies = {
  	"@babel/polyfill": "^7.11.5",
  	"@lightningjs/core": "*",
  	"@michieljs/execute-as-promise": "^1.0.0",
  	deepmerge: "^4.2.2",
  	localCookie: "github:WebPlatformForEmbedded/localCookie",
  	shelljs: "^0.8.5",
  	"url-polyfill": "^1.1.10",
  	"whatwg-fetch": "^3.0.0"
  };
  var devDependencies = {
  	"@babel/core": "^7.11.6",
  	"@babel/plugin-transform-parameters": "^7.10.5 ",
  	"@babel/plugin-transform-spread": "^7.11.0",
  	"@babel/preset-env": "^7.11.5",
  	"babel-eslint": "^10.1.0",
  	eslint: "^7.10.0",
  	"eslint-config-prettier": "^6.12.0",
  	"eslint-plugin-prettier": "^3.1.4",
  	husky: "^4.3.0",
  	"lint-staged": "^10.4.0",
  	prettier: "^1.19.1",
  	rollup: "^1.32.1",
  	"rollup-plugin-babel": "^4.4.0"
  };
  var repository = {
  	type: "git",
  	url: "git@github.com:rdkcentral/Lightning-SDK.git"
  };
  var bugs = {
  	url: "https://github.com/rdkcentral/Lightning-SDK/issues"
  };
  var packageInfo = {
  	name: name$1,
  	version: version$1,
  	license: license,
  	scripts: scripts,
  	"lint-staged": {
  	"*.js": [
  		"eslint --fix"
  	],
  	"src/startApp.js": [
  		"rollup -c ./rollup.config.js"
  	]
  },
  	husky: husky,
  	dependencies: dependencies,
  	devDependencies: devDependencies,
  	repository: repository,
  	bugs: bugs
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let AppInstance;
  const defaultOptions = {
    stage: {
      w: 1920,
      h: 1080,
      clearColor: 0x00000000,
      canvas2d: false
    },
    debug: false,
    defaultFontFace: 'RobotoRegular',
    keys: {
      8: 'Back',
      13: 'Enter',
      27: 'Menu',
      37: 'Left',
      38: 'Up',
      39: 'Right',
      40: 'Down',
      174: 'ChannelDown',
      175: 'ChannelUp',
      178: 'Stop',
      250: 'PlayPause',
      191: 'Search',
      // Use "/" for keyboard
      409: 'Search'
    }
  };
  const customFontFaces$1 = [];
  const fontLoader$1 = (fonts, store) => new Promise((resolve, reject) => {
    fonts.map(_ref => {
      let {
        family,
        url,
        urls,
        descriptors
      } = _ref;
      return () => {
        const src = urls ? urls.map(url => {
          return 'url(' + url + ')';
        }) : 'url(' + url + ')';
        const fontFace = new FontFace(family, src, descriptors || {});
        store.push(fontFace);
        Log.info('Loading font', family);
        document.fonts.add(fontFace);
        return fontFace.load();
      };
    }).reduce((promise, method) => {
      return promise.then(() => method());
    }, Promise.resolve(null)).then(resolve).catch(reject);
  });
  function Application (App, appData, platformSettings) {
    const {
      width,
      height
    } = platformSettings;
    if (width && height) {
      defaultOptions.stage['w'] = width;
      defaultOptions.stage['h'] = height;
      defaultOptions.stage['precision'] = width / 1920;
    }

    // support for 720p browser
    if (!width && !height && window.innerHeight === 720) {
      defaultOptions.stage['w'] = 1280;
      defaultOptions.stage['h'] = 720;
      defaultOptions.stage['precision'] = 1280 / 1920;
    }
    return class Application extends Lightning.Application {
      constructor(options) {
        const config = cjs(defaultOptions, options);
        // Deepmerge breaks HTMLCanvasElement, so restore the passed in canvas.
        if (options.stage.canvas) {
          config.stage.canvas = options.stage.canvas;
        }
        super(config);
        this.config = config;
      }
      static _template() {
        return {
          w: 1920,
          h: 1080
        };
      }
      _setup() {
        Promise.all([this.loadFonts(App.config && App.config.fonts || App.getFonts && App.getFonts() || []),
        // to be deprecated
        Locale$1.load(App.config && App.config.locale || App.getLocale && App.getLocale()), App.language && this.loadLanguage(App.language()), App.colors && this.loadColors(App.colors())]).then(() => {
          Metrics$2.app.loaded();
          AppInstance = this.stage.c({
            ref: 'App',
            type: App,
            zIndex: 1,
            forceZIndexContext: !!platformSettings.showVersion || !!platformSettings.showFps
          });
          this.childList.a(AppInstance);
          this._refocus();
          Log.info('App version', this.config.version);
          Log.info('SDK version', packageInfo.version);
          if (platformSettings.showVersion) {
            this.childList.a({
              ref: 'VersionLabel',
              type: VersionLabel,
              version: this.config.version,
              sdkVersion: packageInfo.version,
              zIndex: 1
            });
          }
          if (platformSettings.showFps) {
            this.childList.a({
              ref: 'FpsCounter',
              type: FpsIndicator,
              zIndex: 1
            });
          }
          super._setup();
        }).catch(console.error);
      }
      _handleBack() {
        this.closeApp();
      }
      _handleExit() {
        this.closeApp();
      }
      closeApp() {
        Log.info('Signaling App Close');
        if (platformSettings.onClose && typeof platformSettings.onClose === 'function') {
          platformSettings.onClose(...arguments);
        } else {
          this.close();
        }
      }
      close() {
        Log.info('Closing App');
        Settings.clearSubscribers();
        Registry.clear();
        this.childList.remove(this.tag('App'));
        this.cleanupFonts();
        // force texture garbage collect
        this.stage.gc();
        this.destroy();
      }
      loadFonts(fonts) {
        return platformSettings.fontLoader && typeof platformSettings.fontLoader === 'function' ? platformSettings.fontLoader(fonts, customFontFaces$1) : fontLoader$1(fonts, customFontFaces$1);
      }
      cleanupFonts() {
        if ('delete' in document.fonts) {
          customFontFaces$1.forEach(fontFace => {
            Log.info('Removing font', fontFace.family);
            document.fonts.delete(fontFace);
          });
        } else {
          Log.info('No support for removing manually-added fonts');
        }
      }
      loadLanguage(config) {
        let file = Utils.asset('translations.json');
        let language = config;
        if (typeof language === 'object') {
          language = config.language || null;
          file = config.file || file;
        }
        return initLanguage(file, language);
      }
      loadColors(config) {
        let file = Utils.asset('colors.json');
        if (config && (typeof config === 'string' || typeof config === 'object')) {
          file = config;
        }
        return initColors(file);
      }
      set focus(v) {
        this._focussed = v;
        this._refocus();
      }
      _getFocused() {
        return this._focussed || this.tag('App');
      }
    };
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /**
   * @type {Lightning.Application}
   */
  let application;

  /**
   * Actual instance of the app
   * @type {Lightning.Component}
   */
  let app;

  /**
   * Component that hosts all routed pages
   * @type {Lightning.Component}
   */
  let pagesHost;

  /**
   * @type {Lightning.Stage}
   */
  let stage;

  /**
   * Platform driven Router configuration
   * @type {Map<string>}
   */
  let routerConfig;

  /**
   * Component that hosts all attached widgets
   * @type {Lightning.Component}
   */
  let widgetsHost;

  /**
   * Hash we point the browser to when we boot the app
   * and there is no deep-link provided
   * @type {string|Function}
   */
  let rootHash;

  /**
   * Boot request will fire before app start
   * can be used to execute some global logic
   * and can be configured
   */
  let bootRequest;

  /**
   * Flag if we need to update the browser location hash.
   * Router can work without.
   * @type {boolean}
   */
  let updateHash = true;

  /**
   * Will be called before a route starts, can be overridden
   * via routes config
   * @param from - route we came from
   * @param to - route we navigate to
   * @returns {Promise<*>}
   */
  // eslint-disable-next-line
  let beforeEachRoute = async (from, to) => {
    return true;
  };

  /**
   *  * Will be called after a navigate successfully resolved,
   * can be overridden via routes config
   */
  let afterEachRoute = () => {};

  /**
   * All configured routes
   * @type {Map<string, object>}
   */
  let routes$1 = new Map();

  /**
   * Store all page components per route
   * @type {Map<string, object>}
   */
  let components = new Map();

  /**
   * Flag if router has been initialised
   * @type {boolean}
   */
  let initialised = false;

  /**
   * Current page being rendered on screen
   * @type {null}
   */
  let activePage = null;
  let activeHash;
  let activeRoute;

  /**
   *  During the process of a navigation request a new
   *  request can start, to prevent unwanted behaviour
   *  the navigate()-method stores the last accepted hash
   *  so we can invalidate any prior requests
   */
  let lastAcceptedHash;

  /**
   * With on()-data providing behaviour the Router forced the App
   * in a Loading state. When the data-provider resolves we want to
   * change the state back to where we came from
   */
  let previousState;
  const mixin = app => {
    // by default the Router Baseclass provides the component
    // reference in which we store our pages
    if (app.pages) {
      pagesHost = app.pages.childList;
    }
    // if the app is using widgets we grab refs
    // and hide all the widgets
    if (app.widgets && app.widgets.children) {
      widgetsHost = app.widgets.childList;
      // hide all widgets on boot
      widgetsHost.forEach(w => w.visible = false);
    }
    app._handleBack = e => {
      step(-1);
      e.preventDefault();
    };
  };
  const bootRouter = (config, instance) => {
    let {
      appInstance,
      routes
    } = config;

    // if instance is provided and it's and Lightning Component instance
    if (instance && isPage(instance)) {
      app = instance;
    }
    if (!app) {
      app = appInstance || AppInstance;
    }
    application = app.application;
    pagesHost = application.childList;
    stage = app.stage;
    routerConfig = getConfigMap();
    mixin(app);
    if (isArray(routes)) {
      setup(config);
    } else if (isFunction(routes)) {
      console.warn('[Router]: Calling Router.route() directly is deprecated.');
      console.warn('Use object config: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration');
    }
  };
  const setup = config => {
    if (!initialised) {
      init(config);
    }
    config.routes.forEach(r => {
      const path = cleanHash(r.path);
      if (!routeExists(path)) {
        const route = createRoute(r);
        routes$1.set(path, route);
        // if route has a configured component property
        // we store it in a different map to simplify
        // the creating and destroying per route
        if (route.component) {
          let type = route.component;
          if (isComponentConstructor(type)) {
            if (!routerConfig.get('lazyCreate')) {
              type = createComponent(stage, type);
              pagesHost.a(type);
            }
          }
          components.set(path, type);
        }
      } else {
        console.error("".concat(path, " already exists in routes configuration"));
      }
    });
  };
  const init = config => {
    rootHash = config.root;
    if (isFunction(config.boot)) {
      bootRequest = config.boot;
    }
    if (isBoolean(config.updateHash)) {
      updateHash = config.updateHash;
    }
    if (isFunction(config.beforeEachRoute)) {
      beforeEachRoute = config.beforeEachRoute;
    }
    if (isFunction(config.afterEachRoute)) {
      afterEachRoute = config.afterEachRoute;
    }
    if (config.bootComponent) {
      console.warn('[Router]: Boot Component is now available as a special router: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration?id=special-routes');
      console.warn('[Router]: setting { bootComponent } property will be deprecated in a future release');
      if (isPage(config.bootComponent)) {
        config.routes.push({
          path: '$',
          component: config.bootComponent,
          // we try to assign the bootRequest as after data-provider
          // so it will behave as any other component
          after: bootRequest || null,
          options: {
            preventStorage: true
          }
        });
      } else {
        console.error("[Router]: ".concat(config.bootComponent, " is not a valid boot component"));
      }
    }
    initialised = true;
  };
  const storeComponent = (route, type) => {
    if (components.has(route)) {
      components.set(route, type);
    }
  };
  const getComponent = route => {
    if (components.has(route)) {
      return components.get(route);
    }
    return null;
  };
  /**
   * Test if router needs to update browser location hash
   * @returns {boolean}
   */
  const mustUpdateLocationHash = () => {
    if (!routerConfig || !routerConfig.size) {
      return false;
    }
    // we need support to either turn change hash off
    // per platform or per app
    const updateConfig = routerConfig.get('updateHash');
    return !(isBoolean(updateConfig) && !updateConfig || isBoolean(updateHash) && !updateHash);
  };

  /**
   * Will be called when a new navigate() request has completed
   * and has not been expired due to it's async nature
   * @param request
   */
  const onRequestResolved = request => {
    const hash = request.hash;
    const route = request.route;
    const register = request.register;
    const page = request.page;

    // clean up history if modifier is set
    if (getOption(route.options, 'clearHistory')) {
      setHistory([]);
    } else if (hash && !isWildcard.test(route.path)) {
      updateHistory(request);
    }

    // we only update the stackLocation if a route
    // is not expired before it resolves
    storeComponent(route.path, page);
    if (request.isSharedInstance || !request.isCreated) {
      emit$1(page, 'changed');
    } else if (request.isCreated) {
      emit$1(page, 'mounted');
    }

    // only update widgets if we have a host
    if (widgetsHost) {
      updateWidgets(route.widgets, page);
    }

    // we want to clean up if there is an
    // active page that is not being shared
    // between current and previous route
    if (getActivePage() && !request.isSharedInstance) {
      cleanUp(activePage, request);
    }

    // provide history object to active page
    if (register.get(symbols.historyState) && isFunction(page.historyState)) {
      page.historyState(register.get(symbols.historyState));
    }
    setActivePage(page);
    activeHash = request.hash;
    activeRoute = route.path;

    // cleanup all cancelled requests
    for (let request of navigateQueue.values()) {
      if (request.isCancelled && request.hash) {
        navigateQueue.delete(request.hash);
      }
    }
    afterEachRoute(request);
    Log.info('[route]:', route.path);
    Log.info('[hash]:', hash);
  };
  const cleanUp = (page, request) => {
    const route = activeRoute;
    const register = request.register;
    const lazyDestroy = routerConfig.get('lazyDestroy');
    const destroyOnBack = routerConfig.get('destroyOnHistoryBack');
    const keepAlive = register.get('keepAlive');
    const isFromHistory = register.get(symbols.backtrack);
    let doCleanup = false;

    // if this request is executed due to a step back in history
    // and we have configured to destroy active page when we go back
    // in history or lazyDestory is enabled
    if (isFromHistory && (destroyOnBack || lazyDestroy)) {
      doCleanup = true;
    }

    // clean up if lazyDestroy is enabled and the keepAlive flag
    // in navigation register is false
    if (lazyDestroy && !keepAlive) {
      doCleanup = true;
    }

    // if the current and new request share the same route blueprint
    if (activeRoute === request.route.path) {
      doCleanup = true;
    }
    if (doCleanup) {
      // grab original class constructor if
      // statemachine routed else store constructor
      storeComponent(route, page._routedType || page.constructor);

      // actual remove of page from memory
      pagesHost.remove(page);

      // force texture gc() if configured
      // so we can cleanup textures in the same tick
      if (routerConfig.get('gcOnUnload')) {
        stage.gc();
      }
    } else {
      // If we're not removing the page we need to
      // reset it's properties
      page.patch({
        x: 0,
        y: 0,
        scale: 1,
        alpha: 1,
        visible: false
      });
    }
  };
  const getActiveHash = () => {
    return activeHash;
  };
  const setActivePage = page => {
    activePage = page;
  };
  const getActivePage = () => {
    return activePage;
  };
  const getActiveRoute = () => {
    return activeRoute;
  };
  const getLastHash = () => {
    return lastAcceptedHash;
  };
  const setLastHash = hash => {
    lastAcceptedHash = hash;
  };
  const getPreviousState = () => {
    return previousState;
  };
  const routeExists = key => {
    return routes$1.has(key);
  };
  const getRootHash = () => {
    return rootHash;
  };
  const getBootRequest = () => {
    return bootRequest;
  };
  const getRouterConfig = () => {
    return routerConfig;
  };
  const getRoutes = () => {
    return routes$1;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const isFunction = v => {
    return typeof v === 'function';
  };
  const isObject = v => {
    return typeof v === 'object' && v !== null;
  };
  const isBoolean = v => {
    return typeof v === 'boolean';
  };
  const isPage = v => {
    if (v instanceof Lightning.Element || isComponentConstructor(v)) {
      return true;
    }
    return false;
  };
  const isComponentConstructor = type => {
    return type.prototype && 'isComponent' in type.prototype;
  };
  const isArray = v => {
    return Array.isArray(v);
  };
  const ucfirst = v => {
    return "".concat(v.charAt(0).toUpperCase()).concat(v.slice(1));
  };
  const isString = v => {
    return typeof v === 'string';
  };
  const isPromise = method => {
    let result;
    if (isFunction(method)) {
      try {
        result = method.apply(null);
      } catch (e) {
        result = e;
      }
    } else {
      result = method;
    }
    return isObject(result) && isFunction(result.then);
  };
  const cleanHash = function () {
    let hash = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
    return hash.replace(/^#/, '').replace(/\/+$/, '');
  };
  const getConfigMap = () => {
    const routerSettings = Settings.get('platform', 'router');
    const isObj = isObject(routerSettings);
    return ['backtrack', 'gcOnUnload', 'destroyOnHistoryBack', 'lazyCreate', 'lazyDestroy', 'reuseInstance', 'autoRestoreRemote', 'numberNavigation', 'updateHash', 'storeSameHash'].reduce((config, key) => {
      config.set(key, isObj ? routerSettings[key] : Settings.get('platform', key));
      return config;
    }, new Map());
  };
  const getQueryStringParams = function () {
    let hash = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getActiveHash();
    const resumeHash = getResumeHash();
    if ((hash === '$' || !hash) && resumeHash) {
      if (isString(resumeHash)) {
        hash = resumeHash;
      }
    }
    let parse = '';
    const getQuery = /([?&].*)/;
    const matches = getQuery.exec(hash);
    const params = {};
    if (document.location && document.location.search) {
      parse = document.location.search;
    }
    if (matches && matches.length) {
      let hashParams = matches[1];
      if (parse) {
        // if location.search is not empty we
        // remove the leading ? to create a
        // valid string
        hashParams = hashParams.replace(/^\?/, '');
        // we parse hash params last so they we can always
        // override search params with hash params
        parse = "".concat(parse, "&").concat(hashParams);
      } else {
        parse = hashParams;
      }
    }
    if (parse) {
      const urlParams = new URLSearchParams(parse);
      for (const [key, value] of urlParams.entries()) {
        params[key] = value;
      }
      return params;
    } else {
      return false;
    }
  };
  const objectToQueryString = obj => {
    if (!isObject(obj)) {
      return '';
    }
    return '?' + Object.keys(obj).map(key => {
      return "".concat(key, "=").concat(obj[key]);
    }).join('&');
  };
  const symbols = {
    route: Symbol('route'),
    hash: Symbol('hash'),
    store: Symbol('store'),
    fromHistory: Symbol('fromHistory'),
    expires: Symbol('expires'),
    resume: Symbol('resume'),
    backtrack: Symbol('backtrack'),
    historyState: Symbol('historyState'),
    queryParams: Symbol('queryParams')
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const dataHooks = {
    on: request => {
      app.state || '';
      app._setState('Loading');
      return execProvider(request);
    },
    before: request => {
      return execProvider(request);
    },
    after: request => {
      try {
        execProvider(request, true);
      } catch (e) {
        // for now we fail silently
      }
      return Promise.resolve();
    }
  };
  const execProvider = (request, emitProvided) => {
    const route = request.route;
    const provider = route.provider;
    const expires = route.cache ? route.cache * 1000 : 0;
    const params = addPersistData(request);
    return provider.request(request.page, {
      ...params
    }).then(() => {
      request.page[symbols.expires] = Date.now() + expires;
      if (emitProvided) {
        emit$1(request.page, 'dataProvided');
      }
    }).catch(e => {
      request.page[symbols.expires] = Date.now();
      throw e;
    });
  };
  const addPersistData = _ref => {
    let {
      page,
      route,
      hash,
      register = new Map()
    } = _ref;
    const urlValues = getValuesFromHash(hash, route.path);
    const queryParams = getQueryStringParams(hash);
    const pageData = new Map([...urlValues, ...register]);
    const params = {};

    // make dynamic url data available to the page
    // as instance properties
    for (let [name, value] of pageData) {
      params[name] = value;
    }
    if (queryParams) {
      params[symbols.queryParams] = queryParams;
    }

    // check navigation register for persistent data
    if (register.size) {
      const obj = {};
      for (let [k, v] of register) {
        obj[k] = v;
      }
      page.persist = obj;
    }

    // make url data and persist data available
    // via params property
    page.params = params;
    emit$1(page, ['urlParams'], params);
    return params;
  };

  /**
   * Test if page passed cache-time
   * @param page
   * @returns {boolean}
   */
  const isPageExpired = page => {
    if (!page[symbols.expires]) {
      return false;
    }
    const expires = page[symbols.expires];
    const now = Date.now();
    return now >= expires;
  };
  const hasProvider = path => {
    if (routeExists(path)) {
      const record = routes$1.get(path);
      return !!record.provider;
    }
    return false;
  };
  const getProvider = route => {
    // @todo: fix, route already is passed in
    if (routeExists(route.path)) {
      const {
        provider
      } = routes$1.get(route.path);
      return {
        type: provider.type,
        provider: provider.request
      };
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  const fade = (i, o) => {
    return new Promise(resolve => {
      i.patch({
        alpha: 0,
        visible: true,
        smooth: {
          alpha: [1, {
            duration: 0.5,
            delay: 0.1
          }]
        }
      });
      // resolve on y finish
      i.transition('alpha').on('finish', () => {
        if (o) {
          o.visible = false;
        }
        resolve();
      });
    });
  };
  const crossFade = (i, o) => {
    return new Promise(resolve => {
      i.patch({
        alpha: 0,
        visible: true,
        smooth: {
          alpha: [1, {
            duration: 0.5,
            delay: 0.1
          }]
        }
      });
      if (o) {
        o.patch({
          smooth: {
            alpha: [0, {
              duration: 0.5,
              delay: 0.3
            }]
          }
        });
      }
      // resolve on y finish
      i.transition('alpha').on('finish', () => {
        resolve();
      });
    });
  };
  const moveOnAxes = (axis, direction, i, o) => {
    const bounds = axis === 'x' ? 1920 : 1080;
    return new Promise(resolve => {
      i.patch({
        ["".concat(axis)]: direction ? bounds * -1 : bounds,
        visible: true,
        smooth: {
          ["".concat(axis)]: [0, {
            duration: 0.4,
            delay: 0.2
          }]
        }
      });
      // out is optional
      if (o) {
        o.patch({
          ["".concat(axis)]: 0,
          smooth: {
            ["".concat(axis)]: [direction ? bounds : bounds * -1, {
              duration: 0.4,
              delay: 0.2
            }]
          }
        });
      }
      // resolve on y finish
      i.transition(axis).on('finish', () => {
        resolve();
      });
    });
  };
  const up = (i, o) => {
    return moveOnAxes('y', 0, i, o);
  };
  const down = (i, o) => {
    return moveOnAxes('y', 1, i, o);
  };
  const left = (i, o) => {
    return moveOnAxes('x', 0, i, o);
  };
  const right = (i, o) => {
    return moveOnAxes('x', 1, i, o);
  };
  var Transitions = {
    fade,
    crossFade,
    up,
    down,
    left,
    right
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /**
   * execute transition between new / old page and
   * toggle the defined widgets
   * @todo: platform override default transition
   * @param pageIn
   * @param pageOut
   */
  const executeTransition = function (pageIn) {
    let pageOut = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    const transition = pageIn.pageTransition || pageIn.easing;
    const hasCustomTransitions = !!(pageIn.smoothIn || pageIn.smoothInOut || transition);
    const transitionsDisabled = getRouterConfig().get('disableTransitions');
    if (pageIn.easing) {
      console.warn('easing() method is deprecated and will be removed. Use pageTransition()');
    }

    // default behaviour is a visibility toggle
    if (!hasCustomTransitions || transitionsDisabled) {
      pageIn.visible = true;
      if (pageOut) {
        pageOut.visible = false;
      }
      return Promise.resolve();
    }
    if (transition) {
      let type;
      try {
        type = transition.call(pageIn, pageIn, pageOut);
      } catch (e) {
        type = 'crossFade';
      }
      if (isPromise(type)) {
        return type;
      }
      if (isString(type)) {
        const fn = Transitions[type];
        if (fn) {
          return fn(pageIn, pageOut);
        }
      }

      // keep backwards compatible for now
      if (pageIn.smoothIn) {
        // provide a smooth function that resolves itself
        // on transition finish
        const smooth = function (p, v) {
          let args = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          return new Promise(resolve => {
            pageIn.visible = true;
            pageIn.setSmooth(p, v, args);
            pageIn.transition(p).on('finish', () => {
              resolve();
            });
          });
        };
        return pageIn.smoothIn({
          pageIn,
          smooth
        });
      }
    }
    return Transitions.crossFade(pageIn, pageOut);
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /**
   * The actual loading of the component
   * */
  const load = async request => {
    let expired = false;
    try {
      request = await loader$1(request);
      if (request && !request.isCancelled) {
        // in case of on() providing we need to reset
        // app state;
        if (app.state === 'Loading') {
          if (getPreviousState() === 'Widgets') ; else {
            app._setState('');
          }
        }
        // Do page transition if instance
        // is not shared between the routes
        if (!request.isSharedInstance && !request.isCancelled) {
          await executeTransition(request.page, getActivePage());
        }
      } else {
        expired = true;
      }
      // on expired we only cleanup
      if (expired || request.isCancelled) {
        Log.debug('[router]:', "Rejected ".concat(request.hash, " because route to ").concat(getLastHash(), " started"));
        if (request.isCreated && !request.isSharedInstance) {
          // remove from render-tree
          pagesHost.remove(request.page);
        }
      } else {
        onRequestResolved(request);
        // resolve promise
        return request.page;
      }
    } catch (request) {
      if (!request.route) {
        console.error(request);
      } else if (!expired) {
        // @todo: revisit
        const {
          route
        } = request;
        // clean up history if modifier is set
        if (getOption(route.options, 'clearHistory')) {
          setHistory([]);
        } else if (!isWildcard.test(route.path)) {
          updateHistory(request);
        }
        if (request.isCreated && !request.isSharedInstance) {
          // remove from render-tree
          pagesHost.remove(request.page);
        }
        handleError(request);
      }
    }
  };
  const loader$1 = async request => {
    const route = request.route;
    const hash = request.hash;
    const register = request.register;

    // todo: grab from Route instance
    let type = getComponent(route.path);
    let isConstruct = isComponentConstructor(type);
    let provide = false;

    // if it's an instance bt we're not coming back from
    // history we test if we can re-use this instance
    if (!isConstruct && !register.get(symbols.backtrack)) {
      if (!mustReuse(route)) {
        type = type.constructor;
        isConstruct = true;
      }
    }

    // If page is Lightning Component instance
    if (!isConstruct) {
      request.page = type;
      // if we have have a data route for current page
      if (hasProvider(route.path)) {
        if (isPageExpired(type) || type[symbols.hash] !== hash) {
          provide = true;
        }
      }
      let currentRoute = getActivePage() && getActivePage()[symbols.route];
      // if the new route is equal to the current route it means that both
      // route share the Component instance and stack location / since this case
      // is conflicting with the way before() and after() loading works we flag it,
      // and check platform settings in we want to re-use instance
      if (route.path === currentRoute) {
        request.isSharedInstance = true;
        // since we're re-using the instance we must attach
        // historyState to the request to prevent it from
        // being overridden.
        if (isFunction(request.page.historyState)) {
          request.copiedHistoryState = request.page.historyState();
        }
      }
    } else {
      request.page = createComponent(stage, type);
      pagesHost.a(request.page);
      // test if need to request data provider
      if (hasProvider(route.path)) {
        provide = true;
      }
      request.isCreated = true;
    }

    // we store hash and route as properties on the page instance
    // that way we can easily calculate new behaviour on page reload
    request.page[symbols.hash] = hash;
    request.page[symbols.route] = route.path;
    try {
      if (provide) {
        // extract attached data-provider for route
        // we're processing
        const {
          type: loadType,
          provider
        } = getProvider(route);

        // update running request
        request.provider = provider;
        request.providerType = loadType;
        await dataHooks[loadType](request);

        // we early exit if the current request is expired
        if (hash !== getLastHash()) {
          return false;
        } else {
          if (request.providerType !== 'after') {
            emit$1(request.page, 'dataProvided');
          }
          // resolve promise
          return request;
        }
      } else {
        addPersistData(request);
        return request;
      }
    } catch (e) {
      request.error = e;
      return Promise.reject(request);
    }
  };
  const handleError = request => {
    if (request && request.error) {
      console.error(request.error);
    } else if (request) {
      Log.error(request);
    }
    if (request.page && routeExists('!')) {
      navigate('!', {
        request
      }, false);
    }
  };
  const mustReuse = route => {
    const opt = getOption(route.options, 'reuseInstance');
    const config = routerConfig.get('reuseInstance');

    // route always has final decision
    if (isBoolean(opt)) {
      return opt;
    }
    return !(isBoolean(config) && config === false);
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class RoutedApp extends Lightning.Component {
    static _template() {
      return {
        Pages: {
          forceZIndexContext: true
        },
        /**
         * This is a default Loading page that will be made visible
         * during data-provider on() you CAN override in child-class
         */
        Loading: {
          rect: true,
          w: 1920,
          h: 1080,
          color: 0xff000000,
          visible: false,
          zIndex: 99,
          Label: {
            mount: 0.5,
            x: 960,
            y: 540,
            text: {
              text: 'Loading..'
            }
          }
        }
      };
    }
    static _states() {
      return [class Loading extends this {
        $enter() {
          this.tag('Loading').visible = true;
        }
        $exit() {
          this.tag('Loading').visible = false;
        }
      }, class Widgets extends this {
        $enter(args, widget) {
          // store widget reference
          this._widget = widget;

          // since it's possible that this behaviour
          // is non-remote driven we force a recalculation
          // of the focuspath
          this._refocus();
        }
        _getFocused() {
          // we delegate focus to selected widget
          // so it can consume remotecontrol presses
          return this._widget;
        }

        // if we want to widget to widget focus delegation
        reload(widget) {
          this._widget = widget;
          this._refocus();
        }
        _handleKey() {
          const restoreFocus = routerConfig.get('autoRestoreRemote');
          /**
           * The Router used to delegate focus back to the page instance on
           * every unhandled key. This is barely usefull in any situation
           * so for now we offer the option to explicity turn that behaviour off
           * so we don't don't introduce a breaking change.
           */
          if (!isBoolean(restoreFocus) || restoreFocus === true) {
            Router.focusPage();
          }
        }
      }];
    }

    /**
     * Return location where pages need to be stored
     */
    get pages() {
      return this.tag('Pages');
    }

    /**
     * Tell router where widgets are stored
     */
    get widgets() {
      return this.tag('Widgets');
    }

    /**
     * we MUST register _handleBack method so the Router
     * can override it
     * @private
     */
    _handleBack() {}

    /**
     * We MUST return Router.activePage() so the new Page
     * can listen to the remote-control.
     */
    _getFocused() {
      return Router.getActivePage();
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  /*
  rouThor ==[x]
   */
  let navigateQueue = new Map();
  let forcedHash = '';
  let resumeHash = '';

  /**
   * Start routing the app
   * @param config - route config object
   * @param instance - instance of the app
   */
  const startRouter = (config, instance) => {
    bootRouter(config, instance);
    registerListener();
    start();
  };

  // start translating url
  const start = () => {
    let hash = (getHash$1() || '').replace(/^#/, '');
    const bootKey = '$';
    const params = getQueryStringParams(hash);
    const bootRequest = getBootRequest();
    const rootHash = getRootHash();
    const isDirectLoad = hash.indexOf(bootKey) !== -1;

    // prevent direct reload of wildcard routes
    // expect bootComponent
    if (isWildcard.test(hash) && hash !== bootKey) {
      hash = '';
    }

    // store resume point for manual resume
    resumeHash = isDirectLoad ? rootHash : hash || rootHash;
    const ready = () => {
      if (!hash && rootHash) {
        if (isString(rootHash)) {
          navigate(rootHash);
        } else if (isFunction(rootHash)) {
          rootHash().then(res => {
            if (isObject(res)) {
              navigate(res.path, res.params);
            } else {
              navigate(res);
            }
          });
        }
      } else {
        queue(hash);
        handleHashChange().then(() => {
          app._refocus();
        }).catch(e => {
          console.error(e);
        });
      }
    };
    if (routeExists(bootKey)) {
      if (hash && !isDirectLoad) {
        if (!getRouteByHash(hash)) {
          navigate('*', {
            failedHash: hash
          });
          return;
        }
      }
      navigate(bootKey, {
        resume: resumeHash,
        reload: bootKey === hash
      }, false);
    } else if (isFunction(bootRequest)) {
      bootRequest(params).then(() => {
        ready();
      }).catch(e => {
        handleBootError(e);
      });
    } else {
      ready();
    }
  };
  const handleBootError = e => {
    if (routeExists('!')) {
      navigate('!', {
        request: {
          error: e
        }
      });
    } else {
      console.error(e);
    }
  };

  /**
   * start a new request
   * @param url
   * @param args
   * @param store
   */
  const navigate = function (url) {
    let args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    let store = arguments.length > 2 ? arguments[2] : undefined;
    if (isObject(url)) {
      url = getHashByName(url);
      if (!url) {
        return;
      }
    }
    let hash = getHash$1();
    if (!mustUpdateLocationHash() && forcedHash) {
      hash = forcedHash;
    }
    if (hash.replace(/^#/, '') !== url) {
      // push request in the queue
      queue(url, args, store);
      setHash(url);
      if (!mustUpdateLocationHash()) {
        forcedHash = url;
        handleHashChange(url).then(() => {
          app._refocus();
        }).catch(e => {
          console.error(e);
        });
      }
    } else if (args.reload) {
      // push request in the queue
      queue(url, args, store);
      handleHashChange(url).then(() => {
        app._refocus();
      }).catch(e => {
        console.error(e);
      });
    }
  };
  const queue = function (hash) {
    let args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    let store = arguments.length > 2 ? arguments[2] : undefined;
    hash = cleanHash(hash);
    if (!navigateQueue.has(hash)) {
      for (let request of navigateQueue.values()) {
        request.cancel();
      }
      const request = createRequest(hash, args, store);
      navigateQueue.set(decodeURIComponent(hash), request);
      return request;
    }
    return false;
  };

  /**
   * Handle change of hash
   * @param override
   * @returns {Promise<void>}
   */
  const handleHashChange = async override => {
    const hash = cleanHash(override || getHash$1());
    const queueId = decodeURIComponent(hash);
    let request = navigateQueue.get(queueId);

    // handle hash updated manually
    if (!request && !navigateQueue.size) {
      request = queue(hash);
    }
    const route = getRouteByHash(hash);
    if (!route) {
      if (routeExists('*')) {
        navigate('*', {
          failedHash: hash
        });
      } else {
        console.error("Unable to navigate to: ".concat(hash));
      }
      return;
    }

    // update current processed request
    request.hash = hash;
    request.route = route;
    let result = await beforeEachRoute(getActiveHash(), request);

    // test if a local hook is configured for the route
    if (result && route.beforeNavigate) {
      result = await route.beforeNavigate(getActiveHash(), request);
    }
    if (isBoolean(result)) {
      // only if resolve value is explicitly true
      // we continue the current route request
      if (result) {
        return resolveHashChange(request);
      }
    } else {
      // if navigation guard didn't return true
      // we cancel the current request
      request.cancel();
      navigateQueue.delete(queueId);
      if (isString(result)) {
        navigate(result);
      } else if (isObject(result)) {
        let store = true;
        if (isBoolean(result.store)) {
          store = result.store;
        }
        navigate(result.path, result.params, store);
      }
    }
  };

  /**
   * Continue processing the hash change if not blocked
   * by global or local hook
   * @param request - {}
   */
  const resolveHashChange = request => {
    const hash = request.hash;
    const route = request.route;
    const queueId = decodeURIComponent(hash);
    // store last requested hash so we can
    // prevent a route that resolved later
    // from displaying itself
    setLastHash(hash);
    if (route.path) {
      const component = getComponent(route.path);
      // if a hook is provided for the current route
      if (isFunction(route.hook)) {
        const urlParams = getValuesFromHash(hash, route.path);
        const params = {};
        for (const key of urlParams.keys()) {
          params[key] = urlParams.get(key);
        }
        route.hook(app, {
          ...params
        });
      }
      // if there is a component attached to the route
      if (component) {
        // force page to root state to prevent shared state issues
        const activePage = getActivePage();
        if (activePage) {
          const keepAlive = keepActivePageAlive(getActiveRoute(), request);
          if (activePage && route.path === getActiveRoute() && !keepAlive) {
            activePage._setState('');
          }
        }
        if (isPage(component)) {
          load(request).then(() => {
            app._refocus();
            navigateQueue.delete(queueId);
          });
        } else {
          // of the component is not a constructor
          // or a Component instance we can assume
          // that it's a dynamic import
          component().then(contents => {
            return contents.default;
          }).then(module => {
            storeComponent(route.path, module);
            return load(request);
          }).then(() => {
            app._refocus();
            navigateQueue.delete(queueId);
          });
        }
      } else {
        navigateQueue.delete(queueId);
      }
    }
  };

  /**
   * Directional step in history
   * @param level
   */
  const step = function () {
    let level = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
    if (!level || isNaN(level)) {
      return false;
    }
    const history = getHistory();
    // for now we only support negative numbers
    level = Math.abs(level);

    // we can't step back past the amount
    // of history entries
    if (level > history.length) {
      if (isFunction(app._handleAppClose)) {
        return app._handleAppClose();
      }
      return app.application.closeApp();
    } else if (history.length) {
      // for now we only support history back
      const route = history.splice(history.length - level, level)[0];
      // store changed history
      setHistory(history);
      return navigate(route.hash, {
        [symbols.backtrack]: true,
        [symbols.historyState]: route.state
      }, false);
    } else if (routerConfig.get('backtrack')) {
      const hashLastPart = /(\/:?[\w%\s-]+)$/;
      let hash = stripRegex(getHash$1());
      let floor = getFloor(hash);

      // test if we got deep-linked
      if (floor > 1) {
        while (floor--) {
          // strip of last part
          hash = hash.replace(hashLastPart, '');
          // if we have a configured route
          // we navigate to it
          if (getRouteByHash(hash)) {
            return navigate(hash, {
              [symbols.backtrack]: true
            }, false);
          }
        }
      }
    }
    return false;
  };

  /**
   * Resume Router's page loading process after
   * the BootComponent became visible;
   */
  const resume = () => {
    if (isString(resumeHash)) {
      navigate(resumeHash, false);
      resumeHash = '';
    } else if (isFunction(resumeHash)) {
      resumeHash().then(res => {
        resumeHash = '';
        if (isObject(res)) {
          navigate(res.path, res.params);
        } else {
          navigate(res);
        }
      });
    } else {
      console.warn('[Router]: resume() called but no hash found');
    }
  };

  /**
   * Force reload active hash
   */
  const reload = () => {
    if (!isNavigating()) {
      const hash = getActiveHash();
      navigate(hash, {
        reload: true
      }, false);
    }
  };

  /**
   * Query if the Router is still processing a Request
   * @returns {boolean}
   */
  const isNavigating = () => {
    if (navigateQueue.size) {
      let isProcessing = false;
      for (let request of navigateQueue.values()) {
        if (!request.isCancelled) {
          isProcessing = true;
        }
      }
      return isProcessing;
    }
    return false;
  };
  const getResumeHash = () => {
    return resumeHash;
  };

  /**
   * By default we return the location hash
   * @returns {string}
   */
  let getHash$1 = () => {
    return document.location.hash;
  };

  /**
   * Update location hash
   * @param url
   */
  let setHash = url => {
    document.location.hash = url;
  };

  /**
   * This can be called from the platform / bootstrapper to override
   * the default getting and setting of the hash
   * @param config
   */
  const initRouter = config => {
    if (config.getHash) {
      getHash$1 = config.getHash;
    }
    if (config.setHash) {
      setHash = config.setHash;
    }
  };

  /**
   * On hash change we start processing
   */
  const registerListener = () => {
    Registry.addEventListener(window, 'hashchange', async () => {
      if (mustUpdateLocationHash()) {
        try {
          await handleHashChange();
        } catch (e) {
          console.error(e);
        }
      }
    });
  };

  /**
   * Navigate to root hash
   */
  const root = () => {
    const rootHash = getRootHash();
    if (isString(rootHash)) {
      navigate(rootHash);
    } else if (isFunction(rootHash)) {
      rootHash().then(res => {
        if (isObject(res)) {
          navigate(res.path, res.params);
        } else {
          navigate(res);
        }
      });
    }
  };

  // export API
  var Router = {
    startRouter,
    navigate,
    resume,
    step,
    go: step,
    back: step.bind(null, -1),
    activePage: getActivePage,
    getActivePage() {
      // warning
      return getActivePage();
    },
    getActiveRoute,
    getActiveHash,
    focusWidget,
    getActiveWidget,
    restoreFocus,
    isNavigating,
    getHistory,
    setHistory,
    getHistoryState,
    replaceHistoryState,
    getQueryStringParams,
    reload,
    symbols,
    App: RoutedApp,
    // keep backwards compatible
    focusPage: restoreFocus,
    root: root,
    /**
     * Deprecated api methods
     */
    setupRoutes() {
      console.warn('Router: setupRoutes is deprecated, consolidate your configuration');
      console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration');
    },
    on() {
      console.warn('Router.on() is deprecated, consolidate your configuration');
      console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration');
    },
    before() {
      console.warn('Router.before() is deprecated, consolidate your configuration');
      console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration');
    },
    after() {
      console.warn('Router.after() is deprecated, consolidate your configuration');
      console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration');
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const defaultChannels = [{
    number: 1,
    name: 'Metro News 1',
    description: 'New York Cable News Channel',
    entitled: true,
    program: {
      title: 'The Morning Show',
      description: "New York's best morning show",
      startTime: new Date(new Date() - 60 * 5 * 1000).toUTCString(),
      // started 5 minutes ago
      duration: 60 * 30,
      // 30 minutes
      ageRating: 0
    }
  }, {
    number: 2,
    name: 'MTV',
    description: 'Music Television',
    entitled: true,
    program: {
      title: 'Beavis and Butthead',
      description: 'American adult animated sitcom created by Mike Judge',
      startTime: new Date(new Date() - 60 * 20 * 1000).toUTCString(),
      // started 20 minutes ago
      duration: 60 * 45,
      // 45 minutes
      ageRating: 18
    }
  }, {
    number: 3,
    name: 'NBC',
    description: 'NBC TV Network',
    entitled: false,
    program: {
      title: 'The Tonight Show Starring Jimmy Fallon',
      description: 'Late-night talk show hosted by Jimmy Fallon on NBC',
      startTime: new Date(new Date() - 60 * 10 * 1000).toUTCString(),
      // started 10 minutes ago
      duration: 60 * 60,
      // 1 hour
      ageRating: 10
    }
  }];
  const channels = () => Settings.get('platform', 'tv', defaultChannels);
  const randomChannel = () => channels()[~~(channels.length * Math.random())];

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let currentChannel;
  const callbacks = {};
  const emit = function (event) {
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }
    callbacks[event] && callbacks[event].forEach(cb => {
      cb.apply(null, args);
    });
  };

  // local mock methods
  let methods = {
    getChannel() {
      if (!currentChannel) currentChannel = randomChannel();
      return new Promise((resolve, reject) => {
        if (currentChannel) {
          const channel = {
            ...currentChannel
          };
          delete channel.program;
          resolve(channel);
        } else {
          reject('No channel found');
        }
      });
    },
    getProgram() {
      if (!currentChannel) currentChannel = randomChannel();
      return new Promise((resolve, reject) => {
        currentChannel.program ? resolve(currentChannel.program) : reject('No program found');
      });
    },
    setChannel(number) {
      return new Promise((resolve, reject) => {
        if (number) {
          const newChannel = channels().find(c => c.number === number);
          if (newChannel) {
            currentChannel = newChannel;
            const channel = {
              ...currentChannel
            };
            delete channel.program;
            emit('channelChange', channel);
            resolve(channel);
          } else {
            reject('Channel not found');
          }
        } else {
          reject('No channel number supplied');
        }
      });
    }
  };
  const initTV = config => {
    methods = {};
    if (config.getChannel && typeof config.getChannel === 'function') {
      methods.getChannel = config.getChannel;
    }
    if (config.getProgram && typeof config.getProgram === 'function') {
      methods.getProgram = config.getProgram;
    }
    if (config.setChannel && typeof config.setChannel === 'function') {
      methods.setChannel = config.setChannel;
    }
    if (config.emit && typeof config.emit === 'function') {
      config.emit(emit);
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const initPurchase = config => {
    if (config.billingUrl) config.billingUrl;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class PinInput extends Lightning.Component {
    static _template() {
      return {
        w: 120,
        h: 150,
        rect: true,
        color: 0xff949393,
        alpha: 0.5,
        shader: {
          type: Lightning.shaders.RoundedRectangle,
          radius: 10
        },
        Nr: {
          w: w => w,
          y: 24,
          text: {
            text: '',
            textColor: 0xff333333,
            fontSize: 80,
            textAlign: 'center',
            verticalAlign: 'middle'
          }
        }
      };
    }
    set index(v) {
      this.x = v * (120 + 24);
    }
    set nr(v) {
      this._timeout && clearTimeout(this._timeout);
      if (v) {
        this.setSmooth('alpha', 1);
      } else {
        this.setSmooth('alpha', 0.5);
      }
      this.tag('Nr').patch({
        text: {
          text: v && v.toString() || '',
          fontSize: v === '*' ? 120 : 80
        }
      });
      if (v && v !== '*') {
        this._timeout = setTimeout(() => {
          this._timeout = null;
          this.nr = '*';
        }, 750);
      }
    }
  }
  class PinDialog extends Lightning.Component {
    static _template() {
      return {
        zIndex: 1,
        w: w => w,
        h: h => h,
        rect: true,
        color: 0xdd000000,
        alpha: 0.000001,
        Dialog: {
          w: 648,
          h: 320,
          y: h => (h - 320) / 2,
          x: w => (w - 648) / 2,
          rect: true,
          color: 0xdd333333,
          shader: {
            type: Lightning.shaders.RoundedRectangle,
            radius: 10
          },
          Info: {
            y: 24,
            x: 48,
            text: {
              text: 'Please enter your PIN',
              fontSize: 32
            }
          },
          Msg: {
            y: 260,
            x: 48,
            text: {
              text: '',
              fontSize: 28,
              textColor: 0xffffffff
            }
          },
          Code: {
            x: 48,
            y: 96
          }
        }
      };
    }
    _init() {
      const children = [];
      for (let i = 0; i < 4; i++) {
        children.push({
          type: PinInput,
          index: i
        });
      }
      this.tag('Code').children = children;
    }
    get pin() {
      if (!this._pin) this._pin = '';
      return this._pin;
    }
    set pin(v) {
      if (v.length <= 4) {
        const maskedPin = new Array(Math.max(v.length - 1, 0)).fill('*', 0, v.length - 1);
        v.length && maskedPin.push(v.length > this._pin.length ? v.slice(-1) : '*');
        for (let i = 0; i < 4; i++) {
          this.tag('Code').children[i].nr = maskedPin[i] || '';
        }
        this._pin = v;
      }
    }
    get msg() {
      if (!this._msg) this._msg = '';
      return this._msg;
    }
    set msg(v) {
      this._timeout && clearTimeout(this._timeout);
      this._msg = v;
      if (this._msg) {
        this.tag('Msg').text = this._msg;
        this.tag('Info').setSmooth('alpha', 0.5);
        this.tag('Code').setSmooth('alpha', 0.5);
      } else {
        this.tag('Msg').text = '';
        this.tag('Info').setSmooth('alpha', 1);
        this.tag('Code').setSmooth('alpha', 1);
      }
      this._timeout = setTimeout(() => {
        this.msg = '';
      }, 2000);
    }
    _firstActive() {
      this.setSmooth('alpha', 1);
    }
    _handleKey(event) {
      if (this.msg) {
        this.msg = false;
      } else {
        const val = parseInt(event.key);
        if (val > -1) {
          this.pin += val;
        }
      }
    }
    _handleBack() {
      if (this.msg) {
        this.msg = false;
      } else {
        if (this.pin.length) {
          this.pin = this.pin.slice(0, this.pin.length - 1);
        } else {
          Pin.hide();
          this.resolve(false);
        }
      }
    }
    _handleEnter() {
      if (this.msg) {
        this.msg = false;
      } else {
        Pin.submit(this.pin).then(val => {
          this.msg = 'Unlocking ...';
          setTimeout(() => {
            Pin.hide();
          }, 1000);
          this.resolve(val);
        }).catch(e => {
          this.msg = e;
          this.reject(e);
        });
      }
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */

  // only used during local development
  let unlocked = false;
  const contextItems = ['purchase', 'parental'];
  let submit = (pin, context) => {
    return new Promise((resolve, reject) => {
      if (pin.toString() === Settings.get('platform', 'pin', '0000').toString()) {
        unlocked = true;
        resolve(unlocked);
      } else {
        reject('Incorrect pin');
      }
    });
  };
  let check = context => {
    return new Promise(resolve => {
      resolve(unlocked);
    });
  };
  const initPin = config => {
    if (config.submit && typeof config.submit === 'function') {
      submit = config.submit;
    }
    if (config.check && typeof config.check === 'function') {
      check = config.check;
    }
  };
  let pinDialog = null;
  const contextCheck = context => {
    if (context === undefined) {
      Log.info('Please provide context explicitly');
      return contextItems[0];
    } else if (!contextItems.includes(context)) {
      Log.warn('Incorrect context provided');
      return false;
    }
    return context;
  };

  // Public API
  var Pin = {
    show() {
      return new Promise((resolve, reject) => {
        pinDialog = ApplicationInstance.stage.c({
          ref: 'PinDialog',
          type: PinDialog,
          resolve,
          reject
        });
        ApplicationInstance.childList.a(pinDialog);
        ApplicationInstance.focus = pinDialog;
      });
    },
    hide() {
      ApplicationInstance.focus = null;
      ApplicationInstance.children = ApplicationInstance.children.map(child => child !== pinDialog && child);
      pinDialog = null;
    },
    submit(pin, context) {
      return new Promise((resolve, reject) => {
        try {
          context = contextCheck(context);
          if (context) {
            submit(pin, context).then(resolve).catch(reject);
          } else {
            reject('Incorrect Context provided');
          }
        } catch (e) {
          reject(e);
        }
      });
    },
    unlocked(context) {
      return new Promise((resolve, reject) => {
        try {
          context = contextCheck(context);
          if (context) {
            check(context).then(resolve).catch(reject);
          } else {
            reject('Incorrect Context provided');
          }
        } catch (e) {
          reject(e);
        }
      });
    },
    locked(context) {
      return new Promise((resolve, reject) => {
        try {
          context = contextCheck(context);
          if (context) {
            check(context).then(unlocked => resolve(!!!unlocked)).catch(reject);
          } else {
            reject('Incorrect Context provided');
          }
        } catch (e) {
          reject(e);
        }
      });
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let ApplicationInstance;
  var Launch = (App, appSettings, platformSettings, appData) => {
    initSettings(appSettings, platformSettings);
    initUtils(platformSettings);
    initStorage();
    // Initialize plugins
    if (platformSettings.plugins) {
      platformSettings.plugins.profile && initProfile(platformSettings.plugins.profile);
      platformSettings.plugins.metrics && initMetrics(platformSettings.plugins.metrics);
      platformSettings.plugins.mediaPlayer && initMediaPlayer(platformSettings.plugins.mediaPlayer);
      platformSettings.plugins.mediaPlayer && initVideoPlayer(platformSettings.plugins.mediaPlayer);
      platformSettings.plugins.ads && initAds(platformSettings.plugins.ads);
      platformSettings.plugins.router && initRouter(platformSettings.plugins.router);
      platformSettings.plugins.tv && initTV(platformSettings.plugins.tv);
      platformSettings.plugins.purchase && initPurchase(platformSettings.plugins.purchase);
      platformSettings.plugins.pin && initPin(platformSettings.plugins.pin);
    }
    const app = Application(App, appData, platformSettings);
    ApplicationInstance = new app(appSettings);
    return ApplicationInstance;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class VideoTexture extends Lightning.Component {
    static _template() {
      return {
        Video: {
          alpha: 1,
          visible: false,
          pivot: 0.5,
          texture: {
            type: Lightning.textures.StaticTexture,
            options: {}
          }
        }
      };
    }
    set videoEl(v) {
      this._videoEl = v;
    }
    get videoEl() {
      return this._videoEl;
    }
    get videoView() {
      return this.tag('Video');
    }
    get videoTexture() {
      return this.videoView.texture;
    }
    get isVisible() {
      return this.videoView.alpha === 1 && this.videoView.visible === true;
    }
    _init() {
      this._createVideoTexture();
    }
    _createVideoTexture() {
      const stage = this.stage;
      const gl = stage.gl;
      const glTexture = gl.createTexture();
      gl.bindTexture(gl.TEXTURE_2D, glTexture);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
      this.videoTexture.options = {
        source: glTexture,
        w: this.videoEl.width,
        h: this.videoEl.height
      };
      this.videoView.w = this.videoEl.width / this.stage.getRenderPrecision();
      this.videoView.h = this.videoEl.height / this.stage.getRenderPrecision();
    }
    start() {
      const stage = this.stage;
      this._lastTime = 0;
      if (!this._updateVideoTexture) {
        this._updateVideoTexture = () => {
          if (this.videoTexture.options.source && this.videoEl.videoWidth && this.active) {
            const gl = stage.gl;
            const currentTime = new Date().getTime();
            const getVideoPlaybackQuality = this.videoEl.getVideoPlaybackQuality();

            // When BR2_PACKAGE_GST1_PLUGINS_BAD_PLUGIN_DEBUGUTILS is not set in WPE, webkitDecodedFrameCount will not be available.
            // We'll fallback to fixed 30fps in this case.
            // As 'webkitDecodedFrameCount' is about to deprecate, check for the 'totalVideoFrames'
            const frameCount = getVideoPlaybackQuality ? getVideoPlaybackQuality.totalVideoFrames : this.videoEl.webkitDecodedFrameCount;
            const mustUpdate = frameCount ? this._lastFrame !== frameCount : this._lastTime < currentTime - 30;
            if (mustUpdate) {
              this._lastTime = currentTime;
              this._lastFrame = frameCount;
              try {
                gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source);
                gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);
                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.videoEl);
                this._lastFrame = this.videoEl.webkitDecodedFrameCount;
                this.videoView.visible = true;
                this.videoTexture.options.w = this.videoEl.width;
                this.videoTexture.options.h = this.videoEl.height;
                const expectedAspectRatio = this.videoView.w / this.videoView.h;
                const realAspectRatio = this.videoEl.width / this.videoEl.height;
                if (expectedAspectRatio > realAspectRatio) {
                  this.videoView.scaleX = realAspectRatio / expectedAspectRatio;
                  this.videoView.scaleY = 1;
                } else {
                  this.videoView.scaleY = expectedAspectRatio / realAspectRatio;
                  this.videoView.scaleX = 1;
                }
              } catch (e) {
                Log.error('texImage2d video', e);
                this.stop();
              }
              this.videoTexture.source.forceRenderUpdate();
            }
          }
        };
      }
      if (!this._updatingVideoTexture) {
        stage.on('frameStart', this._updateVideoTexture);
        this._updatingVideoTexture = true;
      }
    }
    stop() {
      const stage = this.stage;
      stage.removeListener('frameStart', this._updateVideoTexture);
      this._updatingVideoTexture = false;
      this.videoView.visible = false;
      if (this.videoTexture.options.source) {
        const gl = stage.gl;
        gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source);
        gl.clearColor(0, 0, 0, 1);
        gl.clear(gl.COLOR_BUFFER_BIT);
      }
    }
    position(top, left) {
      this.videoView.patch({
        smooth: {
          x: left,
          y: top
        }
      });
    }
    size(width, height) {
      this.videoView.patch({
        smooth: {
          w: width,
          h: height
        }
      });
    }
    show() {
      this.videoView.setSmooth('alpha', 1);
    }
    hide() {
      this.videoView.setSmooth('alpha', 0);
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let mediaUrl = url => url;
  let videoEl;
  let videoTexture;
  let metrics;
  let consumer$1;
  let precision = 1;
  let textureMode = false;
  const initVideoPlayer = config => {
    if (config.mediaUrl) {
      mediaUrl = config.mediaUrl;
    }
  };

  // todo: add this in a 'Registry' plugin
  // to be able to always clean this up on app close
  let eventHandlers = {};
  const state$1 = {
    adsEnabled: false,
    playing: false,
    _playingAds: false,
    get playingAds() {
      return this._playingAds;
    },
    set playingAds(val) {
      if (this._playingAds !== val) {
        this._playingAds = val;
        fireOnConsumer$1(val === true ? 'AdStart' : 'AdEnd');
      }
    },
    skipTime: false,
    playAfterSeek: null
  };
  const hooks = {
    play() {
      state$1.playing = true;
    },
    pause() {
      state$1.playing = false;
    },
    seeked() {
      state$1.playAfterSeek === true && videoPlayerPlugin.play();
      state$1.playAfterSeek = null;
    },
    abort() {
      deregisterEventListeners();
    }
  };
  const withPrecision = val => Math.round(precision * val) + 'px';
  const fireOnConsumer$1 = (event, args) => {
    if (consumer$1) {
      consumer$1.fire('$videoPlayer' + event, args, videoEl.currentTime);
      consumer$1.fire('$videoPlayerEvent', event, args, videoEl.currentTime);
    }
  };
  const fireHook = (event, args) => {
    hooks[event] && typeof hooks[event] === 'function' && hooks[event].call(null, event, args);
  };
  let customLoader = null;
  let customUnloader = null;
  const loader = (url, videoEl, config) => {
    return customLoader && typeof customLoader === 'function' ? customLoader(url, videoEl, config) : new Promise(resolve => {
      url = mediaUrl(url);
      videoEl.setAttribute('src', url);
      videoEl.load();
      resolve();
    });
  };
  const unloader = videoEl => {
    return customUnloader && typeof customUnloader === 'function' ? customUnloader(videoEl) : new Promise(resolve => {
      videoEl.removeAttribute('src');
      videoEl.load();
      resolve();
    });
  };
  const setupVideoTag = () => {
    const videoEls = document.getElementsByTagName('video');
    if (videoEls && videoEls.length) {
      return videoEls[0];
    } else {
      const videoEl = document.createElement('video');
      const platformSettingsWidth = Settings.get('platform', 'width') ? Settings.get('platform', 'width') : 1920;
      const platformSettingsHeight = Settings.get('platform', 'height') ? Settings.get('platform', 'height') : 1080;
      videoEl.setAttribute('id', 'video-player');
      videoEl.setAttribute('width', withPrecision(platformSettingsWidth));
      videoEl.setAttribute('height', withPrecision(platformSettingsHeight));
      videoEl.style.position = 'absolute';
      videoEl.style.zIndex = '1';
      videoEl.style.display = 'none';
      videoEl.style.visibility = 'hidden';
      videoEl.style.top = withPrecision(0);
      videoEl.style.left = withPrecision(0);
      videoEl.style.width = withPrecision(platformSettingsWidth);
      videoEl.style.height = withPrecision(platformSettingsHeight);
      document.body.appendChild(videoEl);
      return videoEl;
    }
  };
  const setUpVideoTexture = () => {
    if (!ApplicationInstance.tag('VideoTexture')) {
      const el = ApplicationInstance.stage.c({
        type: VideoTexture,
        ref: 'VideoTexture',
        zIndex: 0,
        videoEl
      });
      ApplicationInstance.childList.addAt(el, 0);
    }
    return ApplicationInstance.tag('VideoTexture');
  };
  const registerEventListeners = () => {
    Log.info('VideoPlayer', 'Registering event listeners');
    Object.keys(events$2).forEach(event => {
      const handler = e => {
        // Fire a metric for each event (if it exists on the metrics object)
        if (metrics && metrics[event] && typeof metrics[event] === 'function') {
          metrics[event]({
            currentTime: videoEl.currentTime
          });
        }
        // fire an internal hook
        fireHook(event, {
          videoElement: videoEl,
          event: e
        });

        // fire the event (with human friendly event name) to the consumer of the VideoPlayer
        fireOnConsumer$1(events$2[event], {
          videoElement: videoEl,
          event: e
        });
      };
      eventHandlers[event] = handler;
      videoEl.addEventListener(event, handler);
    });
  };
  const deregisterEventListeners = () => {
    Log.info('VideoPlayer', 'Deregistering event listeners');
    Object.keys(eventHandlers).forEach(event => {
      videoEl.removeEventListener(event, eventHandlers[event]);
    });
    eventHandlers = {};
  };
  const videoPlayerPlugin = {
    consumer(component) {
      consumer$1 = component;
    },
    loader(loaderFn) {
      customLoader = loaderFn;
    },
    unloader(unloaderFn) {
      customUnloader = unloaderFn;
    },
    position() {
      let top = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      let left = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      videoEl.style.left = withPrecision(left);
      videoEl.style.top = withPrecision(top);
      if (textureMode === true) {
        videoTexture.position(top, left);
      }
    },
    size() {
      let width = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1920;
      let height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1080;
      videoEl.style.width = withPrecision(width);
      videoEl.style.height = withPrecision(height);
      videoEl.width = parseFloat(videoEl.style.width);
      videoEl.height = parseFloat(videoEl.style.height);
      if (textureMode === true) {
        videoTexture.size(width, height);
      }
    },
    area() {
      let top = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      let right = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1920;
      let bottom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1080;
      let left = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
      this.position(top, left);
      this.size(right - left, bottom - top);
    },
    open(url) {
      let config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      if (!this.canInteract) return;
      metrics = Metrics$2.media(url);
      this.hide();
      deregisterEventListeners();
      if (this.src == url) {
        this.clear().then(this.open(url, config));
      } else {
        const adConfig = {
          enabled: state$1.adsEnabled,
          duration: 300
        };
        if (config.videoId) {
          adConfig.caid = config.videoId;
        }
        Ads.get(adConfig, consumer$1).then(ads => {
          state$1.playingAds = true;
          ads.prerolls().then(() => {
            state$1.playingAds = false;
            loader(url, videoEl, config).then(() => {
              registerEventListeners();
              this.show();
              this.play();
            }).catch(e => {
              fireOnConsumer$1('error', {
                videoElement: videoEl,
                event: e
              });
            });
          });
        });
      }
    },
    reload() {
      if (!this.canInteract) return;
      const url = videoEl.getAttribute('src');
      this.close();
      this.open(url);
    },
    close() {
      Ads.cancel();
      if (state$1.playingAds) {
        state$1.playingAds = false;
        Ads.stop();
        // call self in next tick
        setTimeout(() => {
          this.close();
        });
      }
      if (!this.canInteract) return;
      this.clear();
      this.hide();
      deregisterEventListeners();
    },
    clear() {
      if (!this.canInteract) return;
      // pause the video first to disable sound
      this.pause();
      if (textureMode === true) videoTexture.stop();
      return unloader(videoEl).then(() => {
        fireOnConsumer$1('Clear', {
          videoElement: videoEl
        });
      });
    },
    play() {
      if (!this.canInteract) return;
      if (textureMode === true) videoTexture.start();
      executeAsPromise(videoEl.play, null, videoEl).catch(e => {
        fireOnConsumer$1('error', {
          videoElement: videoEl,
          event: e
        });
      });
    },
    pause() {
      if (!this.canInteract) return;
      videoEl.pause();
    },
    playPause() {
      if (!this.canInteract) return;
      this.playing === true ? this.pause() : this.play();
    },
    mute() {
      let muted = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      if (!this.canInteract) return;
      videoEl.muted = muted;
    },
    loop() {
      let looped = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      videoEl.loop = looped;
    },
    seek(time) {
      if (!this.canInteract) return;
      if (!this.src) return;
      // define whether should continue to play after seek is complete (in seeked hook)
      if (state$1.playAfterSeek === null) {
        state$1.playAfterSeek = !!state$1.playing;
      }
      // pause before actually seeking
      this.pause();
      // currentTime always between 0 and the duration of the video (minus 0.1s to not set to the final frame and stall the video)
      videoEl.currentTime = Math.max(0, Math.min(time, this.duration - 0.1));
    },
    skip(seconds) {
      if (!this.canInteract) return;
      if (!this.src) return;
      state$1.skipTime = (state$1.skipTime || videoEl.currentTime) + seconds;
      easeExecution(() => {
        this.seek(state$1.skipTime);
        state$1.skipTime = false;
      }, 300);
    },
    show() {
      if (!this.canInteract) return;
      if (textureMode === true) {
        videoTexture.show();
      } else {
        videoEl.style.display = 'block';
        videoEl.style.visibility = 'visible';
      }
    },
    hide() {
      if (!this.canInteract) return;
      if (textureMode === true) {
        videoTexture.hide();
      } else {
        videoEl.style.display = 'none';
        videoEl.style.visibility = 'hidden';
      }
    },
    enableAds() {
      let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      state$1.adsEnabled = enabled;
    },
    /* Public getters */
    get duration() {
      return videoEl && (isNaN(videoEl.duration) ? Infinity : videoEl.duration);
    },
    get currentTime() {
      return videoEl && videoEl.currentTime;
    },
    get muted() {
      return videoEl && videoEl.muted;
    },
    get looped() {
      return videoEl && videoEl.loop;
    },
    get src() {
      return videoEl && videoEl.getAttribute('src');
    },
    get playing() {
      return state$1.playing;
    },
    get playingAds() {
      return state$1.playingAds;
    },
    get canInteract() {
      // todo: perhaps add an extra flag wether we allow interactions (i.e. pauze, mute, etc.) during ad playback
      return state$1.playingAds === false;
    },
    get top() {
      return videoEl && parseFloat(videoEl.style.top);
    },
    get left() {
      return videoEl && parseFloat(videoEl.style.left);
    },
    get bottom() {
      return videoEl && parseFloat(videoEl.style.top - videoEl.style.height);
    },
    get right() {
      return videoEl && parseFloat(videoEl.style.left - videoEl.style.width);
    },
    get width() {
      return videoEl && parseFloat(videoEl.style.width);
    },
    get height() {
      return videoEl && parseFloat(videoEl.style.height);
    },
    get visible() {
      if (textureMode === true) {
        return videoTexture.isVisible;
      } else {
        return videoEl && videoEl.style.display === 'block';
      }
    },
    get adsEnabled() {
      return state$1.adsEnabled;
    },
    // prefixed with underscore to indicate 'semi-private'
    // because it's not recommended to interact directly with the video element
    get _videoEl() {
      return videoEl;
    },
    get _consumer() {
      return consumer$1;
    }
  };
  var VideoPlayer = autoSetupMixin(videoPlayerPlugin, () => {
    precision = ApplicationInstance && ApplicationInstance.stage && ApplicationInstance.stage.getRenderPrecision() || precision;
    videoEl = setupVideoTag();
    textureMode = Settings.get('platform', 'textureMode', false);
    if (textureMode === true) {
      videoEl.setAttribute('crossorigin', 'anonymous');
      videoTexture = setUpVideoTexture();
    }
  });

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  let consumer;
  let getAds = () => {
    // todo: enable some default ads during development, maybe from the settings.json
    return Promise.resolve({
      prerolls: [],
      midrolls: [],
      postrolls: []
    });
  };
  const initAds = config => {
    if (config.getAds) {
      getAds = config.getAds;
    }
  };
  const state = {
    active: false
  };
  const playSlot = function () {
    let slot = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    return slot.reduce((promise, ad) => {
      return promise.then(() => {
        return playAd(ad);
      });
    }, Promise.resolve(null));
  };
  const playAd = ad => {
    return new Promise(resolve => {
      if (state.active === false) {
        Log.info('Ad', 'Skipping add due to inactive state');
        return resolve();
      }
      // is it safe to rely on videoplayer plugin already created the video tag?
      const videoEl = document.getElementsByTagName('video')[0];
      videoEl.style.display = 'block';
      videoEl.style.visibility = 'visible';
      videoEl.src = mediaUrl(ad.url);
      videoEl.load();
      let timeEvents = null;
      let timeout;
      const cleanup = () => {
        // remove all listeners
        Object.keys(handlers).forEach(handler => videoEl.removeEventListener(handler, handlers[handler]));
        resolve();
      };
      const handlers = {
        play() {
          Log.info('Ad', 'Play ad', ad.url);
          fireOnConsumer('Play', ad);
          sendBeacon(ad.callbacks, 'defaultImpression');
        },
        ended() {
          fireOnConsumer('Ended', ad);
          sendBeacon(ad.callbacks, 'complete');
          cleanup();
        },
        timeupdate() {
          if (!timeEvents && videoEl.duration) {
            // calculate when to fire the time based events (now that duration is known)
            timeEvents = {
              firstQuartile: videoEl.duration / 4,
              midPoint: videoEl.duration / 2,
              thirdQuartile: videoEl.duration / 4 * 3
            };
            Log.info('Ad', 'Calculated quartiles times', {
              timeEvents
            });
          }
          if (timeEvents && timeEvents.firstQuartile && videoEl.currentTime >= timeEvents.firstQuartile) {
            fireOnConsumer('FirstQuartile', ad);
            delete timeEvents.firstQuartile;
            sendBeacon(ad.callbacks, 'firstQuartile');
          }
          if (timeEvents && timeEvents.midPoint && videoEl.currentTime >= timeEvents.midPoint) {
            fireOnConsumer('MidPoint', ad);
            delete timeEvents.midPoint;
            sendBeacon(ad.callbacks, 'midPoint');
          }
          if (timeEvents && timeEvents.thirdQuartile && videoEl.currentTime >= timeEvents.thirdQuartile) {
            fireOnConsumer('ThirdQuartile', ad);
            delete timeEvents.thirdQuartile;
            sendBeacon(ad.callbacks, 'thirdQuartile');
          }
        },
        stalled() {
          fireOnConsumer('Stalled', ad);
          timeout = setTimeout(() => {
            cleanup();
          }, 5000); // make timeout configurable
        },
        canplay() {
          timeout && clearTimeout(timeout);
        },
        error() {
          fireOnConsumer('Error', ad);
          cleanup();
        },
        // this doesn't work reliably on sky box, moved logic to timeUpdate event
        // loadedmetadata() {
        //   // calculate when to fire the time based events (now that duration is known)
        //   timeEvents = {
        //     firstQuartile: videoEl.duration / 4,
        //     midPoint: videoEl.duration / 2,
        //     thirdQuartile: (videoEl.duration / 4) * 3,
        //   }
        // },
        abort() {
          cleanup();
        }
        // todo: pause, resume, mute, unmute beacons
      };
      // add all listeners
      Object.keys(handlers).forEach(handler => videoEl.addEventListener(handler, handlers[handler]));
      videoEl.play();
    });
  };
  const sendBeacon = (callbacks, event) => {
    if (callbacks && callbacks[event]) {
      Log.info('Ad', 'Sending beacon', event, callbacks[event]);
      return callbacks[event].reduce((promise, url) => {
        return promise.then(() => fetch(url)
        // always resolve, also in case of a fetch error (so we don't block firing the rest of the beacons for this event)
        // note: for fetch failed http responses don't throw an Error :)
        .then(response => {
          if (response.status === 200) {
            fireOnConsumer('Beacon' + event + 'Sent');
          } else {
            fireOnConsumer('Beacon' + event + 'Failed' + response.status);
          }
          Promise.resolve(null);
        }).catch(() => {
          Promise.resolve(null);
        }));
      }, Promise.resolve(null));
    } else {
      Log.info('Ad', 'No callback found for ' + event);
    }
  };
  const fireOnConsumer = (event, args) => {
    if (consumer) {
      consumer.fire('$ad' + event, args);
      consumer.fire('$adEvent', event, args);
    }
  };
  var Ads = {
    get(config, videoPlayerConsumer) {
      if (config.enabled === false) {
        return Promise.resolve({
          prerolls() {
            return Promise.resolve();
          }
        });
      }
      consumer = videoPlayerConsumer;
      return new Promise(resolve => {
        Log.info('Ad', 'Starting session');
        getAds(config).then(ads => {
          Log.info('Ad', 'API result', ads);
          resolve({
            prerolls() {
              if (ads.preroll) {
                state.active = true;
                fireOnConsumer('PrerollSlotImpression', ads);
                sendBeacon(ads.preroll.callbacks, 'slotImpression');
                return playSlot(ads.preroll.ads).then(() => {
                  fireOnConsumer('PrerollSlotEnd', ads);
                  sendBeacon(ads.preroll.callbacks, 'slotEnd');
                  state.active = false;
                });
              }
              return Promise.resolve();
            },
            midrolls() {
              return Promise.resolve();
            },
            postrolls() {
              return Promise.resolve();
            }
          });
        });
      });
    },
    cancel() {
      Log.info('Ad', 'Cancel Ad');
      state.active = false;
    },
    stop() {
      Log.info('Ad', 'Stop Ad');
      state.active = false;
      // fixme: duplication
      const videoEl = document.getElementsByTagName('video')[0];
      videoEl.pause();
      videoEl.removeAttribute('src');
    }
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class ScaledImageTexture extends Lightning.textures.ImageTexture {
    constructor(stage) {
      super(stage);
      this._scalingOptions = undefined;
    }
    set options(options) {
      this.resizeMode = this._scalingOptions = options;
    }
    _getLookupId() {
      return "".concat(this._src, "-").concat(this._scalingOptions.type, "-").concat(this._scalingOptions.w, "-").concat(this._scalingOptions.h);
    }
    getNonDefaults() {
      const obj = super.getNonDefaults();
      if (this._src) {
        obj.src = this._src;
      }
      return obj;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2020 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  var Img = (imageUrl, options) => {
    const imageServerUrl = Settings.get('platform', 'imageServerUrl');

    // make and return ScaledImageTexture
    const make = options => {
      // local asset, wrap it in Utils.asset()
      if (!/^(?:https?:)?\/\//i.test(imageUrl)) {
        imageUrl = Utils.asset(imageUrl);
      }

      // only pass to image server if imageServerUrl is configured
      // and if the asset isn't local to the app (i.e. has same origin)
      if (imageServerUrl && imageUrl.indexOf(window.location.origin) === -1) {
        imageUrl = Utils.ensureUrlWithProtocol(imageServerUrl + '?' + Utils.makeQueryString(imageUrl, options));
      } else {
        // Lightning will handle the resizing and has only 2 flavours (cover and contain)
        if (options.type === 'crop') options.type = 'cover';else options.type = 'contain';
      }
      return {
        type: ScaledImageTexture,
        src: imageUrl,
        options: options
      };
    };

    // merge options with default
    const setOptions = options => {
      options = {
        ...{
          type: 'contain',
          w: 0,
          h: 0
        },
        ...options
      };
      const imageQuality = Math.max(0.1, Math.min(1, (parseFloat(Settings.get('platform', 'image.quality')) || 100) / 100));
      options.w = options.w * imageQuality;
      options.h = options.h * imageQuality;
      return options;
    };

    // if options are passed, return scaled image right away
    if (options) {
      return make(setOptions(options));
    }

    // otherwise return 'chained' functions
    return {
      // official api
      exact: (w, h) => make(setOptions({
        type: 'exact',
        w,
        h
      })),
      landscape: w => make(setOptions({
        type: 'landscape',
        w
      })),
      portrait: h => make(setOptions({
        type: 'portrait',
        h
      })),
      cover: (w, h) => make(setOptions({
        type: 'cover',
        w,
        h
      })),
      contain: (w, h) => make(setOptions({
        type: 'contain',
        w,
        h
      })),
      original: () => make(setOptions({
        type: 'contain'
      }))

      // todo: add positioning - i.e. top, bottom, center, left etc.
    };
  };

  const colors = {
    fontColor: 0xffffffff,
    background: 0xff091422,
    focusBorderColor: 0xff03AAD3,
    lightHighlight: 0x4003AAD3,
    focusFillColor: 0x6003AAD3,
    searchKeyColor: 0xff1d2f46,
    searchKeyFocusColor: 0x6003AAD3,
    dynamicBtnLabel: 0xfffafafa,
    iconDynamicBtnLabel: 0xfffafafa,
    loginbBottomGradient: 0x9903AAD3,
    blackColor: 0xff000000,
    popupBlurColor: 0x80000000,
    TopToBottomGradientColor: 0x90030f1c,
    rightGradientColor: 0x00ffffff,
    errorBackgroundColor: 0xffb70606,
    itemBackground: 0xff283b51,
    buttonUnfocusColor: 0xfff3f3f3,
    seeAllCardColor: 0xff003251,
    keyboardButtonColor: 0xff8f8f8f,
    bannerImgGradient: 0x00002846,
    detailGradientBg: 0x000c2744,
    itemTitle: 0xfffafafb,
    profileBtnItem: 0xfff3f3f3,
    menuShadowColor: 0x80000000,
    keyboardInputDisplayFill: 0x00ffffff,
    keyboardInputDisplayBorder: 0x10ffffff,
    playerTopGradientColorUp: 0x232e2e2e,
    playerTopGradientColorDown: 0x052e2e2e,
    playerBottomGradientColorUp: 0x102e2e2e,
    playerBottomGradientColorDown: 0x80000000,
    menuItemFocusColor: 0x00ffffff
  };
  const fontsizes = {
    detailsPageTitle: 50,
    detailsPageDescription: 23,
    detailsPageStarring: 23,
    detailsPageCreator: 23,
    searchPageToastMessage: 28,
    seriesPageMetadata: 24,
    splashPageFooter: 24,
    iconDynamicbuttonText: 24,
    emptyPageText: 24,
    keyboardButton: 36,
    keyboardInputText: 32,
    popUpAlertText: 36,
    popUpAlertSubtext: 28,
    popupButtonsText: 24,
    videoSliderTitle: 37.5,
    bannerItemTitle: 50,
    bannerItemMetaContainer: 27,
    menuItemText: 25,
    KeyboardInputDisplayDefaultInput: 42,
    viewMore: 26
  };

  const emptyPageIcon = 'globe.png';
  const contentImagesFolder = 'content_images/';
  const imagesFolder = 'images/';
  const fallBackBanner = 'images/fallback_banner.png';
  const backIcon = 'backIcon.png';
  const playbackURL = 'https://cdn.bitmovin.com/content/assets/art-of-motion-dash-hls-progressive/mpds/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.mpd';
  const activeCategory = 'activeCategory';
  const stateInfo = 'stateInfo';
  const bannerKey = 'banner';
  const gridStateInfo = 'gridStateInfo';
  const rewindImage = 'images/rewind-center.png';
  const forwardImage = 'images/forward-center.png';
  const pauseImageCenter = 'images/pause-center.png';
  const playImageCenter = 'images/play-center.png';
  const pauseHighlight = 'images/highlight_pause.png';
  const playHighlight = 'images/highlight_play.png';
  const playPlain = 'images/plain_play.png';
  const pausePlain = 'images/plain_pause.png';
  const viewMoreImage = 'images/view_more.png';
  let scroll = 0;
  function setScroll(inputVal) {
    scroll = inputVal;
  }
  let categories$1 = [];
  function setCategories(inputData) {
    categories$1 = inputData;
  }
  const getButtons = () => {
    return [{
      text: Language.translate('watch_now_text'),
      layout: 'border',
      Icon: '',
      x: 90,
      y: 430,
      h: 62,
      w: 280,
      color: colors.fontColor,
      borderRadius: ''
    }];
  };
  const commaSeparatedwithSpaces = string => {
    return string.split(',').map(tag => tag.trim()).join(', ');
  };

  const homePageInfo = [{
    'title': 'Banners',
    'key': 'banner',
    'list': [
    //{},{},{}
    {
      'content_id': 1001,
      'publish_time': '2016',
      'title': 'John Wick 3',
      'orentitation': 0,
      'duration': '40 minutes',
      'banner_medium': '',
      'banner_image': 'John_wick.jpeg',
      'poster_image': 'john_wick_poster.png',
      'description': 'John Wick is on the run after killing a member of the international assassins guild, and with a $14 million price tag on his head, he is the target of hit men and women everywhere.',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1002,
      'publish_time': '2019',
      'title': 'The Handmaiden',
      'orentitation': 0,
      'duration': '90 minutes',
      'banner_medium': '',
      'banner_image': 'Handmaiden.jpeg',
      'poster_image': 'handmaiden_poster.png',
      'description': '',
      'playback_url': '',
      'tags': 'Thriller & Misdaad, Drama, Romantiek'
    }]
  }, {
    'title': 'Movies',
    'key': 'movies',
    'list': [{
      'content_id': 1008,
      'description': 'A troubled security guard begins working at Freddy Fazbears Pizza During his first night on the job, he realizes that the night shift wont be so easy to get through. Pretty soon he will unveil what actually happened at Freddys',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'FIVE NIGHTS AT FREDDYS',
      'orentitation': 1,
      'banner_medium': 'cae23eedba1c8c08b57ebc9e893879c419f4d4e9.jpg',
      'banner_image': 'five_nights.jpeg',
      'poster_image': 'poster_4.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1009,
      'description': 'The incredible true story of a former government agent turned vigilante who embarks on a dangerous mission to rescue hundreds of children from traffickers.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'SOUND OF FREEDOM',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'sound_freedom.jpg',
      'poster_image': 'poster_5.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1010,
      'description': 'The history of the United States from the 1950s to the 70s unfolds from the perspective of an Alabama man with an IQ of 75, who yearns to be reunited with his childhood sweetheart.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Forrest Gump',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'forest_gump.jpg',
      'poster_image': 'poster_6.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1011,
      'description': 'The lives of two mob hitmen, a boxer, a gangster and his wife, and a pair of diner bandits intertwine in four tales of violence and redemption.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'PULP FICTION',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'pulp_fiction.jpeg',
      'poster_image': 'poster_7.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1012,
      'description': 'An alien scarab chooses Jaime Reyes to be its symbiotic host, bestowing the recent college graduate with a suit of armor thats capable of extraordinary powers, forever changing his destiny as he becomes the superhero known as Blue Beetle.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Blue Beetle',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'Blue_beetle.jpeg',
      'poster_image': 'poster_8.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1013,
      'description': 'During the 90s, a new faction of Transformers - the Maximals - join the Autobots as allies in the battle for Earth.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'TRANSFORMERS: RISE OF THE BEASTS',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'Transformers.jpg',
      'poster_image': 'poster_9.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1014,
      'description': 'Barbie suffers a crisis that leads her to question her world and her existence.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Barbie',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'Barbie.jpeg',
      'poster_image': 'poster_10.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1015,
      'description': 'When two girls disappear into the woods and return three days later with no memory of what happened to them, the father of one girl seeks out Chris MacNeil, whos been forever altered by what happened to her daughter fifty years ago.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'THE EXORCIST BELIEVER',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'Exorcist.jpeg',
      'poster_image': 'poster_11.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1016,
      'description': 'Dom Toretto and his family are targeted by the vengeful son of drug kingpin Hernan Reyes.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'FAST-X',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'FastX.jpeg',
      'poster_image': 'poster_12.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1017,
      'description': 'Robert McCall finds himself at home in Southern Italy but he discovers his friends are under the control of local crime bosses. As events turn deadly, McCall knows what he has to do: become his friends protector by taking on the mafia.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'THE Equalizer-3',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'equalizer_3.jpeg',
      'poster_image': 'poster_13.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1018,
      'description': 'A sick and desperate John travels to Mexico for a risky and experimental medical procedure in hopes of a miracle cure for his cancer only to discover the entire operation is a scam to defraud the most vulnerable.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'SAW X',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'saw_x.jpeg',
      'poster_image': 'poster_14.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1019,
      'description': 'The adventures of a band of space warriors who work to protect the universe from the evil overlord Thanos.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Gardians of the Galaxy',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'guardians_galaxy.webp',
      'poster_image': 'poster_1.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1020,
      'description': 'Ethan Hunt and his IMF team must track down a dangerous weapon before it falls into the wrong hands.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'MISSION:IMPOSSIBLE Dead Reckoning -Part ONE',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'mission_imposisble.jpeg',
      'poster_image': 'poster_2.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1021,
      'description': 'Armed with every weapon they can get their hands on, the Expendables are the worlds last line of defense and the team that gets called when all other options are off the table.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'EXPENDABLES-4',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'expen4bles.jpeg',
      'poster_image': 'poster_3.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1022,
      'description': 'A troubled security guard begins working at Freddy Fazbears Pizza During his first night on the job, he realizes that the night shift wont be so easy to get through. Pretty soon he will unveil what actually happened at Freddys',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'FIVE NIGHTS AT FREDDYS',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'five_nights.jpeg',
      'poster_image': 'poster_4.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1023,
      'description': 'The incredible true story of a former government agent turned vigilante who embarks on a dangerous mission to rescue hundreds of children from traffickers.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'SOUND OF FREEDOM',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'sound_freedom.jpg',
      'poster_image': 'poster_5.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1024,
      'description': 'The history of the United States from the 1950s to the 70s unfolds from the perspective of an Alabama man with an IQ of 75, who yearns to be reunited with his childhood sweetheart.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Forrest Gump',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'forest_gump.jpg',
      'poster_image': 'poster_6.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }, {
      'content_id': 1025,
      'description': 'The lives of two mob hitmen, a boxer, a gangster and his wife, and a pair of diner bandits intertwine in four tales of violence and redemption.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'PULP FICTION',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'pulp_fiction.jpeg',
      'poster_image': 'poster_7.webp',
      'playback_url': '',
      'tags': 'Thriller & Crime,Drama'
    }]
  }, {
    'title': 'Comedy',
    'key': 'comedy',
    'list': [{
      'content_id': 1026,
      'description': 'A charismatic but clueless news anchor faces challenges when a talented female journalist joins the newsroom.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Anchorman: The Legend of Ron Burgundy',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'anchorman_banner.jpeg',
      'poster_image': 'anchorman_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1027,
      'description': 'A student decides to skip school for a day of adventure, outsmarting authority figures and creating a memorable day off.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': "Ferris Bueller's Day Off",
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'ferrisbuellersdayoff_banner.jpeg',
      'poster_image': 'ferrisbuellersdayoff_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1028,
      'description': 'Two friends embark on a cross-country trip, encountering absurd and humorous situations.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Dumb and Dumber',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'dumbanddumber_banner.jpeg',
      'poster_image': 'dumbanddumber_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1029,
      'description': 'A quirky film follows the misadventures of a hotel concierge and his protégé involving a valuable painting and a murder.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'The Grand Budapest Hotel',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'thegrandbudapesthotel_banner.jpeg',
      'poster_image': 'thegrandbudapesthotel_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1030,
      'description': 'A group of paranormal investigators forms the Ghostbusters to save New York City from supernatural threats, blending comedy and supernatural elements.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Ghostbusters',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'ghostbusters_banner.jpeg',
      'poster_image': 'ghostbusters_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1031,
      'description': 'A parody of disaster films, the movie follows a mismatched crew trying to safely land a troubled flight.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Airplane!',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'airplane_banner.jpeg',
      'poster_image': 'airplane_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1032,
      'description': 'An animated comedy filled with humor and creativity as an ordinary LEGO construction worker becomes the key to saving the world.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'The LEGO Movie',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'thelegomovie_banner.jpeg',
      'poster_image': 'thelegomovie_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1033,
      'description': "A man's teddy bear comes to life, causing comedic chaos as they navigate adult life together.",
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Ted',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'ted_banner.jpeg',
      'poster_image': 'ted_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1034,
      'description': 'A man becomes embroiled in a kidnapping plot after being mistaken for a millionaire with the same name, leading to a quirky and comedic odyssey.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'The Big Lebowski',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'thebiglebowski_banner.jpeg',
      'poster_image': 'thebiglebowski_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }, {
      'content_id': 1035,
      'description': 'A dim-witted male model becomes entangled in a plot to assassinate the Prime Minister, leading to absurd and comedic situations.',
      'duration': '40 minutes',
      'publish_time': '2019',
      'title': 'Zoolander',
      'orentitation': 1,
      'banner_medium': '',
      'banner_image': 'zoolander_banner.jpeg',
      'poster_image': 'zoolander_poster.jpeg',
      'playback_url': '',
      'tags': 'comedy'
    }]
  }, {
    'title': 'News',
    'key': 'news',
    'list': [{
      'content_id': 1003,
      'description': "A television network cynically exploits a deranged former anchor's ravings and revelations about the news media for its own profit, but finds that his message may be difficult to control.",
      'publish_time': '2019',
      'title': 'Network',
      'orentitation': 1,
      'duration': '50 minutes',
      'banner_medium': '',
      'banner_image': 'network_banner.jpeg',
      'poster_image': 'network_poster.jpeg',
      'playback_url': '',
      'tags': 'News'
    }, {
      'content_id': 1004,
      'description': "The Washington Post reporters Bob Woodward and Carl Bernstein uncover the details of the Watergate scandal that leads to President Richard Nixon's resignation.",
      'publish_time': '2021',
      'title': "All the President's Men ",
      'orentitation': 1,
      'duration': '65 minutes',
      'banner_medium': '',
      'banner_image': 'atpm_poster.jpeg',
      'poster_image': 'atpm_banner.jpeg',
      'playback_url': '',
      'tags': 'News'
    }, {
      'content_id': 1005,
      'description': 'Journalist witness a nuckear power plant accident and find their attempts to expose it thwarted',
      'publish_time': '2022',
      'title': 'The China Syndrome',
      'orentitation': 1,
      'duration': '30 minutes',
      'banner_medium': '',
      'banner_image': 'tcs_banner.jpeg',
      'poster_image': 'tcs_banner.jpeg',
      'playback_url': '',
      'tags': 'News'
    }, {
      'content_id': 1006,
      'description': "A journalist is trapped in Cambodia during tyrant Pol Pot's bloody 'Year Zero' cleansing campaign, which claimed the lives of two million 'undesirable' civilians.",
      'publish_time': '2020',
      'title': 'The Killing Fields',
      'orentitation': 1,
      'duration': '80 minutes',
      'banner_medium': '',
      'banner_image': 'tkf_banner.jpeg',
      'poster_image': 'tkf_poster.jpeg',
      'playback_url': '',
      'tags': 'News'
    }, {
      'content_id': 1007,
      'description': 'A research chemist comes under personal and professional attack when he decides to appear in a 60 Minutes exposé on Big Tobacco.',
      'publish_time': '2021',
      'title': 'The Insider',
      'orentitation': 1,
      'duration': '90 minutes',
      'banner_medium': '',
      'banner_image': 'tinsider_banner.jpeg',
      'poster_image': 'tinsider_poster.jpeg',
      'playback_url': '',
      'tags': 'News'
    }]
  }];
  const categories = [{
    'content_id': 1,
    'category_id': '01',
    'title': 'Home',
    'slug': 'home',
    'icon': 'images/home.png',
    'title_en': 'Home'
  }, {
    'content_id': 1,
    'category_id': '01',
    'title': 'Search',
    'slug': 'search',
    'icon': 'images/search.png',
    'title_en': 'Search'
  }, {
    'content_id': 1,
    'category_id': '01',
    'title': 'Movies',
    'slug': 'movies',
    'icon': 'images/movies.png',
    'title_en': 'Movies'
  }, {
    'content_id': 1,
    'category_id': '01',
    'title': 'Profile',
    'slug': 'profile',
    'icon': 'images/user.png',
    'title_en': 'Profile'
  }, {
    'content_id': 1,
    'category_id': '01',
    'title': 'OTTAvatar',
    'slug': 'ottavatar',
    'icon': 'images/search-AI.png',
    'title_en': 'OTTAvatar'
  }, {
    'content_id': 1,
    'category_id': '01',
    'title': 'OTTWebgpu',
    'slug': 'ottwebgpu',
    'icon': 'images/A2.jpg',
    'title_en': 'OTTWebgpu'
  }];

  const getCategories = () => {
    return JSON.parse(JSON.stringify(categories));
  };
  const getStaticPageDetails = async type => {
    let url;
    switch (type) {
      case 'terms':
        {
          url = Utils.asset('locale/Terms.json');
          break;
        }
      case 'faq':
        {
          url = Utils.asset('locale/FAQ.json');
          break;
        }
      case 'privacy':
        {
          url = Utils.asset('locale/Privacy.json');
          break;
        }
    }
    return fetch(url).then(response => response.json()).then(data => {
      return data;
    }).catch(error => {
      return error;
    });
  };
  const getHome = () => {
    return JSON.parse(JSON.stringify(homePageInfo));
  };
  const getVideoDetails = videoId => {
    for (const category of homePageInfo) {
      for (const item of category.list) {
        if (item.content_id == videoId) {
          return item;
        }
      }
    }
  };
  const searchVideo = keyword => {
    const searchText = keyword.toLowerCase(); // Convert search text to lowercase for case-insensitive matching
    const matchingKeys = [];
    for (const category of homePageInfo) {
      for (const item of category.list) {
        const itemDescription = item.description.toLowerCase();
        const itemTitle = item.title.toLowerCase();
        if (itemTitle.includes(searchText)) {
          matchingKeys.push({
            item
          });
          break;
        } else if (itemDescription.includes(searchText)) {
          matchingKeys.push({
            item
          });
          break;
        }
      }
    }
    return matchingKeys.length > 0 ? {
      'contents': [{
        'total': matchingKeys.length,
        'list': matchingKeys
      }]
    } : null;
  };
  const getCategory = () => {
    return JSON.parse(JSON.stringify(homePageInfo));
  };

  class Home extends Lightning.Component {
    _focus() {
      this.widgets.menu.alpha = 0;
      this.widgets.iconmenu.alpha = 1;
    }
    _init() {
      this._focus();
    }
    async prepareData() {
      const homeVideos = await getHome();
      const data = this.stitchingBanners(homeVideos);
      this.patchingDataToTemplate(data);
    }
    patchingDataToTemplate(data) {
      if (categories$1 && !this.widgets.menu.categories) {
        this.widgets.menu.data = categories$1;
        this.widgets.iconmenu.data = categories$1;
      }
      if (Storage.get(activeCategory)) {
        this.widgets.menu.activeIndex = Storage.get(activeCategory);
        this.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
      }
      this.widgets.loader.alpha = 0;
      this._index = 0;
      this.checkHomeVideoLen = data.length;
      if (Storage.get(stateInfo)) {
        this.stateInfo = JSON.parse(Storage.get(stateInfo));
      }
      if (data.length > 0) {
        var _this$bannerVideos, _this$stateInfo;
        this.widgets.videoslider.alpha = 1;
        this.widgets.videoslider.data = data;
        this.widgets.emptypage.alpha = 0;
        const isBannerVisible = ((_this$bannerVideos = this.bannerVideos) === null || _this$bannerVideos === void 0 || (_this$bannerVideos = _this$bannerVideos.list) === null || _this$bannerVideos === void 0 ? void 0 : _this$bannerVideos.length) > 0 && (!this.stateInfo || ((_this$stateInfo = this.stateInfo) === null || _this$stateInfo === void 0 ? void 0 : _this$stateInfo.banner));
        this.widgets.banner.alpha = isBannerVisible ? 1 : 0;
        this.widgets.banneritem.alpha = isBannerVisible ? 0 : 1;
        Router.focusWidget(isBannerVisible ? 'Banner' : 'VideoSlider');
      } else {
        this.widgets.videoslider.alpha = 0;
        this.widgets.banner.alpha = 0;
        this.widgets.emptypage.data = {
          status: true,
          Message: Language.translate('no_content_found_string'),
          Image: emptyPageIcon
        };
        Router.focusWidget('EmptyPage');
      }
    }
    stitchingBanners(homeVideos) {
      if (homeVideos.length == 0) return homeVideos;
      this.bannerVideos = homeVideos.find(Obj => Obj.key === bannerKey);
      const homeDataWithoutBanner = homeVideos.filter(Obj => Obj.key !== bannerKey);
      this.widgets.banner.data = this.bannerVideos;
      Router.focusWidget('Banner');
      return homeDataWithoutBanner;
    }
    _handleBack() {
      this.widgets.popup.showExitPopUp();
      Router.focusWidget('Popup');
    }
    _getFocused() {
      this.widgets.banner.alpha ? Router.focusWidget('Banner') : this.focusVideoSlider();
    }
    focusVideoSlider() {
      if (this.checkHomeVideoLen > 0) {
        this.widgets.banner.alpha = 0;
        this.widgets.banneritem.alpha = 1;
        Router.focusWidget('VideoSlider');
      } else Router.focusWidget('EmptyPage');
    }
    _handleUp() {
      this.widgets.banneritem.alpha = 0;
      this.widgets.banner.alpha = 1;
      this.widgets.banner.data = this.bannerVideos;
      Router.focusWidget('Banner');
    }
  }

  var name = "OpenSource";
  var identifier = "com.tv2z.opensource";
  var version = "1.0.0";
  var icon = "./static/images/favicon.png";
  var description = "Metro Lightning Application";
  var author = "TV2Z";
  var Meta = {
  	name: name,
  	identifier: identifier,
  	version: version,
  	icon: icon,
  	description: description,
  	author: author
  };

  class Loader$1 extends Lightning.Component {
    static _template() {
      return {
        alpha: 0,
        zIndex: 9,
        Spinner: {
          mount: 0.5,
          x: 960,
          y: 540,
          w: 140,
          h: 140,
          src: Utils.asset('images/spinner.png')
        }
      };
    }
    _init() {
      this._spin = this.tag('Spinner').animation({
        duration: 2,
        repeat: -1,
        actions: [{
          p: 'rotation',
          v: {
            0: 0,
            1: Math.PI * 2
          }
        }]
      });
    }
    _enable() {
      this._spin.start();
    }
    finish() {
      this.setSmooth('alpha', 0, {
        duration: 0.6
      });
      setTimeout(() => this._spin.stop(), 400);
    }
  }

  class Splash extends Lightning.Component {
    static _template() {
      return {
        TopToBottomGradient: {
          w: App$1.width,
          h: App$1.height,
          rect: true,
          color: colors.background
        },
        AlertText: {
          x: 1250,
          y: 700,
          text: {
            text: Language.translate("splash_footer"),
            fontFace: "Regular",
            fontSize: fontsizes.splashPageFooter,
            wordWrapWidth: 500,
            lineHeight: 40,
            maxLines: 2,
            textColor: colors.fontColor
          }
        },
        Footer: {
          w: App$1.width,
          h: App$1.height * 0.13,
          color: colors.background,
          rect: true,
          y: App$1.height - App$1.height * 0.13,
          Copyright: {
            y: App$1.height * 0.13 * 0.5,
            x: 1000,
            mountX: 0.5,
            mountY: 0.5,
            text: {
              text: Language.translate("foot_copyright_def"),
              fontFace: "Regular",
              fontSize: fontsizes.splashPageFooter,
              textColor: colors.fontColor
            }
          },
          Version: {
            countY: 0.5,
            x: 1700,
            y: App$1.height * 0.13 * 0.5,
            mountY: 0.5,
            text: {
              text: "VERSION ".concat(Meta.version),
              fontFace: "Regular",
              fontSize: fontsizes.splashPageFooter,
              textColor: colors.fontColor
            }
          }
        },
        Logo: {
          x: 960,
          y: 540,
          mount: 0.5,
          src: Utils.asset("images/menu_open.png")
        },
        Loader: {
          alpha: 1,
          type: Loader$1
        }
      };
    }
    async _active() {
      const categoriesData = await getCategories();
      setCategories(await categoriesData);
      this.widgets.menu.data = categories$1;
      this.widgets.iconmenu.data = categories$1;
      setTimeout(() => {
        Router.navigate('home');
      }, 4000);
    }
  }

  class KeyboardInputDisplay extends Lightning.Component {
    static _template() {
      return {
        Display: {
          mountY: 1,
          Icon: {},
          Input: {
            x: 0,
            y: 70,
            text: {
              textAlign: 'center',
              fontSize: fontsizes.KeyboardInputDisplayDefaultInput,
              maxLines: 1,
              maxLinesSuffix: '...',
              lineHeight: 38,
              fontFace: 'Regular',
              textColor: colors.fontColor
            }
          },
          UnderLine: {
            x: 0,
            alpha: 1,
            y: 850,
            texture: Lightning.Tools.getRoundRect(470, 60, 0, 3, colors.keyboardInputDisplayFill, false, colors.fontColor)
          }
        }
      };
    }
    set displayType(inputType) {
      if (inputType == 'search') {
        this.patch({
          Display: {
            Title: {},
            Icon: {
              x: 100,
              y: 92,
              w: 30,
              h: 30,
              alpha: 0,
              src: Utils.asset('images/iconSearch.png')
            },
            SearchIcon: {
              x: 805,
              y: 10,
              alpha: 1,
              texture: Lightning.Tools.getRoundRect(71, 73, 0, 3, colors.fontColor, false),
              Img: {
                src: Utils.asset('images/search.png'),
                w: 35,
                h: 35,
                x: 20,
                y: 20
              }
            },
            UnderLine: {
              x: 905,
              y: 10,
              texture: Lightning.Tools.getRoundRect(686, 73, 0, 3, colors.fontColor, false, colors.keyboardInputDisplayBorder)
            },
            Input: {
              x: 932,
              alpha: 1,
              y: 26,
              text: {
                textAlign: 'center',
                fontSize: fontsizes.keyboardInputText,
                maxLines: 1,
                maxLinesSuffix: '...',
                lineHeight: 32,
                textColor: colors.fontColor,
                fontFace: 'Regular'
              }
            }
          }
        });
      }
    }
    set input(input) {
      this._input = input;
      this.tag('Input').patch({
        alpha: 1,
        text: {
          text: input
        }
      });
    }
    set hideTitle(bool) {
      this.tag('Title').alpha = bool ? 0 : 1;
    }
    get input() {
      return this._input;
    }
  }

  class Search extends Lightning.Component {
    static _template() {
      return {
        w: App$1.width,
        h: App$1.height,
        signals: {
          openMenu: '_openMenu'
        },
        Background: {
          w: 1920,
          h: 1080,
          color: colors.background,
          rect: true
        },
        SearchForm: {
          type: KeyboardInputDisplay,
          x: 100,
          y: 100,
          w: 480,
          props: {
            isDark: true,
            fields: [{
              id: 'query',
              label: 'Zoeken',
              value: '',
              isMasked: false
            }]
          }
        },
        Message: {
          x: 910,
          y: 200,
          alpha: 0,
          Toast: {
            w: 915,
            x: 450,
            mountX: 0.5,
            text: {
              fontFace: 'Regular',
              fontSize: fontsizes.searchPageToastMessage,
              textColor: colors.focusBorderColor,
              wordWrapWidth: 900,
              textAlign: 'left'
            }
          },
          AdditionalToast: {
            y: 100,
            w: 915,
            x: 450,
            mountX: 0.5,
            text: {
              text: Language.translate('maybe_something_else_definition'),
              fontFace: 'Regular',
              fontSize: fontsizes.searchPageToastMessage,
              textColor: colors.fontColor,
              wordWrapWidth: 900,
              textAlign: 'left'
            }
          }
        },
        KeyboardBgShadow: {
          x: 200,
          y: 72,
          alpha: 0,
          color: colors.popupBlurColor,
          texture: Lightning.Tools.getShadowRect(500 + 20, 570 + 20, 10, 16)
        }
      };
    }
    _focus() {
      Storage.set('state', 'Search');
      this.patch({
        alpha: 1
      });
      this.patch({
        Message: {
          Toast: {
            text: Language.translate('no_results') + "\"" + this.searchTerm || '' + "\""
          }
        }
      });
      this.widgets.menu.alpha = 0;
      this.widgets.iconmenu.alpha = 1;
    }
    _init() {
      this._index = 1;
      this.searchData = [];
      this.searchTerm = '';
      this.searchVal = '';
      this.widgets.keyboard.layout = 'search';
      this.tag('SearchForm').displayType = 'search';
      this.widgets.iconmenu.alpha = 1;
      this.widgets.menu.alpha = 0;
    }
    _enable() {
      if (categories$1 && !this.widgets.menu.categories) {
        this.widgets.menu.data = categories$1;
        this.widgets.iconmenu.data = categories$1;
        this.widgets.menu.activeIndex = Storage.get(activeCategory) || null;
        this.widgets.iconmenu.activeIndex = Storage.get(activeCategory) || null;
      }
      this.widgets.loader.alpha = 0;
      this._index = 1;
      this.focusItem = 'KeyBoard';
      this.patch({
        Message: {
          alpha: 0
        }
      });
      if (Storage.get('prevsearchkey') != '') {
        this._index = 3;
        this.searchTerm = Storage.get('prevsearchkey');
        Storage.set('prevsearchkey', '');
        this.widgets.searchresults.alpha = 1;
        this.tag('Message').setSmooth('alpha', 0);
        this.tag('SearchForm').input = this.searchTerm;
        this.handleSearch(this.searchTerm, 'prevsearch');
        this.widgets.keyboard.value = this.searchTerm;
      } else {
        this.tag('SearchForm').input = Language.translate('what_to_watch');
        this.widgets.searchresults.alpha = 0;
        this.tag('Message').setSmooth('alpha', 0);
        this.searchData = [];
      }
      this.widgets.keyboard.x = 220 + 20;
      this.widgets.keyboard.y = 109;
      this.widgets.keyboard.layout = 'search';
      this._index == 3 ? Router.focusWidget('SearchResults') : Router.focusWidget('Keyboard');
    }
    _handleRight() {
      if (this.widgets.searchresults.alpha) {
        this._index = 3;
        this.focusItem = 'SearchResults';
        Router.focusWidget('SearchResults');
      }
    }
    $focusKeyboard() {
      this._index = 1;
      this.focusItem = 'KeyBoard';
      this._index == 3 ? Router.focusWidget('SearchResults') : Router.focusWidget('Keyboard');
    }
    _handleUp() {
      if (this._index > 1) {
        this._index--;
        if (this._index == 1) {
          this.focusItem = 'KeyBoard';
        }
      }
    }
    _handleDown() {
      if (this._index == 0) {
        this._index++;
        this.focusItem = 'KeyBoard';
      }
    }
    _getFocused() {
      if (this._index >= 0 && this._index != 2 && !Storage.get('stateInfo')) {
        if (this.focusItem == 'KeyBoard') return Router.focusWidget('Keyboard');
      }
      if (this._index == 3 || Storage.get('stateInfo')) return Router.focusWidget('SearchResults');
    }
    _disable() {
      if (this._index != 3) {
        this._index = 1;
        this.focusItem = 'KeyBoard';
      }
    }
    async handleSearch(query) {
      let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
      if (query !== '') {
        this.widgets.loader.positions = true;
        this.widgets.loader.alpha = 1;
        const searchData = searchVideo(query);
        this.searchData = searchData === null || searchData === void 0 ? void 0 : searchData.contents.filter(val => {
          return val.list.length > 0;
        });
        searchData ? this.sendDataToWidget(searchData, type, query) : this.showNoResults();
      } else {
        this.tag('SearchForm').input = Language.translate('what_to_watch');
        this.widgets.searchresults.alpha = 0;
        this.tag('Message').setSmooth('alpha', 0);
        this.searchData = [];
      }
    }
    sendDataToWidget(searchData, type, query) {
      this.widgets.loader.alpha = 0;
      this.searchTerm = type == 'prevsearch' ? query : this.searchTerm;
      Storage.set('prevsearchkey', this.searchTerm);
      this.widgets.searchresults.alpha = 1;
      this.tag('Message').setSmooth('alpha', 0);
      // passing data to searchresults
      this.widgets.searchresults.data = {
        res: searchData.contents,
        key: this.searchTerm
      };
      this.widgets.loader.alpha = 0;
      this.focusItem = 'KeyBoard';
      if (Router.getActiveHash().includes('search')) this._index == 3 ? Router.focusWidget('SearchResults') : Router.focusWidget('Keyboard');
    }
    showNoResults() {
      this.widgets.searchresults.alpha = 0;
      this.tag('Message').setSmooth('alpha', 1);
      this.patch({
        Message: {
          Toast: {
            text: Language.translate('no_results') + ' ' + "\"" + this.searchTerm + "\""
          }
        }
      });
      this.widgets.loader.alpha = 0;
      this.focusItem = 'KeyBoard';
      Router.focusWidget('Keyboard');
    }
    onKeyboardInputUpdate(value, keyAction) {
      if (this.timer) clearTimeout(this.timer);
      switch (keyAction) {
        case 'backspace':
          this.handleBackspace();
          break;
        case 'delete':
          this.handleDelete();
          break;
        default:
          this.handleOtherKeyActions(value, keyAction);
      }
    }
    handleBackspace() {
      if (this.searchVal.length > 0) {
        this.searchVal = this.searchTerm = this.searchVal.slice(0, -1);
        this.updateSearchForm();
      }
      if (this.searchVal.length < 3 && this.searchVal.length !== 0) {
        this.hideSearchResults();
      } else if (this.searchVal.length === 0) {
        this.clearSearchForm();
      } else {
        this.prepareSearchData();
      }
    }
    handleDelete() {
      this.clearSearchForm();
      this.hideSearchResults();
      this.resetSearchData();
    }
    handleOtherKeyActions(value, keyAction) {
      if (this.searchVal.length > 23) return;
      this.searchVal += keyAction === 'space' ? ' ' : value;
      this.searchTerm = this.searchVal;
      this.updateSearchForm();
      if (this.searchTerm.length === 0) {
        this.resetSearchResults();
      } else if (this.searchTerm.length > 2) {
        this.prepareSearchData();
      } else {
        this.resetSearchResults();
      }
    }
    updateSearchForm() {
      this.tag('SearchForm').input = this.searchVal;
      this.tag('SearchForm').title = '';
    }
    clearSearchForm() {
      this.searchVal = this.searchTerm = '';
      this.tag('SearchForm').input = '';
      this.tag('SearchForm').input = Language.translate('what_to_watch');
    }
    hideSearchResults() {
      this.resetSearchResults();
      this.focusOnKeyboard();
      this.tag('Message').setSmooth('alpha', 0);
    }
    resetSearchResults() {
      this.widgets.searchresults.alpha = 0;
      this.searchData = [];
    }
    focusOnKeyboard() {
      this.focusItem = 'KeyBoard';
    }
    prepareSearchData() {
      this.searchData = [];
      this.timer = setTimeout(() => {
        this.handleSearch(this.searchTerm);
      }, 1000);
    }
    resetSearchData() {
      this.searchData = [];
      this.tag('SearchForm').input = Language.translate('what_to_watch');
    }
    onkeyboardExitLeft() {
      Router.focusWidget('Menu');
    }
    _handleBack() {
      Router.back();
    }
  }

  class UserProfile extends Lightning.Component {
    static _template() {
      return {
        Background: {
          w: App$1.width,
          h: App$1.height,
          rect: true,
          color: colors.background
        }
      };
    }
    _init() {
      this.widgets.iconmenu.alpha = 1;
      this.widgets.menu.alpha = 0;
      this.getButtonSelection('terms', 0);
      Storage.remove('selectedBtn');
    }
    _getFocused() {
      return Router.focusWidget('ProfileButtons');
    }
    _active() {
      this.widgets.loader.alpha = 0;
    }
    prepareData() {
      this.widgets.loader.alpha = 0;
      if (categories$1) {
        this.widgets.menu.data = categories$1;
        this.widgets.iconmenu.data = categories$1;
      }
      const buttonsArray = [{
        heading: 'Terms and Conditions',
        type: 'terms'
      }, {
        heading: 'Privacy Policy',
        type: 'privacy'
      }];
      this.widgets.profilebuttons.data = buttonsArray;
      Router.focusWidget('ProfileButtons');
      this.widgets.profilebuttons.listVisibility = 1;
    }
    async getButtonSelection(value, index) {
      const staticRes = await getStaticPageDetails(value);
      this.widgets.staticdata.data = staticRes;
      this.widgets.staticdata.alpha = 1;
      Storage.set('setting_index', index);
    }
    _handleBack() {
      Router.back();
    }
  }

  class Category extends Lightning.Component {
    _focus() {
      //this code snippet is focusing on the 'Videos' state, making some adjustments to the visibility of different 
      // widgets (hiding the menu(full menu) and showing the icon menu(small menu)). It ensures that the interface reflects the current focus.
      Storage.set('state', 'Videos');
      this.patch({
        alpha: 1
      });
      this.widgets.menu.alpha = 0;
      this.widgets.iconmenu.alpha = 1;
    }
    _init() {
      this._focus();
    }

    //this function fetches category data, processes it to exclude certain objects, 
    // and then further filters the data to keep only those elements with non-empty lists. 
    // It then updates the banner and template widgets with the processed data.
    async prepareData(categoryId) {
      const categoryRes = await getCategory();
      this.patchingBanner(categoryRes); // used for displaying banner widget
      const completeHomedata = categoryRes.filter(Obj => Obj.key !== bannerKey); // filtered array w/o banner Object
      const data = completeHomedata.filter(val => {
        var _val$list;
        return (val === null || val === void 0 || (_val$list = val.list) === null || _val$list === void 0 ? void 0 : _val$list.length) > 0;
      });
      this.patchingDataToTemplate(data);
    }

    //this function manages the display and focus of banner-related widgets based on the provided category data. 
    // It ensures that if no banner data is available but other categories are, 
    // it focuses on the video slider; otherwise, it updates the banner widget with the relevant data.
    patchingBanner(categoryRes) {
      var _this$bannerVideos;
      this.bannerVideos = [];
      //This line filters the categoryRes array to (include) only objects where the key equals bannerKey. 
      // The result is stored in bannerAvail.
      this.bannerAvail = categoryRes.filter(Obj => Obj.key == bannerKey);
      //This line filters the categoryRes array to (exclude) objects where the key equals bannerKey. 
      // The result is stored in checkOtherCatExceptBanner.
      this.checkOtherCatExceptBanner = categoryRes.filter(Obj => Obj.key != bannerKey);
      if (
      //This condition checks if there are no objects with bannerKey in bannerAvail and if checkOtherCatExceptBanner 
      // contains objects (meaning other categories are available except the banner).
      this.bannerAvail.length === 0 && this.checkOtherCatExceptBanner.length > 0) {
        this.widgets.banneritem.alpha = 1; // banneritems(movies, news, comedy) comes one by one to visible
        this.widgets.banner.alpha = 0; // banner goes to invisible
        Router.focusWidget('VideoSlider'); //Sets focus on the VideoSlider widget.
        return;
      }
      //If the function didn't exit earlier, it finds the object with bannerKey in categoryRes and assigns it to bannerVideos.
      this.bannerVideos = categoryRes.find(Obj => Obj.key === bannerKey);
      //This checks if bannerVideos is not undefined and if its list property has a length greater than 0.
      if (((_this$bannerVideos = this.bannerVideos) === null || _this$bannerVideos === void 0 ? void 0 : _this$bannerVideos.list.length) > 0) {
        //Updates the banner widget's data with bannerVideos.
        this.widgets.banner.data = this.bannerVideos;
        //Calls a method widgetsVisibility with bannerKey as an argument, 
        // likely to adjust the visibility of widgets based on the bannerKey.
        this.widgetsVisibility(bannerKey);
        Router.focusWidget('Banner');
      }
    }

    //this function manages the visibility of different widgets based on the value of bannerTypes.
    // It ensures that either the banner or banneritem widget is visible while making the emptypage widget invisible.
    widgetsVisibility(bannerTypes) {
      //This line checks if bannerTypes equals bannerKey.
      //If true, it sets the alpha property of the banner widget to 1 (making it visible).
      //If false, it sets the alpha property of the banner widget to 0 (making it invisible).
      this.widgets.banner.alpha = bannerTypes === bannerKey ? 1 : 0;
      //This line checks if bannerTypes equals 'banneritem'.
      //If true, it sets the alpha property of the banneritem widget to 1 (making it visible).
      //If false, it sets the alpha property of the banneritem widget to 0 (making it invisible).
      this.widgets.banneritem.alpha = bannerTypes === 'banneritem' ? 1 : 0;
      //This line sets the alpha property of the emptypage widget to 0, making it invisible.
      this.widgets.emptypage.alpha = 0;
    }

    //this function updates various widgets based on the provided data,
    // hiding or displaying elements as needed and setting focus on the appropriate widget.
    patchingDataToTemplate(data) {
      //This line sets the alpha property of the loader widget to 0, making it invisible.
      this.widgets.loader.alpha = 0;
      //This condition checks if categories exists and if menu.categories is not already set.
      //If true, it sets the menu.data and iconmenu.data to categories.
      if (categories$1 && !this.widgets.menu.categories) {
        this.widgets.menu.data = categories$1;
        this.widgets.iconmenu.data = categories$1;
      }
      //This condition checks if there is a stored value for activeCategory.
      //If true, it sets the activeIndex of both menu and iconmenu to the stored value of activeCategory.
      if (Storage.get(activeCategory)) {
        this.widgets.menu.activeIndex = Storage.get(activeCategory);
        this.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
      }
      this.widgets.loader.alpha = 0;
      this._index = 0; //This line initializes the _index property to 0.

      this.checkCatLen = data.length; //This line sets checkCatLen to the length of data.

      //This line attempts to get the stored value of stateInfo.
      //If stateInfo exists, it parses the JSON string into an object and assigns it to stateInfo.
      //If stateInfo does not exist, it assigns null to stateInfo.
      this.stateInfo = Storage.get(stateInfo) ? JSON.parse(Storage.get(stateInfo)) : null;
      //This condition checks if checkCatLen is greater than 0 (i.e., if data has any elements).
      //If true:
      //Sets emptypage.alpha to 0 (making it invisible).
      //Sets videoslider.alpha to 1 (making it visible).
      //Sets videoslider.data to data.
      //Determines whether the banner should be visible based on the length of bannerVideos.list and the state of stateInfo.banner.
      //Sets banner.alpha to 1 and banneritem.alpha to 0 if the banner should be visible, otherwise sets banner.alpha to 0 and banneritem.alpha to 1.
      //Focuses the appropriate widget (Banner or VideoSlider).
      if (this.checkCatLen > 0) {
        var _this$bannerVideos2, _this$stateInfo;
        this.widgets.emptypage.alpha = 0;
        this.widgets.videoslider.alpha = 1;
        this.widgets.videoslider.data = data;
        const isBannerVisible = ((_this$bannerVideos2 = this.bannerVideos) === null || _this$bannerVideos2 === void 0 || (_this$bannerVideos2 = _this$bannerVideos2.list) === null || _this$bannerVideos2 === void 0 ? void 0 : _this$bannerVideos2.length) > 0 && (!this.stateInfo || ((_this$stateInfo = this.stateInfo) === null || _this$stateInfo === void 0 ? void 0 : _this$stateInfo.banner));
        this.widgets.banner.alpha = isBannerVisible ? 1 : 0;
        this.widgets.banneritem.alpha = isBannerVisible ? 0 : 1;
        Router.focusWidget(isBannerVisible ? 'Banner' : 'VideoSlider');
      } else {
        //If checkCatLen is not greater than 0 (i.e., if data is empty):
        // Sets videoslider.alpha to 0 (making it invisible).
        // Sets banner.alpha to 0 (making it invisible).
        // Sets banneritem.alpha to 0 (making it invisible).
        // Sets emptypage.data to an object with status: true, a translated Message, and an Image.
        //Focuses the EmptyPage widget.
        this.widgets.videoslider.alpha = 0;
        this.widgets.banner.alpha = 0;
        this.widgets.banneritem.alpha = 0;
        this.widgets.emptypage.data = {
          status: true,
          Message: Language.translate('no_content_found_string'),
          Image: emptyPageIcon
        };
        Router.focusWidget('EmptyPage');
      }
    }
    _getFocused() {
      // Checks if the 'alpha' property of 'widgets.banner' is truthy (i.e., it exists and is not zero, null, false, etc.)
      this.widgets.banner.alpha ?
      // If true, it focuses on the 'Banner' widget using the 'Router' object's focusWidget method.
      Router.focusWidget('Banner') :
      // If false, it calls the 'focusVideoSlider' method to focus on the video slider.
      this.focusVideoSlider();
    }

    //This function appears to be dynamically managing the display and focus of different widgets based on the length of a category.
    focusVideoSlider() {
      if (this.checkCatLen > 0) {
        this.widgets.banner.alpha = 0;
        this.widgets.banneritem.alpha = 1;
        Router.focusWidget('VideoSlider');
      } else Router.focusWidget('EmptyPage');
    }
    _handleBack() {
      Router.back();
    }

    //This function ensures that the banner is properly managed and displayed when needed, 
    // based on the availability of banners and other categories.
    _handleUp() {
      if (this.bannerAvail.length === 0 && this.checkOtherCatExceptBanner.length > 0) return;
      this.widgets.banneritem.alpha = 0;
      this.widgets.banner.alpha = 1;
      this.widgets.banner.data = this.bannerVideos;
      Router.focusWidget('Banner');
    }
  }

  function asyncGeneratorStep(n, t, e, r, o, a, c) {
      try {
          var i = n[a](c), u = i.value;
      } catch (n) {
          return void e(n);
      }
      i.done ? t(u) : Promise.resolve(u).then(r, o);
  }

  function _asyncToGenerator(n) {
      return function() {
          var t = this, e = arguments;
          return new Promise((function(r, o) {
              var a = n.apply(t, e);
              function _next(n) {
                  asyncGeneratorStep(a, r, o, _next, _throw, "next", n);
              }
              function _throw(n) {
                  asyncGeneratorStep(a, r, o, _next, _throw, "throw", n);
              }
              _next(void 0);
          }));
      };
  }

  function ownKeys(e, r) {
      var t = Object.keys(e);
      if (Object.getOwnPropertySymbols) {
          var o = Object.getOwnPropertySymbols(e);
          r && (o = o.filter((function(r) {
              return Object.getOwnPropertyDescriptor(e, r).enumerable;
          }))), t.push.apply(t, o);
      }
      return t;
  }

  function _objectSpread(e) {
      for (var r = 1; r < arguments.length; r++) {
          var t = null != arguments[r] ? arguments[r] : {};
          r % 2 ? ownKeys(Object(t), !0).forEach((function(r) {
              _defineProperty(e, r, t[r]);
          })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach((function(r) {
              Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));
          }));
      }
      return e;
  }

  function _defineProperty(e, r, t) {
      return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, {
          value: t,
          enumerable: !0,
          configurable: !0,
          writable: !0
      }) : e[r] = t, e;
  }

  function _toPropertyKey(t) {
      var i = _toPrimitive(t, "string");
      return "symbol" == typeof i ? i : i + "";
  }

  function _toPrimitive(t, r) {
      if ("object" != typeof t || !t) return t;
      var e = t[Symbol.toPrimitive];
      if (void 0 !== e) {
          var i = e.call(t, r || "default");
          if ("object" != typeof i) return i;
          throw new TypeError("@@toPrimitive must return a primitive value.");
      }
      return ("string" === r ? String : Number)(t);
  }

  class Logger {
      constructor() {
          this._logCallback = undefined;
          this._prefix = "LightningUI";
          this._debug = false;
      }
      get debug() {
          return this._debug;
      }
      set debug(value) {
          this._debug = Boolean(value);
      }
      get logCallback() {
          return this._logCallback;
      }
      set logCallback(value) {
          if ("function" !== typeof value) {
              this.warn("logCallback value must be a function, instead received ".concat(typeof value));
              return;
          }
          this._logCallback = value;
      }
      log() {
          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
              args[_key] = arguments[_key];
          }
          if (this._logCallback) {
              this._logCallback({
                  level: "log",
                  payload: args
              });
          }
          if (this.debug) {
              console.log(this._prefix, ...args);
          }
      }
      info() {
          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
              args[_key2] = arguments[_key2];
          }
          if (this._logCallback) {
              this._logCallback({
                  level: "info",
                  payload: args
              });
          }
          if (this.debug) {
              console.info(this._prefix, ...args);
          }
      }
      warn() {
          for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
              args[_key3] = arguments[_key3];
          }
          if (this._logCallback) {
              this._logCallback({
                  level: "warn",
                  payload: args
              });
          }
          if (this.debug) {
              console.warn(this._prefix, ...args);
          }
      }
      error() {
          for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
              args[_key4] = arguments[_key4];
          }
          if (this._logCallback) {
              this._logCallback({
                  level: "error",
                  payload: args
              });
          }
          if (this.debug) {
              console.error(this._prefix, ...args);
          }
      }
  }

  var loggerInstance = new Logger;

  function getEuclideanDistance(xA, yA, xB, yB) {
      var xDiff = xA - xB;
      var yDiff = yA - yB;
      return Math.sqrt(Math.pow(xDiff, 2) + Math.sqrt(Math.pow(yDiff, 2)));
  }

  function getShortestDistance(coordinate, element) {
      var [xA, yA] = coordinate;
      var [xB, yB] = element.core ? element.core.getAbsoluteCoords(0, 0) : [ 0, 0 ];
      var distanceToStart = getEuclideanDistance(xA, yA, xB, yB);
      var distanceToMiddle = getEuclideanDistance(xA, yA, xB + element.w / 2, yB + element.h / 2);
      var distanceToEnd = getEuclideanDistance(xA, yA, xB + element.w, yB + element.h);
      return Math.min(distanceToStart, distanceToMiddle, distanceToEnd);
  }

  function isComponentOnScreen(component) {
      var offsets = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      if (!component) return false;
      var {w: w, h: h, core: {renderContext: {px: px, py: py}, _scissor: scissor = []} = {}} = component;
      var stageH = component.stage.h / component.stage.getRenderPrecision();
      var stageW = component.stage.w / component.stage.getRenderPrecision();
      var finalX = px;
      var finalY = py;
      var relativeOffsetX = px - component.x;
      var relativeOffsetY = py - component.y;
      var offsetX = offsets.offsetX - relativeOffsetX || 0;
      var offsetY = offsets.offsetY - relativeOffsetY || 0;
      if (component.transition("x")) {
          finalX = px - component.x + component.transition("x").targetValue;
      }
      if (component.transition("y")) {
          finalY = py - component.y + component.transition("y").targetValue;
      }
      finalX += offsetX;
      finalY += offsetY;
      var wVis = finalX >= 0 && finalX + w <= stageW;
      var hVis = finalY >= 0 && finalY + h <= stageH;
      if (!wVis || !hVis) return false;
      if (scissor && scissor.length) {
          var [leftBounds = null, topBounds = null, clipWidth = null, clipHeight = null] = scissor;
          var withinLeftClippingBounds = Math.round(finalX + w) >= Math.round(leftBounds);
          var withinRightClippingBounds = Math.round(finalX) <= Math.round(leftBounds + clipWidth);
          var withinTopClippingBounds = Math.round(finalY + h) >= Math.round(topBounds);
          var withinBottomClippingBounds = Math.round(finalY + h) <= Math.round(topBounds + clipHeight);
          return withinLeftClippingBounds && withinRightClippingBounds && withinTopClippingBounds && withinBottomClippingBounds;
      }
      return true;
  }

  function getWidthByUpCount(theme) {
      var upCount = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var screenW = theme.layout.screenW;
      var columnCount = theme.layout.columnCount;
      var marginX = theme.layout.marginX;
      var gutterX = theme.layout.gutterX;
      if (upCount < 1 || upCount > columnCount) {
          console.error("Column expects a number between 1 & ".concat(columnCount, ". Received ").concat(upCount));
          return;
      }
      var columnWidth = screenW - marginX * 2;
      var columnGapTotal = (upCount - 1) * gutterX;
      var totalColumnsWidth = columnWidth - columnGapTotal;
      return totalColumnsWidth / upCount;
  }

  function getWidthByColumnSpan(theme, columnSpan) {
      var columnCount = theme.layout.columnCount;
      var gutterX = theme.layout.gutterX;
      return getWidthByUpCount(theme, columnCount) * columnSpan + gutterX * (columnSpan - 1);
  }

  function getDimensions(theme) {
      var obj = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var fallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      var {w: w, h: h, ratioX: ratioX, ratioY: ratioY, upCount: upCount} = obj;
      var fallbackW = fallback.w || 0;
      var fallbackH = fallback.h || 0;
      var dimensions = {};
      if (w && h) {
          dimensions = {
              w: w,
              h: h
          };
      } else if (h && ratioX && ratioY) {
          dimensions = {
              w: Math.round(h * ratioX / ratioY),
              h: h
          };
      } else if (ratioX && ratioY && upCount) {
          dimensions = getItemRatioDimensions(theme, ratioX, ratioY, upCount);
      } else if (h && upCount) {
          dimensions = {
              w: Math.round(getWidthByUpCount(theme, upCount)),
              h: h
          };
      } else if (h) {
          dimensions = {
              w: fallbackW,
              h: h
          };
      } else if (w) {
          dimensions = {
              w: w,
              h: fallbackH
          };
      } else {
          dimensions = {
              w: fallbackW,
              h: fallbackH
          };
      }
      dimensions = _objectSpread(_objectSpread({}, dimensions), {}, {
          ratioX: ratioX,
          ratioY: ratioY,
          upCount: upCount
      });
      return dimensions;
  }

  function getItemRatioDimensions(theme, ratioX, ratioY, upCount) {
      var w, h;
      if (ratioX && ratioY && upCount) {
          w = Math.round(getWidthByUpCount(theme, upCount));
          h = Math.round(w / ratioX * ratioY);
      } else {
          w = 0;
          h = 0;
      }
      return {
          w: w,
          h: h
      };
  }

  function getAspectRatioW(h) {
      var ratio = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "16:9";
      var seperator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ":";
      var [ratioW, ratioH] = ratio.split(seperator);
      return h * (ratioW / ratioH);
  }

  function getAspectRatioH(w) {
      var ratio = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "16:9";
      var seperator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ":";
      var [ratioW, ratioH] = ratio.split(seperator);
      return w / (ratioW / ratioH);
  }

  function getHexColor(hex) {
      var alpha = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      if (!hex) {
          return 0;
      }
      if (typeof hex === "number") {
          hex = hex.toString(16).slice(2);
      }
      hex = hex.replace("#", "");
      var hexAlpha = Math.round(alpha * 255).toString(16);
      var str = "0x".concat(hexAlpha).concat(hex);
      return Number(str);
  }

  function getValidColor(color) {
      if (typeof color === "string" || typeof color === "number") {
          if (/^0x[0-9a-fA-F]{8}/g.test(color)) {
              return Number(color);
          } else if (/^#[0-9a-fA-F]{6}/g.test(color)) {
              return getHexColor(color.substr(1, 6));
          } else if (typeof color === "string" && /^[0-9]{8,10}/g.test(color)) {
              return parseInt(color);
          } else if (typeof color === "number" && /^[0-9]{8,10}/g.test(color.toString())) {
              return color;
          } else if (typeof color === "string" && color.indexOf("rgba") > -1) {
              return rgba2argb(color);
          } else if (typeof color === "string" && color.indexOf("rgb") > -1) {
              var rgba = [ ...color.replace(/rgb\(|\)/g, "").split(","), "255" ];
              return Lightning.StageUtils.getArgbNumber(rgba);
          }
      }
      return null;
  }

  function simplifyFraction(_ref) {
      var [numerator, denominator] = _ref;
      for (var i = numerator; i > 0; i--) {
          if (!(numerator % i) && !(denominator % i)) {
              return [ numerator / i, denominator / i ];
          }
      }
  }

  function reduceFraction(string) {
      return simplifyFraction(string.split("/").map((n => +n))).join("/");
  }

  var getValFromObjPath = (object, path) => {
      if (typeof path === "string") path = path.split(".").filter((key => key.length));
      return path.reduce(((dive, key) => dive && dive[key]), object);
  };

  function rgba2argb(rgbaStr) {
      var rgba = rgbaStr.replace(/rgba\(|\)/g, "").split(",");
      rgba[3] = rgba[3] * 255;
      return Lightning.StageUtils.getArgbNumber(rgba);
  }

  function capitalizeFirstLetter(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
  }

  var RoundRect = {
      getWidth(w) {
          var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          var {padding: padding, paddingLeft: paddingLeft, paddingRight: paddingRight, strokeWidth: strokeWidth} = _objectSpread({
              padding: 0,
              paddingLeft: 0,
              paddingRight: 0,
              strokeWidth: 0
          }, options);
          if (!w) return 0;
          return w - (paddingLeft || padding) - (paddingRight || padding) - strokeWidth;
      },
      getHeight(h) {
          var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          var {padding: padding, paddingBottom: paddingBottom, paddingTop: paddingTop, strokeWidth: strokeWidth} = _objectSpread({
              padding: 0,
              paddingBottom: 0,
              paddingTop: 0,
              strokeWidth: 0
          }, options);
          if (!h) return 0;
          return h - (paddingBottom || padding) - (paddingTop || padding) - strokeWidth;
      }
  };

  function clone(target, object) {
      var _clone = Object.create(Object.getPrototypeOf(target));
      Object.defineProperties(_clone, Object.getOwnPropertyDescriptors(target));
      if (!object || target === object) return _clone;
      for (var key in object) {
          var value = object[key];
          if (target.hasOwnProperty(key)) {
              _clone[key] = getMergeValue(key, target, object);
          } else {
              _clone[key] = value;
          }
      }
      return _clone;
  }

  function getMergeValue(key, target, object) {
      var targetVal = target[key];
      var objectVal = object[key];
      var targetValType = typeof targetVal;
      var objectValType = typeof objectVal;
      if (targetValType !== objectValType || objectValType === "function" || Array.isArray(objectVal)) {
          return objectVal;
      }
      if (objectVal && objectValType === "object") {
          return clone(targetVal, objectVal);
      }
      return objectVal;
  }

  function measureTextWidth() {
      var text = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var canvas = document.createElement("canvas");
      var ctx = canvas.getContext("2d");
      var {fontStyle: fontStyle, fontWeight: fontWeight, fontSize: fontSize, fontFamily: fontFamily = text.fontFace || "sans-serif"} = text;
      var fontCss = [ fontStyle, fontWeight, fontSize ? "".concat(fontSize, "px") : "0", "'".concat(fontFamily, "'") ].filter(Boolean).join(" ");
      ctx.font = fontCss;
      var textMetrics = ctx.measureText(text.text || "");
      return Math.round(textMetrics.width);
  }

  function getFirstNumber() {
      for (var _len5 = arguments.length, numbers = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
          numbers[_key5] = arguments[_key5];
      }
      return numbers.find(Number.isFinite);
  }

  function getDimension(prop, component) {
      if (!component) return 0;
      var transition = component.transition(prop);
      if (transition.isRunning()) return transition.targetValue;
      var renderProp = prop;
      if (prop === "w") {
          renderProp = "renderWidth";
      } else if (prop === "h") {
          renderProp = "renderHeight";
      }
      return component[renderProp] || component[prop];
  }

  var getX = component => getDimension("x", component);

  var getY = component => getDimension("y", component);

  var getW = component => getDimension("w", component);

  var getH = component => getDimension("h", component);

  function flatten(arr) {
      return arr.reduce(((flat, toFlatten) => flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten)), []);
  }

  function objectPropertyOf(object, path) {
      return path.reduce(((obj, key) => obj && obj[key] !== "undefined" ? obj[key] : undefined), object);
  }

  function stringifyCompare(objA, objB) {
      return JSON.stringify(objA) === JSON.stringify(objB);
  }

  function delayForAnimation(callback) {
      var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;
      setTimeout(callback, delay);
  }

  function downloadFile(content, fileName, contentType) {
      var validContentTypes = [ "plain", "json" ];
      if (!validContentTypes.includes(contentType)) {
          contentType = "plain";
      }
      var dataStr = "data:text/".concat(contentType, ";charset=utf-8,") + encodeURIComponent(JSON.stringify(content));
      var dlAnchorElem = document.createElement("a");
      dlAnchorElem.setAttribute("href", dataStr);
      dlAnchorElem.setAttribute("download", fileName);
      dlAnchorElem.click();
  }

  var degreesToRadians = deg => deg * (Math.PI / 180);

  var MARKUP_STRING_PATTERN = /({ICON.*?}|{BADGE:.*?}|{NEWLINE}|{TEXT:.*?})/g;

  function isMarkupString() {
      var str = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
      if (typeof str !== "string") {
          return false;
      }
      return MARKUP_STRING_PATTERN.test(str);
  }

  function parseInlineContent() {
      var str = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
      var content = [];
      if (str && typeof str === "string" || str.text) {
          var string = typeof str === "string" ? str : str.text;
          var iconRegEx = /^{ICON:(.*?)?\|(.*?)?}$/g;
          var badgeRegEx = /^{BADGE:(.*?)}$/g;
          var newlineRegEx = /^{NEWLINE}$/g;
          var textRegEx = /^{TEXT:(.*?)?\|(.*?)?}$/g;
          var splitStr = string.split(MARKUP_STRING_PATTERN);
          if (splitStr && splitStr.length) {
              splitStr.forEach((item => {
                  var formattedItem = item;
                  var badge = badgeRegEx.exec(item);
                  var icon = iconRegEx.exec(item);
                  var newline = newlineRegEx.exec(item);
                  var text = textRegEx.exec(item);
                  if (badge && badge[1]) {
                      formattedItem = {
                          badge: badge[1]
                      };
                  } else if (icon && icon[1]) {
                      formattedItem = {
                          title: icon[1],
                          icon: icon[2] || icon[1]
                      };
                  } else if (newline) {
                      formattedItem = {
                          newline: true
                      };
                  } else if (text && text[1]) {
                      formattedItem = {
                          text: text[1],
                          style: text[2]
                      };
                  }
                  content.push(formattedItem);
              }));
          }
      }
      return content;
  }

  function max() {
      if (!arguments) {
          return;
      }
      var args = Array.from(arguments).filter((arg => !isNaN(arg) && arg != null));
      if (!args.length) {
          return;
      }
      return Math.max(...args);
  }

  function createConditionalZContext(component, zOffset) {
      if (!component.zIndex && typeof zOffset !== "undefined" && zOffset !== 0) {
          component.forceZIndexContext = true;
          component.zIndex = 0;
      }
  }

  function watchForUpdates(_ref2) {
      var _element$__core;
      var {element: element, watchProps: watchProps = [], sideEffect: sideEffect = () => {}} = _ref2;
      if (!(element !== null && element !== void 0 && element.isElement)) {
          loggerInstance.error("watchForUpdates: Expected a Lightning Element passed to element parameter, received ".concat(typeof element));
      }
      var initialOnAfterUpdate = (_element$__core = element.__core) === null || _element$__core === void 0 ? void 0 : _element$__core._onAfterUpdate;
      element.onAfterUpdate = function(element) {
          var hasChanged = false;
          watchProps.forEach((prop => {
              if (element.transition(prop) && element.transition(prop).isRunning()) {
                  return;
              }
              var prevValueKey = "__watchPrev".concat(prop);
              var nextValue = element[prop];
              if (nextValue !== element[prevValueKey]) {
                  element[prevValueKey] = nextValue;
                  hasChanged = true;
              }
          }));
          if (hasChanged) {
              sideEffect();
          }
          if (initialOnAfterUpdate) {
              initialOnAfterUpdate(element);
          }
      }.bind(this);
      return element;
  }

  function convertTextAlignToFlexJustify(align) {
      switch (align) {
        case "left":
          return "flex-start";

        case "center":
          return "center";

        case "right":
          return "flex-end";

        default:
          console.warn('Expected "textAlign" values are "left," "center," and "right," but instead, '.concat(align, ' was received and will fall back to "left."'));
          return "flex-start";
      }
  }

  function getMaxRoundRadius(radius, width, height) {
      var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
      var maxRadius = r => Math.max(0, Math.min(r, Math.min(width, height) / 2) + offset);
      return Array.isArray(radius) ? radius.map((r => Number(maxRadius(r)) || 0)) : Number(maxRadius(radius)) || 0;
  }

  var utils = {
      isMarkupString: isMarkupString,
      capitalizeFirstLetter: capitalizeFirstLetter,
      degreesToRadians: degreesToRadians,
      downloadFile: downloadFile,
      delayForAnimation: delayForAnimation,
      stringifyCompare: stringifyCompare,
      objectPropertyOf: objectPropertyOf,
      flatten: flatten,
      getDimension: getDimension,
      getFirstNumber: getFirstNumber,
      measureTextWidth: measureTextWidth,
      clone: clone,
      getMergeValue: getMergeValue,
      RoundRect: RoundRect,
      rgba2argb: rgba2argb,
      getValFromObjPath: getValFromObjPath,
      reduceFraction: reduceFraction,
      getValidColor: getValidColor,
      getHexColor: getHexColor,
      getAspectRatioH: getAspectRatioH,
      getAspectRatioW: getAspectRatioW,
      getWidthByUpCount: getWidthByUpCount,
      getDimensions: getDimensions,
      getWidthByColumnSpan: getWidthByColumnSpan,
      createConditionalZContext: createConditionalZContext,
      watchForUpdates: watchForUpdates,
      convertTextAlignToFlexJustify: convertTextAlignToFlexJustify,
      getMaxRoundRadius: getMaxRoundRadius
  };

  var utils$1 = utils;

  class Metrics {
      constructor() {
          this._keyMetricsCallback = undefined;
      }
      get keyMetricsCallback() {
          return this._keyMetricsCallback;
      }
      set keyMetricsCallback(value) {
          if (-1 < [ "undefined", "function" ].indexOf(typeof value)) {
              this._keyMetricsCallback = value;
              return;
          }
          loggerInstance.warn("context keyMetricsCallback expected a function. Received ".concat(typeof value));
      }
  }

  var metricsInstance = new Metrics;

  var eventEmitterInstance = new Lightning.EventEmitter;

  var events = eventEmitterInstance;

  var baseTheme = {
      name: "Base Lightning TV",
      alpha: {
          primary: 1,
          secondary: .7,
          tertiary: .1,
          inactive: .5,
          full: 1,
          none: 0,
          alpha1: .1,
          alpha2: .3,
          alpha3: .5,
          alpha4: .7,
          alpha5: .9
      },
      animation: {
          duration: {
              none: 0,
              xfast: .1,
              fast: .25,
              normal: .5,
              slow: .75,
              xslow: .9
          },
          delay: {
              none: 0,
              xfast: .01,
              fast: .025,
              normal: .05,
              slow: .075,
              xslow: .09
          },
          expressive: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          expressiveEntrance: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          expressiveExit: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          standard: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          standardEntrance: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          standardExit: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          utility: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          utilityEntrance: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          },
          utilityExit: {
              timingFunction: "cubic-bezier(0, 0, 1, 1)",
              delay: 0,
              duration: .25
          }
      },
      asset: {
          arrowLeft: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAi0lEQVRIDWNgGAWjIfD//38JID5Fk5AAGqwKxPeA+D/VLQCaaQLEr0CGgwBVLQCa5wbEn0EGwwDVLAAaGA3Ev2AGw2iqWAA0rBiI/8EMRaYptgBoWDeygehsci1gIlcjWfqArqZdEMFcBLSEdpGMZAntkimSJbTLaEiW0K6oQLKEdoUdzJJRemiHAAD4n+yzPWCs7QAAAABJRU5ErkJggg==",
          arrowRight: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAg0lEQVRIDWNgGAWjIYArBP7//38KiCVwyVMsDjQcBO4BsSrFhmEzAGw8hHgFpEywqaFIDMkCEPMzELtRZCC6ZjQLQNxfQByNro5sPhYLQEL/gLiYbEORNeKwACbcDVPLBGMMOhrmVDSapkFE00imaTKlaUajaVFB28Ju0CXrUQfhDAEAEgHss6NhpLQAAAAASUVORK5CYII=",
          backspaceOutline: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC",
          check: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAOCAYAAAAi2ky3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACtSURBVHgBvdPdDcIgEAfwoy8Nb45QN3AGF2s36Ahu4gpuIDoBfSgfpdoTlCbEWEMh6T8hFzjyg5AAkBHOcQe5UWqspRx435sDpMYj6IYQwwVSEiJ2MKVUBWuzLSLl2HL+uxmNCGFO8yaL7RHxve6qRZoAuS4hxac8735elWVx7jrtMKL1o0Gcat9jhExHSukN/kUIFZ7MpDRtzE1isDRkAUtDvrA8ZI597FUf8gWH9P0b4gko9wAAAABJRU5ErkJggg=="
      },
      color: {
          white: [ "#ffffff", 1 ],
          black: [ "#000000", 1 ],
          grey: [ "#929096", 1 ],
          red: [ "#e74c3c", 1 ],
          orange: [ "#dc7633", 1 ],
          yellow: [ "#f7dc6f", 1 ],
          green: [ "#2Ecc71", 1 ],
          blue: [ "#93a9fd", 1 ],
          purple: [ "#663399", 1 ],
          palette: {
              "grey-05": [ "#f8f7fa", 1 ],
              "grey-40": [ "#929096", 1 ],
              "grey-70": [ "#48474b", 1 ],
              "grey-90": [ "#181819", 1 ],
              "blue-20": [ "#becffe", 1 ],
              "blue-40": [ "#93a9fd", 1 ],
              "blue-90": [ "#000033", 1 ]
          },
          material: [ "#181819", 1 ],
          materialBrand: [ "#000033", 1 ],
          overlay: [ "#181819", .7 ],
          textNeutral: [ "#f8f7fa", 1 ],
          textNeutralSecondary: [ "#f8f7fa", .7 ],
          textNeutralTertiary: [ "#f8f7fa", .1 ],
          textNeutralDisabled: [ "#f8f7fa", .5 ],
          textInverse: [ "#181819", 1 ],
          textInverseSecondary: [ "#181819", .7 ],
          textInverseTertiary: [ "#181819", .1 ],
          textInverseDisabled: [ "#181819", .5 ],
          textBrand: [ "#93a9fd", 1 ],
          textBrandSecondary: [ "#93a9fd", .7 ],
          textBrandTertiary: [ "#93a9fd", .1 ],
          textBrandDisabled: [ "#93a9fd", .5 ],
          textPositive: [ "#2Ecc71", 1 ],
          textNegative: [ "#e74c3c", 1 ],
          textInfo: [ "#93a9fd", 1 ],
          textCaution: [ "#dc7633", 1 ],
          fillTransparent: [ "#ffffff", 0 ],
          fillNeutral: [ "#f8f7fa", 1 ],
          fillNeutralSecondary: [ "#f8f7fa", .7 ],
          fillNeutralTertiary: [ "#f8f7fa", .1 ],
          fillNeutralDisabled: [ "#f8f7fa", .5 ],
          fillInverse: [ "#181819", 1 ],
          fillInverseSecondary: [ "#181819", .7 ],
          fillInverseTertiary: [ "#181819", .1 ],
          fillInverseDisabled: [ "#181819", .5 ],
          fillBrand: [ "#93a9fd", 1 ],
          fillBrandSecondary: [ "#93a9fd", .7 ],
          fillBrandTertiary: [ "#93a9fd", .1 ],
          fillBrandDisabled: [ "#93a9fd", .5 ],
          fillPositive: [ "#2Ecc71", 1 ],
          fillNegative: [ "#e74c3c", 1 ],
          fillInfo: [ "#93a9fd", 1 ],
          fillCaution: [ "#dc7633", 1 ],
          strokeNeutral: [ "#f8f7fa", 1 ],
          strokeNeutralSecondary: [ "#f8f7fa", .7 ],
          strokeNeutralTertiary: [ "#f8f7fa", .1 ],
          strokeNeutralDisabled: [ "#f8f7fa", .5 ],
          strokeInverse: [ "#181819", 1 ],
          strokeInverseSecondary: [ "#181819", .7 ],
          strokeInverseTertiary: [ "#181819", .1 ],
          strokeInverseDisabled: [ "#181819", .5 ],
          strokeBrand: [ "#93a9fd", 1 ],
          strokeBrandSecondary: [ "#93a9fd", .7 ],
          strokeBrandTertiary: [ "#93a9fd", .1 ],
          strokeBrandDisabled: [ "#93a9fd", .5 ],
          strokePositive: [ "#2Ecc71", 1 ],
          strokeNegative: [ "#e74c3c", 1 ],
          strokeInfo: [ "#93a9fd", 1 ],
          strokeCaution: [ "#dc7633", 1 ],
          interactiveNeutral: [ "#ffffff", .1 ],
          interactiveNeutralFocus: [ "#ffffff", 1 ],
          interactiveNeutralFocusSoft: [ "#ffffff", .1 ],
          interactiveInverse: [ "#48474b", undefined ],
          interactiveInverseFocus: [ "#48474b", 1 ],
          interactiveInverseFocusSoft: [ "#48474b", .1 ],
          interactiveBrand: [ "#becffe", .1 ],
          interactiveBrandFocus: [ "#becffe", 1 ],
          interactiveBrandFocusSoft: [ "#becffe", .1 ],
          shadowNeutral: [ "#000000", .7 ],
          shadowNeutralFocus: [ "#000000", .7 ],
          shadowNeutralFocusSoft: [ "#000000", .7 ],
          shadowNeutralText: [ "#000000", 1 ],
          shadowInverse: [ "#000000", .7 ],
          shadowInverseFocus: [ "#000000", .7 ],
          shadowInverseFocusSoft: [ "#000000", .7 ],
          shadowInverseText: [ "#000000", 1 ],
          shadowBrand: [ "#000000", .7 ],
          shadowBrandFocus: [ "#000000", .7 ],
          shadowBrandFocusSoft: [ "#000000", .7 ],
          shadowBrandText: [ "#000000", 1 ]
      },
      componentConfig: {
          Keyboard: {
              style: {
                  keyProps: {
                      delete: {
                          title: null,
                          icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC"
                      }
                  }
              }
          }
      },
      font: [],
      layout: {
          columnCount: 10,
          focusScale: 1.2,
          gutterX: 20,
          gutterY: 20,
          marginX: 150,
          marginY: 150,
          safe: 50,
          screenW: 1920,
          screenH: 1080
      },
      radius: {
          none: 0,
          xs: 2,
          sm: 4,
          md: 8,
          lg: 16,
          xl: 24
      },
      spacer: {
          none: 0,
          xxs: 2,
          xs: 4,
          sm: 8,
          md: 10,
          lg: 20,
          xl: 30,
          xxl: 40,
          xxxl: 50
      },
      stroke: {
          none: 0,
          sm: 2,
          md: 4,
          lg: 6,
          xl: 8
      },
      typography: {
          display1: {
              fontFamily: "Arial",
              fontSize: 75,
              lineHeight: 85,
              fontStyle: "500",
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          display2: {
              fontFamily: "Arial",
              fontSize: 50,
              lineHeight: 60,
              fontStyle: "500",
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          headline1: {
              fontFamily: "Arial",
              fontSize: 35,
              fontStyle: "500",
              lineHeight: 48,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          headline2: {
              fontFamily: "Arial",
              fontSize: 30,
              fontStyle: "500",
              lineHeight: 40,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          headline3: {
              fontFamily: "Arial",
              fontSize: 25,
              fontStyle: "500",
              lineHeight: 36,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          body1: {
              fontFamily: "Arial",
              fontSize: 25,
              fontStyle: "300",
              lineHeight: 40,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          body2: {
              fontFamily: "Arial",
              fontSize: 22,
              fontStyle: "300",
              lineHeight: 32,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          body3: {
              fontFamily: "Arial",
              fontSize: 20,
              fontStyle: "300",
              lineHeight: 32,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          button1: {
              fontFamily: "Arial",
              fontSize: 25,
              fontStyle: "500",
              lineHeight: 32,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          button2: {
              fontFamily: "Arial",
              fontSize: 20,
              fontStyle: "500",
              lineHeight: 32,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          callout1: {
              fontFamily: "Arial",
              fontSize: 20,
              fontStyle: "500",
              lineHeight: 32,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          caption1: {
              fontFamily: "Arial",
              fontSize: 15,
              fontStyle: "500",
              lineHeight: 24,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          tag1: {
              fontFamily: "Arial",
              fontSize: 20,
              fontStyle: "500",
              lineHeight: 24,
              verticalAlign: "middle",
              textBaseline: "bottom"
          },
          footnote1: {
              fontFamily: "Arial",
              fontSize: 22,
              fontStyle: "300",
              lineHeight: 30,
              verticalAlign: "middle",
              textBaseline: "bottom"
          }
      }
  };

  var customFontFaces = [];

  var fontLoader = fonts => {
      var promises = [];
      var _loop = function _loop() {
          var {family: family, src: src, descriptors: descriptors} = fonts[i];
          var fontSrc = src && Array.isArray(src) && src.length ? src.map((url => url.substr(0, 5) === "local" ? url : "url(".concat(url, ")"))).join(",") : "url(" + src + ")";
          var fontFace = new FontFace(family, fontSrc, descriptors || {});
          loggerInstance.info("Loading font", family);
          document.fonts.add(fontFace);
          promises.push(new Promise((resolve => {
              fontFace.load().then((() => {
                  customFontFaces.push(fontFace);
                  resolve(family);
              })).catch((err => {
                  resolve(new Error("".concat(family, ": ").concat(err.message)));
              }));
          })));
      };
      for (var i = 0; i < fonts.length; i++) {
          _loop();
      }
      return Promise.all(promises).then((fontsLoaded => {
          var loaded = fontsLoaded.filter((font => !(font instanceof Error))).join(", ");
          if (loaded) {
              loggerInstance.log("Fonts loaded: ".concat(loaded));
          }
          var failed = fontsLoaded.filter((font => font instanceof Error)).map((item => item.message)).join(", ");
          if (failed) {
              loggerInstance.error("Unable to load fonts: ".concat(failed));
          }
      }));
  };

  var cleanupFonts = function() {
      var _ref3 = _asyncToGenerator((function*(fonts) {
          if (document.fonts && "delete" in document.fonts) {
              if (!customFontFaces.length) return;
              customFontFaces = customFontFaces.filter((fontFace => {
                  if (!fonts.find((font => font.family === fontFace.family))) {
                      loggerInstance.info("Removing font", fontFace.family);
                      document.fonts.delete(fontFace);
                      return false;
                  } else {
                      return fontFace;
                  }
              }));
          } else {
              loggerInstance.info("Unable to remove manually-added fonts");
          }
      }));
      return function cleanupFonts(_x) {
          return _ref3.apply(this, arguments);
      };
  }();

  var THEME_KEY_REPLACER = {
      fontFamily: "fontFace"
  };

  var merge = {
      all: objArray => {
          var result = {};
          for (var i = 0; i < objArray.length; i++) {
              result = clone(result, objArray[i]);
          }
          return result;
      }
  };

  var base64Cache = [];

  var isSubTheme = themeName => "subTheme" === themeName.slice(0, 8);

  function getMimeTypeFromDataUri(dataUri) {
      var matches = dataUri.match(/^data:(.*?);base64,/);
      if (matches && matches.length === 2) {
          return matches[1];
      }
      return null;
  }

  function checkBase64EncodedImage(str) {
      var regex = /^data:image\/(jpeg|jpg|png|gif);base64,/;
      var isImage = regex.test(str);
      var mimeType = isImage ? getMimeTypeFromDataUri(str.match(regex)[0]) : null;
      return {
          isImage: isImage,
          mimeType: mimeType
      };
  }

  function base64ToBlobURL(base64String, mimeType) {
      var byteCharacters = atob(base64String.substring(base64String.indexOf(",") + 1));
      var byteArrays = [];
      try {
          for (var offset = 0; offset < byteCharacters.length; offset += 512) {
              var slice = byteCharacters.slice(offset, offset + 512);
              var byteNumbers = new Array(slice.length);
              for (var i = 0; i < slice.length; i++) {
                  byteNumbers[i] = slice.charCodeAt(i);
              }
              var byteArray = new Uint8Array(byteNumbers);
              byteArrays.push(byteArray);
          }
          var blob = new Blob(byteArrays, {
              type: mimeType
          });
          var blobURL = URL.createObjectURL(blob);
          return blobURL;
      } catch (error) {
          loggerInstance.info("Unable to convert base64 image to URL");
          return null;
      }
  }

  class ThemeManager {
      constructor() {
          this._cache = new Map;
          if (typeof window === "undefined") return;
          if (!window.LUI) {
              window.LUI = {};
          }
          if (!window.LUI.themeManagerInstances) {
              window.LUI.themeManagerInstances = [ {
                  themeManager: this,
                  events: events
              } ];
          } else {
              window.LUI.themeManagerInstances.push({
                  themeManager: this,
                  events: events
              });
          }
      }
      _setCache(key, payload) {
          if (typeof window === "undefined") return;
          window.LUI.themeManagerInstances.forEach((_ref4 => {
              var {themeManager: themeManager} = _ref4;
              if (themeManager) themeManager._cache.set(key, payload);
          }));
      }
      _deleteCache(key) {
          if (typeof window === "undefined") return;
          window.LUI.themeManagerInstances.forEach((_ref5 => {
              var {themeManager: themeManager} = _ref5;
              if (themeManager) themeManager._cache.delete(key);
          }));
      }
      _emit(key, payload) {
          if (typeof window === "undefined") return;
          window.LUI.themeManagerInstances.forEach((_ref6 => {
              var {events: events} = _ref6;
              events.emit(key, payload);
          }));
      }
      getTheme() {
          if (this._cache.has("theme")) {
              return this._cache.get("theme");
          }
          var theme = this._processTheme.call(this);
          this._setCache("theme", theme);
          return theme;
      }
      setTheme(themeConfig) {
          var _this = this;
          return _asyncToGenerator((function*() {
              var value;
              if (Array.isArray(themeConfig)) {
                  value = merge.all(themeConfig);
              } else {
                  value = themeConfig;
              }
              if ("object" !== typeof value || null === value) {
                  loggerInstance.warn("context theme expected an object. Received ".concat(typeof value));
                  return;
              }
              _this._clearCache();
              var theme = _this._processTheme.call(_this, [ value ], value.extensions);
              _this._setCache("theme", theme);
              yield cleanupFonts(theme.font);
              if (theme.font && theme.font.length) {
                  yield _this._loadFonts(theme.font);
              }
              _this._refreshSubThemes();
              _this._emit("themeExtensionsUpdate");
              _this._emit("themeUpdate");
              return theme;
          }))();
      }
      getSubTheme(subThemeName) {
          if (this._cache.has("subTheme".concat(subThemeName))) {
              return this._cache.get("subTheme".concat(subThemeName)).result;
          }
          return;
      }
      setSubTheme(subThemeName, value) {
          var _arguments = arguments, _this2 = this;
          return _asyncToGenerator((function*() {
              var triggerUpdate = _arguments.length > 2 && _arguments[2] !== undefined ? _arguments[2] : true;
              if (!subThemeName) {
                  loggerInstance.warn("Sub theme name not specified");
                  return;
              }
              if ("string" !== typeof subThemeName) {
                  loggerInstance.warn("Sub theme name must be a string. Received an ".concat(typeof subThemeName));
                  return;
              }
              if ("object" !== typeof value || !Object.keys(value).length) {
                  loggerInstance.warn("Could not set subTheme ".concat(subThemeName, ", value should be an object with properties. Received an ").concat(typeof value));
                  return;
              }
              var globalTheme = _this2.getTheme();
              var subTheme = _this2._processTheme.call(_this2, [ globalTheme, value ]);
              if (subTheme.font && subTheme.font.length) {
                  yield _this2._loadFonts(subTheme.font);
              }
              _this2._setCache("subTheme".concat(subThemeName), {
                  original: value,
                  result: subTheme
              });
              if (triggerUpdate) _this2._emit("themeUpdate".concat(subThemeName));
              return subTheme;
          }))();
      }
      _refreshSubThemes() {
          [ ...this._cache.keys() ].forEach((key => {
              if ("string" === typeof key && isSubTheme(key)) {
                  var _cache = this._cache.get(key);
                  if (_cache.original) this.updateSubTheme(key.replace(/^subTheme/, ""), _cache.original);
              }
          }));
      }
      _loadFonts(fontArray) {
          return _asyncToGenerator((function*() {
              try {
                  yield fontLoader(fontArray);
              } catch (err) {
                  loggerInstance.error("Unable to load font: ".concat(err));
              }
          }))();
      }
      updateTheme(themeConfig) {
          var _this3 = this;
          return _asyncToGenerator((function*() {
              var value;
              if (Array.isArray(themeConfig)) {
                  value = merge.all(themeConfig);
              } else {
                  value = themeConfig;
              }
              var currentTheme = {};
              if (_this3._cache.has("theme")) {
                  currentTheme = _this3._cache.get("theme");
              }
              _this3._clearCache();
              var theme = _this3._processTheme.call(_this3, [ currentTheme, value ], value.extensions || currentTheme.extensions);
              _this3._setCache("theme", theme);
              if (theme.font && theme.font.length) {
                  yield _this3._loadFonts(theme.font);
              }
              _this3._refreshSubThemes();
              if (value.extensions) _this3._emit("themeExtensionsUpdate");
              _this3._emit("themeUpdate");
              return theme;
          }))();
      }
      _clearCache() {
          base64Cache.filter((image => {
              if (window.URL && typeof window.URL.revokeObjectURL === "function") URL.revokeObjectURL(image);
              return false;
          }));
          this._cache.forEach(((value, key) => {
              if ("string" !== typeof key || !isSubTheme(key)) {
                  this._deleteCache(key);
              }
          }));
          this._cache.forEach(((value, key) => {
              if ("string" === typeof key && isSubTheme(key)) {
                  this.setSubTheme(key.replace("subTheme", ""), value.original, false);
              }
          }));
      }
      updateSubTheme(subThemeName, value) {
          var _arguments2 = arguments, _this4 = this;
          return _asyncToGenerator((function*() {
              var triggerUpdate = _arguments2.length > 2 && _arguments2[2] !== undefined ? _arguments2[2] : true;
              if (!subThemeName) {
                  loggerInstance.warn("Sub theme name not specified");
                  return;
              }
              if ("object" !== typeof value || !Object.keys(value).length) {
                  loggerInstance.warn("Could not update subTheme ".concat(subThemeName, " due to invalid value"));
                  return;
              }
              var globalTheme = _this4.getTheme();
              var currentTheme = {};
              if (_this4._cache.has("subTheme".concat(subThemeName))) {
                  currentTheme = _this4._cache.get("subTheme".concat(subThemeName)).original;
              }
              var subTheme = _this4._processTheme.call(_this4, [ globalTheme, currentTheme, value ]);
              if (subTheme.font && subTheme.font.length) {
                  yield _this4._loadFonts(subTheme.font);
              }
              _this4._setCache("subTheme".concat(subThemeName), {
                  original: clone(currentTheme, value),
                  result: subTheme
              });
              if (triggerUpdate) _this4._emit("themeUpdate".concat(subThemeName));
              return subTheme;
          }))();
      }
      removeSubTheme(subThemeName) {
          if (this._cache.has("subTheme".concat(subThemeName))) {
              this._deleteCache("subTheme".concat(subThemeName));
          }
          this._emit("themeUpdate".concat(subThemeName));
      }
      _getComponentUUID(id) {
          return "componentStyle".concat(id);
      }
      _processTheme() {
          var themeArray = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          var extensions = arguments.length > 1 ? arguments[1] : undefined;
          if (!Array.isArray(themeArray)) {
              throw new Error("context processTheme expected an array. Received ".concat(typeof themeArray));
          }
          var theme = merge.all([ baseTheme, ...themeArray ]);
          var themeFunctions = {};
          var themeString = JSON.stringify(theme, ((key, originalValue) => {
              var value = originalValue;
              if (value && typeof value === "object") {
                  var replacement = originalValue;
                  for (var k in value) {
                      if (Object.hasOwnProperty.call(value, k) && THEME_KEY_REPLACER[k]) {
                          replacement[k && THEME_KEY_REPLACER[k]] = value[k];
                          delete replacement[k];
                      }
                  }
                  value = replacement;
              }
              var {isImage: isImage, mimeType: mimeType} = checkBase64EncodedImage(value);
              if (window.URL && typeof window.URL.createObjectURL === "function" && isImage) {
                  try {
                      var blobURL = base64ToBlobURL(value, mimeType);
                      base64Cache.push(blobURL);
                      return blobURL;
                  } catch (error) {
                      return value;
                  }
              }
              if (Array.isArray(value) && 2 === value.length && !value[0].targetComponent && value[0].length && typeof value[0] === "string" && value[0].substr(0, 1) === "#" && typeof value[1] === "number") {
                  return getHexColor(value[0], value[1]);
              } else if ("extensions" === key || "function" === typeof value || "object" === typeof value && value !== null && "Object" !== value.constructor.name && !Array.isArray(value)) {
                  themeFunctions[key] = value;
                  return;
              } else if ("string" === typeof value && value.includes("theme.")) {
                  var themeValue = getValFromObjPath({
                      theme: theme
                  }, value);
                  if (themeValue) {
                      return themeValue;
                  } else {
                      return value;
                  }
              } else {
                  var validColor = getValidColor(value);
                  if (validColor) {
                      return validColor;
                  }
                  return value;
              }
          }));
          return _objectSpread(_objectSpread(_objectSpread({}, JSON.parse(themeString)), themeFunctions), {}, {
              extensions: extensions
          });
      }
  }

  var themeManagerInstance = new ThemeManager;

  class Context {
      get theme() {
          return themeManagerInstance.getTheme();
      }
      set theme(value) {
          loggerInstance.warn("Context.theme must be set using context.setTheme or context.updateTheme");
      }
      get keyMetricsCallback() {
          return metricsInstance.keyMetricsCallback;
      }
      set keyMetricsCallback(value) {
          loggerInstance.warn("Context.keyMetricsCallback must be set using context.setKeyMetricsCallback");
      }
      get debug() {
          return loggerInstance.debug;
      }
      set debug(value) {
          loggerInstance.debug = value;
      }
      on() {
          return events.on(...arguments);
      }
      off() {
          return events.off(...arguments);
      }
      emit() {
          return events.emit(...arguments);
      }
      log() {
          loggerInstance.log(...arguments);
      }
      info() {
          loggerInstance.info(...arguments);
      }
      warn() {
          loggerInstance.warn(...arguments);
      }
      error() {
          for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
              args[_key6] = arguments[_key6];
          }
          loggerInstance.error(args);
      }
      setTheme(value) {
          return themeManagerInstance.setTheme(value);
      }
      updateTheme(value) {
          return themeManagerInstance.updateTheme(value);
      }
      getSubTheme(subThemeName) {
          return themeManagerInstance.getSubTheme(subThemeName);
      }
      setSubThemes(subThemesObj) {
          if ("object" !== typeof subThemesObj) {
              loggerInstance.warn("subThemes must be an object");
              return;
          }
          for (var subTheme in subThemesObj) {
              themeManagerInstance.setSubTheme(subTheme, subThemesObj[subTheme]);
          }
      }
      setSubTheme(subThemeName, value) {
          return themeManagerInstance.setSubTheme(subThemeName, value);
      }
      updateSubTheme(subThemeName, value) {
          return themeManagerInstance.updateSubTheme(subThemeName, value);
      }
      removeSubTheme(subThemeName) {
          themeManagerInstance.removeSubTheme(subThemeName);
      }
      setLogCallback(value) {
          loggerInstance.logCallback = value;
      }
      setKeyMetricsCallback(value) {
          metricsInstance.keyMetricsCallback = value;
      }
      config() {
          var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
          var configKeys = Object.keys(config);
          for (var i = 0; i < configKeys.length; i++) {
              var setMethod = this["set" + capitalizeFirstLetter(configKeys[i])];
              if (setMethod) {
                  setMethod(config[configKeys[i]]);
              }
          }
          return this;
      }
  }

  var contextInstance = new Context;

  class GlobalUpdateManager {
      constructor() {
          this._updateThemeSet = new Set;
          this._requestUpdateSet = new Set;
          this._timeout = null;
          this._runUpdatesTimeoutHandler = this._runUpdatesTimeoutHandler.bind(this);
      }
      _runUpdatesTimeoutHandler() {
          this._timeout = null;
          this._updateThemeSet.forEach((component => {
              try {
                  component._updateThemeComponent();
              } catch (e) {
                  contextInstance.error("Error updating component themes", e);
              }
          }));
          this._updateThemeSet.clear();
          this._requestUpdateSet.forEach((component => {
              try {
                  component.requestUpdate();
              } catch (e) {
                  contextInstance.error("Error updating component", e);
              }
          }));
          this._requestUpdateSet.clear();
      }
      flush() {
          if (!this._timeout) return;
          clearTimeout(this._timeout);
          this._runUpdatesTimeoutHandler();
      }
      addUpdateTheme(component) {
          this._updateThemeSet.add(component);
          if (!this._timeout) {
              this._timeout = setTimeout(this._runUpdatesTimeoutHandler, 0);
          }
      }
      deleteUpdateTheme(component) {
          this._updateThemeSet.delete(component);
      }
      addRequestUpdate(component) {
          this._requestUpdateSet.add(component);
          if (!this._timeout) {
              this._timeout = setTimeout(this._runUpdatesTimeoutHandler, 0);
          }
      }
      deleteRequestUpdate(component) {
          this._requestUpdateSet.delete(component);
      }
      hasQueuedRequestFor(component) {
          return this._requestUpdateSet.has(component);
      }
  }

  var updateManager = new GlobalUpdateManager;

  function capital(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
  }

  function mergeProps(componentConfigProp, prop) {
      var _result;
      var result = prop;
      if (typeof componentConfigProp === "object" && Object.keys(componentConfigProp).length && typeof prop === "object") {
          result = clone(componentConfigProp, prop);
      }
      return (_result = result) !== null && _result !== void 0 ? _result : componentConfigProp;
  }

  function getPropertyDescriptor$1(name, key) {
      return {
          get() {
              var _this$__componentConf3;
              var customGetter = this["_get".concat(capital(name))];
              if (customGetter && typeof customGetter === "function") {
                  var _this$__componentConf, _this$__componentConf2;
                  var value = customGetter.call(this, this[key]);
                  this[key] = value || ((_this$__componentConf = this.__componentConfigProps) === null || _this$__componentConf === void 0 ? void 0 : _this$__componentConf[name]);
                  return mergeProps((_this$__componentConf2 = this.__componentConfigProps) === null || _this$__componentConf2 === void 0 ? void 0 : _this$__componentConf2[name], value);
              }
              return mergeProps((_this$__componentConf3 = this.__componentConfigProps) === null || _this$__componentConf3 === void 0 ? void 0 : _this$__componentConf3[name], this[key]);
          },
          set(value) {
              var oldValue = this[key];
              if (value !== oldValue) {
                  var changeHandler = this["_set".concat(capital(name))];
                  if (changeHandler && typeof changeHandler === "function") {
                      value = changeHandler.call(this, value);
                  }
                  var newValue = key === "style" ? clone(this[key], value) : value;
                  if (typeof this[key] === "object" && this[key] !== null && this[key].style) {
                      var style = clone(this[key].style, value.style || {});
                      newValue.style = style;
                  }
                  this[key] = newValue;
                  this.queueRequestUpdate();
              }
          },
          configurable: true,
          enumerable: true
      };
  }

  function getAliasPropertyDescriptor(prev, curr) {
      var deprecationWarning = 'The property "'.concat(prev, '" is deprecated and will be removed in a future release. Please use "').concat(curr, '" instead.');
      return {
          get() {
              console.warn(deprecationWarning);
              return this[curr];
          },
          set(value) {
              console.warn(deprecationWarning);
              this[curr] = value;
          }
      };
  }

  function withUpdates(Base) {
      return class extends Base {
          static get name() {
              return Base.name;
          }
          _construct() {
              var prototype = Object.getPrototypeOf(this);
              if (!prototype._withUpdatesInitialized) {
                  var props = this.constructor.properties || [];
                  props.forEach((name => {
                      var key = "_" + name;
                      var descriptor = getPropertyDescriptor$1(name, key);
                      if (descriptor !== undefined) {
                          Object.defineProperty(prototype, name, descriptor);
                      }
                  }));
                  var aliasProps = this.constructor.aliasProperties || [];
                  aliasProps.forEach((alias => {
                      if (alias && typeof alias.prev === "string" && typeof alias.curr === "string") {
                          var descriptor = getAliasPropertyDescriptor(alias.prev, alias.curr);
                          if (descriptor !== undefined) {
                              Object.defineProperty(prototype, alias.prev, descriptor);
                          }
                      }
                  }));
                  prototype._withUpdatesInitialized = true;
              }
              this._whenEnabled = new Promise((resolve => {
                  this._whenEnabledResolver = resolve;
              }));
              super._construct && super._construct();
          }
          queueRequestUpdate() {
              if (!this._isAttached()) return;
              updateManager.addRequestUpdate(this);
          }
          _firstEnable() {
              this._readyForUpdates = true;
              this._whenEnabledResolver();
              updateManager.deleteRequestUpdate(this);
              this.requestUpdate();
              super._firstEnable && super._firstEnable();
          }
          requestEarlyUpdate() {
              this._readyForUpdates = true;
              if (updateManager.hasQueuedRequestFor(this)) {
                  updateManager.deleteRequestUpdate(this);
                  this._readyForUpdates = true;
                  this.requestUpdate();
                  return true;
              }
              return false;
          }
          _detach() {
              super._detach();
              updateManager.deleteRequestUpdate(this);
          }
          requestUpdate() {
              var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
              if (this._readyForUpdates || force) {
                  var result = this._update();
                  if (typeof result === "object" && result !== null && result.catch) {
                      result.catch((e => {
                          contextInstance.error("asyncronous _update() error in '".concat(this.constructor.__componentName, "'"), this, e);
                      }));
                  }
              }
          }
          logPropTable() {
              console.table(this._propTable);
          }
          get _propTable() {
              return this.constructor.properties.reduce(((acc, prop) => {
                  acc[prop] = this[prop];
                  return acc;
              }), {});
          }
      };
  }

  function getPropertyDescriptor(path) {
      return {
          get() {
              return this.tag(path);
          },
          configurable: true,
          enumerable: true
      };
  }

  function withTags(Base) {
      return class extends Base {
          static get name() {
              return Base.name;
          }
          _construct() {
              var prototype = Object.getPrototypeOf(this);
              if (!prototype._withTagsInitialized) {
                  var tags = this.constructor.tags || [];
                  tags.forEach((tag => {
                      if (typeof tag === "object") {
                          var {name: name, path: path} = tag;
                      } else {
                          var name = tag;
                          var path = tag;
                      }
                      var key = "_" + name;
                      var descriptor = getPropertyDescriptor(path);
                      Object.defineProperty(prototype, key, descriptor);
                  }));
                  prototype._withTagsInitialized = true;
              }
              super._construct && super._construct();
          }
      };
  }

  function withHandleKey(Base) {
      return class extends Base {
          static get name() {
              return Base.name;
          }
          _handleKey(keyEvent) {
              return this._processEvent(keyEvent);
          }
          _handleKeyRelease(keyEvent) {
              return this._processEvent(keyEvent, "Release");
          }
          _processEvent(keyEvent) {
              var suffix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "";
              var keyMap = this.stage.application.__keymap || {};
              var key = keyMap[keyEvent.keyCode];
              if (!key) {
                  key = keyEvent.key;
              }
              if (key && typeof this["on".concat(key).concat(suffix)] === "function") {
                  this._invokeKeyPayloadCallback(key + suffix);
                  return this["on".concat(key).concat(suffix)].call(this, this, keyEvent);
              }
              return false;
          }
          _invokeKeyPayloadCallback(key) {
              if (this.metricsPayload && typeof contextInstance.keyMetricsCallback === "function") {
                  contextInstance.keyMetricsCallback(key, this.metricsPayload);
              }
          }
      };
  }

  function withLayout(Base) {
      return class extends Base {
          _construct() {
              super._construct && super._construct();
              this._previousDimensionData = null;
          }
          get itemLayout() {
              return this._itemLayout;
          }
          set itemLayout(v) {
              var componentName = this.constructor._componentName || this.constructor.name;
              var itemLayout;
              if (v) {
                  itemLayout = JSON.parse(JSON.stringify(v, ((k, v) => {
                      if (k !== "circle" && v < 0) {
                          contextInstance.error("itemLayout for ".concat(componentName, " received an invalid value of ").concat(v, " for ").concat(k));
                          return;
                      } else if (k === "circle") {
                          return Boolean(v);
                      }
                      return v;
                  })));
              }
              if (!stringifyCompare(this._itemLayout, itemLayout)) {
                  if (itemLayout && !itemLayout.upCount) {
                      this._originalW = this.w;
                      this._originalH = this.h;
                      this._itemLayout = _objectSpread({
                          w: this._originalW,
                          h: this._originalH
                      }, itemLayout);
                  } else {
                      this._itemLayout = itemLayout;
                  }
                  this._updateItemLayout();
              }
          }
          _allowUpdate() {
              var {w: w = "", h: h = "", circle: circle = "", ratioX: ratioX = "", ratioY: ratioY = "", upCount: upCount = ""} = this._itemLayout || {};
              var layoutString = Object.values(contextInstance.theme.layout).join("") + "".concat(w).concat(h).concat(circle ? 1 : 0).concat(ratioX).concat(ratioY).concat(upCount);
              if (layoutString !== this._previousDimensionData) {
                  this._previousDimensionData = layoutString;
                  return true;
              }
              return false;
          }
          _updateItemLayout() {
              if (!this._allowUpdate()) return;
              var {w: w, h: h} = getDimensions(this.theme, this._itemLayout);
              if (h || w) {
                  var width = contextInstance.theme.layout.screenW;
                  var height = contextInstance.theme.layout.screenH;
                  var calculatedWidth = w || h * (width / height);
                  var calculatedHeight = h || w * (height / width);
                  this.w = this._itemLayout && this._itemLayout.circle ? calculatedHeight : calculatedWidth;
                  this.h = calculatedHeight;
                  if (this._itemLayout && this._itemLayout.circle && this.style.radius) {
                      this._circleSet = true;
                      this._originalRadius = this.style.radius;
                      this.style = _objectSpread(_objectSpread({}, this.style), {}, {
                          radius: calculatedHeight / 2
                      });
                  } else if (this._circleSet) {
                      this.style = _objectSpread(_objectSpread({}, this.style), {}, {
                          radius: this._originalRadius
                      });
                      this._originalRadius = undefined;
                      this._circleSet = false;
                  }
                  this.queueRequestUpdate && this.queueRequestUpdate();
                  this.fireAncestors("$itemChanged");
              }
          }
      };
  }

  var getCharacterValue = (char, index) => char.charCodeAt(0) * (index + 1);

  var sortObject = obj => {
      var sortedObj = {};
      Object.keys(obj).sort().forEach((key => {
          if (typeof obj[key] === "object" && obj[key] !== null && !Array.isArray(obj[key])) {
              sortedObj[key] = sortObject(obj[key]);
          } else {
              sortedObj[key] = obj[key];
          }
      }));
      return sortedObj;
  };

  var getCharacterSum = obj => {
      var sortedObj = sortObject(obj);
      var str = JSON.stringify(sortedObj).replace(/[{}:",\s]/g, "");
      var sum = 0;
      for (var i = 0; i < str.length; i++) {
          sum += getCharacterValue(str[i], i);
      }
      return sum;
  };

  var getHash = obj => {
      var str = JSON.stringify(obj);
      return str.length + "-" + getCharacterSum(obj);
  };

  function executeWithContextRecursive(objOrFunction, theme) {
      if (typeof objOrFunction === "function") {
          var result = objOrFunction(theme);
          return executeWithContextRecursive(result, theme);
      } else if (Array.isArray(objOrFunction)) {
          return objOrFunction.map((item => executeWithContextRecursive(item, theme)));
      } else if (typeof objOrFunction === "object" && objOrFunction !== null) {
          var _result2 = {};
          for (var key in objOrFunction) {
              if (objOrFunction.hasOwnProperty(key)) {
                  _result2[key] = executeWithContextRecursive(objOrFunction[key], theme);
              }
          }
          return _result2;
      } else {
          return objOrFunction;
      }
  }

  function isPlainObject(value) {
      return typeof value === "object" && value !== null && !Array.isArray(value) && !(value instanceof Date) && !(value instanceof RegExp) && !(value instanceof Function) && !(value instanceof Error);
  }

  var getSubTheme = obj => {
      while (obj && (!obj.subTheme || typeof obj.subTheme !== "string")) {
          obj = obj.p;
      }
      return obj ? obj.subTheme : undefined;
  };

  var getComponentConfig = obj => {
      var _obj$theme;
      if (!isPlainObject(obj)) return {};
      return (obj === null || obj === void 0 || (_obj$theme = obj.theme) === null || _obj$theme === void 0 || (_obj$theme = _obj$theme.componentConfig) === null || _obj$theme === void 0 ? void 0 : _obj$theme[obj.constructor.__componentName]) || {};
  };

  function removeEmptyObjects(obj) {
      for (var key in obj) {
          if (obj.hasOwnProperty(key) && isPlainObject(obj[key])) {
              removeEmptyObjects(obj[key]);
              if (Object.keys(obj[key]).length === 0) {
                  delete obj[key];
              }
          }
      }
      return obj;
  }

  function safeStringify(originalObj) {
      var obj = _objectSpread({}, originalObj);
      var seen = new WeakSet;
      return JSON.stringify(obj, ((key, value) => {
          if (typeof value === "object" && value !== null) {
              if (seen.has(value)) {
                  return "[Circular]";
              }
              seen.add(value);
          }
          return value;
      }));
  }

  function createSharedReferences() {
      var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var seenObjects = new Map;
      function process(currentObj) {
          var queue = [ currentObj ];
          while (queue.length > 0) {
              var current = queue.shift();
              for (var key in current) {
                  if (current.hasOwnProperty(key)) {
                      var value = current[key];
                      if (typeof value === "object" && value !== null) {
                          var cacheKey = safeStringify(value);
                          if (seenObjects.has(cacheKey)) {
                              current[key] = seenObjects.get(cacheKey);
                          } else {
                              seenObjects.set(cacheKey, value);
                              queue.push(value);
                          }
                      }
                  }
              }
          }
      }
      process(obj);
      return obj;
  }

  function getUniqueProperties() {
      var defaultProps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      if (!Array.isArray(defaultProps)) {
          throw new TypeError("Expected defaultProps to be an array of strings.");
      }
      return [ ...new Set(defaultProps) ];
  }

  function generatePayload(base, defaultStyle, toneItem, modeItem, tone, mode) {
      var _tone$toneItem, _mode$modeItem;
      var payload = clone(defaultStyle, base);
      payload = clone(payload, tone === null || tone === void 0 ? void 0 : tone[toneItem]);
      payload = clone(payload, mode === null || mode === void 0 ? void 0 : mode[modeItem]);
      payload = clone(payload, (tone === null || tone === void 0 || (_tone$toneItem = tone[toneItem]) === null || _tone$toneItem === void 0 || (_tone$toneItem = _tone$toneItem.mode) === null || _tone$toneItem === void 0 ? void 0 : _tone$toneItem[modeItem]) || {});
      payload = clone(payload, (mode === null || mode === void 0 || (_mode$modeItem = mode[modeItem]) === null || _mode$modeItem === void 0 || (_mode$modeItem = _mode$modeItem.tone) === null || _mode$modeItem === void 0 ? void 0 : _mode$modeItem[toneItem]) || {});
      return payload;
  }

  function findNestedKeys(obj, keyToFind) {
      var nestedKeys = [];
      function searchNestedKeys(obj) {
          if (typeof obj === "object" && obj !== null) {
              for (var key in obj) {
                  if (obj.hasOwnProperty(key)) {
                      nestedKeys.push(key);
                  }
              }
          }
      }
      function searchForKey(obj) {
          if (typeof obj === "object" && obj !== null) {
              for (var key in obj) {
                  if (obj.hasOwnProperty(key)) {
                      if (key === keyToFind) {
                          searchNestedKeys(obj[key]);
                          break;
                      }
                      searchForKey(obj[key]);
                  }
              }
          }
      }
      searchForKey(obj);
      return nestedKeys;
  }

  var generateSolution = function generateSolution(_ref7) {
      var {base: base = {}, tone: tone = {}, mode: mode = {}, defaultStyle: defaultStyle = {}} = _ref7;
      var modeKeys = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      var toneKeys = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
      var solution = {};
      var uniqueModes = getUniqueProperties([ "focused", "disabled", ...modeKeys, "unfocused" ]);
      var uniqueTones = getUniqueProperties([ "neutral", "inverse", "brand", ...toneKeys ]);
      for (var modeItem of uniqueModes) {
          for (var toneItem of uniqueTones) {
              var payload = generatePayload(base, defaultStyle, toneItem, modeItem, tone, mode);
              solution["".concat(modeItem, "_").concat(toneItem)] = payload;
          }
      }
      return solution;
  };

  var DEFAULT_KEYS = [ "unfocused_neutral", "unfocused_inverse", "unfocused_brand", "focused_neutral", "focused_inverse", "focused_brand", "disabled_neutral", "disabled_inverse", "disabled_brand" ];

  function enforceContract(inputObj) {
      var result = {};
      for (var key of [ ...DEFAULT_KEYS, ...Object.keys(inputObj) ]) {
          if (!inputObj.hasOwnProperty(key)) {
              var fallbackKey = DEFAULT_KEYS.find((fallback => inputObj.hasOwnProperty(fallback)));
              if (fallbackKey) {
                  var fallback = inputObj[fallbackKey];
                  result[key] = typeof fallback !== "object" ? {} : fallback;
              } else {
                  result[key] = {};
              }
          } else {
              if (typeof inputObj[key] !== "object") {
                  result[key] = {};
              } else {
                  result[key] = inputObj[key];
              }
          }
      }
      return result;
  }

  var generateComponentStyleSource = function generateComponentStyleSource() {
      var {theme: theme = {}, styleChain: styleChain = [], inlineStyle: inlineStyle = {}, alias: alias = []} = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      if (typeof theme !== "object") {
          throw new Error("Expected theme to be an object");
      }
      if (!Array.isArray(styleChain)) {
          throw new Error("Expected styleChain to be an array");
      }
      if (typeof inlineStyle !== "object") {
          throw new Error("Expected inlineStyle to be an object");
      }
      if (!Array.isArray(alias)) {
          throw new Error("Expected alias to be an array");
      }
      var componentDefault = styleChain.map((_ref8 => {
          var {style: style} = _ref8;
          if (typeof style === "object" && !style.base && !style.mode && !style.tone && !style.default) {
              return {
                  base: style
              };
          } else {
              var {base: _base = {}, mode: _mode = {}, tone: _tone = {}} = style;
              var componentConfigDefaultStyle;
              if (style) {
                  var defaultStyle = JSON.parse(JSON.stringify(style));
                  delete defaultStyle.base;
                  delete defaultStyle.tone;
                  delete defaultStyle.mode;
                  componentConfigDefaultStyle = defaultStyle;
              }
              return {
                  defaultStyle: componentConfigDefaultStyle || {},
                  base: _base,
                  mode: _mode,
                  tone: _tone
              };
          }
      }));
      var localDefaultStyle;
      if (inlineStyle) {
          var defaultStyle = JSON.parse(JSON.stringify(inlineStyle));
          delete defaultStyle.base;
          delete defaultStyle.tone;
          delete defaultStyle.mode;
          localDefaultStyle = defaultStyle;
      }
      var local = {
          defaultStyle: localDefaultStyle || {},
          base: (inlineStyle === null || inlineStyle === void 0 ? void 0 : inlineStyle.base) || {},
          mode: (inlineStyle === null || inlineStyle === void 0 ? void 0 : inlineStyle.mode) || {},
          tone: (inlineStyle === null || inlineStyle === void 0 ? void 0 : inlineStyle.tone) || {}
      };
      var merged = [ ...componentDefault, local ];
      var parsedStyles = merged.map((style => executeWithContextRecursive(style, theme)));
      var modeKeys = findNestedKeys(parsedStyles, "mode");
      var toneKeys = findNestedKeys(parsedStyles, "tone");
      var solution = parsedStyles.reduce(((acc, style) => clone(acc, generateSolution(style, modeKeys, toneKeys))), {});
      var final = formatStyleObj(removeEmptyObjects(colorParser({
          theme: theme
      }, solution)) || {}, alias);
      var cleanObj = createSharedReferences(final);
      return enforceContract(cleanObj);
  };

  var colorParser = (targetObject, styleObj) => {
      if (typeof targetObject !== "object" || targetObject === null) {
          throw new TypeError("targetObject must be an object.");
      }
      if (typeof styleObj !== "object" || styleObj === null) {
          throw new TypeError("styleObj must be an object.");
      }
      var processedStyle = JSON.stringify(styleObj, ((_, value) => {
          if (-1 < [ "tone", "mode" ].indexOf(_)) return value;
          if (typeof value === "string" && value.startsWith("theme.")) {
              return getValFromObjPath(targetObject, value);
          }
          function isValidColor(num) {
              return num >= 0 && num <= 4294967295;
          }
          if (Array.isArray(value) && value.length === 2 && (typeof value[0] === "string" && value[0].startsWith("#") || typeof value[0] === "number" && isValidColor(value[0])) && typeof value[1] === "number") {
              return getHexColor(value[0], value[1]) || value;
          }
          return value;
      }));
      return JSON.parse(processedStyle || {});
  };

  var generateStyle = function generateStyle(component) {
      var componentStyleSource = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      if (!isPlainObject(component)) return {};
      var {mode: mode = "unfocused", tone: tone = "neutral"} = component;
      return componentStyleSource["".concat(mode, "_").concat(tone)] || componentStyleSource["unfocused_neutral"] || {};
  };

  function generateNameFromPrototypeChain(obj) {
      var _proto$constructor;
      var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "";
      if (!obj) return name;
      var proto = Object.getPrototypeOf(obj);
      if (!proto || !proto.constructor) return name;
      var componentName = "".concat(name ? name + "." : "").concat((proto === null || proto === void 0 || (_proto$constructor = proto.constructor) === null || _proto$constructor === void 0 ? void 0 : _proto$constructor.__componentName) || "").replace(/\.*$/, "").trim();
      var result = generateNameFromPrototypeChain(proto, componentName);
      return result;
  }

  var styleChainCache = {};

  var clearStyleChainCache = () => {
      for (var key in styleChainCache) {
          if (styleChainCache.hasOwnProperty(key)) {
              delete styleChainCache[key];
          }
      }
  };

  var getStyleChainMemoized = componentObj => {
      var cacheKey = generateNameFromPrototypeChain(componentObj);
      if (styleChainCache[cacheKey]) {
          return styleChainCache[cacheKey];
      }
      var styleChain = getStyleChain(componentObj);
      styleChainCache[cacheKey] = styleChain;
      return styleChain;
  };

  var getStyleChain = componentObj => {
      var styleMap = new Map;
      var proto;
      do {
          var _proto;
          proto = !proto ? componentObj : Object.getPrototypeOf(proto);
          if (((_proto = proto) === null || _proto === void 0 ? void 0 : _proto.constructor) === Object) break;
          if (proto && typeof proto === "object" && proto.hasOwnProperty("constructor")) {
              var {style: componentConfigStyle} = getComponentConfig(proto);
              if (Object.keys(componentConfigStyle || {}).length) {
                  if (!styleMap.has(componentConfigStyle)) {
                      styleMap.set(componentConfigStyle, {
                          style: componentConfigStyle
                      });
                  }
              }
              var themeStyle = proto.constructor.hasOwnProperty("__themeStyle") && proto.constructor.__themeStyle;
              if (Object.keys(themeStyle || {}).length) {
                  if (!styleMap.has(themeStyle)) {
                      styleMap.set(themeStyle, {
                          style: _objectSpread({}, themeStyle)
                      });
                  }
              } else if (typeof themeStyle === "function") {
                  if (!styleMap.has(themeStyle)) {
                      styleMap.set(themeStyle, {
                          style: themeStyle
                      });
                  }
              }
              var mixinStyle = proto.constructor.hasOwnProperty("__mixinStyle") && proto.constructor.__mixinStyle;
              if (Object.keys(mixinStyle || {}).length) {
                  if (!styleMap.has(mixinStyle)) {
                      styleMap.set(mixinStyle, {
                          style: mixinStyle
                      });
                  }
              }
          }
      } while (proto);
      var uniqueStyles = Array.from(styleMap.values());
      return uniqueStyles.map((style => style)).reverse();
  };

  var formatStyleObj = function formatStyleObj(originalObj) {
      var aliasStyles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      if (typeof originalObj !== "object" || originalObj === null) {
          throw new Error("The originalObj parameter must be an object.");
      }
      var formatters = new Set;
      formatters.add([ replaceAliasValues, [ aliasStyles ] ]);
      var formattersArray = Array.from(formatters);
      return formattersArray.reduce(((obj, _ref9) => {
          var [func, args] = _ref9;
          return func(obj, ...args);
      }), originalObj);
  };

  var replaceAliasValues = function replaceAliasValues(value) {
      var aliasStyles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      if (typeof value !== "object" || value === null) {
          throw new Error("Value must be an object");
      }
      if (!Array.isArray(aliasStyles)) {
          throw new Error("Alias styles must be an array");
      }
      var str = JSON.stringify(value);
      var aliasProps = [ {
          prev: "height",
          curr: "h",
          skipWarn: true
      }, {
          prev: "width",
          curr: "w",
          skipWarn: true
      }, ...aliasStyles || [] ];
      aliasProps.forEach((alias => {
          if (alias && typeof alias.prev === "string" && typeof alias.curr === "string") {
              !alias.skipWarn && str.search('"'.concat(alias.prev, '":')) >= 0 && loggerInstance.warn('The style property "'.concat(alias.prev, '" is deprecated and will be removed in a future release. Please use "').concat(alias.curr, '" instead.'));
              str = str.replace(new RegExp('"'.concat(alias.prev, '":'), "gi"), '"'.concat(alias.curr, '":'));
          }
      }));
      return JSON.parse(str);
  };

  var themeStyleCache = new Map;

  contextInstance.on("themeUpdate", (() => {
      themeStyleCache.clear();
  }));

  var cache = themeStyleCache;

  class StyleManager extends Lightning.EventEmitter {
      constructor() {
          var {component: component = {}} = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
          super(...arguments);
          this.init(component);
      }
      init(component) {
          this.isActive = true;
          this.component = component;
          this.setupListeners();
          this._style = {};
          this.update();
      }
      setupListeners() {
          this._boundThemeUpdate = this._onThemeUpdate.bind(this);
          this._hasSubTheme = Boolean(this.component._targetSubTheme);
          if (!this.component._targetSubTheme) {
              contextInstance.on("themeUpdate", this._boundThemeUpdate);
          } else {
              contextInstance.on("themeUpdate".concat(this.component._targetSubTheme), this._boundThemeUpdate);
          }
      }
      clearListeners() {
          if (!this._boundThemeUpdate) return;
          if (!this.component._targetSubTheme) {
              contextInstance.off("themeUpdate", this._boundThemeUpdate);
          } else {
              contextInstance.off("themeUpdate".concat(this.component._targetSubTheme), this._boundThemeUpdate);
          }
      }
      destroy() {
          this.isActive = false;
          this._cleanupCache();
          this.clearListeners();
          this._styleCache = null;
          this._boundThemeUpdate = null;
          this.component = null;
      }
      _onThemeUpdate() {
          clearStyleChainCache();
          this.clearSourceCache();
          this.clearStyleCache();
          this.update();
      }
      clearStyleChainCache() {
          clearStyleChainCache();
      }
      clearSourceCache() {
          if (!this.component) return;
          var sourceKey = this._generateCacheKey("styleSource");
          this._removeCache(sourceKey);
      }
      clearStyleCache() {
          if (!this.component) return;
          var {tone: tone, mode: mode} = this.component;
          var styleKey = this._generateCacheKey("style_".concat(mode, "_").concat(tone));
          cache.delete(styleKey);
      }
      _generateCacheKey(name) {
          var cacheKey = [ name, this.component._targetSubTheme, this.component.constructor.__componentName, this._customStyleHash ].filter(Boolean).join("_");
          return cacheKey;
      }
      _addCache(name, payload) {
          var key = this._generateCacheKey(name);
          var existing = cache.get(key);
          cache.set(key, {
              ids: [ ...new Set([ ...(existing === null || existing === void 0 ? void 0 : existing.ids) || [], this.component.__id ]) ],
              payload: payload
          });
      }
      _cleanupCache() {
          if (!this.component) return;
          cache.forEach(((_ref10, name) => {
              var {ids: ids, payload: payload} = _ref10;
              var removeIndex = ids && ids.length && ids.indexOf(this.component.__id);
              if (removeIndex > -1 && ids.length > 1) {
                  cache.set(name, {
                      ids: ids.slice(0, removeIndex).concat(ids.slice(removeIndex + 1)),
                      payload: payload
                  });
              } else if (removeIndex > -1) {
                  cache.delete(name);
              }
          }));
      }
      _removeCache(name) {
          cache.delete(name);
      }
      _getCache(name) {
          var key = this._generateCacheKey(name);
          return cache.get(key);
      }
      update() {
          if (!this.component) return;
          var {mode: mode, tone: tone} = this.component;
          try {
              var _this$_getCache, _this$_getCache2;
              var styleSource = (_this$_getCache = this._getCache("styleSource")) === null || _this$_getCache === void 0 ? void 0 : _this$_getCache.payload;
              if (!styleSource) {
                  styleSource = generateComponentStyleSource({
                      alias: this.component.constructor.aliasStyles,
                      inlineStyle: this.component._componentLevelStyle,
                      styleChain: getStyleChainMemoized(this.component),
                      theme: this.component.theme
                  });
                  this._addCache("styleSource", styleSource);
              }
              var style = (_this$_getCache2 = this._getCache("style_".concat(mode, "_").concat(tone))) === null || _this$_getCache2 === void 0 ? void 0 : _this$_getCache2.payload;
              if (!style) {
                  style = generateStyle(this.component, styleSource);
                  this._addCache("style_".concat(mode, "_").concat(tone), style);
              }
              this._style = style;
              this.emit("styleUpdate", this.style);
          } catch (error) {
              contextInstance.error("styleManager: ", error.message);
          }
      }
      set style(v) {
          contextInstance.warn("styleManager: Cannot mutate style directly");
      }
      get style() {
          return this._style;
      }
      set props(v) {
          contextInstance.warn("styleManager: Cannot mutate props directly");
      }
      get props() {
          return Object.keys(this.component._componentConfig).reduce(((acc, key) => {
              if (![ "base", "tone", "mode", "style", "styleConfig" ].includes(key)) {
                  acc[key] = this.component._componentConfig[key];
              }
              return acc;
          }), {});
      }
      get _customStyleHash() {
          var hasCustomStyle = Boolean(Object.keys(this.component.constructor.__mixinStyle || {}).length) || Boolean(Object.keys(this.component._componentLevelStyle || {}).length);
          if (hasCustomStyle) {
              return getHash(clone(this.component.constructor.__mixinStyle || {}, this.component._componentLevelStyle || {}));
          }
          return undefined;
      }
  }

  function mergeObjectsWithSecondDominant(firstObj, secondObj) {
      if (firstObj !== null && typeof firstObj === "object") {
          if (Array.isArray(firstObj)) {
              return firstObj.map(((item, index) => mergeObjectsWithSecondDominant(item, Array.isArray(secondObj) ? secondObj[index] : undefined)));
          } else {
              var result = {};
              var allKeys = new Set([ ...Object.keys(firstObj), ...Object.keys(secondObj) ]);
              allKeys.forEach((key => {
                  if (typeof firstObj[key] === "object" && firstObj[key] !== null) {
                      result[key] = mergeObjectsWithSecondDominant(firstObj[key], secondObj[key] || {});
                  } else if (typeof secondObj[key] === "object" && secondObj[key] !== null) {
                      result[key] = mergeObjectsWithSecondDominant(firstObj[key] || {}, secondObj[key]);
                  } else {
                      result[key] = secondObj.hasOwnProperty(key) ? secondObj[key] : undefined;
                  }
              }));
              return result;
          }
      } else {
          return firstObj;
      }
  }

  function withThemeStyles(Base) {
      var mixinStyle = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      return class extends Base {
          _construct() {
              if (this._withThemeStylesSetupComplete) {
                  super._construct();
                  return;
              }
              this._hSetByUser = false;
              this._wSetByUser = false;
              this._styleManager = new StyleManager({
                  component: this
              });
              this._style = this._styleManager.style;
              this._updatePropDefaults();
              this._styleManager.on("styleUpdate", (() => {
                  this._style = this._styleManager.style;
                  this._updatePropDefaults();
                  this.queueThemeUpdate();
              }));
              this._withThemeStylesSetupComplete = true;
              super._construct();
          }
          _setup() {
              super._setup && super._setup();
              this._targetSubTheme = getSubTheme(this);
              if (this._targetSubTheme) {
                  this._styleManager.clearListeners();
                  this._styleManager.setupListeners();
                  this._styleManager.clearStyleChainCache();
                  this._styleManager.clearStyleCache();
                  this._styleManager.clearSourceCache();
                  this._styleManager.update();
              }
          }
          _updatePropDefaults() {
              if (!Object.keys(this._styleManager.props).length || JSON.stringify(this._styleManager.props) === JSON.stringify(this._prevComponentConfigProps)) {
                  return;
              }
              var payload = this._prevComponentConfigProps ? mergeObjectsWithSecondDominant(this._prevComponentConfigProps || {}, this._styleManager.props || {}) : this._styleManager.props || {};
              this._prevComponentConfigProps = this._styleManager.props && JSON.parse(JSON.stringify(this._styleManager.props));
              this.__componentConfigProps = payload;
          }
          _attach() {
              super._attach();
              if (!this._styleManager.isActive) {
                  this._styleManager.init(this);
              }
          }
          _detach() {
              super._detach();
              this._styleManager.destroy();
          }
          _unfocus() {
              if (this._isFocusedMode) this.mode = "unfocused";
              super._unfocus();
          }
          _focus() {
              if (!this._isDisabledMode) this.mode = "focused";
              super._focus();
          }
          _checkDimensionUpdates() {
              var dimensionUpdateRequired = false;
              if (!this._wSetByUser && this.style.w && this._w !== this.style.w) {
                  this._w = this.style.w;
                  dimensionUpdateRequired = true;
              }
              if (!this._hSetByUser && this.style.h && this._h !== this.style.h) {
                  this._h = this.style.h;
                  dimensionUpdateRequired = true;
              }
              if (dimensionUpdateRequired) {
                  this._updateDimensions();
              }
          }
          _updateThemeComponent() {
              if (!this.style) return;
              if (!this._isAttached()) return;
              this._checkDimensionUpdates();
              this.queueRequestUpdate ? this.queueRequestUpdate() : this._update && this._update();
              this._updateItemLayout && this._updateItemLayout();
          }
          queueThemeUpdate() {
              updateManager.addUpdateTheme(this);
          }
          static get name() {
              return Base.name;
          }
          static get __componentName() {
              if (!super.__componentName) {
                  throw new Error("A valid static __componentName property is required for theming to work properly. Please add this to the ".concat(this.constructor.name, " class."));
              }
              return super.__componentName;
          }
          static get __mixinStyle() {
              return mixinStyle;
          }
          get theme() {
              var subTheme = this._targetSubTheme && contextInstance.getSubTheme(this._targetSubTheme);
              return subTheme || contextInstance.theme;
          }
          set style(v) {
              if (Object.prototype.toString.call(v) !== "[object Object]") {
                  contextInstance.error("style must be an object");
                  return;
              }
              this._componentLevelStyle = v;
              this._styleManager.clearStyleCache();
              this._styleManager.update();
          }
          get style() {
              return this._style;
          }
          get _componentStyle() {
              contextInstance.info("_componentStyle will soon be deprecated. Please use Component.style");
              return this._style;
          }
          set styleConfig(v) {
              contextInstance.info("style config is deprecated. Please use style = { base: {}, tone: {}, mode: {} }");
              this._styleConfig = v;
              this._styleManager.update();
          }
          get styleConfig() {
              return this._styleConfig;
          }
          get _componentConfig() {
              return getComponentConfig(this);
          }
          get mode() {
              var _this$_componentConfi;
              return this._mode || ((_this$_componentConfi = this._componentConfig) === null || _this$_componentConfi === void 0 ? void 0 : _this$_componentConfi.mode) || "unfocused";
          }
          set mode(v) {
              if (typeof v !== "string" || this._mode === v) return;
              this._mode = v;
              var event = this["on".concat(capitalizeFirstLetter(v))];
              if (event && typeof event === "function") event.call(this);
              this._styleManager.update();
          }
          get tone() {
              return this._tone || this._componentConfig.tone || "neutral";
          }
          set tone(v) {
              if (typeof v !== "string" || this._tone === v) return;
              this._tone = v;
              this._styleManager.update();
          }
          get w() {
              var _this$style;
              return this._wSetByUser && this._w || ((_this$style = this.style) === null || _this$style === void 0 ? void 0 : _this$style.w) || 0;
          }
          set w(v) {
              if (this._w === v) return;
              super.w = v;
              this._wSetByUser = true;
              this._updateThemeComponent();
          }
          get h() {
              var _this$style2;
              return this._hSetByUser && this._h || ((_this$style2 = this.style) === null || _this$style2 === void 0 ? void 0 : _this$style2.h) || this._h || 0;
          }
          set h(v) {
              if (this._h === v) return;
              super.h = v;
              this._hSetByUser = true;
              this._updateThemeComponent();
          }
      };
  }

  var SUFFIX = "__original";

  function withExtensions(Base) {
      if (Base.prototype.constructor._withExtensionsApplied) {
          return Base;
      }
      return class extends Base {
          static get name() {
              return Base.name;
          }
          static get __componentName() {
              if (!super.__componentName) {
                  throw new Error("A valid static __componentName property is required for theming to work properly. Please add this to the ".concat(this.constructor.name, " class."));
              }
              return super.__componentName;
          }
          static get _withExtensionsApplied() {
              return true;
          }
          get _prototypeChain() {
              if (this.__prototypeChain) return this.__prototypeChain;
              var prototypeChain = new Set;
              var proto = this;
              do {
                  proto = Object.getPrototypeOf(proto);
                  if (null !== proto && typeof proto === "object") {
                      try {
                          if (proto.constructor.__componentName) prototypeChain.add(proto.constructor.__componentName);
                      } catch (error) {}
                  }
              } while (proto);
              this.__prototypeChain = prototypeChain;
              return prototypeChain;
          }
          get _extensions() {
              var extensions = contextInstance && contextInstance.theme && contextInstance.theme.extensions;
              if (!extensions || !Array.isArray(extensions) || Array.isArray(extensions) && !extensions.length) return [];
              return extensions.filter((_ref11 => {
                  var {targetComponent: targetComponent, extension: extension} = _ref11;
                  return (typeof targetComponent === "string" || Array.isArray(targetComponent)) && typeof extension === "function";
              })).slice().reverse() || [];
          }
          get _componentExtensions() {
              return this._extensions.filter((_ref12 => {
                  var {targetComponent: targetComponent} = _ref12;
                  if (typeof targetComponent === "string") {
                      return targetComponent === this.constructor.__componentName || this._prototypeChain.has(targetComponent);
                  } else if (Array.isArray(targetComponent)) {
                      return targetComponent.find((pattern => {
                          if (pattern.startsWith("/") && pattern.endsWith("/")) {
                              var ComponentRegExp = new RegExp(pattern.slice(1, -1));
                              return Array.from(this._prototypeChain).some((name => ComponentRegExp.test(name)));
                          } else {
                              return this._prototypeChain.has(pattern);
                          }
                      }));
                  }
                  return false;
              })).reduce(((acc, _ref13) => {
                  var {extension: extension} = _ref13;
                  acc.push(extension);
                  return acc;
              }), []);
          }
          get _extensionApplied() {
              return this._currentComponentExtensionLength === this._appliedExtensionLength;
          }
          _construct() {
              this._appliedExtensionLength = 0;
              this._extendedList = {};
              this._extensionInstance = {};
              this._setupExtensionBound = this._setupExtension.bind(this);
              contextInstance.on("themeUpdate", this._setupExtensionBound);
              this._currentComponentExtensionLength = this._calculateComponentExtensionLength();
              this._createExtension();
              super._construct();
          }
          _detach() {
              super._detach();
              contextInstance.off("themeUpdate", this._setupExtensionBound);
          }
          _setupExtension() {
              this._currentComponentExtensionLength = this._calculateComponentExtensionLength();
              this._createExtension.call(this);
          }
          _resetComponent() {
              this._extensionInstance._extensionCleanup && this._extensionInstance._extensionCleanup.call(this);
              (Object.keys(this._extendedList) || []).forEach((prop => {
                  delete this[prop];
                  delete this[prop + SUFFIX];
              }));
              this._extensionInstance = {};
              this._extendedList = {};
          }
          _calculateComponentExtensionLength() {
              var extensionLength = this._componentExtensions.reduce(((acc, extensionMixin) => {
                  acc += extensionMixin.toString().length;
                  return acc;
              }), 0);
              return extensionLength;
          }
          _createExtension() {
              if (this._extensionApplied) return;
              this._resetComponent();
              var ExtendedClass = this._createExtensionClass();
              var instance = new ExtendedClass;
              this._extendedList = this._createExtensionAliases(instance);
              this._extensionInstance = instance;
              this._setComponentAliases(this._extendedList);
          }
          _createExtensionClass() {
              function ExtensionBase() {}
              var ExtendedClass = this._componentExtensions.reduce(((acc, extension) => extension(acc)), ExtensionBase);
              this._appliedExtensionLength = this._calculateComponentExtensionLength();
              return ExtendedClass;
          }
          _createExtensionAliases(obj) {
              var baseProto = obj;
              for (var i = 0; i < this._componentExtensions.length + 1; i++) {
                  baseProto = Object.getPrototypeOf(baseProto);
              }
              var extended = {};
              var extensionOverrides = this._componentExtensions.reduce(((acc, extension) => {
                  var extensionClass = new extension(class FakeClass {});
                  var instance = new extensionClass;
                  var originalComponentDescriptors = Object.getOwnPropertyDescriptors(Object.getPrototypeOf(instance));
                  Object.keys(originalComponentDescriptors).forEach((prop => {
                      if ([ "constructor" ].includes(prop)) return;
                      if (originalComponentDescriptors[prop].get || originalComponentDescriptors[prop].set) {
                          extended[prop] = {
                              type: "accessor"
                          };
                          acc[prop] = {
                              get: function get() {
                                  return this[prop + SUFFIX];
                              },
                              set: function set(v) {
                                  this[prop + SUFFIX] = v;
                              }
                          };
                          return;
                      }
                      extended[prop] = {
                          type: "method"
                      };
                      acc[prop] = {
                          value: function value() {
                              this[prop + SUFFIX] && this[prop + SUFFIX]();
                          }
                      };
                  }));
                  return acc;
              }), {});
              Object.defineProperties(baseProto, extensionOverrides);
              Object.setPrototypeOf(baseProto, this);
              return extended;
          }
          _setComponentAliases(aliasObj) {
              Object.keys(aliasObj).forEach((prop => {
                  this[prop + SUFFIX] = this[prop];
                  if (aliasObj[prop].type === "method") {
                      this[prop] = this._extensionInstance[prop];
                  } else if (aliasObj[prop].type === "accessor") {
                      Object.defineProperty(this, prop, {
                          configurable: true,
                          get() {
                              return this._extensionInstance[prop];
                          },
                          set(v) {
                              this._extensionInstance[prop] = v;
                          }
                      });
                  }
              }));
          }
      };
  }

  class Base extends Lightning.Component {
      static get __componentName() {
          return "Base";
      }
      _construct() {
          this.constructor.__componentName;
          this.skipPlinko = false;
          this.centerInParent = false;
          if (!this.loaded) this.loaded = Promise.resolve();
      }
      _init() {
          this.queueRequestUpdate();
      }
      _resetLoadedPromise() {
          this.loaded = new Promise(((resolve, reject) => {
              this._resolveLoadedPromise = resolve;
              this._rejectLoadedPromise = reject;
          }));
      }
      _update() {}
      _focus() {
          this._updateShouldSmooth();
          this.queueRequestUpdate();
      }
      _unfocus() {
          this.queueRequestUpdate();
      }
      _updateShouldSmooth() {
          if (this.shouldSmooth === undefined) this.shouldSmooth = true;
      }
      applySmooth(ref, patch, smooth) {
          if (this.shouldSmooth) {
              ref.smooth = smooth || patch;
          } else {
              ref.patch(patch);
          }
      }
      get announce() {
          return this._announce;
      }
      set announce(announce) {
          this._announce = announce;
      }
      get announceContext() {
          return this._announceContext;
      }
      set announceContext(announce) {
          this._announceContext = announce;
      }
      get shouldSmooth() {
          return this._shouldSmooth;
      }
      set shouldSmooth(shouldSmooth) {
          this._shouldSmooth = shouldSmooth;
      }
      get _isDisabledMode() {
          return this.mode === "disabled";
      }
      get _isUnfocusedMode() {
          return this.mode === "unfocused";
      }
      get _isFocusedMode() {
          return this.mode === "focused";
      }
      isFullyOnScreen(offsets) {
          return isComponentOnScreen(this, offsets);
      }
      getFocusScale() {
          return contextInstance.theme.layout.focusScale;
      }
      getUnfocusScale() {
          return 1;
      }
  }

  function withMixins(baseComponent) {
      return withExtensions(withLayout(withThemeStyles(withUpdates(withTags(withHandleKey(baseComponent))))));
  }

  var Base$1 = withMixins(Base);

  var base$R = theme => ({
      gradientTop: theme.color.fillTransparent,
      radius: theme.radius.none
  });

  var tone$p = theme => ({
      neutral: {
          gradientColor: theme.color.material
      },
      inverse: {
          gradientColor: theme.color.fillNeutral
      },
      brand: {
          gradientColor: theme.color.fillBrand
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$R,
      tone: tone$p
  });

  var base$Q = theme => ({
      animationBlurEntrance: theme.animation.utilityEntrance,
      animationBlurExit: theme.animation.utilityExit,
      animationComponentEntrance: theme.animation.utilityEntrance,
      animationGradientEntrance: theme.animation.utilityEntrance,
      animationGradientExit: theme.animation.utilityExit,
      animationImageScaleEntrance: theme.animation.standardEntrance,
      animationImageScaleExit: theme.animation.standardEntrance,
      blur: 4,
      centerImageRadius: theme.radius.md,
      fallbackSrc: undefined,
      fillColor: theme.color.overlay,
      gradientColor: theme.color.material,
      imageScale: 1,
      imageScalePivotX: .5,
      imageScalePivotY: .5,
      padding: theme.spacer.md,
      radius: 0,
      zIndexSet: {
          image: 1,
          blur: 2,
          centerImage: 3,
          fill: 4,
          gradient: 5,
          foreground: 6
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$Q
  });

  function checkFileType(str) {
      if (str.startsWith("<svg")) {
          return "SVG";
      } else if (str.startsWith("blob:")) {
          return "Blob";
      } else if (/\.(jpeg|jpg|gif|png|svg)$/i.test(str)) {
          return "Image";
      } else {
          return "Unknown";
      }
  }

  function createSvg(cb, stage, url, w, h) {
      var canvas = stage.platform.getDrawingCanvas();
      var ctx = canvas.getContext("2d");
      ctx.imageSmoothingEnabled = true;
      var img = new Image;
      img.onload = () => {
          canvas.width = w;
          canvas.height = h;
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
          cb(null, {
              source: canvas,
              w: w,
              h: h
          });
      };
      img.onerror = err => {
          cb(err);
      };
      if (!Lightning.Utils.isPS4) {
          img.crossOrigin = "Anonymous";
      }
      img.src = url;
  }

  function imageLoader(_ref14, cb) {
      var {src: src} = _ref14;
      var image = new Image;
      if (!(src.substr(0, 5) == "data:") && !Lightning.Utils.isPS4) {
          image.crossOrigin = "Anonymous";
      }
      image.onerror = function() {
          if (image.src) {
              return cb("Image load error");
          }
      };
      image.onload = function() {
          cb(null, {
              source: image,
              renderInfo: {
                  src: src,
                  compressed: false
              },
              hasAlpha: true
          });
      };
      image.src = src;
      return function() {
          image.onerror = null;
          image.onload = null;
          image.removeAttribute("src");
      };
  }

  class CustomImageTexture extends Lightning.Texture {
      constructor(stage) {
          super(stage);
          this._src = undefined;
          this._hasAlpha = false;
      }
      get src() {
          return this._src;
      }
      set src(v) {
          if (this._src !== v) {
              this._src = v;
              this._changed();
          }
      }
      get hasAlpha() {
          return this._hasAlpha;
      }
      set hasAlpha(v) {
          if (this._hasAlpha !== v) {
              this._hasAlpha = v;
              this._changed();
          }
      }
      get w() {
          return this._w;
      }
      set w(l) {
          this._w = l;
          this._changed();
      }
      get h() {
          return this._h;
      }
      set h(l) {
          this._h = l;
          this._changed();
      }
      _getIsValid() {
          return !!this._src;
      }
      _getLookupId() {
          return this._src;
      }
      _getSourceLoader() {
          var w = this._w;
          var h = this._h;
          var src = this._src;
          var hasAlpha = this._hasAlpha;
          if (this.stage.getOption("srcBasePath")) {
              var fc = src.charCodeAt(0);
              if (src.indexOf("//") === -1 && (fc >= 65 && fc <= 90 || fc >= 97 && fc <= 122 || fc == 46)) {
                  src = this.stage.getOption("srcBasePath") + src;
              }
          }
          return cb => {
              var fileType = checkFileType(src);
              switch (fileType) {
                case "SVG":
                  return createSvg(cb, this.stage, "data:image/svg+xml,".concat(encodeURIComponent(src)), w, h);

                case "Blob":
                  return imageLoader({
                      src: src
                  }, cb);

                default:
                  return this.stage.platform.loadSrcTexture({
                      src: src,
                      hasAlpha: hasAlpha
                  }, cb);
              }
          };
      }
      getNonDefaults() {
          var obj = super.getNonDefaults();
          if (this._src) {
              obj.src = this._src;
          }
          return obj;
      }
  }

  var tone$o = theme => ({
      neutral: {
          color: theme.color.fillNeutral
      },
      inverse: {
          color: theme.color.fillInverse
      },
      brand: {
          color: theme.color.fillBrand
      }
  });

  var styles$Q = Object.freeze({
      __proto__: null,
      tone: tone$o
  });

  class Icon extends Base$1 {
      static get __componentName() {
          return "Icon";
      }
      static get __themeStyle() {
          return styles$Q;
      }
      static get properties() {
          return [ "icon", "fixed", "color" ];
      }
      _init() {
          this.on("txLoaded", (() => {
              if (!this.fixed) {
                  this._notify.bind(this)();
              }
          }));
          this.on("txError", this._handleTxtError.bind(this));
      }
      _getColor() {
          return this._color || this.style.color;
      }
      _notify() {
          this.w = this.finalW;
          this.h = this.finalH;
          this.signal("itemChanged", this);
          this.fireAncestors("$itemChanged");
      }
      _handleTxtError() {
          contextInstance.error("Unable to load icon ".concat(this._icon));
          this._icon = null;
          this.texture = null;
      }
      _update() {
          if (!this._icon) {
              this.texture = null;
              return;
          }
          this.patch(this._iconPatch);
      }
      get _iconPatch() {
          var [isSvgTag, isSvgURI] = [ /^<svg.*<\/svg>$/, /\.svg$/ ].map((regex => RegExp.prototype.test.bind(regex)));
          var texture;
          var svgTag = isSvgTag(this.icon);
          var svgURI = isSvgURI(this.icon);
          if (svgTag) {
              texture = Lightning.Tools.getSvgTexture("data:image/svg+xml,".concat(encodeURIComponent(this.icon)), this.w, this.h);
          } else if (svgURI) {
              texture = Lightning.Tools.getSvgTexture(this.icon, this.w, this.h);
          } else {
              texture = {
                  type: CustomImageTexture,
                  w: this.w,
                  h: this.h,
                  src: this.icon
              };
          }
          var color = getValidColor(this._color || this.style.color);
          var shader = this.radius || this.style.radius ? {
              radius: this.radius || this.style.radius,
              type: Lightning.shaders.RoundedRectangle
          } : undefined;
          return _objectSpread({
              texture: texture,
              shader: shader
          }, color ? {
              colorUl: color,
              colorUr: color,
              colorBl: color,
              colorBr: color
          } : {});
      }
  }

  var base$P = theme => ({
      contentSpacing: theme.spacer.xs,
      offsetY: 1,
      paddingX: theme.spacer.md,
      paddingY: theme.spacer.xs,
      radius: theme.radius.sm,
      strokeWidth: theme.stroke.sm,
      textStyle: _objectSpread(_objectSpread({}, theme.typography.tag1), {}, {
          textAlign: "center"
      })
  });

  var tone$n = theme => ({
      neutral: {
          backgroundColor: theme.color.fillInverseSecondary,
          iconColor: theme.color.textNeutral,
          textStyle: {
              textColor: theme.color.textNeutral
          },
          strokeColor: theme.color.strokeNeutralSecondary
      },
      inverse: {
          backgroundColor: theme.color.fillNeutralSecondary,
          iconColor: theme.color.textInverse,
          textStyle: {
              textColor: theme.color.textInverse
          },
          strokeColor: theme.color.strokeInverseSecondary
      },
      brand: {
          backgroundColor: theme.color.fillBrand,
          iconColor: theme.color.textNeutral,
          textStyle: {
              textColor: theme.color.textNeutral
          },
          strokeColor: theme.color.strokeInverseSecondary
      }
  });

  var styles$P = Object.freeze({
      __proto__: null,
      base: base$P,
      tone: tone$n
  });

  class Badge extends Base$1 {
      static _template() {
          return {
              Text: {
                  mountY: .5
              },
              Icon: {
                  type: Icon,
                  mountY: .5,
                  signals: {
                      itemChanged: "_updateLayout"
                  }
              }
          };
      }
      static get __componentName() {
          return "Badge";
      }
      static get __themeStyle() {
          return styles$P;
      }
      static get properties() {
          return [ "title", "icon", "iconAlign", "iconWidth", "iconHeight" ];
      }
      static get tags() {
          return [ "Background", "Text", "Icon" ];
      }
      _init() {
          this._Text.on("txLoaded", this._updateLayout.bind(this));
          super._init();
      }
      _update() {
          this._updateText();
          this._updateIcon();
          this._updateLayout();
          this._updateVisibility();
      }
      _updateVisibility() {
          this.alpha = this.title || this.icon ? 1 : 0;
      }
      _updateLayout() {
          this._updateWidth();
          this._updateBackground();
          this._updatePositions();
          this.signal("loadedBadge", this);
      }
      _updateBackground() {
          var height = Math.max(this._Text.renderHeight, this._Icon.h) + this.style.paddingY * 2;
          this.patch({
              h: height,
              texture: Lightning.Tools.getRoundRect(this.w, height, getMaxRoundRadius(this.style.radius, this.w, height), this.style.strokeWidth, this.style.strokeColor, true, this.style.backgroundColor)
          });
      }
      _updateText() {
          if (this._Text) {
              this._Text.patch({
                  text: _objectSpread(_objectSpread({}, this.style.textStyle), {}, {
                      text: this.title || ""
                  })
              });
          }
      }
      _updateIcon() {
          this._Icon.patch({
              icon: this.icon,
              w: this.iconWidth,
              h: this.iconHeight,
              style: {
                  color: getHexColor(this.style.iconColor)
              }
          });
      }
      _updateWidth() {
          var width = 0;
          if (this.title && this.icon) {
              width = this._Text.renderWidth + this._Icon.finalW + this.style.contentSpacing + this.style.paddingX * 2;
          } else if (this.title) {
              width = this._Text.renderWidth + this.style.paddingX * 2;
          } else if (this.icon) {
              width = this._Icon.finalW + this.style.paddingX * 2;
          }
          this.w = width;
      }
      _updatePositions() {
          this._Icon.y = this.h / 2;
          if (this.iconAlign === "left" && this.title && this.icon) {
              this._Icon.x = this.style.paddingX;
              this._Text.x = this._Icon.x + this._Icon.finalW + this.style.contentSpacing;
          } else if (this.iconAlign === "right" && this.title && this.icon) {
              this._Text.x = this.style.paddingX;
              this._Icon.x = this._Text.x + this._Text.renderWidth + this.style.contentSpacing;
          } else {
              this._Text.x = this.style.paddingX;
              this._Icon.x = this.style.paddingX;
          }
          this._Text.y = this._h / 2 + this.style.offsetY;
      }
      _getIconHeight() {
          if (this.icon) {
              return !this._Icon.finalH && this._Text ? this._Text.text.lineHeight : this._Icon.finalH;
          }
          return 0;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          return this._announce || this.title;
      }
  }

  var base$O = theme => ({
      width: 0,
      justify: "center",
      minWidth: getWidthByColumnSpan(theme, 3),
      paddingX: theme.spacer.xxxl,
      paddingXNoTitle: theme.spacer.xl,
      paddingY: theme.spacer.xl,
      radius: theme.radius.sm,
      contentSpacing: theme.spacer.md,
      itemSpacing: theme.spacer.md,
      textStyle: _objectSpread(_objectSpread({}, theme.typography.button1), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutral
      }),
      contentColor: theme.color.fillNeutral
  });

  var mode$g = theme => ({
      focused: {
          textStyle: {
              textColor: theme.color.textInverse
          },
          contentColor: theme.color.fillInverse,
          tone: {
              inverse: {
                  textStyle: {
                      textColor: theme.color.textNeutral
                  },
                  contentColor: theme.color.fillNeutral
              },
              brand: {
                  contentColor: theme.color.fillNeutral
              }
          }
      },
      disabled: {
          textStyle: {
              textColor: theme.color.textNeutralDisabled
          },
          contentColor: theme.color.fillNeutralDisabled
      }
  });

  var styles$O = Object.freeze({
      __proto__: null,
      base: base$O,
      mode: mode$g
  });

  class FocusManager extends Base$1 {
      static get __componentName() {
          return "FocusManager";
      }
      static get tags() {
          return [ "Items" ];
      }
      static get properties() {
          return [ "direction", "wrapSelected" ];
      }
      _construct() {
          super._construct();
          this._selectedIndex = 0;
          this._itemPosX = 0;
          this._itemPosY = 0;
          this.direction = this.direction || "row";
      }
      _init() {
          this._checkSkipFocus();
      }
      get Items() {
          if (!this.tag("Items")) {
              this.patch({
                  Items: {}
              });
          }
          return this._Items;
      }
      _setDirection(direction) {
          var state = {
              none: "None",
              column: "Column",
              row: "Row"
          }[direction];
          if (state) {
              this._setState(state);
          }
          return direction;
      }
      _getItems() {
          return this._Items.children;
      }
      get items() {
          return this.Items.children;
      }
      set items(items) {
          this._resetItems();
          this._selectedIndex = 0;
          this.appendItems(items);
          this._checkSkipFocus();
      }
      set itemPosX(x) {
          this.Items.x = this._itemPosX = x;
      }
      get itemPosX() {
          return this._itemPosX;
      }
      set itemPosY(y) {
          this.Items.y = this._itemPosY = y;
      }
      get itemPosY() {
          return this._itemPosY;
      }
      _resetItems() {
          this.Items.childList.clear();
          this.Items.patch({
              w: 0,
              h: 0,
              x: this.itemPosX,
              y: this.itemPosY
          });
          if (this._lazyItems) {
              this._lazyItems = null;
          }
      }
      _appendLazyItem(item) {
          this.appendItems([ item ]);
      }
      appendItems() {
          var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          this.Items.childList.a(items);
          this._refocus();
      }
      appendItemsAt() {
          var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          var idx = arguments.length > 1 ? arguments[1] : undefined;
          var addIndex = Number.isInteger(idx) ? idx : this.Items.children.length;
          this.shouldSmooth = false;
          this._lastAppendedIdx = addIndex;
          items.forEach(((item, itemIdx) => {
              this.Items.childList.addAt(_objectSpread(_objectSpread({}, item), {}, {
                  parentFocus: this.hasFocus()
              }), addIndex + itemIdx);
          }));
          if (this.selectedIndex >= this._lastAppendedIdx) {
              this._selectedIndex += items.length;
          }
          this.requestUpdate();
          this._refocus();
      }
      prependItems(items) {
          this.appendItemsAt(items, 0);
      }
      removeItemAt(index) {
          this.shouldSmooth = false;
          this.Items.childList.removeAt(index);
          if (this.selectedIndex > index || this.selectedIndex === this.Items.children.length) {
              this._selectedIndex--;
          }
          this.requestUpdate();
          this._refocus();
      }
      _checkSkipFocus() {
          var initialSelection = this.Items.children[this.selectedIndex];
          if (initialSelection && initialSelection.skipFocus) {
              this.selectNext(false);
          }
      }
      get selected() {
          return this.Items.children[this.selectedIndex];
      }
      get selectedIndex() {
          return this._selectedIndex;
      }
      set selectedIndex(index) {
          this.prevSelected = this.selected;
          if (!this.Items.children.length || !this.Items.children[index] || !this.Items.children[index].skipFocus) {
              if (index !== this._selectedIndex) {
                  this._selectedIndex = index;
              }
              if (this.selected) {
                  this._selectedChange(this.selected, this.prevSelected);
              }
              this._refocus();
          }
      }
      _selectedChange(selected, prevSelected) {
          this._render(selected, prevSelected);
          this.signal("selectedChange", selected, prevSelected);
      }
      _render() {}
      _firstFocusableIndex() {
          if (!this.items.length) return 0;
          var firstItem = this.items.reduce(((acc, item, idx) => {
              if (!item.skipFocus) {
                  acc.push(_objectSpread(_objectSpread({}, item), {}, {
                      originalIdx: idx
                  }));
              }
              return acc;
          }), []).shift();
          return firstItem.originalIdx;
      }
      _lastFocusableIndex() {
          if (!this.items.length) return 0;
          var lastItem = this.items.reduce(((acc, item, idx) => {
              if (!item.skipFocus) {
                  acc.push(_objectSpread(_objectSpread({}, item), {}, {
                      originalIdx: idx
                  }));
              }
              return acc;
          }), []).pop();
          return lastItem.originalIdx;
      }
      selectPrevious() {
          this.shouldSmooth = true;
          var hasFocusable = !!(this.items || []).filter((i => !i.skipFocus)).length;
          if (this.selectedIndex === 0 && !this.wrapSelected || !hasFocusable) {
              return false;
          }
          var previousItemIndex = this.items.map((item => !!item.skipFocus)).lastIndexOf(false, this._selectedIndex - 1);
          if (previousItemIndex > -1) {
              this.selectedIndex = previousItemIndex;
              return true;
          } else if (this.wrapSelected) {
              this.selectedIndex = this._lastFocusableIndex();
              return true;
          }
          return false;
      }
      selectNext(shouldSmoothOverride) {
          if (this._lazyItems && this._lazyItems.length) {
              this._appendLazyItem(this._lazyItems.splice(0, 1)[0]);
          }
          this.shouldSmooth = shouldSmoothOverride !== null && shouldSmoothOverride !== void 0 ? shouldSmoothOverride : true;
          var hasFocusable = !!(this.items || []).filter((i => !i.skipFocus)).length;
          if (this.selectedIndex === this.Items.children.length - 1 && !this.wrapSelected || !hasFocusable) {
              return false;
          }
          var nextIndex = this.items.findIndex(((item, idx) => !item.skipFocus && idx > this._selectedIndex));
          if (nextIndex > -1) {
              this.selectedIndex = nextIndex;
              return true;
          } else if (this.wrapSelected) {
              this.selectedIndex = this._firstFocusableIndex();
              return true;
          }
          return false;
      }
      _getIndexOfItemNear(selected, prev) {
          var prevItem = prev.selected;
          if (!selected || !selected.items || !selected.items.length || !prevItem) {
              return 0;
          }
          var [itemX, itemY] = prevItem.core.getAbsoluteCoords(0, 0);
          var prevMiddle = [ itemX + prevItem.w / 2, itemY + prevItem.h / 2 ];
          var selectedCoordArray = selected.items.map(((item, index) => ({
              index: index,
              distance: !item.skipFocus ? getShortestDistance(prevMiddle, item) : null
          }))).filter((item => null !== item.distance)).sort((function(a, b) {
              return a.distance - b.distance;
          }));
          return selectedCoordArray[0].index;
      }
      _focus() {
          super._focus();
          this.items.forEach((item => item.parentFocus = true));
      }
      _unfocus() {
          super._unfocus();
          this.items.forEach((item => item.parentFocus = false));
      }
      _updateShouldSmooth() {}
      _getFocused() {
          var {selected: selected} = this;
          if (selected) {
              if (selected.focusRef) {
                  return selected.tag(selected.focusRef);
              } else if (selected.cparent) {
                  return selected;
              }
          }
          return this;
      }
      _updateTransitionTarget(element, property, newValue) {
          if (element && element.transition(property) && !element.transition(property).isRunning() && element.transition(property).targetValue !== newValue) {
              element.transition(property).updateTargetValue(newValue);
          }
      }
      get onScreenItems() {
          return this.Items.children.filter((child => this._isOnScreen(child)));
      }
      _isOnScreenCompletely(child) {
          return child.isFullyOnScreen ? child.isFullyOnScreen() : isComponentOnScreen(child);
      }
      get fullyOnScreenItems() {
          return this.Items.children.reduce(((rv, item) => {
              if (item instanceof FocusManager) {
                  return [ ...rv, ...item.Items.children.filter(this._isOnScreenCompletely) ];
              } else if (this._isOnScreenCompletely(item)) {
                  return [ ...rv, item ];
              } else {
                  return rv;
              }
          }), []);
      }
      _isOnScreen() {
          throw new Error("'_isOnScreen' must be implemented by 'row'/'column'");
      }
      _isComponentHorizontallyVisible(child) {
          var x = getX(child);
          if (!Number.isFinite(x)) return false;
          var transitionX = this.getTransitionXTargetValue();
          var px = this.core.renderContext.px;
          var itemX = px + transitionX + x;
          var [leftBounds = null, , clipWidth = null] = this.core._scissor || [];
          var stageW = this.stage.w / this.stage.getRenderPrecision();
          var {w: w} = child;
          var withinLeftStageBounds = itemX >= 0;
          var withinRightStageBounds = itemX + w <= stageW;
          if (!withinLeftStageBounds || !withinRightStageBounds) return false;
          var withinLeftClippingBounds = true;
          var withinRightClippingBounds = true;
          if (Number.isFinite(leftBounds)) {
              withinLeftClippingBounds = Math.round(itemX + w) >= Math.round(leftBounds);
              withinRightClippingBounds = Math.round(itemX) <= Math.round(leftBounds + clipWidth);
          }
          return withinLeftClippingBounds && withinRightClippingBounds;
      }
      _isComponentVerticallyVisible(child) {
          var y = getY(child);
          if (!Number.isFinite(y)) return false;
          var transitionY = this.getTransitionYTargetValue();
          var py = this.core.renderContext.py;
          var [, topBounds = null, , clipHeight = null] = this.core._scissor || [];
          var {h: h} = child;
          var itemY = py + transitionY + y;
          var stageH = this.stage.h / this.stage.getRenderPrecision();
          var withinTopStageBounds = itemY + h >= 0;
          var withingBottomStageBounds = itemY <= stageH;
          if (!withinTopStageBounds || !withingBottomStageBounds) return false;
          var withinTopClippingBounds = true;
          var withinBottomClippingBounds = true;
          if (Number.isFinite(topBounds)) {
              withinTopClippingBounds = Math.round(itemY + h) > Math.round(topBounds);
              withinBottomClippingBounds = Math.round(itemY) < Math.round(topBounds + clipHeight);
          }
          return withinTopClippingBounds && withinBottomClippingBounds;
      }
      getTransitionXTargetValue() {
          return this.Items.transition("x").targetValue;
      }
      getTransitionYTargetValue() {
          return this.Items.transition("y").targetValue;
      }
      static _states() {
          return [ class None extends(this){}, class Row extends(this){
              _handleLeft() {
                  return typeof this.onLeft === "function" ? this.onLeft(this) : this.selectPrevious();
              }
              _handleRight() {
                  return typeof this.onRight === "function" ? this.onRight(this) : this.selectNext();
              }
          }, class Column extends(this){
              _handleUp() {
                  return typeof this.onUp === "function" ? this.onUp(this) : this.selectPrevious();
              }
              _handleDown() {
                  return typeof this.onDown === "function" ? this.onDown(this) : this.selectNext();
              }
          } ];
      }
  }

  var base$N = theme => ({
      alwaysScroll: false,
      itemSpacing: theme.layout.gutterX,
      itemTransition: theme.animation.utility,
      neverScroll: false,
      scrollIndex: 0
  });

  var styles$N = Object.freeze({
      __proto__: null,
      base: base$N
  });

  var directionPropNames = {
      row: {
          axis: "x",
          crossAxis: "y",
          lengthDimension: "w",
          crossDimension: "h",
          innerLengthDimension: "innerW",
          innerCrossDimension: "innerH"
      },
      column: {
          axis: "y",
          crossAxis: "x",
          lengthDimension: "h",
          crossDimension: "w",
          innerLengthDimension: "innerH",
          innerCrossDimension: "innerW"
      }
  };

  class NavigationManager extends FocusManager {
      static get __componentName() {
          return "NavigationManager";
      }
      static get __themeStyle() {
          return styles$N;
      }
      static get properties() {
          return [ ...super.properties, "alwaysScroll", "neverScroll", "scrollIndex", "autoResizeWidth", "autoResizeHeight", "lazyUpCount", "lazyUpCountBuffer", "waitForDimensions" ];
      }
      _construct() {
          super._construct();
          this.shouldSmooth = false;
          this._lazyUpCountBuffer = 2;
      }
      _init() {
          var {lengthDimension: lengthDimension, axis: axis} = this._directionPropNames;
          if (!this[lengthDimension]) {
              this._initComponentSize();
          }
          this.Items.transition(axis).on("finish", this._transitionListener.bind(this));
          super._init();
      }
      _initComponentSize() {
          var {lengthDimension: lengthDimension} = this._directionPropNames;
          if ((this === null || this === void 0 ? void 0 : this.parent.parent) instanceof NavigationManager && this !== null && this !== void 0 && this.parent.parent[lengthDimension]) {
              this[lengthDimension] = this.parent.parent[lengthDimension];
          } else {
              var parent = this.parent;
              while (parent && !parent[lengthDimension]) {
                  parent = parent.parent;
              }
              this[lengthDimension] = parent && parent[lengthDimension] || this.stage.h / this.stage.getRenderPrecision();
          }
      }
      _update() {
          this._updateLayout();
      }
      _updateLayout() {
          var {lengthDimension: lengthDimension, crossDimension: crossDimension, crossAxis: crossAxis, innerCrossDimension: innerCrossDimension} = this._directionPropNames;
          var nextPosition = 0;
          var maxCrossDimensionSize = 0;
          var maxInnerCrossDimensionSize = 0;
          var childrenToCenter = [];
          var loadingChildren = [];
          for (var i = 0; i < this.Items.children.length; i++) {
              var child = this.Items.children[i];
              if (child.requestEarlyUpdate) {
                  var updateDidRun = child.requestEarlyUpdate();
                  if (!updateDidRun && (child.w === 0 || child.h === 0)) {
                      child._updateLayout && child._updateLayout();
                  }
              }
              var childCrossDimensionSize = this._calcCrossDimensionSize(child);
              if (this.waitForDimensions && (!childCrossDimensionSize || !child[lengthDimension])) {
                  loadingChildren.push(child);
              }
              maxCrossDimensionSize = max(maxCrossDimensionSize, childCrossDimensionSize);
              maxInnerCrossDimensionSize = max(maxInnerCrossDimensionSize, child[innerCrossDimension] || 0);
              this.updatePositionOnAxis(child, nextPosition);
              nextPosition += child[lengthDimension];
              if (i < this.Items.children.length - 1) {
                  var extraItemSpacing = child.extraItemSpacing || 0;
                  nextPosition += this.style.itemSpacing + extraItemSpacing;
              }
              if (child.centerInParent) {
                  var _childCrossDimensionSize = child.Items && child.Items[crossDimension] || child[crossDimension];
                  if (_childCrossDimensionSize < this[crossDimension] || !this.Items[innerCrossDimension]) {
                      childrenToCenter.push({
                          childIdx: i,
                          childCrossDimensionSize: _childCrossDimensionSize
                      });
                  }
              } else {
                  child[crossAxis] = 0;
              }
          }
          var itemChanged = this.Items[crossDimension] !== maxCrossDimensionSize || this.Items[lengthDimension] !== nextPosition;
          if (this.waitForDimensions) {
              this.Items.alpha = loadingChildren.length ? .001 : 1;
          }
          this.Items.patch({
              [crossDimension]: maxCrossDimensionSize,
              [innerCrossDimension]: maxInnerCrossDimensionSize || maxCrossDimensionSize,
              [lengthDimension]: nextPosition + (this._totalAddedWidth || 0)
          });
          this._autoResize();
          this._centerItemsInParent(childrenToCenter);
          this._updateLastScrollIndex();
          if (itemChanged) {
              this._performRender();
              this.fireAncestors("$itemChanged");
          }
      }
      _centerItemsInParent(items) {
          var {crossDimension: crossDimension, crossAxis: crossAxis, innerCrossDimension: innerCrossDimension} = this._directionPropNames;
          if (items.length) {
              var sizes = [ this.Items[crossDimension], this.Items[innerCrossDimension] ];
              if (this.children.length === 1) {
                  sizes.push(this[crossDimension]);
              }
              var crossDimensionSize = Math.max(...sizes);
              items.forEach((_ref15 => {
                  var {childIdx: childIdx, childCrossDimensionSize: childCrossDimensionSize} = _ref15;
                  this.Items.children[childIdx][crossAxis] = (crossDimensionSize - childCrossDimensionSize) / 2;
              }));
          }
      }
      _autoResize() {
          if (this.autoResizeWidth) {
              this.w = this.Items.w;
          }
          if (this.autoResizeHeight) {
              this.h = this.Items.h;
          }
      }
      _updateLastScrollIndex() {
          var {axis: axis, lengthDimension: lengthDimension} = this._directionPropNames;
          if (this.alwaysScroll) {
              this._lastScrollIndex = this.Items.children.length - 1;
              return;
          }
          var itemPos = this._isRow ? this.itemPosX : this.itemPosY;
          var scrollOffset = (this.Items.children[this.scrollIndex] || {
              [axis]: 0
          })[axis] + itemPos;
          var lastChild = this.Items.childList.last;
          var endOfLastChild = lastChild ? this._calcAxisPosition(lastChild) + lastChild[lengthDimension] : 0;
          if (endOfLastChild > this[lengthDimension]) {
              var lastScrollIndex;
              for (var i = this.Items.children.length - 1; i >= 0; i--) {
                  var childPosition = this._calcAxisPosition(this.Items.children[i]);
                  var canScrollToChild = childPosition + this[lengthDimension] - scrollOffset > endOfLastChild;
                  if (canScrollToChild) {
                      lastScrollIndex = i;
                  } else {
                      break;
                  }
              }
              this._lastScrollIndex = lastScrollIndex;
              return;
          }
          if (this._lastScrollIndex > this.items.length) {
              this._lastScrollIndex = this.items.length - 1;
          }
      }
      _calcCrossDimensionSize(comp) {
          if (this._isRow) {
              return getH(comp);
          }
          if (this._isColumn) {
              return getW(comp);
          }
      }
      _calcAxisPosition(comp) {
          if (this._isRow) {
              return getX(comp);
          }
          if (this._isColumn) {
              return getY(comp);
          }
      }
      _transitionListener() {
          this.shouldSmooth = false;
          this.transitionDone();
      }
      _withAfterUpdate(element) {
          return watchForUpdates({
              element: element,
              watchProps: [ this._directionPropNames.crossAxis, "w", "h", "innerW", "innerH" ],
              sideEffect: this.queueRequestUpdate.bind(this)
          });
      }
      _performRender() {}
      _appendItem(item, shouldSmoothOverride) {
          this.shouldSmooth = shouldSmoothOverride !== null && shouldSmoothOverride !== void 0 ? shouldSmoothOverride : false;
          item.parentFocus = this.hasFocus();
          item = this.Items.childList.a(item);
          var {crossDimension: crossDimension} = this._directionPropNames;
          if (!item[crossDimension]) {
              var itemCrossSize = this._isRow ? this.renderHeight : this.renderWidth;
              item[crossDimension] = item[crossDimension] || itemCrossSize;
          }
          item = this._withAfterUpdate(item);
          return item;
      }
      _appendLazyItem(item) {
          var {lengthDimension: lengthDimension, axis: axis} = this._directionPropNames;
          var lastChild = this._Items.children[this.items.length - 1];
          var nextPosition = lastChild[lengthDimension] + lastChild[axis] + (lastChild.extraItemSpacing || 0) + this.style.itemSpacing;
          var appended = this._appendItem(item, true);
          appended[axis] = nextPosition;
          this._Items[lengthDimension] += nextPosition + item[lengthDimension];
      }
      $itemChanged() {
          this.queueRequestUpdate();
      }
      appendItems() {
          var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          this.shouldSmooth = false;
          if (this._lazyItems) {
              this._lazyItems.push(...items);
              return;
          }
          if (items.length > this.lazyUpCount + this.lazyUpCountBuffer) {
              this._lazyItems = items.splice(this.lazyUpCount + this.lazyUpCountBuffer);
          }
          items.forEach((item => this._appendItem(item)));
          this.requestUpdate();
          this._refocus();
      }
      appendItemsAt() {
          var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          var idx = arguments.length > 1 ? arguments[1] : undefined;
          if (this._lazyItems && idx > this.items.length - 1) {
              var addAtIdx = idx - this.items.length;
              this._lazyItems.splice(addAtIdx, 0, ...items);
              return;
          }
          var {crossDimension: crossDimension, lengthDimension: lengthDimension, innerLengthDimension: innerLengthDimension} = this._directionPropNames;
          var addIndex = Number.isInteger(idx) ? idx : this.Items.children.length;
          this.shouldSmooth = false;
          this._lastAppendedIdx = addIndex;
          this._totalAddedLength = 0;
          items.forEach(((item, itemIdx) => {
              var newItem = _objectSpread(_objectSpread({}, this._withAfterUpdate(item)), {}, {
                  parentFocus: this.hasFocus()
              });
              if (!item[crossDimension]) {
                  newItem[crossDimension] = item[crossDimension] || this.Items[crossDimension];
              }
              this.Items.childList.addAt(newItem, addIndex + itemIdx);
              var itemLength = item[lengthDimension] || item[innerLengthDimension] || 0;
              var extraItemSpacing = item.extraItemSpacing || 0;
              this._totalAddedLength += itemLength + this.style.itemSpacing + extraItemSpacing;
          }));
          if (this.selectedIndex >= this._lastAppendedIdx) {
              this._selectedPastAdded = true;
              this._selectedIndex += items.length;
          }
          this.requestUpdate();
          this._refocus();
      }
      updatePositionOnAxis(item, position) {
          var {axis: axis} = this._directionPropNames;
          this.applySmooth(item, {
              [axis]: position
          }, {
              [axis]: [ position, this.style.itemTransition ]
          });
          if (!this.shouldSmooth) {
              this._updateTransitionTarget(item, axis, position);
          }
      }
      scrollTo(index) {
          var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.style.itemTransition.duration * 100;
          if (index == undefined) {
              return;
          }
          if (duration === 0) {
              this.selectedIndex = index;
              return;
          }
          for (var i = 0; i !== Math.abs(this.selectedIndex - index); i++) {
              setTimeout((() => {
                  this.selectedIndex > index ? this.selectPrevious() : this.selectNext();
              }), duration * i);
          }
      }
      transitionDone() {}
      shouldScrollLeft() {
          return this._isRow && this._canScrollBack;
      }
      shouldScrollRight() {
          return this._isRow && this._canScrollNext;
      }
      shouldScrollUp() {
          return this._isColumn && this._canScrollBack;
      }
      shouldScrollDown() {
          return this._isColumn && this._canScrollNext;
      }
      get _directionPropNames() {
          return directionPropNames[this.direction];
      }
      get _canScrollBack() {
          var shouldScroll = false;
          if (this._lastScrollIndex) {
              shouldScroll = this.selectedIndex < this._lastScrollIndex;
              if (this._prevLastScrollIndex !== undefined && this._prevLastScrollIndex !== this._lastScrollIndex) {
                  shouldScroll = true;
              }
          } else {
              shouldScroll = this.selectedIndex >= this.scrollIndex;
          }
          var itemsStartCoord = this._isRow ? this._itemsX : this._itemsY;
          return itemsStartCoord < (this._isRow ? this.itemPosX : this.itemPosY) && shouldScroll;
      }
      get _canScrollNext() {
          var {axis: axis, lengthDimension: lengthDimension} = this._directionPropNames;
          var lastChild = this.Items.childList.last;
          var endOfItemsPosition;
          if (this._isRow) {
              endOfItemsPosition = Math.abs(this._itemsX - this.w);
          }
          if (this._isColumn) {
              endOfItemsPosition = Math.abs(this._itemsY - this.h);
          }
          return this.selectedIndex > this.scrollIndex && endOfItemsPosition < lastChild[axis] + lastChild[lengthDimension];
      }
      get _isColumn() {
          return this.direction === "column";
      }
      get _isRow() {
          return this.direction === "row";
      }
      get _itemsX() {
          return getX(this.Items);
      }
      get _itemsY() {
          return getY(this.Items);
      }
      _getAlwaysScroll() {
          return this._alwaysScroll !== undefined ? this._alwaysScroll : this.style.alwaysScroll;
      }
      _getNeverScroll() {
          if (this.alwaysScroll) {
              return false;
          }
          return this._neverScroll !== undefined ? this._neverScroll : this.style.neverScroll;
      }
      _setScrollIndex(index) {
          return index >= 0 ? index : 0;
      }
      _getScrollIndex() {
          return this._scrollIndex !== undefined ? this._scrollIndex : this.style.scrollIndex;
      }
      _setLazyUpCountBuffer(buffer) {
          if (buffer < 0) {
              console.warn("lazyUpCountBuffer must be greater than or equal to 0. Setting to 0.");
              buffer = 0;
          }
          return buffer;
      }
      isFullyOnScreen() {
          var _this$parent;
          var {offsetX: offsetX = 0, offsetY: offsetY = 0} = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
          var focusmanager = (_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : _this$parent.parent;
          if (focusmanager instanceof FocusManager) {
              offsetX += focusmanager.Items.transition("x").targetValue || 0;
              offsetY += focusmanager.Items.transition("y").targetValue || 0;
          }
          return super.isFullyOnScreen({
              offsetX: offsetX,
              offsetY: offsetY
          });
      }
  }

  var base$M = theme => ({
      itemSpacing: theme.layout.gutterX,
      scrollIndex: 0,
      alwaysScroll: false,
      neverScroll: false,
      itemTransition: _objectSpread(_objectSpread({}, theme.animation.standardEntrance), {}, {
          duration: theme.animation.duration.fast
      })
  });

  var styles$M = Object.freeze({
      __proto__: null,
      base: base$M
  });

  class Row extends NavigationManager {
      static get __componentName() {
          return "Row";
      }
      static get __themeStyle() {
          return styles$M;
      }
      static _template() {
          return _objectSpread(_objectSpread({}, super._template()), {}, {
              direction: "row"
          });
      }
      static get properties() {
          return [ ...super.properties, "lazyScroll", "startLazyScrollIndex", "stopLazyScrollIndex" ];
      }
      _isOnScreenForScrolling(child) {
          if (!child) return false;
          var x = getX(child);
          if (!Number.isFinite(x)) return false;
          var itemsTransitionX = this.getTransitionXTargetValue();
          var rowX = this.core.renderContext.px;
          var itemX = rowX + itemsTransitionX + x;
          var xModifier;
          if (child.transition("x")) {
              xModifier = child.x - child.transition("x").targetValue;
              itemX = itemX - xModifier;
          }
          return itemX >= rowX && itemX + child.w <= rowX + this.w;
      }
      _shouldScroll() {
          var prevIndex = this.Items.childList.getIndex(this.prevSelected);
          if (this.alwaysScroll || this.lazyScroll && (this.selectedIndex < this.startLazyScrollIndex || this.selectedIndex > this.stopLazyScrollIndex || prevIndex < this.startLazyScrollIndex && this.selectedIndex === this.startLazyScrollIndex || prevIndex > this.stopLazyScrollIndex && this.selectedIndex === this.stopLazyScrollIndex)) {
              return true;
          }
          var shouldScroll = this._selectedPastAdded;
          if (!shouldScroll && !this.neverScroll) {
              var isCompletelyOnScreen = this._isOnScreenForScrolling(this.selected);
              if (this.lazyScroll) {
                  shouldScroll = !isCompletelyOnScreen;
              } else {
                  var lastChild = this.Items.childList.last;
                  shouldScroll = lastChild && (this.shouldScrollLeft() || this.shouldScrollRight() || !isCompletelyOnScreen);
              }
          }
          return shouldScroll;
      }
      _getPrependedOffset() {
          this._selectedPastAdded = false;
          return this.Items.x - this._totalAddedWidth;
      }
      _getLazyScrollX(prev) {
          var prevIndex = this.Items.childList.getIndex(this.prevSelected);
          if (this._selectedPastAdded) {
              return this._getPrependedOffset();
          }
          if (this.selectedIndex <= this.startLazyScrollIndex) {
              return this._getScrollX();
          } else if (this.selectedIndex >= this.stopLazyScrollIndex && this.selectedIndex < prevIndex) {
              var currItemsX = this.Items.x;
              return currItemsX + (this.prevSelected.w + this.style.itemSpacing + (this.selected.extraItemSpacing || 0));
          } else if (prev && this.selectedIndex > this.stopLazyScrollIndex) {
              var prevX = prev.x;
              return -prevX + this.prevSelected.w + this.style.itemSpacing + (this.selected.extraItemSpacing || 0) + this.itemPosX;
          } else if (prev) {
              var itemsContainerX;
              var _prevIndex = this.Items.childList.getIndex(prev);
              var selectedX = this.selected.x;
              if (_prevIndex === -1) {
                  return;
              }
              if (_prevIndex > this.selectedIndex) {
                  itemsContainerX = -selectedX + this.itemPosX;
              } else if (_prevIndex < this.selectedIndex) {
                  itemsContainerX = this.w - selectedX - this.selected.w;
              }
              return itemsContainerX;
          }
          return this._getScrollX();
      }
      _getScrollX() {
          if (this._selectedPastAdded) {
              return this._getPrependedOffset();
          }
          var itemsContainerX;
          var itemIndex = this.selectedIndex - this.scrollIndex;
          itemIndex = itemIndex < 0 ? 0 : itemIndex;
          if (itemIndex === this._firstFocusableIndex()) {
              itemIndex = 0;
          }
          if (this.Items.children[itemIndex]) {
              itemsContainerX = this.Items.children[itemIndex].transition("x") ? -this.Items.children[itemIndex].transition("x").targetValue + this.itemPosX : -this.Items.children[itemIndex].x + this.itemPosX;
          }
          return itemsContainerX;
      }
      _render(next, prev) {
          if (this.plinko && prev && prev.selected) {
              next.selectedIndex = this._getIndexOfItemNear(next, prev);
          }
          this._prevLastScrollIndex = this._lastScrollIndex;
          var itemsContainerX;
          if (!this.Items.children.length) {
              itemsContainerX = this.itemPosX;
          } else if (this._shouldScroll()) {
              itemsContainerX = this.lazyScroll && prev ? this._getLazyScrollX(prev) : this._getScrollX();
          }
          if (itemsContainerX !== undefined) {
              this.updatePositionOnAxis(this.Items, itemsContainerX);
          }
          this.onScreenEffect(this.onScreenItems);
      }
      _performRender() {
          this._render(this.selected, this.prevSelected);
      }
      _isOnScreen(child) {
          if (!child) return false;
          return this._isComponentHorizontallyVisible(child);
      }
      onScreenEffect() {}
      get _totalAddedWidth() {
          return this._totalAddedLength;
      }
      _getLazyScroll() {
          if (this.alwaysScroll) {
              return false;
          }
          return this._lazyScroll !== undefined ? this._lazyScroll : this.style.lazyScroll;
      }
      _getNeverScroll() {
          if (this.alwaysScroll || this.lazyScroll) {
              return false;
          }
          return this._neverScroll !== undefined ? this._neverScroll : this.style.neverScroll;
      }
  }

  var base$L = theme => ({
      backgroundColor: theme.color.interactiveNeutral,
      radius: theme.radius.md,
      animation: {}
  });

  var tone$m = theme => ({
      inverse: {
          backgroundColor: theme.color.interactiveInverse
      }
  });

  var mode$f = theme => ({
      focused: {
          backgroundColor: theme.color.interactiveNeutralFocus,
          tone: {
              inverse: {
                  backgroundColor: theme.color.interactiveInverseFocus
              }
          }
      },
      disabled: {
          backgroundColor: theme.color.fillNeutralDisabled
      }
  });

  var styles$L = Object.freeze({
      __proto__: null,
      base: base$L,
      mode: mode$f,
      tone: tone$m
  });

  class Surface extends Base$1 {
      static _template() {
          return {
              Background: {}
          };
      }
      static get __componentName() {
          return "Surface";
      }
      static get __themeStyle() {
          return styles$L;
      }
      static get properties() {
          return [];
      }
      static get tags() {
          return [ "Background" ];
      }
      get innerH() {
          return this.h;
      }
      get innerW() {
          return this.w;
      }
      get _radius() {
          return getMaxRoundRadius(this.style.radius, this.w, this.h);
      }
      _update() {
          this._updateLayout();
          this._updateScale();
      }
      _updateLayout() {
          this._Background.patch({
              texture: Lightning.Tools.getRoundRect(this.innerW - 2, this.innerH - 2, this._radius, 0, null, true, this.style.backgroundColor)
          });
      }
      _updateScale() {
          var scale = this._isFocusedMode ? this.getFocusScale(this.w, this.h) : this.getUnfocusScale(this.w, this.h);
          this.applySmooth(this, {
              scale: scale
          }, {
              scale: [ scale, this.style.animation ]
          });
      }
  }

  var base$K = theme => ({
      offsetY: theme.spacer.xxs,
      offsetX: 0,
      textStyle: theme.typography.body1
  });

  var tone$l = theme => ({
      neutral: {
          textStyle: {
              textColor: theme.color.fillNeutral
          }
      },
      inverse: {
          textStyle: {
              textColor: theme.color.fillInverse
          }
      },
      brand: {
          textStyle: {
              textColor: theme.color.fillBrand
          }
      }
  });

  var styles$K = Object.freeze({
      __proto__: null,
      base: base$K,
      tone: tone$l
  });

  var base$J = theme => ({
      textY: 0,
      iconWidth: theme.spacer.xxl + theme.spacer.xs,
      iconHeight: theme.spacer.xxl + theme.spacer.xs,
      contentSpacing: theme.spacer.md,
      marginBottom: 0,
      strikethroughRatio: .08,
      strikethroughColor: theme.color.textNeutral,
      textStyle: _objectSpread({}, theme.typography.body1),
      maxLines: 1,
      justify: "flex-start"
  });

  var styles$J = Object.freeze({
      __proto__: null,
      base: base$J
  });

  var isText = item => typeof item === "string" || !!item.text;

  var isIcon = item => !!item.icon;

  var isBadge = item => !!item.badge;

  class InlineContent extends Base$1 {
      static get properties() {
          return [ "content", "contentProperties", "badgeY", "badgeProperties", "justify", "contentWrap", "customStyleMappings", "maxLines", "maxLinesSuffix" ];
      }
      static get __componentName() {
          return "InlineContent";
      }
      static get __themeStyle() {
          return styles$J;
      }
      static get aliasStyles() {
          return [ {
              prev: "iconH",
              curr: "iconHeight"
          }, {
              prev: "iconW",
              curr: "iconWidth"
          } ];
      }
      _construct() {
          super._construct();
          this._maxLinesSuffix = "..";
      }
      _update() {
          this._updateContent();
          this._waitForComponentLoad();
      }
      _updateContent() {
          this.childList.clear();
          if (this._shouldTruncate) {
              this.alpha = .001;
          }
          if (this._parsedContent && this._parsedContent.length) {
              this.patch({
                  flex: {
                      direction: "row",
                      wrap: !!this.contentWrap,
                      justifyContent: this.justify != undefined ? this.justify : this.style.justify
                  }
              });
              this._parsedContent.forEach(((item, index) => {
                  var isLast = index === this._parsedContent.length - 1;
                  var base = {
                      flexItem: _objectSpread(_objectSpread({}, this.contentProperties), {}, {
                          marginBottom: isLast ? 0 : this._marginBottom,
                          marginRight: isLast ? 0 : this.contentProperties.marginRight || this.style.contentSpacing
                      })
                  };
                  if (isText(item)) {
                      var nextItem = this._parsedContent[index + 1];
                      if (nextItem && isText(nextItem) || this.contentWrap && nextItem && nextItem.newline && this._parsedContent[index + 2] && isText(this._parsedContent[index + 2])) {
                          base.flexItem.marginRight = 0;
                      }
                      this.childList.a(this._createText(base, item));
                  } else if (isIcon(item)) {
                      this.childList.a(this._createIcon(base, item));
                  } else if (isBadge(item)) {
                      this.childList.a(this._createBadge(base, item.badge));
                  } else if (item.newline && this.contentWrap) {
                      this.childList.a({
                          h: 0,
                          w: this.w
                      });
                  }
              }));
          }
      }
      _waitForComponentLoad() {
          if (this.children.length) {
              Promise.all(this.children.map((child => new Promise((resolve => {
                  if (child.h === 0 && child.w === this.w) {
                      resolve();
                  } else {
                      child.on("txLoaded", resolve);
                  }
              }))))).finally((() => this._contentLoaded()));
          } else {
              this.h = 0;
              this._contentLoaded();
          }
      }
      _notifyAncestors() {
          this.fireAncestors("$loadedInlineContent", this);
          this.signal("loadedInlineContent", this.finalW, this.multiLineHeight);
      }
      _contentLoaded() {
          if (this.children.length) {
              setTimeout((() => {
                  this.multiLineHeight = this.finalH;
                  if (this.flex && this.flex._layout && this.flex._layout._lineLayouter && this.flex._layout._lineLayouter._lines) {
                      var totalHeight = 0;
                      this.flex._layout._lineLayouter._lines.forEach((line => {
                          totalHeight += Object.entries(line.items).slice(line.startIndex, line.endIndex + 1).sort(((a, b) => b[1].h - a[1].h))[0][1].h;
                      }));
                      this.multiLineHeight = totalHeight;
                      if (this._shouldTruncate) {
                          this._renderMaxLines();
                      }
                      this._notifyAncestors();
                  } else {
                      this._contentLoaded();
                  }
              }), 10);
          } else {
              this._notifyAncestors();
          }
      }
      _renderMaxLines() {
          var childrenDimensions = this._calcChildrenDimensions();
          this.childList.clear();
          var renderedLastElement = false;
          childrenDimensions.forEach(((child, index) => {
              if (renderedLastElement) {
                  return;
              }
              var nextChild = childrenDimensions[index + 1];
              if (!nextChild) {
                  this.childList.add(child.component);
                  return;
              }
              var isOnLastLine = child.line === this.maxLines;
              var isLastBeforeMaxLines = isOnLastLine && nextChild.line > this.maxLines;
              var canRenderLastWithSuffix = isLastBeforeMaxLines && child.hasSpaceForSuffix;
              var isLastWithSpaceForSuffix = isOnLastLine && child.hasSpaceForSuffix && !nextChild.hasSpaceForSuffix;
              var isLast = !nextChild || canRenderLastWithSuffix || isLastWithSpaceForSuffix;
              if (child.line <= this.maxLines) {
                  if (isLast && index !== childrenDimensions.length - 1) {
                      this.childList.add(this._addSuffix(child));
                      renderedLastElement = true;
                  } else {
                      this.childList.add(child.component);
                  }
              }
          }));
          this.alpha = 1;
      }
      _calcChildrenDimensions() {
          var suffixW = measureTextWidth(_objectSpread(_objectSpread({}, this.style.textStyle), {}, {
              text: this.maxLinesSuffix
          }));
          var contentEndX = 0;
          var line = 1;
          return this.children.reduce(((acc, child) => {
              var component = child;
              var type, content, w;
              var isNewLineElement = child.w == this.w && child.h === 0;
              if (isNewLineElement) {
                  line++;
                  contentEndX = 0;
                  var _data = {
                      type: "linebreak",
                      component: component,
                      content: content,
                      line: line,
                      hasSpaceForSuffix: true
                  };
                  acc.push(_data);
                  return acc;
              }
              if (isText(child)) {
                  type = "text";
                  content = child.text.text;
                  w = child.texture.getRenderWidth();
              } else if (isIcon(child)) {
                  type = "icon";
                  w = child.w;
              } else if (child.constructor.__componentName === "Badge") {
                  type = "badge";
                  w = child.w;
              }
              contentEndX += w;
              contentEndX += child.flexItem.marginRight;
              if (Math.ceil(contentEndX) >= this.w) {
                  line++;
                  contentEndX = w;
              }
              var hasSpaceForSuffix = Math.ceil(contentEndX) + suffixW <= this.w;
              var data = {
                  type: type,
                  component: component,
                  content: content,
                  line: line,
                  hasSpaceForSuffix: hasSpaceForSuffix
              };
              acc.push(data);
              return acc;
          }), []);
      }
      _addSuffix(_ref16) {
          var {type: type, component: component, content: content} = _ref16;
          var negatedRightMargin = component.flexItem.marginRight * -1;
          var suffix;
          if (type === "text") {
              var {fontFace: fontFace, fontSize: fontSize, fontStyle: fontStyle, lineHeight: lineHeight, verticalAlign: verticalAlign} = component.text;
              suffix = this._createText({
                  flexItem: this.contentProperties
              }, {
                  text: "".concat(content.trim()).concat(this.maxLinesSuffix),
                  style: {
                      fontFace: fontFace,
                      fontSize: fontSize,
                      fontStyle: fontStyle,
                      lineHeight: lineHeight,
                      verticalAlign: verticalAlign
                  }
              });
          } else {
              this.childList.add(component);
              suffix = this._createText({
                  flexItem: _objectSpread(_objectSpread({}, this.contentProperties), {}, {
                      marginLeft: negatedRightMargin
                  })
              }, this.maxLinesSuffix);
          }
          return suffix;
      }
      _createIcon(base, iconProps) {
          var y = (this.textHeight > this.style.textStyle.lineHeight ? this.textHeight : this.style.textStyle.lineHeight) - this.style.iconHeight;
          return _objectSpread(_objectSpread({}, base), {}, {
              type: Icon,
              y: y,
              w: this.style.iconWidth,
              h: this.style.iconHeight,
              signals: {
                  itemChanged: "_updateIconPosition"
              }
          }, iconProps);
      }
      _createText(base, text) {
          var textOverrideStyles = typeof text.style === "string" ? this.customStyleMappings[text.style] : text.style;
          var textComponent = _objectSpread(_objectSpread({}, base), {}, {
              y: this.textY !== undefined ? this.textY : this.style.textY,
              h: (textOverrideStyles === null || textOverrideStyles === void 0 ? void 0 : textOverrideStyles.lineHeight) || (textOverrideStyles === null || textOverrideStyles === void 0 ? void 0 : textOverrideStyles.fontSize) || this.textHeight,
              text: _objectSpread(_objectSpread(_objectSpread({}, this.style.textStyle), textOverrideStyles), {}, {
                  text: text.text || text
              })
          });
          if ((textOverrideStyles === null || textOverrideStyles === void 0 ? void 0 : textOverrideStyles.textDecoration) === "line-through") {
              var textWidth = measureTextWidth(_objectSpread(_objectSpread(_objectSpread({}, this.style.textStyle), textOverrideStyles), {}, {
                  text: text.text || text
              }));
              var strikethroughLine = {
                  rect: true,
                  w: textWidth,
                  color: this.style.strikethroughColor || (textOverrideStyles === null || textOverrideStyles === void 0 ? void 0 : textOverrideStyles.textColor) || this.style.textStyle.textColor,
                  h: textComponent.h * this.style.strikethroughRatio,
                  y: textComponent.h / 2,
                  mountY: 1
              };
              return {
                  type: Lightning.Component,
                  w: textWidth + textComponent.flexItem.marginRight,
                  h: textComponent.h,
                  children: [ _objectSpread({}, textComponent), _objectSpread({}, strikethroughLine) ]
              };
          }
          return textComponent;
      }
      _createBadge(base, badge) {
          return _objectSpread(_objectSpread(_objectSpread({}, base), {}, {
              y: this.badgeY || 0
          }, this.badgeProperties), {}, {
              type: Badge,
              title: badge,
              signals: {
                  loadedBadge: "_loadedBadge"
              }
          });
      }
      _updateIconPosition(icon) {
          icon.y = this.style.textStyle.lineHeight - icon.h;
      }
      _loadedBadge(badge) {
          if (this.badgeY === undefined) {
              badge.y = this.style.textStyle.lineHeight - badge.h;
          }
      }
      _formatSpaces(parsedContent) {
          var whitespace = /(.+?\s+)/;
          return flatten((parsedContent || []).reduce(((acc, item) => {
              var parsed = item;
              if (isText(item)) {
                  if (typeof item === "object") {
                      var formattedWords = item.text.split(whitespace).map((word => word && _objectSpread(_objectSpread({}, item), {}, {
                          text: word
                      })));
                      acc.push(...formattedWords);
                      return acc;
                  }
                  parsed = item.split(whitespace);
              }
              acc.push(parsed);
              return acc;
          }), [])).map(((item, index, arr) => {
              if (item === " ") return false;
              if (arr[index + 1] === " ") return item + " ";
              return item;
          })).filter(Boolean);
      }
      _setContent(content) {
          if (content !== this._content) {
              this._content = content;
              var parsedContent = this._content;
              if (content && !Array.isArray(content)) {
                  parsedContent = parseInlineContent(content);
              }
              this._parsedContent = this._formatSpaces(parsedContent);
          }
          return content;
      }
      _setBadgeProperties(badgeProperties) {
          if (typeof badgeProperties === "object") {
              return badgeProperties;
          }
      }
      _getBadgeProperties() {
          return this._badgeProperties || {};
      }
      _setContentProperties(contentProperties) {
          if (typeof contentProperties === "object") {
              return contentProperties;
          }
      }
      _getContentProperties() {
          return this._contentProperties || {};
      }
      _setCustomStyleMappings(customStyleMappings) {
          if (typeof customStyleMappings === "object") {
              return customStyleMappings;
          }
      }
      _getCustomStyleMappings() {
          return this._customStyleMappings || {};
      }
      _setMaxLines(maxLines) {
          return maxLines >= 1 ? Math.floor(maxLines) : 0;
      }
      get textHeight() {
          return this.style.textStyle.lineHeight || this.style.textStyle.fontSize;
      }
      get _marginBottom() {
          if (this.contentProperties.marginBottom !== undefined) {
              return this.contentProperties.marginBottom;
          }
          if (this.style.marginBottom) {
              return this.style.marginBottom;
          }
          return 0;
      }
      get _shouldTruncate() {
          return this.contentWrap && this.maxLines;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce) {
              return this._announce;
          }
          var announce = this._parsedContent && this._parsedContent.reduce(((announce, item) => {
              if (typeof item === "string") {
                  announce += item;
              } else if (item.announce) {
                  announce += item.announce;
              } else if (item.text) {
                  var _item$style;
                  announce += item.text;
                  if (((_item$style = item.style) === null || _item$style === void 0 ? void 0 : _item$style.textDecoration) === "line-through") {
                      announce += "strikethrough";
                  }
              } else if (item.title) {
                  announce += item.title;
              } else if (item.badge) {
                  announce += item.badge;
              }
              return announce + " ";
          }), "");
          return announce ? announce.replace(/\s+(?=\s)|\s$/g, "") : "";
      }
  }

  var base$I = theme => ({
      fadeWidth: 100,
      offset: theme.spacer.xxl,
      shouldSmooth: false,
      textStyle: theme.typography.body1
  });

  var styles$I = Object.freeze({
      __proto__: null,
      base: base$I
  });

  class FadeShader extends Lightning.shaders.WebGLDefaultShader {
      constructor(context) {
          super(context);
          this._margin = {
              left: 0,
              right: 0
          };
      }
      set positionLeft(v) {
          this._positionLeft = v;
      }
      set positionRight(v) {
          this._positionRight = v;
      }
      setupUniforms(operation) {
          super.setupUniforms(operation);
          var owner = operation.shaderOwner;
          if (this._positionLeft === 0) {
              this._positionLeft = .001;
          }
          if (this._positionRight === 0) {
              this._positionRight = .001;
          }
          var renderPrecision = this.ctx.stage.getRenderPrecision();
          this._setUniform("margin", [ this._positionLeft * renderPrecision, this._positionRight * renderPrecision ], this.gl.uniform1fv);
          this._setUniform("resolution", new Float32Array([ owner._w * renderPrecision, owner._h * renderPrecision ]), this.gl.uniform2fv);
      }
  }

  FadeShader.fragmentShaderSource = "\n  #ifdef GL_ES\n  # ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  # else\n  precision lowp float;\n  # endif\n  #endif\n\n  #define PI 3.14159265359\n\n  varying vec2 vTextureCoord;\n  varying vec4 vColor;\n\n  uniform sampler2D uSampler;\n  uniform vec2 resolution;\n  uniform float margin[2];\n\n  void main() {\n      vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n      vec2 halfRes = 0.5 * resolution.xy;\n      vec2 point = vTextureCoord.xy * resolution;\n\n\n      vec2 pos1 = vec2(point.x, point.y);\n      vec2 pos2 = pos1;\n      pos2.x += margin[0];\n\n      vec2 d = pos2 - pos1;\n      float t = dot(pos1, d) / dot(d, d);\n      t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));\n\n      vec2 pos3 = vec2(vTextureCoord.x * resolution.x, vTextureCoord.y);\n      pos3.x -= resolution.x - margin[1];\n      vec2 pos4 = vec2(vTextureCoord.x + margin[1], vTextureCoord.y);\n\n      vec2 d2 = pos4 - pos3;\n      float t2 = dot(pos3, d2) / dot(d2, d2);\n      t2 = smoothstep(0.0, 1.0, clamp(t2, 0.0, 1.0));\n\n      color = mix(vec4(0.0), color, t);\n      color = mix(color, vec4(0.0), t2);\n\n      gl_FragColor = color;\n  }\n";

  class Marquee extends Base$1 {
      static _template() {
          return {
              ContentClipper: {
                  boundsMargin: [],
                  ContentBox: {
                      Content: {},
                      ContentLoopTexture: {}
                  }
              }
          };
      }
      static get __componentName() {
          return "Marquee";
      }
      static get __themeStyle() {
          return styles$I;
      }
      static get tags() {
          return [ "ContentClipper", {
              name: "ContentBox",
              path: "ContentClipper.ContentBox"
          }, {
              name: "Content",
              path: "ContentClipper.ContentBox.Content"
          }, {
              name: "ContentLoopTexture",
              path: "ContentClipper.ContentBox.ContentLoopTexture"
          } ];
      }
      static get properties() {
          return [ "autoStart", "title", "contentTexture", "color", "centerAlign", "delay", "repeat", "overrideLoopX" ];
      }
      static get aliasStyles() {
          return [ {
              prev: "fadeW",
              curr: "fadeWidth"
          } ];
      }
      _construct() {
          super._construct();
          this._scrolling = false;
          this._autoStart = false;
          this._centerAlign = false;
      }
      _init() {
          this._Content.on("txLoaded", this._updateContentTexture.bind(this));
          super._init();
      }
      _updateContentTexture() {
          var restartScrolling = this._restartScrolling;
          this.stopScrolling();
          if (!this._currentTexture.h) {
              this._ContentClipper.h = this._currentTexture.text && this._currentTexture.text.lineHeight ? this._currentTexture.text.lineHeight : this._Content.finalH;
          }
          if (this._shouldClip) {
              this._updateShader();
          } else {
              this._ContentClipper.shader = null;
              this._positionTexture();
          }
          restartScrolling && this.startScrolling();
          this.signal("marqueeContentLoaded");
      }
      _update() {
          this._updateColor();
          this._updateTexture();
          this._updateShader();
          this._restartScrolling && this.startScrolling();
      }
      get _restartScrolling() {
          return this.autoStart || this._scrolling || this._shouldTryScrolling;
      }
      _updateColor() {
          if (this.color) {
              this._Content.smooth = {
                  color: utils$1.getValidColor(this.color)
              };
          }
      }
      get _currentTexture() {
          return this._Content.text || this._Content.texture || {};
      }
      _updateTexture() {
          var content = {
              rtt: true
          };
          if (this.contentTexture) {
              content.texture = this.contentTexture;
          } else if (this.title) {
              content.text = _objectSpread(_objectSpread(_objectSpread({}, this.style.textStyle), this.title), {}, {
                  text: this.textContent
              });
          }
          this.patch({
              ContentClipper: {
                  w: this.w + 14,
                  ContentBox: {
                      Content: content,
                      ContentLoopTexture: {}
                  }
              }
          });
          this.signal("marqueeContentLoaded");
      }
      _updateShader() {
          this._ContentClipper.patch({
              w: this.w > 0 ? this.w + this.style.fadeWidth / 2 : 0,
              shader: {
                  type: FadeShader,
                  positionLeft: 0,
                  positionRight: this.style.fadeWidth
              },
              rtt: true
          });
      }
      _updateAnimation() {
          this._scrollAnimation && this._scrollAnimation.stopNow();
          this._scrollAnimation = this.animation({
              duration: this._loopWidth / 50,
              delay: isNaN(this.delay) ? 1.5 : this.delay,
              repeat: isNaN(this.repeat) ? -1 : this.repeat,
              actions: [ {
                  t: "ContentBox",
                  p: "x",
                  v: {
                      sm: 0,
                      0: {
                          v: 0
                      },
                      .5: {
                          v: -(this._loopWidth + this.style.offset)
                      }
                  }
              }, {
                  t: "ContentClipper",
                  p: "shader.positionLeft",
                  v: {
                      sm: 0,
                      0: {
                          v: 0
                      },
                      .1: {
                          v: this.style.fadeWidth
                      },
                      .4: {
                          v: this.style.fadeWidth
                      },
                      .5: {
                          v: 0
                      }
                  }
              } ]
          });
      }
      _positionTexture() {
          var x = this._shouldCenter() ? (this.w - this._textRenderedW) / 2 : 0;
          if (this.style.shouldSmooth) {
              this._ContentBox.smooth = {
                  x: x
              };
          } else {
              this._ContentBox.x = x;
          }
      }
      startScrolling() {
          this._Content.off("txLoaded", this.startScrolling.bind(this));
          this._shouldTryScrolling = true;
          if (this._textRenderedW === 0) {
              this._Content.on("txLoaded", this.startScrolling.bind(this));
          }
          if (this._shouldClip) {
              this._scrolling = true;
              this._ContentLoopTexture.x = this._loopWidth + this.style.offset;
              this._ContentLoopTexture.texture = this._Content.getTexture();
              this._updateAnimation();
              this._scrollAnimation.start();
          } else {
              this._scrolling = false;
          }
      }
      stopScrolling() {
          this._shouldTryScrolling = false;
          this._scrolling = false;
          if (this._scrollAnimation) {
              this._scrollAnimation.stopNow();
              this._ContentLoopTexture.texture = null;
          }
      }
      get _shouldClip() {
          return this._textRenderedW > this.w - this.style.fadeWidth / 4;
      }
      _shouldCenter() {
          return this._centerAlign || this._Content.text && this._Content.text.textAlign === "center";
      }
      _setAutoStart(autoStart) {
          if (this.autoStart && !autoStart) {
              this._updateContentTexture();
          }
          return autoStart;
      }
      _setCenterAlign(center) {
          this._centerAlign = center;
          this._updateContentTexture();
          return center;
      }
      get textContent() {
          var _ref17, _this$title$text, _this$title;
          return (_ref17 = (_this$title$text = (_this$title = this.title) === null || _this$title === void 0 ? void 0 : _this$title.text) !== null && _this$title$text !== void 0 ? _this$title$text : this.title) !== null && _ref17 !== void 0 ? _ref17 : "";
      }
      get _loopWidth() {
          return this.overrideLoopX || this._textRenderedW;
      }
      get _textRenderedW() {
          return this._Content.renderWidth;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          return this._announce || this.title && this.title.text;
      }
  }

  var lightningTextDefaults = Object.entries(Object.getOwnPropertyDescriptors(Lightning.textures.TextTexture.prototype)).reduce(((acc, _ref18) => {
      var [prop] = _ref18;
      var value = Lightning.textures.TextTexture.prototype[prop];
      if (prop.startsWith("_") || [ "undefined", "function" ].includes(typeof value)) return acc;
      return _objectSpread({
          [prop]: value
      }, acc);
  }), {});

  class TextBox extends Base$1 {
      static _template() {
          return {
              alpha: .001
          };
      }
      static get __componentName() {
          return "TextBox";
      }
      static get __themeStyle() {
          return styles$K;
      }
      static get tags() {
          return [ "InlineContent", "Marquee", "Text" ];
      }
      static get properties() {
          return [ ...InlineContent.properties, "content", "fixed", "marquee", "marqueeProps", "hideOnLoad" ];
      }
      _setDimensions(w, h) {
          var width = w;
          var height = h;
          if (!this._isInlineContent) {
              width = this._Text.texture.getRenderWidth();
              height = this._Text.texture.getRenderHeight();
          }
          var sizeChanged = this.w !== width || this.h !== height;
          if (width && height && sizeChanged) {
              this.h = height;
              if (!this.fixed) {
                  this.w = width;
              }
              if (!this.hideOnLoad && this.alpha < 1) {
                  this.alpha = 1;
              }
              this._notifyAncestors();
          }
      }
      _setContent(content) {
          this._isInlineContent = false;
          if (Array.isArray(content) || utils$1.isMarkupString(content)) {
              this._isInlineContent = true;
          }
          if ("string" !== typeof content && !this._isInlineContent) {
              return "";
          }
          return content;
      }
      get title() {
          return this._content;
      }
      _notifyAncestors() {
          var w = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.w;
          var h = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.h;
          this.fireAncestors("$itemChanged");
          this.signal("textBoxChanged", {
              w: w,
              h: h
          });
      }
      _construct() {
          super._construct();
          this._marqueeContentListenerAttached = false;
          this._marqueeOverrideLoopX = undefined;
          this._resetMarqueePromise();
      }
      _update() {
          if (!this.content) {
              if (this._Text || this._InlineContent) {
                  this.w = this.h = 0;
                  this._notifyAncestors();
                  this._updateMarquee();
                  this.patch({
                      Text: undefined,
                      InlineContent: undefined
                  });
              }
              return;
          }
          this._isInlineContent ? this._updateInlineContent() : this._updateText();
          this._updateMarquee();
      }
      _updateInlineContent() {
          this.patch({
              Text: undefined
          });
          var inlineContentPatch = InlineContent.properties.reduce(((acc, prop) => {
              if (this[prop] != undefined) {
                  acc[prop] = this[prop];
              }
              return acc;
          }), {
              style: _objectSpread(_objectSpread({}, this.style), {}, {
                  textStyle: this._textStyleSet
              })
          });
          if (this._textStyleSet.wordWrapWidth) {
              inlineContentPatch.w = this._textStyleSet.wordWrapWidth;
              inlineContentPatch.rtt = true;
          }
          if (this._textStyleSet.maxLines) {
              inlineContentPatch.maxLines = this._textStyleSet.maxLines;
          }
          if (this._textStyleSet.maxLinesSuffix) {
              inlineContentPatch.maxLinesSuffix = this._textStyleSet.maxLinesSuffix;
          }
          this.patch({
              alpha: 1,
              InlineContent: _objectSpread(_objectSpread({
                  type: InlineContent,
                  w: this.w
              }, inlineContentPatch), {}, {
                  signals: {
                      loadedInlineContent: "_setDimensions"
                  }
              })
          });
      }
      _updateText() {
          this.patch({
              InlineContent: undefined
          });
          if (!this._Text) {
              this.patch({
                  Text: {}
              });
              this._Text.on("txLoaded", this._setDimensions.bind(this));
          }
          var fontStyle = this._textStyleSet;
          if (this._Text) {
              this._Text.patch({
                  y: this.style.offsetY,
                  x: this.style.offsetX,
                  text: _objectSpread(_objectSpread({}, lightningTextDefaults), fontStyle)
              });
          }
      }
      set marqueeOverrideLoopX(v) {
          this._marqueeOverrideLoopX = v;
          if (this._Marquee) this._Marquee.overrideLoopX = this._marqueeOverrideLoopX;
          this._resolveAwaitMarqueeOverrideX();
      }
      get marqueeOverrideLoopX() {
          return this._marqueeOverrideLoopX;
      }
      _resetMarqueePromise() {
          this._awaitMarqueeOverrideX = new Promise(((resolve, reject) => {
              this._resolveAwaitMarqueeOverrideX = resolve;
              this._rejectAwaitMarqueeOverrideX = reject;
          }));
      }
      _loadedMarqueeContent() {
          this.signal("willMarquee", this._Marquee);
      }
      _updateMarquee() {
          if (this._Marquee && !this.marquee) {
              this._toggleMarquee(this._contentTag);
          }
          if (this.marquee) {
              this._resetMarqueePromise();
              var marqueePatch = _objectSpread(_objectSpread({}, this.marqueeProps), {}, {
                  w: this._textStyleSet.wordWrapWidth || this.w,
                  h: this.h,
                  y: this.style.offsetY,
                  x: this.style.offsetX,
                  signals: {
                      marqueeContentLoaded: "_loadedMarqueeContent"
                  }
              });
              if (!this._Marquee) {
                  marqueePatch.type = Marquee;
              }
              if (this._isInlineContent) {
                  this._InlineContent.w = 0;
                  marqueePatch.title = undefined;
                  marqueePatch.contentTexture = this._contentTag.getTexture();
                  marqueePatch.w = this._textStyleSet.wordWrapWidth || this.w;
              } else {
                  marqueePatch.contentTexture = undefined;
                  marqueePatch.title = _objectSpread(_objectSpread({
                      text: this._contentTag.text.text
                  }, this._textStyleSet), {}, {
                      wordWrapWidth: 0,
                      maxLines: 1
                  });
              }
              this.patch({
                  Marquee: marqueePatch
              });
              if (!this._marqueeContentListenerAttached) {
                  this._marqueeContentListenerAttached = true;
              }
              if ("undefined" !== typeof this._marqueeOverrideLoopX) {
                  this._awaitMarqueeOverrideX.then((() => {
                      this._toggleMarquee(this._contentTag);
                  }));
              } else {
                  this._toggleMarquee(this._contentTag);
              }
          }
      }
      _getMarqueeProps() {
          var _this$_marqueeProps;
          return (_this$_marqueeProps = this._marqueeProps) !== null && _this$_marqueeProps !== void 0 ? _this$_marqueeProps : {};
      }
      get _textStyleSet() {
          var fontStyle = _objectSpread(_objectSpread({}, this.theme.typography.body1), null !== this.style.textStyle && "object" === typeof this.style.textStyle && Object.keys(this.style.textStyle) ? this.style.textStyle : this.theme.typography[this.style.textStyle]);
          this.constructor.properties.forEach((prop => {
              if ("fontStyle" !== prop && "undefined" !== typeof this["_".concat(prop)]) {
                  var key = "content" === prop ? "text" : prop;
                  fontStyle[key] = this["_".concat(prop)];
              }
          }));
          if (this.w && !this._isInlineContent && !this.style.textStyle.wordWrapWidth && this.fixed) {
              fontStyle.wordWrapWidth = this.w;
          }
          return fontStyle;
      }
      get _contentTag() {
          return this._isInlineContent ? this._InlineContent : this._Text;
      }
      _toggleMarquee(contentTag) {
          if (this.marquee) {
              if (contentTag) {
                  contentTag.alpha = .001;
              }
              if (this._Marquee) {
                  this._Marquee.alpha = 1;
                  this._Marquee.startScrolling();
              }
          } else {
              if (contentTag) {
                  contentTag.alpha = 1;
              }
              if (this._Marquee) {
                  this._Marquee.alpha = .001;
                  this._Marquee.stopScrolling();
              }
          }
      }
      toggleMarquee() {
          this._toggleMarquee(this._contentTag);
      }
      get announce() {
          return this._announce || (this._isInlineContent && this._InlineContent ? this._InlineContent.announce : this.content);
      }
      set announce(announce) {
          super.announce = announce;
      }
      set smooth(v) {
          contextInstance.warn("warning: value smoothing is known to cause bugs with the TextBox - patch updated values instead.");
          super.smooth = v;
      }
  }

  class Button$1 extends Surface {
      static get __componentName() {
          return "Button";
      }
      static get __themeStyle() {
          return styles$O;
      }
      static get properties() {
          return [ "fixed", "justify", "prefix", "suffix", "title" ];
      }
      static get aliasStyles() {
          return [ {
              prev: "titlePadding",
              curr: "contentSpacing"
          } ];
      }
      static get tags() {
          return [ ...super.tags, "Content", {
              name: "TextWrapper",
              path: "Content.TextWrapper"
          }, {
              name: "Title",
              path: "Content.TextWrapper.Title"
          }, {
              name: "Prefix",
              path: "Content.Prefix"
          }, {
              name: "Suffix",
              path: "Content.Suffix"
          } ];
      }
      static _template() {
          return _objectSpread(_objectSpread({}, super._template()), {}, {
              Content: {
                  mount: .5,
                  x: w => w / 2,
                  y: h => h / 2,
                  zIndex: 2
              }
          });
      }
      _update() {
          this._updatePrefix();
          this._updateTitle();
          this._updateSuffix();
          this._updateAllPositioning();
          this._updateTruncation();
      }
      _updateAllPositioning() {
          this._updatePositions();
          this._updateContentDimensions();
          this._updateSurfaceDimensions();
          this._updateContentPosition();
          super._update();
      }
      $itemChanged() {
          this._updateAllPositioning();
          this._updateTruncation();
      }
      _onTitleTextBoxChanged() {
          this._updateAllPositioning();
      }
      _updatePositions() {
          if (this._hasPrefix && this._Prefix !== undefined) {
              this._Prefix.x = this._prefixX;
          }
          if (this._hasTitle) {
              this._TextWrapper.x = this._titleX;
          }
          if (this._hasSuffix && this._Suffix !== undefined) {
              this._Suffix.x = this._suffixX;
          }
      }
      _updatePrefix() {
          var prefixString = JSON.stringify(this.prefix);
          if (this.prefix) {
              var prefixPatch = {
                  style: {
                      itemSpacing: this.style.itemSpacing
                  }
              };
              if (!this._Prefix) {
                  prefixPatch = _objectSpread(_objectSpread({}, this._rowProps), prefixPatch);
              }
              this._Content.patch({
                  Prefix: prefixPatch
              });
              this._updatePrefixSuffixStyles("prefix");
          } else {
              this._Content.patch({
                  Prefix: undefined
              });
          }
          this._prevPrefix = prefixString;
      }
      _updatePrefixSuffixStyles() {
          var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "prefix";
          var map = {
              prefix: {
                  tag: this._Prefix,
                  prop: this.prefix,
                  prevProp: this._prevPrefix
              },
              suffix: {
                  tag: this._Suffix,
                  prop: this.suffix,
                  prevProp: this._prevSuffix
              }
          };
          var {tag: tag, prop: prop} = map[type];
          var {prevProp: prevProp} = map[type];
          var propString = JSON.stringify(prop);
          if (propString !== prevProp) {
              prevProp = propString;
              tag.items = this._addButtonProps(prop);
          } else {
              tag.Items.children.forEach(((item, idx) => {
                  item.color = Array.isArray(prop) ? prop[idx].color : prop.color;
                  item.style = _objectSpread(_objectSpread({}, item.style), {}, {
                      color: this.style.contentColor
                  });
              }));
          }
      }
      _updateTitle() {
          if (this._hasTitle) {
              var titlePatch = {
                  content: this.title,
                  style: {
                      textStyle: this.style.textStyle
                  }
              };
              if (!this._Title) {
                  titlePatch = _objectSpread({
                      type: TextBox,
                      mountY: .5,
                      y: h => h / 2,
                      signals: {
                          textBoxChanged: "_onTitleTextBoxChanged"
                      }
                  }, titlePatch);
              }
              this._Content.patch({
                  TextWrapper: {
                      mountY: .5,
                      Title: titlePatch
                  }
              });
          } else {
              this._Content.patch({
                  TextWrapper: {
                      Title: undefined
                  }
              });
          }
      }
      _updateSuffix() {
          if (this.suffix) {
              var suffixPatch = {
                  style: {
                      itemSpacing: this.style.itemSpacing
                  }
              };
              if (!this._Suffix) {
                  suffixPatch = _objectSpread(_objectSpread({}, this._rowProps), suffixPatch);
              }
              this._Content.patch({
                  Suffix: suffixPatch
              });
              this._updatePrefixSuffixStyles("suffix");
          } else {
              this._Content.patch({
                  Suffix: undefined
              });
          }
      }
      _updateTruncation() {
          if (this._Title) {
              this._Title.patch({
                  style: {
                      textStyle: _objectSpread(_objectSpread({}, this.style.textStyle), {}, {
                          wordWrap: this.fixed,
                          wordWrapWidth: this.fixed ? this._fixedWordWrapWidth : 0
                      })
                  }
              });
          }
      }
      _updateContentDimensions() {
          var contentDimensionsPatch = {};
          var y = this.h / 2;
          if (this._Content.transition("w").targetValue !== this._contentW) {
              this._Content.w = this._contentW;
          }
          if (this._Content.y !== y) {
              contentDimensionsPatch.y = y;
          }
          if (Object.keys(contentDimensionsPatch).length > 0) {
              this._Content.patch(contentDimensionsPatch);
          }
      }
      _updateContentPosition() {
          this._Content.patch(this._contentProps);
      }
      _updateSurfaceDimensions() {
          var newWidth = this.w;
          if (this.fixed) {
              newWidth = this._w;
          } else {
              newWidth = this._calcDynamicWidth();
          }
          if (newWidth !== this.w) {
              this.w = newWidth;
          }
          if (!this._hSetByUser && !this.style.h) {
              this._h = this.style.textStyle.lineHeight + this.style.paddingY * 2;
          }
          this.fireAncestors("$itemChanged");
      }
      _calcDynamicWidth() {
          return !this._hasTitle && (this._hasPrefix || this._hasSuffix) || this._Title && !this._Title.visible && (this._hasPrefix || this._hasSuffix) ? this._contentW + this._paddingX : Math.max(this._contentW + this._paddingX, this.style.minWidth);
      }
      _addButtonProps(arr) {
          var items = Array.isArray(arr) ? arr : [ arr ];
          return items.map((item => _objectSpread(_objectSpread(_objectSpread({}, this._buttonProps), item), {}, {
              style: _objectSpread({
                  color: this.style.contentColor
              }, item.style)
          })));
      }
      _getJustify() {
          return !!this._justify ? this._justify : this.style.justify;
      }
      get _contentProps() {
          var mountX;
          var x;
          switch (this.justify) {
            case "left":
              mountX = 0;
              x = this._paddingLeft;
              break;

            case "right":
              mountX = 1;
              x = this.w - this._paddingRight;
              break;

            case "center":
            default:
              mountX = .5;
              x = this.w / 2;
              break;
          }
          return {
              mountX: mountX,
              x: x
          };
      }
      get _buttonProps() {
          return {
              centerInParent: true,
              mode: this.mode
          };
      }
      get _hasPrefix() {
          return !!(this.prefix && Object.keys(this.prefix).length);
      }
      get _prefixW() {
          return this._hasPrefix && this._Prefix !== undefined ? this._Prefix.w : 0;
      }
      get _prefixX() {
          return 0;
      }
      get _hasTitle() {
          return !!this.title;
      }
      get _titleW() {
          if (this._hasTitle && this._Title && this._Title._Text && this._Title.visible) {
              return this._Title.w;
          }
          return 0;
      }
      get _titleX() {
          return this._hasPrefix ? this._prefixW + this.style.contentSpacing : 0;
      }
      get _hasSuffix() {
          return !!(this.suffix && Object.keys(this.suffix).length);
      }
      get _suffixW() {
          return this._hasSuffix && this._Suffix !== undefined ? this._Suffix.w : 0;
      }
      get _suffixX() {
          if (this._hasTitle) {
              return this._titleW + this._TextWrapper.x + this.style.contentSpacing;
          } else if (this._hasPrefix) {
              return this._prefixW + this.style.itemSpacing;
          }
          return 0;
      }
      get _contentW() {
          if (this._hasSuffix) {
              return this._suffixX + this._suffixW;
          } else if (this._hasTitle && this._Title && this._Title.visible) {
              return this._titleX + this._titleW;
          } else if (this._hasPrefix) {
              return this._prefixX + this._prefixW;
          }
          return 0;
      }
      get _rowProps() {
          return {
              type: Row,
              mountY: .5,
              autoResizeHeight: true,
              autoResizeWidth: true
          };
      }
      get _totalTitlePaddingX() {
          var totalTitlePadding = 0;
          if (this._hasPrefix) {
              totalTitlePadding += this.style.contentSpacing;
          }
          if (this._hasSuffix) {
              totalTitlePadding += this.style.contentSpacing;
          }
          return totalTitlePadding;
      }
      get _fixedWordWrapWidth() {
          var {w: w, _paddingX: _paddingX, _prefixW: _prefixW, _suffixW: _suffixW, _totalTitlePaddingX: _totalTitlePaddingX} = this;
          var nonTextSpace = _paddingX + _prefixW + _suffixW + _totalTitlePaddingX;
          return Math.max(1, w - nonTextSpace);
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce) {
              return this._announce;
          }
          var announce = [];
          if (this.title) {
              announce.push(this.title);
          }
          announce.push(this._announceComponentName);
          if (this._hasPrefix && this._Prefix.items.length) {
              announce.push(...this._Prefix.items.map((item => item.announce)));
          }
          if (this._hasSuffix && this._Suffix.items.length) {
              announce.push(...this._Suffix.items.map((item => item.announce)));
          }
          return announce;
      }
      get _announceComponentName() {
          return Button$1.__componentName;
      }
      get _paddingX() {
          return this._paddingLeft + this._paddingRight;
      }
      get _paddingLeft() {
          return this._hasTitle ? this.style.paddingX : this.style.paddingXNoTitle;
      }
      get _paddingRight() {
          return this._hasTitle ? this.style.paddingX : this.style.paddingXNoTitle;
      }
  }

  var base$H = theme => ({
      minWidth: getWidthByColumnSpan(theme, 1),
      paddingX: theme.spacer.xxl,
      paddingXNoTitle: theme.spacer.lg,
      paddingY: theme.spacer.lg,
      textStyle: theme.typography.button2
  });

  Object.freeze({
      __proto__: null,
      base: base$H
  });

  var base$G = theme => ({
      height: theme.spacer.xxl * 12,
      paddingHorizontal: theme.spacer.xl,
      paddingVertical: theme.spacer.xl,
      radius: theme.radius.md,
      titleTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline1), {}, {
          wordWrap: true,
          maxLines: 2,
          textColor: theme.color.textNeutral
      }),
      width: utils$1.getWidthByUpCount(theme, 6)
  });

  var mode$e = theme => ({
      focused: {
          tone: {
              neutral: {
                  backgroundColor: theme.color.interactiveNeutralFocusSoft
              },
              inverse: {
                  backgroundColor: theme.color.interactiveInverseFocusSoft
              },
              brand: {
                  backgroundColor: theme.color.interactiveBrandFocusSoft
              }
          }
      },
      disabled: {
          titleTextStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$G,
      mode: mode$e
  });

  var base$F = theme => ({
      titleTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline3), {}, {
          wordWrap: true,
          maxLines: 2,
          textColor: theme.color.textNeutral
      }),
      descriptionTextStyle: _objectSpread(_objectSpread({}, theme.typography.body2), {}, {
          textColor: theme.color.textNeutral,
          wordWrap: true,
          maxLines: 3
      }),
      detailsTextStyle: _objectSpread(_objectSpread({}, theme.typography.body3), {}, {
          textColor: theme.color.textNeutral,
          wordWrap: true,
          maxLines: 1
      })
  });

  var mode$d = theme => ({
      disabled: {
          descriptionTextStyle: {
              textColor: theme.color.textNeutralDisabled
          },
          detailsTextStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$F,
      mode: mode$d
  });

  var base$E = theme => ({
      descriptionTextStyle: _objectSpread(_objectSpread({}, theme.typography.body2), {}, {
          textColor: theme.color.textNeutralSecondary,
          wordWrap: true,
          maxLines: 8
      }),
      height: theme.spacer.xxxl * 15,
      subtitleTextStyle: _objectSpread(_objectSpread({}, theme.typography.body3), {}, {
          maxLines: 2,
          textColor: theme.color.textNeutral,
          wordWrap: true
      }),
      width: utils$1.getWidthByColumnSpan(theme, 4)
  });

  var mode$c = theme => ({
      disabled: {
          descriptionTextStyle: {
              textColor: theme.color.textNeutralDisabled
          },
          subtitleTextStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$E,
      mode: mode$c
  });

  var base$D = theme => {
      var size = theme.spacer.xxl;
      return {
          alpha: theme.alpha.primary,
          width: size,
          height: size,
          knobHeight: size / 2,
          knobWidth: size / 2,
          radius: size / 2,
          strokeWidth: theme.stroke.sm
      };
  };

  var tone$k = theme => ({
      neutral: {
          backgroundColor: theme.color.fillInverseSecondary,
          backgroundColorChecked: theme.color.fillNeutral,
          knobColor: theme.color.fillInverse,
          strokeColor: theme.color.strokeNeutralSecondary
      },
      inverse: {
          backgroundColor: theme.color.fillNeutralSecondary,
          backgroundColorChecked: theme.color.fillInverse,
          knobColor: theme.color.fillNeutral,
          strokeColor: theme.color.strokeInverseSecondary
      },
      brand: {
          backgroundColor: theme.color.fillNeutralSecondary,
          backgroundColorChecked: theme.color.fillBrand,
          knobColor: theme.color.fillInverse,
          strokeColor: theme.color.strokeNeutralSecondary
      }
  });

  var mode$b = theme => ({
      disabled: {
          alpha: theme.alpha.inactive
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$D,
      mode: mode$b,
      tone: tone$k
  });

  var base$C = theme => {
      var size = theme.spacer.xl;
      return {
          width: size,
          height: size,
          knobHeight: size / 2,
          knobWidth: size / 2,
          radius: size / 2
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$C
  });

  var base$B = theme => ({
      height: theme.spacer.xxl * 5,
      iconWidth: theme.spacer.xxl,
      iconHeight: theme.spacer.xxl,
      width: utils$1.getWidthByColumnSpan(theme, 3)
  });

  Object.freeze({
      __proto__: null,
      base: base$B
  });

  var base$A = theme => {
      var strokeWidth = theme.stroke.sm;
      var size = theme.spacer.xxl;
      return {
          alpha: theme.alpha.primary,
          width: size,
          height: size,
          iconWidth: theme.spacer.lg,
          iconHeight: theme.spacer.lg,
          icon: theme.asset.check,
          radius: theme.radius.xs,
          strokeWidth: strokeWidth
      };
  };

  var tone$j = theme => ({
      neutral: {
          strokeColor: theme.color.strokeNeutralSecondary,
          checkColor: theme.color.fillInverse,
          backgroundColor: theme.color.fillInverseSecondary,
          backgroundColorChecked: theme.color.fillNeutral
      },
      inverse: {
          strokeColor: theme.color.strokeInverseSecondary,
          checkColor: theme.color.fillNeutral,
          backgroundColor: theme.color.fillNeutralSecondary,
          backgroundColorChecked: theme.color.fillInverse
      },
      brand: {
          strokeColor: theme.color.strokeNeutralSecondary,
          checkColor: theme.color.fillInverse,
          backgroundColor: theme.color.fillNeutralSecondary,
          backgroundColorChecked: theme.color.fillBrand
      }
  });

  var mode$a = theme => ({
      disabled: {
          alpha: theme.alpha.inactive
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$A,
      mode: mode$a,
      tone: tone$j
  });

  var base$z = theme => ({
      radius: [ theme.radius.md, theme.radius.md, theme.radius.md, theme.radius.none ],
      paddingX: theme.spacer.lg,
      paddingY: theme.spacer.md,
      offsetY: theme.spacer.xxs,
      textStyle: theme.typography.caption1
  });

  var tone$i = theme => ({
      neutral: {
          textStyle: {
              textColor: theme.color.textInverse
          },
          backgroundColor: theme.color.fillNeutral
      },
      inverse: {
          textStyle: {
              textColor: theme.color.textNeutral
          },
          backgroundColor: theme.color.fillInverse
      },
      brand: {
          textStyle: {
              textColor: theme.color.textNeutral
          },
          backgroundColor: theme.color.fillBrand
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$z,
      tone: tone$i
  });

  var base$y = theme => ({
      descriptionTextStyle: _objectSpread(_objectSpread({}, theme.typography.body2), {}, {
          maxLines: 1
      }),
      fadeWidth: 100,
      logoWidth: theme.typography.body3.lineHeight,
      logoHeight: theme.typography.body3.lineHeight,
      logoPadding: theme.spacer.lg,
      detailsTextStyle: theme.typography.body3,
      subtitleTextStyle: theme.typography.body3,
      titleTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline1), {}, {
          maxLines: 1
      }),
      marqueeSync: true,
      alpha: theme.alpha.primary
  });

  var mode$9 = theme => ({
      disabled: {
          detailsTextStyle: {
              textColor: theme.color.textNeutralDisabled
          },
          alpha: theme.alpha.inactive
      }
  });

  var tone$h = theme => ({
      neutral: {
          titleTextStyle: {
              textColor: theme.color.textNeutral
          },
          subtitleTextStyle: {
              textColor: theme.color.textNeutralSecondary
          },
          detailsTextStyle: {
              textColor: theme.color.textNeutral
          },
          descriptionTextStyle: {
              textColor: theme.color.textNeutralSecondary
          },
          mode: {
              disabled: {
                  titleTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      },
      inverse: {
          titleTextStyle: {
              textColor: theme.color.textInverse
          },
          subtitleTextStyle: {
              textColor: theme.color.textInverseSecondary
          },
          detailsTextStyle: {
              textColor: theme.color.textInverse
          },
          descriptionTextStyle: {
              textColor: theme.color.textInverseSecondary
          },
          mode: {
              disabled: {
                  titleTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  subtitleTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      },
      brand: {
          titleTextStyle: {
              textColor: theme.color.textNeutral
          },
          subtitleTextStyle: {
              textColor: theme.color.textNeutralSecondary
          },
          detailsTextStyle: {
              textColor: theme.color.textNeutral
          },
          descriptionTextStyle: {
              textColor: theme.color.textNeutralSecondary
          },
          mode: {
              disabled: {
                  titleTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$y,
      mode: mode$9,
      tone: tone$h
  });

  var base$x = theme => ({
      titleTextStyle: theme.typography.headline3,
      descriptionTextStyle: theme.typography.body3
  });

  var tone$g = theme => ({
      neutral: {
          detailsTextStyle: {
              textColor: theme.color.textNeutralSecondary
          },
          descriptionTextStyle: {
              textColor: theme.color.textNeutral
          },
          mode: {
              disabled: {
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      },
      inverse: {
          detailsTextStyle: {
              textColor: theme.color.textInverseSecondary
          },
          descriptionTextStyle: {
              textColor: theme.color.textInverse
          },
          mode: {
              disabled: {
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      },
      brand: {
          detailsTextStyle: {
              textColor: theme.color.textNeutralSecondary
          },
          descriptionTextStyle: {
              textColor: theme.color.textNeutral
          },
          mode: {
              disabled: {
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  },
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$x,
      tone: tone$g
  });

  var base$w = theme => ({
      height: theme.spacer.md,
      animation: theme.animation.utility,
      radius: theme.radius.xs
  });

  var tone$f = theme => ({
      neutral: {
          barColor: theme.color.fillNeutralTertiary,
          progressColor: theme.color.fillNeutral
      },
      inverse: {
          barColor: theme.color.fillInverseTertiary,
          progressColor: theme.color.fillInverse
      },
      brand: {
          barColor: theme.color.fillNeutralTertiary,
          progressColor: theme.color.fillBrand
      }
  });

  var styles$w = Object.freeze({
      __proto__: null,
      base: base$w,
      tone: tone$f
  });

  class ProgressBar$2 extends Base$1 {
      static _template() {
          return {
              Bar: {
                  zIndex: 1
              },
              Progress: {
                  alpha: 0,
                  zIndex: 2
              }
          };
      }
      static get __themeStyle() {
          return styles$w;
      }
      static get __componentName() {
          return "ProgressBar";
      }
      static get properties() {
          return [ "progress" ];
      }
      static get tags() {
          return [ "Bar", "Progress" ];
      }
      _construct() {
          super._construct && super._construct();
          this._progress = 0;
      }
      _update() {
          this._updateTextures();
          this._updateProgress();
          if (this._progressChanged) {
              this.fireAncestors("$announce", this.announce);
              this._progressChanged = false;
          }
      }
      _updateTextures() {
          var w = this._getProgressWidth();
          var radius = getMaxRoundRadius(this.style.radius, this.w - 2, this.h);
          this._Bar.texture = Lightning.Tools.getRoundRect(this.w - 2, this.h, radius, 0, 0, true, this.style.barColor);
          this._Progress.texture = Lightning.Tools.getRoundRect(w + 1, this.h, radius, 0, 0, true, this.style.progressColor);
      }
      _updateProgress() {
          var w = this._getProgressWidth();
          this._Progress.smooth = {
              w: [ w, this.style.animation ],
              alpha: Number(w > 0)
          };
      }
      _setProgress(progress) {
          this._progressChanged = progress !== this._progress;
          return progress;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce !== undefined && this._announce !== null) {
              return this._announce;
          }
          var progress = this.progress;
          if (progress > 1) {
              progress = 1;
          } else if (progress < 0) {
              progress = 0;
          }
          return "".concat(Math.round(progress * 100), "%");
      }
      _getProgressWidth() {
          var p = this.w * this._progress;
          var w = p <= 0 ? 0 : Math.min(p, this.w);
          return w;
      }
  }

  var base$v = theme => ({
      animationEntrance: theme.animation.standardEntrance,
      animationExit: theme.animation.standardExit,
      logoWidth: theme.spacer.lg * 5,
      logoHeight: theme.spacer.xxl + theme.spacer.md,
      metadataLocation: "standard",
      paddingX: theme.spacer.xl,
      paddingY: theme.spacer.lg,
      paddingYProgress: theme.spacer.xl,
      paddingYBetweenContent: theme.spacer.md,
      radius: theme.radius.md,
      alpha: theme.alpha.primary
  });

  var tone$e = theme => ({
      neutral: {
          mode: {
              focused: {
                  backgroundColor: theme.color.interactiveNeutralFocusSoft
              }
          }
      },
      inverse: {
          mode: {
              focused: {
                  backgroundColor: theme.color.interactiveInverseFocusSoft
              }
          }
      },
      brand: {
          mode: {
              focused: {
                  backgroundColor: theme.color.interactiveBrandFocusSoft
              }
          }
      }
  });

  var mode$8 = theme => ({
      disabled: {
          alpha: theme.alpha.inactive
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$v,
      mode: mode$8,
      tone: tone$e
  });

  function base$u(theme) {
      return {
          alpha: theme.alpha.primary,
          counterTextStyle: theme.typography.headline3,
          itemSize: theme.layout.gutterX * 2,
          itemSpacing: theme.spacer.md,
          radius: theme.radius.sm
      };
  }

  var mode$7 = theme => ({
      disabled: {
          alpha: theme.alpha.inactive
      }
  });

  var tone$d = theme => ({
      neutral: {
          counterBackgroundColor: theme.color.fillInverseSecondary
      },
      inverse: {
          counterBackgroundColor: theme.color.fillNeutralSecondary
      },
      brand: {
          counterBackgroundColor: theme.color.fillInverseSecondary
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$u,
      mode: mode$7,
      tone: tone$d
  });

  var base$t = theme => ({
      detailsTextStyle: theme.typography.body3,
      descriptionTextStyle: {
          maxLines: 3
      },
      descriptionDetailsStyle: {
          paddingY: 5
      },
      fadeWidth: theme.spacer.md * theme.spacer.md,
      provider: {
          itemSize: theme.spacer.xxxl + theme.spacer.md
      }
  });

  var tone$c = theme => ({
      neutral: {
          detailsTextStyle: {
              textColor: theme.color.textNeutral
          },
          mode: {
              disabled: {
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      },
      inverse: {
          detailsTextStyle: {
              textColor: theme.color.textInverse
          },
          mode: {
              disabled: {
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      },
      brand: {
          detailsTextStyle: {
              textColor: theme.color.textNeutral
          },
          mode: {
              disabled: {
                  detailsTextStyle: {
                      textColor: theme.color.textNeutralDisabled
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$t,
      tone: tone$c
  });

  var base$s = theme => ({
      expandedWidth: utils$1.getWidthByUpCount(theme, 2),
      expandedHeight: utils$1.getDimensions(theme, {
          ratioX: 16,
          ratioY: 9,
          upCount: 4
      }).h,
      imageSize: {
          width: utils$1.getDimensions(theme, {
              ratioX: 16,
              ratioY: 9,
              upCount: 4
          }).w,
          height: utils$1.getDimensions(theme, {
              ratioX: 16,
              ratioY: 9,
              upCount: 4
          }).h
      },
      metadata: {
          descriptionTextStyle: {
              maxLines: 2
          }
      },
      paddingVertical: theme.spacer.md * 1.5
  });

  Object.freeze({
      __proto__: null,
      base: base$s
  });

  var base$r = theme => {
      var {w: w, h: h} = utils$1.getDimensions(theme, {
          ratioX: 16,
          ratioY: 9,
          upCount: 3
      });
      return {
          expandedWidth: utils$1.getWidthByColumnSpan(theme, 8),
          expandedHeight: h,
          imageSize: {
              width: w,
              height: h
          },
          metadata: {
              descriptionTextStyle: {
                  maxLines: 3
              }
          }
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$r
  });

  var base$q = theme => ({
      expandedWidth: utils$1.getWidthByUpCount(theme, 4),
      expandedHeight: utils$1.getDimensions(theme, {
          ratioX: 16,
          ratioY: 9,
          upCount: 4
      }).h + theme.spacer.xxxl * 7 + theme.spacer.lg + theme.spacer.xxs,
      metadata: {
          descriptionTextStyle: {
              maxLines: 3
          }
      },
      marqueeOnFocus: true
  });

  Object.freeze({
      __proto__: null,
      base: base$q
  });

  var base$p = theme => ({
      expandedHeight: utils$1.getDimensions(theme, {
          ratioX: 16,
          ratioY: 9,
          upCount: 4
      }).h + theme.spacer.md * 14,
      metadata: {
          descriptionTextStyle: {
              maxLines: 1
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$p
  });

  var base$o = theme => {
      var strokeWidth = theme.stroke.sm;
      var size = theme.spacer.xl;
      return {
          width: size,
          height: size,
          iconWidth: theme.spacer.md,
          iconHeight: theme.spacer.md,
          radius: theme.radius.xs,
          strokeWidth: strokeWidth
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$o
  });

  var base$n = theme => ({
      itemSpacing: theme.layout.gutterY,
      scrollIndex: 0,
      itemTransition: _objectSpread(_objectSpread({}, theme.animation.standardEntrance), {}, {
          duration: theme.animation.duration.fast
      })
  });

  var styles$n = Object.freeze({
      __proto__: null,
      base: base$n
  });

  class Column extends NavigationManager {
      static get __componentName() {
          return "Column";
      }
      static get __themeStyle() {
          return styles$n;
      }
      static _template() {
          return _objectSpread(_objectSpread({}, super._template()), {}, {
              direction: "column"
          });
      }
      _isOnScreenForScrolling(child) {
          if (!child) return false;
          var y = getY(child);
          if (!Number.isFinite(y)) return false;
          var itemsTransitionY = this.getTransitionYTargetValue();
          var columnY = this.core.renderContext.py;
          var itemY = columnY + itemsTransitionY + y;
          var yModifier;
          if (child.transition("y")) {
              yModifier = child.y - child.transition("y").targetValue;
              itemY = itemY - yModifier;
          }
          return itemY >= columnY && itemY + child.h <= columnY + this.h;
      }
      _shouldScroll() {
          if (this.alwaysScroll) {
              return true;
          }
          var shouldScroll = false;
          if (!this.neverScroll) {
              var isCompletelyOnScreen = this._isOnScreenForScrolling(this.selected);
              var lastChild = this.Items.childList.last;
              shouldScroll = lastChild && (this.shouldScrollUp() || this.shouldScrollDown() || !isCompletelyOnScreen);
          }
          if (this.selectedIndex < this.scrollIndex) {
              shouldScroll = false;
          }
          return shouldScroll;
      }
      _getScrollY() {
          var itemsContainerY;
          var itemIndex = this.selectedIndex - this.scrollIndex;
          itemIndex = itemIndex < 0 ? 0 : itemIndex;
          if (itemIndex === this._firstFocusableIndex()) {
              itemIndex = 0;
          }
          if (this.Items.children[itemIndex]) {
              itemsContainerY = this.Items.children[itemIndex].transition("y") ? -this.Items.children[itemIndex].transition("y").targetValue + this.itemPosY : -this.Items.children[itemIndex].y + this.itemPosY;
          }
          return itemsContainerY;
      }
      _render(next, prev) {
          this._prevLastScrollIndex = this._lastScrollIndex;
          if (this.plinko && prev && prev.selected && !(this.items.indexOf(prev) === 0 && prev.skipPlinko)) {
              var prevPlinko = this.checkSkipPlinko(prev, next);
              next.selectedIndex = this._getIndexOfItemNear(next, prevPlinko || prev);
          } else if (next && !next.selectedIndex) {
              next.selectedIndex = 0;
          }
          var itemsContainerY;
          if (!this.Items.children.length) {
              itemsContainerY = this.itemPosY;
          } else if (this._shouldScroll()) {
              itemsContainerY = this._getScrollY();
          }
          if (itemsContainerY !== undefined) {
              this.updatePositionOnAxis(this.Items, itemsContainerY);
          }
          this.onScreenEffect(this.onScreenItems);
      }
      _performRender() {
          this._render(this.selected, this.prevSelected);
      }
      checkSkipPlinko(prev, next) {
          if (!prev || !prev.skipPlinko || [ 0, this.items.length - 1 ].includes(this.items.indexOf(prev))) {
              return null;
          }
          var prevIndex = this.items.indexOf(prev);
          var direction = prevIndex - this.items.indexOf(next);
          var up = direction > 0;
          var prevItems = up ? this.items.slice(prevIndex).map((i => ({
              skipPlinko: i.skipPlinko,
              index: this.items.indexOf(i)
          }))) : this.items.slice(0, prevIndex + 1).map((i => ({
              skipPlinko: i.skipPlinko,
              index: this.items.indexOf(i)
          }))).reverse();
          var endOfMultiSkipPlinkos = prevItems.find((i => i.skipPlinko && !this.items[i.index + direction].skipPlinko));
          var prevPlinkoIndex = endOfMultiSkipPlinkos ? endOfMultiSkipPlinkos.index + direction : prevIndex + direction;
          return this.items[prevPlinkoIndex];
      }
      get _itemsY() {
          return getY(this.Items);
      }
      $removeItem(item) {
          if (item) {
              var wasSelected = item === this.selected;
              this.Items.childList.remove(item);
              this.queueRequestUpdate();
              if (wasSelected || this.selectedIndex >= this.items.length) {
                  this.selectedIndex = this._selectedIndex;
              }
              if (!this.items.length) {
                  this.fireAncestors("$columnEmpty");
              }
          }
      }
      $columnChanged() {
          this.queueRequestUpdate();
      }
      _isOnScreen(child) {
          if (!child) return false;
          return this._isComponentVerticallyVisible(child);
      }
      onScreenEffect() {}
  }

  var base$m = theme => {
      var paddingX = theme.spacer.lg;
      var radius = theme.radius.xl;
      var logoRadius = Math.max(radius - paddingX / 2, 0);
      return {
          height: theme.spacer.md * 8,
          iconStyle: {
              radius: radius,
              width: theme.spacer.xxxl,
              height: theme.spacer.xxxl
          },
          logoStyle: {
              radius: logoRadius,
              width: theme.spacer.md * 7,
              height: theme.spacer.md * 6
          },
          minWidth: theme.spacer.md * 9,
          paddingX: paddingX,
          paddingXNoTitle: theme.spacer.md,
          prefixPadding: theme.spacer.md,
          radius: radius,
          contentSpacing: theme.spacer.md
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$m
  });

  var base$l = theme => {
      var parentStyle = base$m(theme);
      var height = theme.spacer.md * 7;
      var radiusOffset = (parentStyle.height - height) / 2;
      var radius = Math.max(parentStyle.radius - radiusOffset, 0);
      var logoRadius = Math.max(radius - parentStyle.paddingX / 2, 0);
      return {
          height: height,
          logoStyle: {
              radius: logoRadius,
              height: theme.spacer.md * 5,
              width: theme.spacer.md * 6
          },
          radius: radius,
          minWidth: theme.spacer.md * 8,
          textStyle: theme.typography.button2
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$l
  });

  var base$k = theme => ({
      width: getWidthByUpCount(theme, 1),
      titleMarginBottom: theme.spacer.lg,
      titleMarginLeft: theme.layout.gutterX,
      titleTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline1), {}, {
          textColor: theme.color.textNeutral
      })
  });

  var tone$b = theme => ({
      neutral: {
          titleTextStyle: {
              textColor: theme.color.textNeutral
          }
      },
      inverse: {
          titleTextStyle: {
              textColor: theme.color.textInverse
          }
      },
      brand: {
          titleTextStyle: {
              textColor: theme.color.textNeutral
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$k,
      tone: tone$b
  });

  var base$j = theme => ({
      extraItemSpacing: theme.spacer.lg
  });

  Object.freeze({
      __proto__: null,
      base: base$j
  });

  var base$i = theme => ({
      propertyTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline1), {}, {
          textColor: theme.color.textNeutral
      }),
      valueTextStyle: _objectSpread(_objectSpread({}, theme.typography.body1), {}, {
          textColor: theme.color.textNeutral
      })
  });

  Object.freeze({
      __proto__: null,
      base: base$i
  });

  var base$h = theme => ({
      cursorStyle: {
          textColor: theme.color.textNeutral,
          blink: true,
          width: theme.spacer.xs,
          height: theme.spacer.xxl
      },
      eyebrowTextStyle: _objectSpread(_objectSpread({}, theme.typography.caption1), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutral
      }),
      textStyle: _objectSpread(_objectSpread({}, theme.typography.body1), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutral
      }),
      helpTextStyle: _objectSpread(_objectSpread({}, theme.typography.caption1), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutralSecondary
      }),
      minWidth: getWidthByUpCount(theme, 4),
      paddingX: theme.spacer.xl,
      paddingY: theme.spacer.xl,
      backgroundColor: theme.color.interactiveNeutral
  });

  var mode$6 = theme => ({
      disabled: {
          eyebrowTextStyle: {
              textColor: theme.color.textNeutralDisabled
          },
          helpTextStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      },
      focused: {
          cursorStyle: {
              textColor: theme.color.textInverse
          },
          eyebrowTextStyle: {
              textColor: theme.color.textNeutral
          },
          helpTextStyle: {
              textColor: theme.color.textNeutralSecondary
          }
      }
  });

  var tone$a = theme => ({
      inverse: {
          mode: {
              focused: {
                  eyebrowTextStyle: {
                      textColor: theme.color.textNeutral
                  },
                  helpTextStyle: {
                      textColor: theme.color.textNeutral
                  }
              }
          }
      }
  });

  var styles$h = Object.freeze({
      __proto__: null,
      base: base$h,
      mode: mode$6,
      tone: tone$a
  });

  class Input extends Button$1 {
      static get __componentName() {
          return "Input";
      }
      static get __themeStyle() {
          return styles$h;
      }
      static _template() {
          return _objectSpread(_objectSpread({}, super._template()), {}, {
              Eyebrow: {
                  type: TextBox
              },
              HelpText: {
                  type: TextBox
              }
          });
      }
      static get properties() {
          return [ ...super.properties, "actualTitle", "cursor", "eyebrow", "helpText", "listening", "mask", "password", "position" ];
      }
      static get tags() {
          return [ ...super.tags, "Eyebrow", "HelpText", {
              name: "Cursor",
              path: "Content.Cursor"
          }, {
              name: "HiddenContent",
              path: "Content.HiddenContent"
          } ];
      }
      _construct() {
          super._construct();
          this._title = "";
          this.actualTitle = "";
          this.position = this.title ? this.title.length : 0;
          this._justify = "left";
          this._fixed = true;
          this.w = this.style.minWidth;
      }
      $itemChanged() {
          super.$itemChanged();
          this._updateTextWrapper();
          this._updateHiddenContent();
          this._updateCursorPosition();
          this._updateTitleScrollPosition();
      }
      _onTitleTextBoxChanged() {
          this._updateHiddenContent();
      }
      _onHiddenTextBoxChanged() {
          this._updateCursorPosition();
      }
      _update() {
          this._updatePassword();
          super._update();
          this._updateEyebrow();
          this._updateHelpText();
          this._updateTextWrapper();
          this._updateHiddenContent();
          this._updateCursor();
          this._updateCursorListening();
          this._updateCursorBlink();
          this._updateCursorPosition();
          this._updateTitleScrollPosition();
      }
      _updatePassword() {
          this.title = this.password ? this.mask.repeat(this.actualTitle.length) : this.actualTitle;
      }
      _updateTruncation() {
          if (this._Title) {
              this._Title.patch({
                  style: {
                      textStyle: _objectSpread(_objectSpread({}, this.style.textStyle), {}, {
                          wordWrap: false
                      })
                  }
              });
          }
      }
      _updateEyebrow() {
          this._Eyebrow.patch({
              content: this.eyebrow,
              style: {
                  textStyle: this.style.eyebrowTextStyle
              },
              mountY: 1,
              x: this.style.paddingX,
              y: this.y - this.style.paddingY
          });
      }
      _updateHelpText() {
          this._HelpText.patch({
              content: this.helpText,
              style: {
                  textStyle: this.style.helpTextStyle
              },
              x: this.style.paddingX,
              y: this.y + this.innerH + this.style.paddingY
          });
      }
      _updateTextWrapper() {
          this._TextWrapper.clipping = true;
          this._TextWrapper.w = this._visibleContentWidth;
          if (this._Title) {
              this._TextWrapper.h = this._Title.h;
          }
      }
      _updateHiddenContent() {
          if (!this._HiddenContent) {
              this._Content.patch({
                  HiddenContent: {
                      type: TextBox,
                      mountY: .5,
                      y: h => h / 2,
                      signals: {
                          textBoxChanged: "_onHiddenTextBoxChanged"
                      }
                  }
              });
          }
          var {title: value = "", position: position, password: password, mask: mask} = this;
          var textBeforeCursor = password ? mask.repeat(value.length).substring(0, position) : value.substring(0, position);
          this._HiddenContent.patch({
              style: {
                  textStyle: this.style.textStyle
              },
              content: textBeforeCursor
          });
          this._HiddenContent._Text && this._HiddenContent._Text.patch({
              alpha: .001
          });
      }
      _updateCursor() {
          if (this.style.cursorStyle && this.style.cursorStyle.blink) {
              if (!this._Cursor) {
                  this._Content.patch({
                      Cursor: {
                          rect: true,
                          mountY: .5
                      }
                  });
                  this.cursorBlink = this._Cursor.animation({
                      duration: 1.5,
                      repeat: -1,
                      actions: [ {
                          p: "alpha",
                          v: {
                              0: 0,
                              .5: 1,
                              1: 0
                          }
                      } ]
                  });
              }
              this._Cursor.patch(this.style.cursorStyle);
          }
      }
      _updateCursorListening() {
          if (!this._isDisabledMode) {
              if (this.cursorBlink && !this.cursorBlink.isPlaying()) {
                  this.cursorBlink.start();
              }
          } else {
              if (this.cursorBlink) this.isCursorActive ? this.cursorBlink.start() : this.cursorBlink.stop();
          }
          this._Cursor.smooth = {
              color: this.style.cursorStyle.textColor
          };
      }
      _updateCursorBlink() {
          if (this.cursorBlink) {
              if (this.isCursorActive) {
                  this.cursorBlink.start();
              } else {
                  this.cursorBlink.stop();
                  this._Cursor.patch({
                      alpha: .001
                  });
              }
          }
      }
      _updateCursorPosition() {
          this._Cursor.x = this._titleX + (this._isOverflow ? this._TextWrapper.w : this._HiddenContent.w);
      }
      _updateTitleScrollPosition() {
          if (this._Title) {
              this._Title.x = this._isOverflow ? this._visibleContentWidth - this._HiddenContent.w : 0;
              if (this._HiddenContent && this._TextWrapper) {
                  this._HiddenContent.x = this._TextWrapper.x + this._Title.x;
              }
          }
      }
      get _suffixX() {
          var suffixX = this._hasPrefix ? this.w - this._paddingLeft - this._paddingRight - this._prefixW : this.w - this._paddingLeft - this._paddingRight - this.style.paddingX;
          return suffixX > 0 ? suffixX : 0;
      }
      get isCursorActive() {
          return this.listening && (this._isFocusedMode || this._isUnfocusedMode);
      }
      get _isOverflow() {
          return this._HiddenContent.w > this._visibleContentWidth;
      }
      get _visibleContentWidth() {
          return this._fixedWordWrapWidth;
      }
      set value(value) {
          this.title = this.actualTitle = value;
          this.position = 0;
          this._updatePassword();
      }
      get value() {
          return this.actualTitle;
      }
      clear() {
          if (this.isCursorActive) {
              this.title = this.actualTitle = "";
              this.position = 0;
          }
      }
      insert(content) {
          if (this.isCursorActive) {
              this.actualTitle = this.actualTitle.slice(0, this.position) + content + this.actualTitle.slice(this.position);
              this._updatePassword();
              this.position += content.length;
          }
      }
      backspace() {
          if (this.isCursorActive && this.position > 0) {
              this.actualTitle = this.actualTitle.slice(0, this.position - 1) + this.actualTitle.slice(this.position);
              this._updatePassword();
              this.position--;
          }
      }
      _handleLeft() {
          if (this._isDisabledMode) {
              return false;
          }
          this.moveLeft();
          if (typeof this.onLeft === "function") {
              return this.onLeft(this);
          }
          return true;
      }
      _handleRight() {
          if (this._isDisabledMode) {
              return false;
          }
          this.moveRight();
          if (typeof this.onRight === "function") {
              return this.onRight(this);
          }
          return true;
      }
      moveLeft() {
          var {position: position} = this;
          if (position >= 0) {
              this.position--;
              return true;
          }
          return false;
      }
      moveRight() {
          var {position: position, title: title} = this;
          if (position < title.length) {
              this.position++;
              return true;
          }
          return false;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce) {
              return this._announce;
          }
          if (this.password) {
              return [ this.eyebrow, this.helpText ];
          } else {
              return [ this.eyebrow, "Input: " + this.title, this.helpText ];
          }
      }
  }

  var base$g = theme => {
      var textStyle = theme.typography.headline2;
      return {
          height: theme.spacer.md * 9,
          minWidth: theme.spacer.md * 7,
          paddingX: theme.spacer.md,
          textStyle: textStyle,
          sizes: {
              sm: 1,
              md: 2,
              lg: 3,
              xl: 4,
              xxl: 5
          },
          baseWidth: theme.spacer.md * 7,
          iconWidth: textStyle.lineHeight,
          iconHeight: textStyle.lineHeight
      };
  };

  var styles$g = Object.freeze({
      __proto__: null,
      base: base$g
  });

  var isUpperCase = string => /^[A-Z]$/.test(string);

  var isAlphaChar = string => /^[A-Za-z]$/.test(string);

  var alphaNato = {
      a: "alpha",
      b: "bravo",
      c: "charlie",
      d: "delta",
      e: "echo",
      f: "foxtrot",
      g: "golf",
      h: "hotel",
      i: "india",
      j: "juliett",
      k: "kilo",
      l: "lima",
      m: "mike",
      n: "november",
      o: "oscar",
      p: "papa",
      q: "quebec",
      r: "romeo",
      s: "sierra",
      t: "tango",
      u: "uniform",
      v: "victor",
      w: "whiskey",
      x: "x-ray",
      y: "yankee",
      z: "zulu"
  };

  function getNato(title) {
      if (isAlphaChar(title)) {
          return "".concat(title, ", ").concat(alphaNato[title.toLowerCase()]);
      }
      return title;
  }

  class Key$2 extends Button$1 {
      static get __componentName() {
          return "Key";
      }
      static get __themeStyle() {
          return styles$g;
      }
      static get properties() {
          return [ ...super.properties, "icon", "size", "toggle", "keySpacing" ];
      }
      static get aliasStyles() {
          return [ {
              prev: "iconH",
              curr: "iconHeight"
          }, {
              prev: "iconW",
              curr: "iconWidth"
          } ];
      }
      _construct() {
          super._construct();
          this._size = "sm";
          this._keySpacing = 0;
      }
      _update() {
          this._updatePrefixStyle();
          super._update();
      }
      _calcDynamicWidth() {
          var sizeMultiplier = this.style.sizes[this.size || "sm"];
          var baseSize = this.style.baseWidth * sizeMultiplier;
          var padding = this.keySpacing * (sizeMultiplier - 1);
          return baseSize + padding;
      }
      _updatePrefixStyle() {
          if (this._prefix && this.icon) {
              this._updatePrefixObj(this.icon, {
                  style: this.style.iconStyle
              });
          }
      }
      _updatePrefixObj(icon) {
          var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          this._prefix = _objectSpread({
              type: Icon,
              icon: icon,
              w: this.style.iconWidth,
              h: this.style.iconHeight
          }, props);
      }
      _setIcon(icon) {
          if (icon) {
              this._updatePrefixObj(icon, {
                  style: this.style.iconStyle
              });
          } else {
              this._prefix = icon;
          }
          return icon;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce) {
              return this._announce;
          }
          if (isUpperCase(this.title)) {
              return "Capital ".concat(getNato(this.title), ", button");
          }
          return getNato(this.title) + ", button";
      }
      _handleEnter() {
          if (typeof this.onEnter === "function") {
              return this.onEnter(this);
          } else {
              if (this.toggle) {
                  this.fireAncestors("$toggleKeyboard", this.toggle);
              }
              this.fireAncestors("$onSoftKey", {
                  key: this.keyId || this.title,
                  toggle: this.toggle
              });
          }
          return false;
      }
  }

  var base$f = theme => ({
      keySpacing: theme.spacer.md,
      screenW: theme.layout.screenW,
      marginX: theme.layout.marginX,
      inputSpacing: theme.spacer.md * 10 + theme.spacer.md,
      inputStyle: {
          radius: theme.radius.md
      }
  });

  var styles$f = Object.freeze({
      __proto__: null,
      base: base$f
  });

  var capitalize = string => string.charAt(0).toUpperCase() + string.slice(1);

  class Keyboard$2 extends Base$1 {
      static get __componentName() {
          return "Keyboard";
      }
      static get __themeStyle() {
          return styles$f;
      }
      static get properties() {
          return [ "formats", "centerKeyboard", "rowWrap", "centerKeys", "keyComponent" ];
      }
      _init() {
          this._setShouldUpdateThemeBound = this._setShouldUpdateTheme.bind(this);
          contextInstance.on("themeUpdate", this._setShouldUpdateThemeBound);
          super._init();
      }
      _setShouldUpdateTheme() {
          this.shouldUpdateTheme = true;
      }
      _detach() {
          super._detach();
          contextInstance.off("themeUpdate", this._setShouldUpdateThemeBound);
      }
      _focus() {
          super._focus();
          this.fireAncestors("$keyboardFocused", true);
      }
      _getFocused() {
          return this._currentKeyboard || this;
      }
      _update() {
          if (!this._currentFormat || this._shouldUpdateKeyboards) {
              this._currentFormat = this.defaultFormat;
          }
          if (this.centerKeyboard) {
              this.x = this.centeredXPos;
          } else if (this.x === this.centeredXPos && !this.centerKeyboard) {
              this.x = 0;
          } else {
              this.x == null && (this.x = 0);
          }
          this._shouldUpdateKeyboards && this._createKeyboardsFromFormats();
          this._formatKeys();
      }
      _createKeyboardsFromFormats() {
          this.childList.clear();
          Object.keys(this.formats).forEach((key => {
              var format = this.formats[key];
              if (format) {
                  var keyboardData = this._formatKeyboardData(format);
                  this._createKeyboard(key, this._createRows(keyboardData, key));
              }
          }));
          this._formatsChanged = false;
      }
      _createKeyboard(key) {
          var rows = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
          key = capitalize(key);
          if (rows.length === 1) {
              this.patch({
                  [key]: rows[0]
              });
          } else {
              this.patch({
                  [key]: {
                      type: Column,
                      plinko: true,
                      items: rows,
                      style: {
                          itemSpacing: this.style.keySpacing
                      },
                      autoResizeWidth: true,
                      autoResizeHeight: true,
                      neverScroll: true,
                      alpha: key === capitalize(this._currentFormat) ? 1 : .001
                  }
              });
          }
      }
      _createRows() {
          var rows = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          var keyboard = arguments.length > 1 ? arguments[1] : undefined;
          return rows.map((keys => {
              var _this$_currentKeyboar;
              return {
                  type: Row,
                  autoResizeHeight: true,
                  autoResizeWidth: true,
                  centerInParent: this.centerKeys,
                  neverScroll: true,
                  wrapSelected: this.rowWrap !== undefined ? this.rowWrap : true,
                  style: {
                      itemSpacing: this.style.keySpacing
                  },
                  items: this._createKeys(keys, keyboard),
                  selectedIndex: ((_this$_currentKeyboar = this._currentKeyboard) === null || _this$_currentKeyboar === void 0 || (_this$_currentKeyboar = _this$_currentKeyboar.selected) === null || _this$_currentKeyboar === void 0 ? void 0 : _this$_currentKeyboar.selectedIndex) || 0
              };
          }));
      }
      _createKeys() {
          var keys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          var keyboard = arguments.length > 1 ? arguments[1] : undefined;
          return keys.map((keyProps => {
              if (!keyProps) {
                  return {
                      type: this.keyComponent || Key$2,
                      keySpacing: this.style.keySpacing,
                      skipFocus: true,
                      alpha: .01
                  };
              }
              var key = {
                  type: this.keyComponent || Key$2,
                  keySpacing: this.style.keySpacing
              };
              if (typeof keyProps === "object") {
                  var _this$style$keyProps, _this$style$keyProps2;
                  var keyName = keyProps.keyId || keyProps.title;
                  var keyOverrides = ((_this$style$keyProps = this.style.keyProps) === null || _this$style$keyProps === void 0 || (_this$style$keyProps = _this$style$keyProps[keyboard]) === null || _this$style$keyProps === void 0 ? void 0 : _this$style$keyProps[keyName]) || ((_this$style$keyProps2 = this.style.keyProps) === null || _this$style$keyProps2 === void 0 ? void 0 : _this$style$keyProps2[keyName]) || {};
                  var keyPatch = _objectSpread(_objectSpread(_objectSpread({}, key), keyProps), keyOverrides);
                  if (keyOverrides !== null && keyOverrides !== void 0 && keyOverrides.icon) {
                      keyPatch.style = _objectSpread(_objectSpread({}, keyOverrides.style), {}, {
                          iconStyle: _objectSpread({}, keyOverrides.iconStyle)
                      });
                  }
                  return keyPatch;
              }
              return _objectSpread(_objectSpread({}, key), {}, {
                  title: keyProps
              });
          }));
      }
      _formatKeyboardData() {
          var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          if (Array.isArray(data) && data.length) {
              if (!Array.isArray(data[0]) && !this.inline) {
                  var keyRows = [];
                  var idx, counter;
                  for (idx = 0, counter = -1; idx < data.length; idx++) {
                      if (idx % this.columnCount === 0) {
                          counter++;
                          keyRows[counter] = [];
                      }
                      keyRows[counter].push(data[idx]);
                  }
                  return keyRows;
              } else if (this.inline) {
                  return [ data ];
              }
              return data;
          }
      }
      _formatKeys() {
          Object.keys(this.formats).forEach((format => {
              var element = this.tag(capitalize(format));
              if (element) {
                  element.patch({
                      alpha: format === this._currentFormat ? 1 : .001,
                      style: {
                          itemSpacing: this.style.keySpacing
                      }
                  });
                  element.items.forEach((row => {
                      row.patch({
                          style: {
                              itemSpacing: this.style.keySpacing
                          },
                          centerInParent: this.centerKeys,
                          wrapSelected: this.rowWrap !== undefined ? this.rowWrap : true
                      });
                  }));
                  element.queueRequestUpdate();
              }
          }));
      }
      $toggleKeyboard(next) {
          var nextKeyboard = capitalize(next);
          if (next !== this._currentFormat) {
              var nextKeyboardTag = this.tag(nextKeyboard);
              this.selectKeyOn(nextKeyboardTag);
              this._currentKeyboard.alpha = .001;
              nextKeyboardTag.alpha = 1;
              this._currentFormat = next;
          }
      }
      selectKeyOn(keyboard) {
          var {row: row, column: column} = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getSelectedKey();
          if (keyboard && keyboard.constructor) {
              var type = keyboard.constructor.name;
              if (type === "Row") {
                  keyboard.selectedIndex = column;
              } else {
                  keyboard.selectedIndex = row;
                  keyboard.selected.selectedIndex = column;
              }
          }
      }
      getSelectedKey() {
          var row, column;
          var keyboard = this._currentKeyboard;
          var type = keyboard.constructor.name;
          if (type === "Row") {
              row = 0;
              column = keyboard.selectedIndex;
          } else {
              row = keyboard.selectedIndex;
              column = keyboard.selected.selectedIndex;
          }
          return {
              row: row,
              column: column
          };
      }
      $itemChanged() {
          this.w = this._currentKeyboard.w;
          this.fireAncestors("$itemChanged");
          this.signal("keyboardWidthChanged");
      }
      _setFormats() {
          var formats = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
          this._formatsChanged = true;
          return formats;
      }
      get centeredXPos() {
          return (this.style.screenW - this.w) / 2 - this.style.marginX;
      }
      get _shouldUpdateKeyboards() {
          return this.shouldUpdateTheme || this._formatsChanged;
      }
      set defaultFormat(format) {
          this._defaultFormat = format;
      }
      get defaultFormat() {
          return this._defaultFormat || Object.keys(this.formats)[0];
      }
      get _currentKeyboard() {
          return this._currentFormat ? this.tag(capitalize(this._currentFormat)) : null;
      }
      set columnCount(columnCount) {
          this._columnCount = columnCount;
      }
      get columnCount() {
          if (this._columnCount) return this._columnCount;
          if (this.rowCount) return this.formats[this.defaultFormat.toLowerCase()].length / this.rowCount;
          if (this.inline) return this.formats[this.defaultFormat.toLowerCase()].length; else return 11;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce) {
              return this._announce;
          }
          return "Keyboard" + (this.title ? ", ".concat(this.title) : "");
      }
      set announceContext(announceContext) {
          super.announceContext = announceContext;
      }
      get announceContext() {
          return this._announceContext || [ "PAUSE-2", "Use arrow keys to choose characters, press center to select" ];
      }
  }

  class KeyboardQwerty extends Keyboard$2 {
      static get __componentName() {
          return "KeyboardQwerty";
      }
      static get __themeStyle() {
          return styles$f;
      }
      _construct() {
          super._construct();
          this.formats = this.qwertyFormat;
      }
      get qwertyFormat() {
          return {
              uppercase: [ [ "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", {
                  title: "Delete",
                  size: "md",
                  keyId: "delete",
                  announce: "delete, button"
              } ], [ "Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P", {
                  title: "#@!",
                  size: "md",
                  toggle: "symbols",
                  announce: "symbol mode, button",
                  keyId: "symbols"
              } ], [ "A", "S", "D", "F", "G", "H", "J", "K", "L", "@", {
                  title: "áöû",
                  size: "md",
                  toggle: "accents",
                  announce: "accents, button",
                  keyId: "accents"
              } ], [ "Z", "X", "C", "V", "B", "N", "M", {
                  title: "_",
                  announce: "underscore, button"
              }, {
                  title: ".",
                  announce: "period, button"
              }, {
                  title: "-",
                  announce: "dash, button"
              }, {
                  title: "shift",
                  size: "md",
                  toggle: "lowercase",
                  announce: "shift off, button",
                  keyId: "shift"
              } ], [ {
                  title: "Clear",
                  size: "lg",
                  keyId: "clear",
                  announce: "clear, button"
              }, {
                  title: "Space",
                  size: "xl",
                  keyId: "space",
                  announce: "space, button"
              }, {
                  title: "Done",
                  size: "lg",
                  keyId: "done",
                  announce: "done, button"
              } ] ],
              lowercase: [ [ "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", {
                  title: "Delete",
                  size: "md",
                  keyId: "delete",
                  announce: "delete, button"
              } ], [ "q", "w", "e", "r", "t", "y", "u", "i", "o", "p", {
                  title: "#@!",
                  size: "md",
                  toggle: "symbols",
                  announce: "symbol mode, button",
                  keyId: "symbols"
              } ], [ "a", "s", "d", "f", "g", "h", "j", "k", "l", "@", {
                  title: "áöû",
                  size: "md",
                  toggle: "accents",
                  announce: "accents, button",
                  keyId: "accents"
              } ], [ "z", "x", "c", "v", "b", "n", "m", {
                  title: "_",
                  announce: "underscore, button"
              }, {
                  title: ".",
                  announce: "period, button"
              }, {
                  title: "-",
                  announce: "dash, button"
              }, {
                  title: "shift",
                  size: "md",
                  toggle: "uppercase",
                  announce: "shift on, button",
                  keyId: "shift"
              } ], [ {
                  title: "Clear",
                  size: "lg",
                  keyId: "clear",
                  announce: "clear, button"
              }, {
                  title: "Space",
                  size: "xl",
                  keyId: "space",
                  announce: "space, button"
              }, {
                  title: "Done",
                  size: "lg",
                  keyId: "done",
                  announce: "done, button"
              } ] ],
              accents: [ [ "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", {
                  title: "Delete",
                  size: "md",
                  keyId: "delete",
                  announce: "delete, button"
              } ], [ "ä", "ë", "ï", "ö", "ü", "ÿ", "à", "è", "ì", "ò", {
                  title: "#@!",
                  size: "md",
                  toggle: "symbols",
                  announce: "symbol mode, button",
                  keyId: "symbols"
              } ], [ "ù", "á", "é", "í", "ó", "ú", "ý", "â", "ê", "@", {
                  title: "abc",
                  size: "md",
                  toggle: "lowercase",
                  announce: "alpha mode, button"
              } ], [ "î", "ô", "û", "ã", "ñ", {
                  title: "_",
                  announce: "underscore, button"
              }, {
                  title: ".",
                  announce: "period, button"
              }, {
                  title: "-",
                  announce: "dash, button"
              }, {
                  title: "shift",
                  size: "xl",
                  toggle: "accentsUpper",
                  announce: "shift off, button",
                  keyId: "shift"
              } ], [ {
                  title: "Clear",
                  size: "lg",
                  keyId: "clear",
                  announce: "clear, button"
              }, {
                  title: "Space",
                  size: "xl",
                  keyId: "space",
                  announce: "space, button"
              }, {
                  title: "Done",
                  size: "lg",
                  keyId: "done",
                  announce: "done, button"
              } ] ],
              accentsUpper: [ [ "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", {
                  title: "Delete",
                  size: "md",
                  keyId: "delete",
                  announce: "delete, button"
              } ], [ "Ä", "Ë", "Ï", "Ö", "Ü", "Ÿ", "À", "È", "Ì", "Ò", {
                  title: "#@!",
                  size: "md",
                  toggle: "symbols",
                  announce: "symbol mode, button",
                  keyId: "symbols"
              } ], [ "Ù", "Á", "É", "Í", "Ó", "Ú", "Ý", "Â", "Ê", "@", {
                  title: "abc",
                  size: "md",
                  toggle: "lowercase",
                  announce: "alpha mode, button"
              } ], [ "Î", "Ô", "Û", "Ã", "Ñ", {
                  title: ".",
                  announce: "period, button"
              }, {
                  title: "-",
                  announce: "dash, button"
              }, {
                  title: "_",
                  announce: "underscore, button"
              }, {
                  title: "shift",
                  size: "xl",
                  toggle: "accents",
                  announce: "shift off, button",
                  keyId: "shift"
              } ], [ {
                  title: "Clear",
                  size: "lg",
                  keyId: "clear",
                  announce: "clear, button"
              }, {
                  title: "Space",
                  size: "xl",
                  keyId: "space",
                  announce: "space, button"
              }, {
                  title: "Done",
                  size: "lg",
                  keyId: "done",
                  announce: "done, button"
              } ] ],
              symbols: [ [ "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", {
                  title: "Delete",
                  size: "md",
                  keyId: "delete",
                  announce: "delete, button"
              } ], [ {
                  title: "!",
                  announce: "exclamation, button"
              }, "@", "#", "$", "%", {
                  title: "^",
                  announce: "caret circumflex, button"
              }, "&", "*", {
                  title: "(",
                  announce: "open parenthesis, button"
              }, {
                  title: ")",
                  announce: "close parenthesis, button"
              }, {
                  title: "abc",
                  size: "md",
                  toggle: "lowercase",
                  announce: "alpha mode, button"
              } ], [ {
                  title: "{",
                  announce: "open brace, button"
              }, {
                  title: "}",
                  announce: "close brace, button"
              }, {
                  title: "[",
                  announce: "open bracket, button"
              }, {
                  title: "]",
                  announce: "close bracket, button"
              }, {
                  title: ";",
                  announce: "semicolon, button"
              }, {
                  title: '"',
                  announce: "doublequote, button"
              }, {
                  title: ",",
                  announce: "comma, button"
              }, {
                  title: "|",
                  announce: "vertical bar, button"
              }, {
                  title: "\\",
                  announce: "backslash, button"
              }, {
                  title: "/",
                  announce: "forwardslash, button"
              }, {
                  title: "áöû",
                  size: "md",
                  toggle: "accents",
                  announce: "accents, button",
                  keyId: "accents"
              } ], [ {
                  title: "<",
                  announce: "less than, button"
              }, {
                  title: ">",
                  announce: "greater than, button"
              }, {
                  title: "?",
                  announce: "question mark, button"
              }, {
                  title: "=",
                  announce: "equal sign, button"
              }, {
                  title: "`",
                  announce: "grave accent, button"
              }, {
                  title: "~",
                  announce: "tilde, button"
              }, {
                  title: "_",
                  announce: "underscore, button"
              }, {
                  title: ":",
                  announce: "colon, button"
              }, {
                  title: "-",
                  announce: "dash, button"
              }, {
                  title: "+",
                  announce: "plus sign, button"
              } ], [ {
                  title: "Clear",
                  size: "lg",
                  keyId: "clear",
                  announce: "clear, button"
              }, {
                  title: "Space",
                  size: "xl",
                  keyId: "space",
                  announce: "space, button"
              }, {
                  title: "Done",
                  size: "lg",
                  keyId: "done",
                  announce: "done, button"
              } ] ]
          };
      }
  }

  class KeyboardInput extends Base$1 {
      static get __componentName() {
          return "KeyboardInput";
      }
      static get properties() {
          return [ "centerKeyboard", "defaultFormat", "input", "keyboardType" ];
      }
      static get __themeStyle() {
          return styles$f;
      }
      static _template() {
          return {
              Wrapper: {
                  type: Column,
                  neverScroll: true,
                  w: this.w,
                  items: [ {
                      type: Input,
                      ref: "Input"
                  }, {
                      type: Keyboard$2,
                      ref: "Keyboard",
                      passSignals: {
                          keyboardWidthChanged: true
                      }
                  } ],
                  selectedIndex: 1,
                  signals: {
                      keyboardWidthChanged: "_updateWidth"
                  }
              }
          };
      }
      static get tags() {
          return [ "Wrapper", {
              name: "Input",
              path: "Wrapper.Input"
          }, {
              name: "Keyboard",
              path: "Wrapper.Keyboard"
          } ];
      }
      _update() {
          this._Wrapper.style.itemSpacing = this.style.inputSpacing;
          this._updateKeyboardType();
          this._updateInput();
          this._updateKeyboard();
          this._updateCenterKeyboard();
      }
      _updateKeyboardType() {
          if (this._Keyboard.constructor !== this.keyboardType) {
              this._Wrapper._resetItems();
              this._Wrapper.items = [ {
                  type: Input,
                  ref: "Input"
              }, {
                  type: this.keyboardType,
                  ref: "Keyboard",
                  passSignals: {
                      keyboardWidthChanged: true
                  }
              } ];
          }
      }
      _updateInput() {
          this._Input.patch(_objectSpread(_objectSpread({}, this.input), {}, {
              centerInParent: this.centerKeyboard,
              w: this._Keyboard.w,
              style: _objectSpread({}, this.style.inputStyle),
              listening: this._isFocusedMode
          }));
      }
      _updateKeyboard() {
          this._Keyboard.patch({
              defaultFormat: this.defaultFormat || "lowercase",
              centerKeyboard: this.centerKeyboard
          });
      }
      _updateWidth() {
          this._Input.w = this.w = this._Keyboard.w;
          this.fireAncestors("$itemChanged");
      }
      _updateCenterKeyboard() {
          if (this.centerKeyboard) {
              this.x = (this.style.screenW - this.w) / 2 - this.style.marginX;
          } else {
              this.x = 0;
          }
      }
      $onSoftKey(_ref22) {
          var {key: key = "", toggle: toggle} = _ref22;
          if (toggle) {
              return;
          }
          switch (key.toLowerCase()) {
            case "delete":
              this._Input.backspace();
              break;

            case "done":
              break;

            case "space":
              this._Input.insert(" ");
              break;

            case "clear":
              this._Input.clear();
              break;

            default:
              this._Input.insert(key);
          }
      }
      $keyboardFocused(focus) {
          if (focus) {
              this._Input.listening = true;
          } else {
              this._Input.listening = false;
          }
      }
      _getFocused() {
          return this._Wrapper || this;
      }
  }

  var base$e = theme => {
      var size = theme.spacer.lg;
      return {
          width: size,
          height: size,
          radius: size / 2
      };
  };

  var tone$9 = theme => ({
      neutral: {
          circleColor: theme.color.interactiveNeutralFocus,
          mode: {
              disabled: {
                  circleColor: theme.color.fillNeutralDisabled
              }
          }
      },
      inverse: {
          circleColor: theme.color.interactiveInverseFocus,
          mode: {
              disabled: {
                  circleColor: theme.color.fillInverseDisabled
              }
          }
      },
      brand: {
          circleColor: theme.color.interactiveBrandFocus,
          mode: {
              disabled: {
                  circleColor: theme.color.fillInverseDisabled
              }
          }
      }
  });

  var styles$e = Object.freeze({
      __proto__: null,
      base: base$e,
      tone: tone$9
  });

  class Knob extends Base$1 {
      static get __componentName() {
          return "Knob";
      }
      static get __themeStyle() {
          return styles$e;
      }
      static _template() {
          return {
              mount: .5
          };
      }
      _update() {
          this._updateLayout();
      }
      _updateLayout() {
          this.patch({
              texture: Lightning.Tools.getRoundRect(this.w, this.h, getMaxRoundRadius(this.style.radius, this.w, this.h), null, null, true, this.style.circleColor)
          });
      }
  }

  var base$d = theme => ({
      alpha: theme.alpha.primary,
      descriptionTextStyle: _objectSpread(_objectSpread({}, theme.typography.body3), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutralSecondary
      }),
      height: theme.spacer.xxl * 3,
      logoStyle: {
          width: theme.spacer.xxl * 2,
          height: theme.spacer.xxl * 2,
          radius: theme.radius.sm
      },
      paddingX: theme.spacer.xl,
      contentSpacing: theme.spacer.lg,
      titleTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline3), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutral
      }),
      width: utils$1.getWidthByColumnSpan(theme, 3)
  });

  var mode$5 = theme => ({
      disabled: {
          alpha: theme.alpha.inactive,
          descriptionTextStyle: {
              textColor: theme.color.textNeutralDisabled
          },
          titleTextStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      },
      focused: {
          descriptionTextStyle: {
              textColor: theme.color.textInverseSecondary
          },
          titleTextStyle: {
              textColor: theme.color.textInverse
          }
      }
  });

  var tone$8 = theme => ({
      inverse: {
          mode: {
              focused: {
                  descriptionTextStyle: {
                      textColor: theme.color.textNeutral
                  },
                  titleTextStyle: {
                      textColor: theme.color.textNeutral
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$d,
      mode: mode$5,
      tone: tone$8
  });

  var base$c = () => ({
      showArrows: false,
      showKnob: false
  });

  var mode$4 = () => ({
      focused: {
          showArrows: true
      }
  });

  var tone$7 = theme => ({
      neutral: {
          mode: {
              focused: {
                  arrowColor: theme.color.fillInverse,
                  progressBar: {
                      barColor: theme.color.fillInverseTertiary,
                      progressColor: theme.color.fillInverse
                  }
              }
          }
      },
      inverse: {
          mode: {
              focused: {
                  arrowColor: theme.color.fillNeutral,
                  progressBar: {
                      barColor: theme.color.fillNeutralTertiary,
                      progressColor: theme.color.fillNeutral
                  }
              }
          }
      },
      brand: {
          mode: {
              focused: {
                  arrowColor: theme.color.fillInverse,
                  progressBar: {
                      barColor: theme.color.fillBrandTertiary,
                      progressColor: theme.color.fillBrand
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$c,
      mode: mode$4,
      tone: tone$7
  });

  var base$b = theme => {
      var size = theme.spacer.lg;
      return {
          arrowAlphaValue: theme.alpha.primary,
          arrowAlphaValueLimit: theme.alpha.secondary,
          arrowHeight: theme.spacer.xxl,
          arrowSpacing: theme.spacer.md,
          arrowWidth: theme.spacer.xxl,
          arrowColor: theme.color.fillNeutral,
          containerHeight: theme.spacer.lg + theme.spacer.xs,
          iconLeftSrc: theme.asset.arrowLeft,
          iconRightSrc: theme.asset.arrowRight,
          minWidth: getWidthByColumnSpan(theme, 2),
          progressBar: {},
          width: size,
          height: size,
          radius: size / 2,
          showArrows: true,
          showKnob: true,
          circleAnimation: {}
      };
  };

  var mode$3 = () => ({
      disabled: {
          arrowAlphaValue: 0
      }
  });

  var tone$6 = theme => ({
      neutral: {
          arrowColor: theme.color.fillNeutral,
          circleColor: theme.color.interactiveNeutralFocus
      },
      inverse: {
          arrowColor: theme.color.fillInverse,
          circleColor: theme.color.interactiveInverseFocus
      },
      brand: {
          arrowColor: theme.color.fillNeutral,
          circleColor: theme.color.interactiveNeutralFocus
      }
  });

  var styles$b = Object.freeze({
      __proto__: null,
      base: base$b,
      mode: mode$3,
      tone: tone$6
  });

  class Slider extends Base$1 {
      static get __componentName() {
          return "Slider";
      }
      static get __themeStyle() {
          return styles$b;
      }
      static _template() {
          return {
              Container: {
                  mountY: .5,
                  y: h => h / 2,
                  Bar: {
                      mountY: .5,
                      SliderBar: {
                          type: ProgressBar$2,
                          progress: .5,
                          mountY: .5,
                          announce: ""
                      },
                      Circle: {
                          type: Knob,
                          zIndex: 5
                      }
                  },
                  LeftArrow: {
                      type: Icon,
                      mountY: .5,
                      y: h => h / 2
                  },
                  RightArrow: {
                      type: Icon,
                      mountY: .5,
                      y: h => h / 2
                  }
              }
          };
      }
      static get properties() {
          return [ "max", "min", "step", "value", "vertical" ];
      }
      static get tags() {
          return [ "Container", {
              name: "Bar",
              path: "Container.Bar"
          }, {
              name: "SliderBar",
              path: "Container.Bar.SliderBar"
          }, {
              name: "Circle",
              path: "Container.Bar.Circle"
          }, {
              name: "LeftArrow",
              path: "Container.LeftArrow"
          }, {
              name: "RightArrow",
              path: "Container.RightArrow"
          } ];
      }
      _construct() {
          super._construct();
          this._min = 0;
          this._max = 100;
          this._step = 1;
          this._value = 0;
          this._vertical = false;
      }
      _update() {
          this._updateDirection();
          this._updateSliderLayout();
          this._updatePositions();
          this._updateArrowAlpha();
          this._updateArrows();
          if (this._valueChanged) {
              this.signal("onChange", this.value, this);
              this.fireAncestors("$announce", this.announce);
              this._valueChanged = false;
          }
          this._checkAndSignalSizeChange();
      }
      _handleLeft() {
          if (this._isDisabledMode) {
              return false;
          }
          this._decrementValue();
          if (typeof this.onLeft === "function") {
              return this.onLeft(this);
          }
          return true;
      }
      _handleRight() {
          if (this._isDisabledMode) {
              return false;
          }
          this._incrementValue();
          if (typeof this.onRight === "function") {
              return this.onRight(this);
          }
          return true;
      }
      _updateDirection() {
          this.patch({
              pivotX: 0,
              rotation: this.vertical ? degreesToRadians(90) : 0,
              mountY: this.vertical ? .5 : 0
          });
      }
      _updateSliderLayout() {
          var w = this.w || this.style.minWidth;
          this._Container.patch({
              h: this.style.containerHeight,
              w: w,
              Bar: {
                  x: this._calculatedSliderX,
                  SliderBar: {
                      y: this.style.containerHeight / 2,
                      w: this._calculatedSliderWidth,
                      style: _objectSpread({
                          duration: 0
                      }, this.style.progressBar)
                  }
              }
          });
          this.h = Math.max(this.style.containerHeight, this.style.arrowHeight);
      }
      _checkAndSignalSizeChange() {
          if (this.h !== this.prevH || this._Container.w !== this.prevW || this.rotation !== this.prevRotation) {
              this.signal("onSizeChange", this);
          }
          this.prevH = this.h;
          this.prevW = this._Container.w;
          this.prevRotation = this.rotation;
      }
      _updatePositions() {
          this._updateSliderProgress();
          this._updateCirclePosition();
      }
      _updateSliderProgress() {
          var progress = this.value < this.min ? this.min / this.max : this.value / this.max;
          if (this.value > this.max || this.value - this.step > this.max) {
              progress = this._calculatedSliderWidth;
          } else if (this.min < 0 || this.max < 0) {
              progress = (this.value - this.min) / (this.max - this.min);
          }
          this._SliderBar.progress = progress;
      }
      _updateCirclePosition() {
          var xCirclePosition;
          if (this.value < this.min || this.value + this.step < this.min) {
              xCirclePosition = this.min / this.max * this._calculatedSliderWidth;
          } else if (this.value > this.max || this.value - this.step > this.max) {
              xCirclePosition = this._calculatedSliderWidth;
          } else {
              if (this.min < 0 || this.max < 0) {
                  xCirclePosition = (this.value - this.min) / (this.max - this.min) * this._calculatedSliderWidth;
              } else {
                  xCirclePosition = this.value / this.max * this._calculatedSliderWidth;
              }
          }
          if (this._Circle) {
              this._Circle.patch({
                  mode: this.mode,
                  style: {
                      radius: this.style.radius,
                      w: this.style.w,
                      h: this.style.h,
                      circleColor: this.style.circleColor
                  },
                  y: this._SliderBar.y + 1,
                  alpha: this._isFocusedMode && this.style.showKnob ? 1 : 0
              });
              if (this.style.circleAnimation && Object.keys(this.style.circleAnimation).length) {
                  this._Circle.smooth = {
                      x: [ xCirclePosition, this.style.circleAnimation ]
                  };
              } else {
                  this._Circle.x = xCirclePosition;
              }
          }
      }
      _updateArrowAlpha() {
          var leftAlpha;
          var rightAlpha;
          var offAlpha = .001;
          var alpha = this.style.showArrows ? this.style.arrowAlphaValue : offAlpha;
          var alphaLimit = this.style.showArrows ? this.style.arrowAlphaValueLimit : offAlpha;
          leftAlpha = rightAlpha = alpha;
          if (!this._isDisabledMode && this.value <= this.min) {
              leftAlpha = alphaLimit;
              rightAlpha = alpha;
          } else if (!this._isDisabledMode && this.value >= this.max) {
              leftAlpha = alpha;
              rightAlpha = alphaLimit;
          }
          this._LeftArrow.smooth = {
              alpha: leftAlpha
          };
          this._RightArrow.smooth = {
              alpha: rightAlpha
          };
      }
      _updateArrows() {
          var arrowProps = {
              w: this.style.arrowWidth,
              h: this.style.arrowHeight,
              style: {
                  color: this.style.arrowColor
              }
          };
          this._LeftArrow.patch(_objectSpread(_objectSpread({}, arrowProps), {}, {
              icon: this.style.iconLeftSrc
          }));
          this._RightArrow.patch(_objectSpread(_objectSpread({}, arrowProps), {}, {
              icon: this.style.iconRightSrc
          }));
          this._RightArrow.smooth = {
              x: this.style.arrowSpacing + this._calculatedSliderWidth + this._Bar.x
          };
      }
      _decrementValue() {
          var value = this.value - this.step;
          this.value = value >= this.min ? value : this.min;
          this._updatePositions();
      }
      _incrementValue() {
          var value = this.value + this.step;
          this.value = value <= this.max ? value : this.max;
          this._updatePositions();
      }
      _handleUp() {
          return false;
      }
      _handleDown() {
          return false;
      }
      get _calculatedSliderX() {
          return this.style.showArrows ? this.style.arrowSpacing + this.style.arrowWidth : 0;
      }
      get _calculatedSliderWidth() {
          var totalArrowSize = this.style.showArrows ? this.style.arrowSpacing * 2 + this.style.arrowWidth * 2 : 0;
          return this.w < totalArrowSize + this._circleW ? this.style.minWidth - totalArrowSize : this.w - totalArrowSize;
      }
      get _circleW() {
          return this._Circle ? this._Circle.w : 0;
      }
      _setVertical(vertical) {
          this._setState(vertical ? "VerticalSlider" : "");
          return vertical;
      }
      _setValue(value) {
          this._valueChanged = value !== this._value;
          return value;
      }
      _setMin(min) {
          var value = this.value;
          this.value = min > value ? min : value;
          this._valueChanged = value !== this.value;
          return min;
      }
      _setMax(max) {
          var value = this.value;
          this.value = max < value ? max : value;
          this._valueChanged = value !== this.value;
          return max;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce !== undefined && this._announce !== null) {
              return this._announce;
          }
          return this.value.toString();
      }
      static _states() {
          return [ class VerticalSlider extends(this){
              _handleLeft() {
                  return false;
              }
              _handleRight() {
                  return false;
              }
              _handleUp() {
                  if (this._isDisabledMode) {
                      return false;
                  }
                  this._decrementValue();
                  if (typeof this.onUp === "function") {
                      return this.onUp(this);
                  }
                  return true;
              }
              _handleDown() {
                  if (this._isDisabledMode) {
                      return false;
                  }
                  this._incrementValue();
                  if (typeof this.onDown === "function") {
                      return this.onDown(this);
                  }
                  return true;
              }
          } ];
      }
  }

  var base$a = theme => ({
      paddingY: theme.spacer.md + theme.spacer.xs,
      valueTextStyle: _objectSpread(_objectSpread({}, theme.typography.headline3), {}, {
          maxLines: 1,
          textColor: theme.color.textNeutralSecondary
      })
  });

  var mode$2 = theme => ({
      disabled: {
          valueTextStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      },
      focused: {
          valueTextStyle: {
              textColor: theme.color.textInverseSecondary
          }
      }
  });

  var tone$5 = theme => ({
      neutral: {
          mode: {
              focused: {
                  valueTextStyle: {
                      textColor: theme.color.textInverseSecondary
                  }
              }
          }
      },
      inverse: {
          mode: {
              focused: {
                  valueTextStyle: {
                      textColor: theme.color.textNeutralSecondary
                  }
              }
          }
      },
      brand: {
          mode: {
              focused: {
                  valueTextStyle: {
                      textColor: theme.color.textInverseSecondary
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$a,
      mode: mode$2,
      tone: tone$5
  });

  var base$9 = theme => ({
      arrowAlphaValue: theme.alpha.primary,
      arrowAlphaValueLimit: theme.alpha.secondary,
      arrowWidth: theme.spacer.xxl,
      arrowHeight: theme.spacer.xxl,
      iconLeftSrc: theme.asset.arrowLeft,
      iconRightSrc: theme.asset.arrowRight
  });

  var tone$4 = theme => ({
      neutral: {
          mode: {
              focused: {
                  arrowColor: theme.color.fillInverse
              }
          }
      },
      inverse: {
          mode: {
              focused: {
                  arrowColor: theme.color.fillNeutral
              }
          }
      },
      brand: {
          mode: {
              focused: {
                  arrowColor: theme.color.fillInverse
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$9,
      tone: tone$4
  });

  var base$8 = theme => ({
      textStyle: theme.typography.body2,
      fadeHeight: 100,
      scroll: {
          timingFunction: "linear",
          duration: theme.animation.duration.xfast
      },
      contentMarginTop: theme.spacer.md,
      contentMarginLeft: theme.spacer.xl,
      sliderMarginLeft: theme.spacer.lg + theme.spacer.xxs
  });

  var styles$8 = Object.freeze({
      __proto__: null,
      base: base$8
  });

  var base$7 = theme => {
      var {scroll: scroll} = base$8(theme);
      return {
          progressBar: {
              animation: scroll
          },
          circleAnimation: scroll
      };
  };

  var styles$7 = Object.freeze({
      __proto__: null,
      base: base$7
  });

  class ScrollSlider extends Slider {
      static get __componentName() {
          return "ScrollSlider";
      }
      static get __themeStyle() {
          return styles$7;
      }
  }

  class ScrollWrapper extends Base$1 {
      static get __themeStyle() {
          return styles$8;
      }
      static _template() {
          return {
              clipping: true,
              FadeContainer: {
                  ScrollContainer: {
                      w: _w => _w,
                      wordWrap: true
                  }
              },
              Slider: {
                  type: ScrollSlider,
                  vertical: true,
                  signals: {
                      onSizeChange: "_updateScrollContainerSize"
                  },
                  announce: " "
              }
          };
      }
      static get __componentName() {
          return "ScrollWrapper";
      }
      static get properties() {
          return [ "autoScroll", "autoScrollDelay", "autoScrollSpeed", "content", "fadeContent", "scrollDuration", "scrollStep", "showScrollBar", "shouldWrap", "flexDirection" ];
      }
      static get tags() {
          return [ "FadeContainer", "Slider", {
              name: "ScrollContainer",
              path: "FadeContainer.ScrollContainer"
          }, {
              name: "ScrollableText",
              path: "ScrollContainer.ScrollableText"
          } ];
      }
      _construct() {
          super._construct();
          this._scrollStep = 10;
          this._shouldWrap = false;
          this._flexDirection = "column";
          this._fadeContent = true;
          this._sliderWidth = 0;
      }
      _afterTextBoxUpdate(textBox) {
          if (this._prevW !== textBox.finalW || this._prevH !== textBox.finalH) {
              this._prevW = textBox.finalW;
              this._prevH = textBox.finalH;
              this._updateScrollWrapperLayout();
              this._updateAlpha();
          }
      }
      _resetFlexContainer() {
          this._FadeContainer.patch({
              ScrollContainer: undefined
          });
          this._FadeContainer.patch({
              ScrollContainer: {
                  w: _w2 => _w2,
                  wordWrap: true
              }
          });
      }
      _update() {
          if (this._contentChanged) {
              this._resetFlexContainer();
              this._updateAutoScroll();
          }
          this._updateScrollContainer();
          this._updateScrollWrapperLayout();
          this._updateAlpha();
      }
      _updateAutoScroll() {
          this.resetScroll();
          this._setupAutoScroll();
          this._contentChanged = false;
      }
      _updateScrollWrapperLayout() {
          this._ScrollContainer.patch({
              w: this._contentWidth
          });
          this._updateFadeContainer();
          this._updateSlider();
      }
      _updateAlpha() {
          this._Slider.smooth = {
              alpha: this.showScrollBar && this._isFocusedMode ? 1 : 0
          };
      }
      _updateFadeContainer() {
          var isScrollable = this._ScrollContainer.finalH > this.h;
          var shouldFade = this.fadeContent && isScrollable && !this._isEndContentVisible;
          this._FadeContainer.patch({
              h: this.h,
              w: this._contentWidth,
              y: this.style.contentMarginTop,
              x: this.style.contentMarginLeft,
              rtt: true,
              shader: shouldFade ? {
                  type: Lightning.shaders.FadeOut,
                  bottom: this.style.fadeHeight
              } : undefined
          });
      }
      _scrollContainerLoaded(_ref23) {
          var {h: h} = _ref23;
          this._ScrollContainer.h = h;
          this._updateScrollWrapperLayout();
      }
      _updateScrollContainer() {
          if (!this.content) return;
          if (typeof this.content === "string") {
              this._ScrollContainer.patch({
                  flex: {
                      direction: "column"
                  },
                  ScrollableText: {
                      h: 0,
                      w: this._contentWidth,
                      type: TextBox,
                      content: this.content,
                      style: {
                          textStyle: _objectSpread(_objectSpread({}, this.style.textStyle), {}, {
                              wordWrap: true,
                              wordWrapWidth: this._contentWidth
                          })
                      },
                      signals: {
                          textBoxChanged: "_scrollContainerLoaded"
                      },
                      onAfterUpdate: this._afterTextBoxUpdate.bind(this)
                  }
              });
          } else if (Array.isArray(this.content)) {
              var content = {};
              this.content.forEach(((item, index) => {
                  var id = "ScrollText".concat(index);
                  content[id] = _objectSpread({
                      w: this._contentWidth
                  }, item);
                  if (item.text) {
                      content[id] = {
                          type: TextBox,
                          content: item.text,
                          style: {
                              textStyle: _objectSpread(_objectSpread(_objectSpread({}, this.style.textStyle), item.style), {}, {
                                  wordWrap: true,
                                  wordWrapWidth: this._contentWidth
                              })
                          },
                          onAfterUpdate: this._afterTextBoxUpdate.bind(this)
                      };
                  }
              }));
              this._ScrollContainer.patch(_objectSpread({
                  flex: {
                      direction: this.flexDirection,
                      wrap: this.shouldWrap
                  }
              }, content));
          }
      }
      _scrollDown() {
          var hasContentToScrollTo = this._scrollContainerY + this._ScrollContainer.finalH > this.renderHeight;
          if (hasContentToScrollTo) {
              var targetY = this._scrollContainerY - this.scrollStep;
              var canScrollByStepLength = targetY + this._ScrollContainer.finalH > this.renderHeight;
              var scrollEndY = this.renderHeight - this._ScrollContainer.finalH - this.style.contentMarginTop;
              this._ScrollContainer.patch({
                  smooth: {
                      y: [ canScrollByStepLength ? targetY : scrollEndY, this._scrollAnimation ]
                  }
              });
              var hasScrolledToEnd = this._scrollContainerY + this._ScrollContainer.finalH <= this.h;
              if (hasScrolledToEnd) {
                  this._isEndContentVisible = true;
                  this._autoScrollComplete = true;
                  this.fireAncestors("$scrollChanged", "endDown", this);
                  this._updateFadeContainer();
              }
          } else {
              return false;
          }
      }
      _scrollUp() {
          var canScrollUp = this._scrollContainerY < 0;
          if (canScrollUp) {
              var targetY = this._scrollContainerY + this.scrollStep;
              var canScrollByStepLength = targetY < 0;
              this._ScrollContainer.patch({
                  smooth: {
                      y: [ canScrollByStepLength ? targetY : 0, this._scrollAnimation ]
                  }
              });
              var isScrollable = this._scrollContainerY + this._ScrollContainer.finalH > this.renderHeight;
              if (isScrollable) {
                  this._autoScrollComplete = false;
              }
              if (this._scrollContainerY >= 0) {
                  this.fireAncestors("$scrollChanged", "endUp", this);
              }
              if (this._isEndContentVisible) {
                  this._isEndContentVisible = false;
                  this._updateFadeContainer();
              }
          } else {
              return false;
          }
      }
      resetScroll() {
          this._ScrollContainer.y = 0;
          this._Slider.value = 0;
          this._ScrollContainer.transition("y").finish();
          delete this._ScrollContainer._transitions;
          this._autoScrollComplete = false;
      }
      _setAutoScroll(val) {
          if (this._autoScroll !== val) {
              this._autoScroll = val;
          }
          this._setupAutoScroll();
          return val;
      }
      _setupAutoScroll() {
          clearTimeout(this._startAutoScroll);
          clearTimeout(this._performAutoScrollTimer);
          if (this.autoScroll) {
              this._startAutoScroll = setTimeout((() => this._performAutoScroll()), isNaN(this.autoScrollDelay) ? 2e3 : this.autoScrollDelay);
          }
      }
      _performAutoScroll() {
          if (this.autoScroll && !this._autoScrollComplete) {
              this._Slider._handleDown();
              this._performAutoScrollTimer = setTimeout((() => this._performAutoScroll()), isNaN(this.autoScrollSpeed) ? 200 : this.autoScrollSpeed);
          }
      }
      _setContent(content) {
          if (content !== this._content && this.enabled) {
              this._contentChanged = true;
          }
          return content;
      }
      _updateScrollContainerSize(slider) {
          if (this._sliderWidth !== slider._Container.h) {
              this._sliderWidth = slider._Container.h;
              this._updateScrollContainer();
          }
      }
      _updateSlider() {
          var scrollHeight = Math.max(this._ScrollContainer.finalH - this.renderHeight, 0);
          var contentScrollSteps = scrollHeight > 0 ? Math.ceil(scrollHeight / this.scrollStep) : 1;
          var sliderMax = this.renderHeight;
          var sliderStep = contentScrollSteps > 0 ? sliderMax / contentScrollSteps : sliderMax;
          if (this._Slider) {
              this._Slider.patch({
                  x: this.w - this._sliderWidth,
                  w: sliderMax,
                  min: 0,
                  max: sliderMax,
                  step: sliderStep,
                  onUp: this._scrollUp.bind(this),
                  onDown: this._scrollDown.bind(this)
              });
          }
      }
      get _contentWidth() {
          return this.w - this.style.contentMarginLeft - this.style.sliderMarginLeft - this._sliderWidth;
      }
      get _scrollContainerY() {
          return this._ScrollContainer.transition("y").targetValue;
      }
      get _scrollAnimation() {
          var duration = isNaN(this.scrollDuration) ? this.style.scroll.duration : this.scrollDuration;
          return _objectSpread(_objectSpread({}, this.style.scroll), {}, {
              duration: duration
          });
      }
      _getFocused() {
          return this._Slider;
      }
      set announce(announce) {
          super.announce = announce;
      }
      get announce() {
          if (this._announce) {
              return this._announce;
          }
          if (Array.isArray(this.content)) {
              if (this._ScrollContainer && this._ScrollContainer.children && this._ScrollContainer.children.length) {
                  return this._ScrollContainer.children.map((item => item.announce));
              } else {
                  return this.content.map((item => item.announce || item.text));
              }
          }
          return this.content;
      }
  }

  var base$6 = theme => ({
      alpha: theme.alpha.none,
      animation: theme.animation.standardEntrance,
      blur: theme.spacer.xxl,
      color: theme.color.shadowNeutralFocus,
      offsetX: 0,
      offsetY: theme.spacer.lg,
      radius: theme.radius.md,
      spread: theme.spacer.md * -1,
      maxOffsetY: theme.spacer.xxl,
      maxOffsetX: 0
  });

  var mode$1 = theme => ({
      focused: {
          alpha: theme.alpha.secondary,
          offsetY: theme.spacer.xxl
      }
  });

  var tone$3 = theme => ({
      neutral: {
          color: theme.color.shadowNeutralFocus
      },
      inverse: {
          color: theme.color.shadowInverseFocus
      },
      brand: {
          color: theme.color.shadowBrandFocus
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$6,
      mode: mode$1,
      tone: tone$3
  });

  var base$5 = theme => {
      var size = theme.spacer.xxl;
      return {
          width: size,
          height: size,
          radius: size / 2
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$5
  });

  var base$4 = theme => ({
      tabSpacing: theme.spacer.lg,
      tabsMarginBottom: theme.spacer.xxl
  });

  Object.freeze({
      __proto__: null,
      base: base$4
  });

  var base$3 = theme => ({
      radius: theme.radius.xl,
      paddingX: theme.spacer.xxxl + theme.spacer.xxs,
      paddingY: theme.spacer.md + theme.spacer.xs,
      paddingXNoTitle: theme.spacer.xl,
      iconSize: theme.spacer.xxxl,
      iconMarginRight: theme.spacer.md,
      textStyle: _objectSpread(_objectSpread({}, theme.typography.headline3), {}, {
          textColor: theme.color.textNeutral
      }),
      backgroundColor: theme.color.fillTransparent,
      contentColor: theme.color.fillNeutral
  });

  var mode = theme => ({
      focused: {
          backgroundColor: theme.color.interactiveNeutralFocus,
          contentColor: theme.color.fillInverse,
          textStyle: {
              textColor: theme.color.textInverse
          }
      },
      selected: {
          backgroundColor: theme.color.interactiveNeutralFocusSoft,
          contentColor: theme.color.fillNeutral,
          textStyle: {
              textColor: theme.color.textNeutral
          }
      },
      disabled: {
          backgroundColor: theme.color.fillTransparent,
          contentColor: theme.color.fillNeutralDisabled,
          textStyle: {
              textColor: theme.color.textNeutralDisabled
          }
      }
  });

  var tone$2 = theme => ({
      neutral: {},
      inverse: {
          mode: {
              focused: {
                  contentColor: theme.color.fillNeutral,
                  textStyle: {
                      textColor: theme.color.textNeutral
                  }
              }
          }
      },
      brand: {
          mode: {
              focused: {
                  contentColor: theme.color.fillNeutral,
                  textStyle: {
                      textColor: theme.color.textNeutral
                  }
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$3,
      mode: mode,
      tone: tone$2
  });

  var base$2 = theme => {
      var knobSize = theme.spacer.xl;
      var knobPadding = theme.spacer.xs;
      var strokeWidth = theme.stroke.sm;
      return {
          height: knobSize + (knobPadding + strokeWidth) * 2,
          knobWidth: knobSize,
          knobHeight: knobSize,
          knobRadius: knobSize / 2,
          knobPadding: knobPadding,
          strokeWidth: strokeWidth,
          width: (strokeWidth + knobPadding * 2 + knobSize) * 2
      };
  };

  var tone$1 = theme => ({
      neutral: {
          strokeColor: theme.color.fillNeutral,
          backgroundColor: theme.color.fillInverseTertiary,
          backgroundColorChecked: theme.color.fillNeutral,
          knobColor: theme.color.fillNeutral,
          knobColorChecked: theme.color.fillInverse,
          mode: {
              disabled: {
                  strokeColor: theme.color.fillNeutralDisabled,
                  backgroundColor: theme.color.fillInverseDisabled,
                  backgroundColorChecked: theme.color.fillNeutralDisabled,
                  knobColor: theme.color.fillNeutralDisabled,
                  knobColorChecked: theme.color.fillInverseDisabled
              }
          }
      },
      inverse: {
          strokeColor: theme.color.fillInverse,
          backgroundColor: theme.color.fillNeutralTertiary,
          backgroundColorChecked: theme.color.fillInverse,
          knobColor: theme.color.fillInverse,
          knobColorChecked: theme.color.fillNeutral,
          mode: {
              disabled: {
                  strokeColor: theme.color.fillInverseDisabled,
                  backgroundColor: theme.color.fillNeutralDisabled,
                  backgroundColorChecked: theme.color.fillInverseDisabled,
                  knobColor: theme.color.fillInverseDisabled,
                  knobColorChecked: theme.color.fillNeutralDisabled
              }
          }
      },
      brand: {
          strokeColor: theme.color.fillBrand,
          backgroundColor: theme.color.fillBrandTertiary,
          backgroundColorChecked: theme.color.fillBrand,
          knobColor: theme.color.fillBrand,
          knobColorChecked: theme.color.fillInverse,
          mode: {
              disabled: {
                  strokeColor: theme.color.fillNeutralDisabled,
                  backgroundColor: theme.color.fillInverseDisabled,
                  backgroundColorChecked: theme.color.fillNeutralDisabled,
                  knobColor: theme.color.fillNeutralDisabled,
                  knobColorChecked: theme.color.fillInverseDisabled
              }
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base$2,
      tone: tone$1
  });

  var base$1 = theme => {
      var knobSize = theme.spacer.lg;
      var knobPadding = theme.spacer.xxs;
      var strokeWidth = theme.stroke.sm;
      return {
          height: knobSize + (knobPadding + strokeWidth) * 2,
          knobWidth: knobSize,
          knobHeight: knobSize,
          knobRadius: knobSize / 2,
          knobPadding: knobPadding,
          strokeWidth: strokeWidth,
          width: (strokeWidth + knobPadding * 2 + knobSize) * 2
      };
  };

  Object.freeze({
      __proto__: null,
      base: base$1
  });

  class Bubble extends Lightning.Texture {
      constructor(stage) {
          super(stage);
          this._w = 0;
          this._h = 0;
          this._radius = 0;
          this._pointerWidth = 0;
          this._pointerHeight = 0;
          this._strokeWidth = 0;
          this._color = "white";
      }
      set w(w) {
          this._w = w;
          this._changed();
      }
      get w() {
          return this._w;
      }
      set h(h) {
          this._h = h;
          this._changed();
      }
      get h() {
          return this._h;
      }
      set radius(radius) {
          if (Array.isArray(radius)) {
              this._radius = new Array(4).fill().map(((_, index) => radius[index] || 0));
          } else {
              this._radius = radius;
          }
          this._changed();
      }
      get radius() {
          return this._radius;
      }
      set pointerWidth(pointerWidth) {
          this._pointerWidth = pointerWidth;
          this._changed();
      }
      get pointerWidth() {
          return this._pointerWidth;
      }
      set pointerHeight(pointerHeight) {
          this._pointerHeight = pointerHeight;
          this._changed();
      }
      get pointerHeight() {
          return this._pointerHeight;
      }
      set strokeWidth(strokeWidth) {
          this._strokeWidth = strokeWidth;
          this._changed();
      }
      get strokeWidth() {
          return this._strokeWidth;
      }
      set color(color) {
          this._color = Lightning.StageUtils.getRgbaString(color);
          this._changed();
      }
      get color() {
          return this._color;
      }
      createBubble(_ref24) {
          var {stage: stage, w: w = 0, h: h = 0, radius: radius = 0, pointerWidth: pointerWidth = 0, pointerHeight: pointerHeight = 0, strokeWidth: strokeWidth = 1, color: color = "white"} = _ref24;
          var canvas = stage.platform.getDrawingCanvas();
          var ctx = canvas.getContext("2d");
          canvas.width = w + strokeWidth + 4;
          canvas.height = h + strokeWidth + 4;
          ctx.imageSmoothingEnabled = true;
          ctx.fillStyle = color;
          ctx.strokeStyle = color;
          ctx.lineWidth = strokeWidth;
          ctx.lineCap = "round";
          ctx.lineJoin = "round";
          var initialCoord = .5 * strokeWidth + 1;
          var leftX = initialCoord;
          var rightX = leftX + w;
          var topY = initialCoord;
          var bottomY = topY + h;
          var bottomBubbleY = bottomY - pointerHeight;
          var isRadiusAnArray = Array.isArray(radius);
          ctx.beginPath();
          ctx.moveTo(leftX + (isRadiusAnArray ? radius[0] : radius), topY);
          ctx.lineTo(rightX - (isRadiusAnArray ? radius[0] : radius), topY);
          ctx.arcTo(rightX, topY, rightX, topY + (isRadiusAnArray ? radius[1] : radius), isRadiusAnArray ? radius[1] : radius);
          ctx.lineTo(rightX, bottomBubbleY - (isRadiusAnArray ? radius[2] : radius));
          ctx.arcTo(rightX, bottomBubbleY, rightX - (isRadiusAnArray ? radius[2] : radius), bottomBubbleY, isRadiusAnArray ? radius[2] : radius);
          ctx.lineTo(w / 2 + pointerWidth / 2, bottomBubbleY);
          ctx.arcTo(w / 2, bottomY, w / 2 - pointerWidth / 2, bottomBubbleY, 2);
          ctx.lineTo(w / 2 - pointerWidth / 2, bottomBubbleY);
          ctx.lineTo(leftX + (isRadiusAnArray ? radius[3] : radius), bottomBubbleY);
          ctx.arcTo(leftX, bottomBubbleY, leftX, bottomBubbleY - (isRadiusAnArray ? radius[3] : radius), isRadiusAnArray ? radius[3] : radius);
          ctx.lineTo(leftX, topY + (isRadiusAnArray ? radius[0] : radius));
          ctx.arcTo(leftX, topY, leftX + (isRadiusAnArray ? radius[0] : radius), topY, isRadiusAnArray ? radius[0] : radius);
          ctx.stroke();
          ctx.fill();
          return canvas;
      }
      _getLookupId() {
          var {w: w, h: h, radius: radius, pointerWidth: pointerWidth, pointerHeight: pointerHeight, color: color} = this;
          return "__bubble_".concat(w, "x").concat(h, "_radius-").concat(radius, "_pointer-").concat(pointerWidth, "x").concat(pointerHeight, "_fill-").concat(color);
      }
      _getSourceLoader() {
          return cb => {
              cb(null, {
                  source: this.createBubble(this)
              });
          };
      }
  }

  var base = theme => ({
      marginBottom: theme.spacer.xl,
      paddingX: theme.spacer.lg,
      paddingY: theme.spacer.md,
      pointerWidth: theme.spacer.xxl,
      pointerHeight: theme.spacer.lg,
      radius: theme.radius.sm,
      textStyle: _objectSpread(_objectSpread({}, theme.typography.body3), {}, {
          textColor: theme.color.textInverse
      }),
      transition: theme.animation.utility
  });

  var tone = theme => ({
      neutral: {
          backgroundColor: theme.color.fillNeutral,
          textStyle: {
              textColor: theme.color.textInverse
          }
      },
      inverse: {
          backgroundColor: theme.color.fillInverse,
          textStyle: {
              textColor: theme.color.textNeutral
          }
      },
      brand: {
          backgroundColor: theme.color.fillBrand,
          textStyle: {
              textColor: theme.color.textNeutral
          }
      }
  });

  Object.freeze({
      __proto__: null,
      base: base,
      tone: tone
  });

  var defaultAbbreviations = [ {
      pattern: "TV-14",
      replacer: "Rated TV-14"
  }, {
      pattern: "CC",
      replacer: "Closed Captions available"
  }, {
      pattern: "HD",
      replacer: "High Definition available"
  }, {
      pattern: /ENG(?!\+)/,
      replacer: "English Available"
  }, {
      pattern: /ENG\+ES/,
      replacer: "Available in English and Spanish"
  }, {
      pattern: "AD",
      replacer: "Audio Description available"
  }, {
      pattern: "RT",
      replacer: "Rotten Tomatoes"
  }, {
      pattern: /(S)+(\d+)+(E)+(\d+)+/,
      replacer: (match, p1, p2, p3, p4) => "Season ".concat(p2, " Episode ").concat(p4)
  } ];

  generateAbbrevConfig(defaultAbbreviations);

  function wrapWithBoundary(str) {
      return "\\b".concat(str, "\\b");
  }

  function getNumberOfCaptureGroups(regExp) {
      return new RegExp(regExp.toString() + "|").exec("").length - 1;
  }

  function generateAbbrevConfig() {
      var abbreviations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultAbbreviations;
      var extendDefault = arguments.length > 1 ? arguments[1] : undefined;
      var abbrev = extendDefault ? [ ...defaultAbbreviations, ...abbreviations ] : abbreviations;
      var stringPatternMap = {};
      var regExpPatternMap = {};
      var abbreviationsPattern = "";
      var patternGroupOffset = 0;
      abbrev.forEach(((_ref27, idx) => {
          var {pattern: pattern, replacer: replacer} = _ref27;
          var stringPattern;
          if (pattern instanceof RegExp) {
              var patternMapIdx = idx + patternGroupOffset;
              regExpPatternMap[patternMapIdx] = {
                  pattern: pattern,
                  replacer: replacer
              };
              stringPattern = wrapWithBoundary(pattern.source);
              patternGroupOffset += getNumberOfCaptureGroups(pattern);
          } else {
              stringPatternMap[pattern] = {
                  replacer: replacer
              };
              stringPattern = wrapWithBoundary(pattern);
          }
          abbreviationsPattern = abbreviationsPattern === "" ? "(".concat(stringPattern, ")") : "".concat(abbreviationsPattern, "|(").concat(stringPattern, ")");
      }));
      abbreviationsPattern = new RegExp(abbreviationsPattern, "g");
      return {
          abbreviationsPattern: abbreviationsPattern,
          stringPatternMap: stringPatternMap,
          regExpPatternMap: regExpPatternMap
      };
  }

  var rad = deg => deg * Math.PI / 180;

  var deg = rad => rad * 180 / Math.PI;

  var getBreakpoints = (width, height) => {
      var a = height / 2;
      var b = width / 2;
      var c = Math.sqrt(Math.pow(a, 2) + Math.pow(b, 2));
      var C = 90;
      var A = Math.ceil(deg(Math.asin(a * Math.sin(rad(C)) / c)));
      var B = 180 - C - A;
      return [ B, 90, 90 + A, 180, 180 + B, 270, 270 + A, 360 ];
  };

  var points = (degrees, width, height) => {
      var breakAngles = getBreakpoints(width, height);
      var breakIndex = breakAngles.findIndex((angle => angle >= degrees));
      var b = height / 2;
      var max = width / 2;
      if ([ 1, 2, 5, 6 ].includes(breakIndex)) {
          b = width / 2;
          max = height / 2;
      }
      if ([ 2, 4, 6 ].includes(breakIndex)) {
          degrees = degrees - breakAngles[breakIndex - 1];
      } else if (breakIndex > 0) {
          degrees = breakAngles[breakIndex] - degrees;
      }
      var A = degrees;
      var B = 90 - A;
      var a = Math.ceil(Math.sin(rad(A)) * b / Math.sin(rad(B)));
      if (a > max) {
          a = max;
      }
      var x0 = 0;
      var y0 = 0;
      var x1 = 0;
      var y1 = 0;
      switch (breakIndex) {
        case 0:
          x0 = width / 2 + a;
          break;

        case 1:
          x0 = width;
          y0 = height / 2 - a;
          break;

        case 2:
          x0 = width;
          y0 = height / 2 + a;
          break;

        case 3:
          x0 = width / 2 + a;
          y0 = height;
          break;

        case 4:
          x0 = width / 2 - a;
          y0 = height;
          break;

        case 5:
          y0 = height / 2 + a;
          break;

        case 6:
          y0 = height / 2 - a;
          break;

        case 7:
          x0 = width / 2 - a;
          break;
      }
      if (x0 == 0) {
          x1 = width;
          y1 = height - y0;
      }
      if (y0 == 0) {
          y1 = height;
          x1 = width - x0;
      }
      if (x0 == width) {
          x1 = 0;
          y1 = height - y0;
      }
      if (y0 == height) {
          y1 = 0;
          x1 = width - x0;
      }
      return {
          x0: x0,
          y0: y0,
          x1: x1,
          y1: y1
      };
  };

  class LinearGradient extends Lightning.Texture {
      constructor(stage) {
          super(stage);
          this._w = 0;
          this._h = 0;
          this._steps = [];
          this._degrees = 0;
      }
      get w() {
          return this._w;
      }
      set w(w) {
          this._w = w;
          this._changed();
      }
      get h() {
          return this._h;
      }
      set h(h) {
          this._h = h;
          this._changed();
      }
      get steps() {
          return this._steps;
      }
      set steps(steps) {
          this._steps = steps;
          this._changed();
      }
      get degrees() {
          return this._degrees;
      }
      set degrees(degrees) {
          this._degrees = degrees;
          this._changed();
      }
      _getLookupId() {
          return "__linearGradient_".concat(this._h, "_").concat(this._w, "_").concat(this._steps.count, "_").concat(this._degrees);
      }
      _getSourceLoader() {
          var w = this._w;
          var h = this._h;
          var d = this._degrees;
          var p = points(d, w, h);
          var {x0: x0, y0: y0, x1: x1, y1: y1} = p;
          var steps = this._steps;
          var strokeWidth = this.strokeWidth;
          var strokeRadius = this.strokeRadius ? Array.isArray(this.strokeRadius) && this.strokeRadius.length === 4 ? this.strokeRadius : Array(4).fill(this.strokeRadius) : Array(4).fill(0);
          return function(cb) {
              var canvas = this.stage.platform.getDrawingCanvas();
              canvas.width = w + strokeWidth + 2;
              canvas.height = h + strokeWidth + 2;
              var ctx = canvas.getContext("2d");
              var gradient = ctx.createLinearGradient(x0, y0, x1, y1);
              steps.forEach((step => {
                  gradient.addColorStop(step.percent, step.color);
              }));
              if (strokeWidth) {
                  var x = .5 * strokeWidth + 1, y = .5 * strokeWidth + 1;
                  ctx.beginPath();
                  ctx.moveTo(x + strokeRadius[0], y);
                  ctx.lineTo(x + w - strokeRadius[1], y);
                  ctx.arcTo(x + w, y, x + w, y + strokeRadius[1], strokeRadius[1]);
                  ctx.lineTo(x + w, y + h - strokeRadius[2]);
                  ctx.arcTo(x + w, y + h, x + w - strokeRadius[2], y + h, strokeRadius[2]);
                  ctx.lineTo(x + strokeRadius[3], y + h);
                  ctx.arcTo(x, y + h, x, y + h - strokeRadius[3], strokeRadius[3]);
                  ctx.lineTo(x, y + strokeRadius[0]);
                  ctx.arcTo(x, y, x + strokeRadius[0], y, strokeRadius[0]);
                  ctx.closePath();
                  ctx.lineWidth = strokeWidth;
                  ctx.strokeStyle = gradient;
                  ctx.stroke();
              } else {
                  ctx.fillStyle = gradient;
                  ctx.fillRect(0, 0, w, h);
              }
              cb(null, {
                  source: canvas,
                  w: w,
                  h: h
              });
          };
      }
  }

  class Circle extends Lightning.Texture {
      constructor(stage) {
          super(stage);
          this._color = "rgb(0,0,0)";
          this._fill = true;
          this._radius = 100;
          this._stroke = false;
          this._strokeColor = "rgb(0,0,0)";
          this._strokeWidth = 1;
      }
      get fill() {
          return this._fill;
      }
      set fill(fill) {
          this._fill = fill;
          this._changed();
      }
      get radius() {
          return this._radius;
      }
      set radius(radius) {
          this._radius = radius;
          this._changed();
      }
      get color() {
          return this._color;
      }
      set color(color) {
          this._color = color;
          this._changed();
      }
      get stroke() {
          return this._stroke;
      }
      set stroke(stroke) {
          this._stroke = stroke;
          this._changed();
      }
      get strokeWidth() {
          return this._strokeWidth;
      }
      set strokeWidth(strokeWidth) {
          this._strokeWidth = strokeWidth;
          this._changed();
      }
      get strokeColor() {
          return this._strokeColor;
      }
      set strokeColor(strokeColor) {
          this._strokeColor = strokeColor;
          this._changed();
      }
      _getLookupId() {
          return "__circle_".concat(this._radius);
      }
      _getSourceLoader() {
          var color = this._color;
          var fill = this._fill;
          var radius = this._radius;
          var stroke = this._stroke;
          var strokeColor = this._strokeColor;
          var strokeWidth = this._strokeWidth;
          var canvas = this.stage.platform.getDrawingCanvas();
          var dimension = radius;
          if (stroke) {
              dimension = radius + strokeWidth * 2;
          }
          canvas.width = dimension * 2;
          canvas.height = dimension * 2;
          return function(cb) {
              var ctx = canvas.getContext("2d");
              ctx.lineWidth = strokeWidth;
              ctx.strokeStyle = strokeColor;
              ctx.fillStyle = color;
              ctx.beginPath();
              ctx.arc(dimension, dimension, radius, 0, 2 * Math.PI);
              if (fill) {
                  ctx.fill();
              }
              if (stroke) {
                  ctx.stroke();
              }
              cb(null, {
                  source: canvas,
                  radius: radius
              });
          };
      }
  }

  class Arrow extends Lightning.Texture {
      constructor(stage) {
          super(stage);
          this._color = "rgb(13, 13, 15)";
          this._w = 0;
          this._h = 0;
          this._direction = "right";
      }
      get w() {
          return this._w;
      }
      set w(l) {
          this._w = l;
          this._changed();
      }
      get h() {
          return this._h;
      }
      set h(l) {
          this._h = l;
          this._changed();
      }
      get direction() {
          return this._direction;
      }
      get color() {
          return this._color;
      }
      set color(color) {
          this._color = color;
          this._changed();
      }
      set direction(direction) {
          this._direction = direction;
          this._changed();
      }
      _getLookupId() {
          return "__triangle_".concat(this._direction, "_").concat(this._w, "x").concat(this._h);
      }
      _getSourceLoader() {
          var color = this._color;
          var w = this._w;
          var h = this._h;
          var direction = this._direction;
          var canvas = this.stage.platform.getDrawingCanvas();
          return function(cb) {
              var ctx = canvas.getContext("2d");
              canvas.width = w;
              canvas.height = h;
              ctx.fillStyle = color;
              ctx.strokeStyle = ctx.fillStyle;
              ctx.lineWidth = 2;
              ctx.lineCap = "round";
              ctx.lineJoin = "round";
              var p = ctx.lineWidth / 2;
              ctx.beginPath();
              if (direction === "right") {
                  ctx.moveTo(p, p);
                  ctx.lineTo(p, h - p);
                  ctx.lineTo(w - p, h / 2);
              } else if (direction === "down") {
                  ctx.moveTo(p, p);
                  ctx.lineTo(w - p, p);
                  ctx.lineTo(w / 2, h - p);
              } else {
                  ctx.moveTo(p, h / 2);
                  ctx.lineTo(w - p, p);
                  ctx.lineTo(w - p, h - p);
              }
              ctx.closePath();
              ctx.stroke();
              ctx.fill();
              cb(null, {
                  source: canvas,
                  w: w,
                  h: h,
                  direction: direction
              });
          };
      }
  }

  class Line extends Lightning.Texture {
      constructor(stage) {
          super(stage);
          this._w = 0;
          this._h = 0;
          this._rounded = false;
      }
      get w() {
          return this._w;
      }
      set w(l) {
          this._w = l;
          this._changed();
      }
      get h() {
          return this._h;
      }
      set h(l) {
          this._h = l;
          this._changed();
      }
      get rounded() {
          return this._rounded;
      }
      set rounded(rounded) {
          this._rounded = rounded;
          this._changed();
      }
      _getLookupId() {
          return "__line_".concat(this._w, "x").concat(this._h).concat(this._rounded ? "_rounded" : "");
      }
      _getSourceLoader() {
          var w = this._w;
          var h = this._h;
          var rounded = this._rounded;
          var canvas = this.stage.platform.getDrawingCanvas();
          return function(cb) {
              var ctx = canvas.getContext("2d");
              canvas.width = w;
              canvas.height = h;
              ctx.lineWidth = h;
              if (rounded) {
                  ctx.lineCap = "round";
              }
              ctx.strokeStyle = "white";
              ctx.beginPath();
              ctx.moveTo(rounded ? 2 : 0, h / 2);
              ctx.lineTo(rounded ? w - 2 : w, h / 2);
              ctx.stroke();
              cb(null, {
                  source: canvas,
                  w: w,
                  h: h,
                  rounded: rounded
              });
          };
      }
  }

  class Details extends Lightning.Component {
    static _template() {
      return {
        TopGradient: {
          zIndex: 2,
          //This sets the stacking order of the element, determining its position in the z-axis (higher values are on top).
          w: 620,
          h: App$1.height,
          rect: true,
          color: colors.background
        },
        LeftToRightGradient: {
          zIndex: 2,
          //Same z-index as TopGradient.
          x: 620,
          w: 800,
          h: App$1.height,
          rect: true,
          colorRight: colors.detailGradientBg,
          colorLeft: colors.background
        },
        BannerImage: {
          zIndex: 1,
          //Lower stacking order compared to gradients.
          w: App$1.width,
          h: App$1.height
        },
        ContentContainer: {
          x: 176,
          y: 0,
          h: 570,
          zIndex: 5,
          //Highest stacking order.
          //(flex: Defines the flexbox layout.column - The direction of the layout.flex-end - Aligns children to the end of the container.)
          flex: {
            direction: 'column',
            justifyContent: 'flex-end'
          },
          Title: {
            text: {
              fontSize: fontsizes.detailsPageTitle,
              textColor: colors.fontColor,
              wordWrapWidth: 1150,
              //Maximum width before wrapping the text.
              maxLines: 1,
              //Maximum number of lines.
              maxLinesSuffix: '...',
              //Suffix for truncated text.
              fontFace: 'Bold'
            },
            //flexItem: Defines flex item properties. mareginBottom - Space below the element
            flexItem: {
              marginBottom: 20
            }
          },
          TitleEN: {
            text: {
              //Similar to Title but with a different font size (40).
              fontSize: 40,
              textColor: colors.fontColor,
              wordWrapWidth: 1150,
              maxLines: 1,
              maxLinesSuffix: '...',
              fontFace: 'Bold'
            },
            flexItem: {
              marginBottom: 20
            }
          },
          TagsData: {
            type: InlineContent,
            //
            justify: 'flex-start',
            //Justifies content to the start.
            content: [],
            //Empty array for content.
            customStyleMappings: {
              //Defines custom styles
              textStyle: {
                //Sets various text properties.
                fontSize: fontsizes.seriesPageMetadata,
                textColor: colors.fontColor,
                textAlign: 'left',
                fontFace: 'Regular'
              }
            },
            //Defines flex item properties
            flexItem: {
              marginBottom: 30
            }
          },
          Description: {
            //Defines text properties
            text: {
              fontSize: fontsizes.seriesPageMetadata,
              textColor: colors.fontColor,
              wordWrapWidth: 750,
              //Maximum width before wrapping.
              lineHeight: 30,
              fontFace: 'Regular',
              maxLines: 3,
              maxLinesSuffix: '...'
            },
            flexItem: {
              marginBottom: 10
            }
          },
          Starring: {
            //Similar to Description but with wordWrapWidth of 610 and different properties.
            text: {
              fontSize: fontsizes.seriesPageMetadata,
              textColor: colors.fontColor,
              wordWrapWidth: 610,
              fontFace: 'Regular',
              maxLines: 1,
              maxLinesSuffix: '...'
            },
            flexItem: {
              marginBottom: 10
            } //Space below the element (for Starring only).
          },
          Director: {
            //Similar to Description but with wordWrapWidth of 610 and different properties.
            text: {
              fontSize: fontsizes.seriesPageMetadata,
              textColor: colors.fontColor,
              wordWrapWidth: 610,
              fontFace: 'Regular',
              maxLines: 1,
              maxLinesSuffix: '...'
            }
          }
        },
        //Signal to handle focus suggestions.
        signals: {
          focusSuggestions: '_focusSuggestions'
        }
      };
    }
    _focus() {
      this.patch({
        alpha: 1
      });
    }
    _active() {
      this.widgets.loader.alpha = 0;
      Router.focusWidget('ButtonsList');
    }
    prepareData(videoId) {
      const detailsResponse = getVideoDetails(videoId);
      this.patchingDataToTemplate(detailsResponse);
    }
    patchingDataToTemplate(contentMetaData) {
      this.widgets.loader.alpha = 0;
      if (categories$1 && !this.widgets.menu.categories) {
        this.widgets.menu.data = categories$1;
        this.widgets.iconmenu.data = categories$1;
        this.widgets.menu.alpha = 0;
        if (Storage.get(activeCategory)) {
          this.widgets.menu.activeIndex = Storage.get(activeCategory);
          this.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
        }
      }
      const tagsData = contentMetaData.tags || '';
      this.patch({
        BannerImage: {
          src: Utils.asset(contentImagesFolder + contentMetaData.banner_image)
        },
        ContentContainer: {
          Title: {
            visible: true,
            text: {
              text: contentMetaData.title
            }
          },
          TitleEN: {
            visible: !!contentMetaData.title_en,
            text: {
              text: contentMetaData.title_en || ''
            }
          },
          TagsData: {
            content: [{
              text: contentMetaData.publish_time,
              style: 'textStyle'
            }, {
              text: " |  ".concat(tagsData),
              style: 'textStyle'
            }]
          },
          Description: {
            visible: !!contentMetaData.description,
            text: {
              text: contentMetaData.description || ''
            }
          },
          Starring: {
            visible: !!contentMetaData.cast,
            text: {
              text: contentMetaData.cast || ''
            }
          },
          Director: {
            visible: !!contentMetaData.director,
            text: {
              text: contentMetaData.director || ''
            }
          }
        }
      });
      this.buttonsData = getButtons();
      this.widgets.buttonslist.data = [this.buttonsData, contentMetaData];
      this.widgets.detailsbtns.data = {
        buttonData: [{
          label: Language.translate('back_button_text'),
          iconImage: backIcon
        }]
      };
      Router.getActiveHash().includes('details') && Router.focusWidget('ButtonsList');
    }
    _getFocused() {
      Router.focusWidget('ButtonsList');
    }
    _handleBack() {
      Router.back();
    }
  }

  var Dash$1 = {exports: {}};

  (function(module,exports){!function(e,t){module.exports=t();}(self,()=>(()=>{var e={4593:(e,t)=>{var n,r,i,o,u,l=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r));}return t;},c=function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r));}return t.join("");},f={};n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=function(e){for(var t=0,r=[],i=0|e.length/3;0<i--;){var a=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,r.push(n.charAt(63&a>>18)),r.push(n.charAt(63&a>>12)),r.push(n.charAt(63&a>>6)),r.push(n.charAt(63&a));}return 2==e.length-t?(a=(e[t]<<16)+(e[t+1]<<8),r.push(n.charAt(63&a>>18)),r.push(n.charAt(63&a>>12)),r.push(n.charAt(63&a>>6)),r.push("=")):1==e.length-t&&(a=e[t]<<16,r.push(n.charAt(63&a>>18)),r.push(n.charAt(63&a>>12)),r.push("==")),r.join("");},i=function(){for(var e=[],t=0;t<n.length;++t)e[n.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e;}(),o=function(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var a=(i[e.charCodeAt(t)]<<18)+(i[e.charCodeAt(t+1)]<<12)+(i[e.charCodeAt(t+2)]<<6)+i[e.charCodeAt(t+3)];n.push(255&a>>16),n.push(255&a>>8),n.push(255&a),t+=4;}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n;},u={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t;},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("");}},f.decodeArray=function(e){var t=o(e);return new Uint8Array(t);},f.encodeASCII=function(e){var t=u.encode(e);return r(t);},f.decodeASCII=function(e){var t=o(e);return u.decode(t);},f.encode=function(e){var t=l(e);return r(t);},f.decode=function(e){var t=o(e);return c(t);},t.decode=f.decode,t.decodeArray=f.decodeArray,t.encode=f.encode,t.encodeASCII=f.encodeASCII;},452:(e,t)=>{!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n);},r=15,i=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e;},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t);}},f=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t;},d=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1;};d.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1;},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r]);}},isDefault:function(){return "white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash;},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash;},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash;},toString:function(){return "color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash;}};var g=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new d(t,n,r,i,a);};g.prototype={reset:function(){this.uchar=" ",this.penState.reset();},setChar:function(e,t){this.uchar=e,this.penState.copy(t);},setPenState:function(e){this.penState.copy(e);},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState);},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState);},isEmpty:function(){return " "===this.uchar&&this.penState.isDefault();}};var h=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new g());this.pos=0,this.currPenState=new d();};h.prototype={equals:function(e){for(var t=!0,n=0;n<i;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break;}return t;},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t]);},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break;}return e;},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=i);},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t);},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState);},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=i?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1));},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset();},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset();},clearToEndOfRow:function(){this.clearFromPos(this.pos);},getTextString:function(){for(var e=[],t=!0,n=0;n<i;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r);}return t?"":e.join("");},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState);}};var p=function(){this.rows=[];for(var e=0;e<r;e++)this.rows.push(new h());this.currRow=14,this.nrRollUpRows=null,this.reset();};p.prototype={reset:function(){for(var e=0;e<r;e++)this.rows[e].clear();this.currRow=14;},equals:function(e){for(var t=!0,n=0;n<r;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break;}return t;},copy:function(e){for(var t=0;t<r;t++)this.rows[t].copy(e.rows[t]);},isEmpty:function(){for(var e=!0,t=0;t<r;t++)if(!this.rows[t].isEmpty()){e=!1;break;}return e;},backSpace:function(){this.rows[this.currRow].backSpace();},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow();},insertChar:function(e){this.rows[this.currRow].insertChar(e);},setPen:function(e){this.rows[this.currRow].setPenStyles(e);},moveCursor:function(e){this.rows[this.currRow].moveCursor(e);},setCursor:function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e);},setPAC:function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground;}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a);},setBkgData:function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32);},setRollUpRows:function(e){this.nrRollUpRows=e;},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up");}else c.log("DEBUG","roll_up but nrRollUpRows not set yet");},getDisplayText:function(e){e=e||!1;for(var t=[],n="",i=-1,a=0;a<r;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+': "'+o+'"'):t.push(o.trim()));}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n;},getTextAndFormat:function(){return this.rows;}};var m=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new p(),this.nonDisplayedMemory=new p(),this.lastOutputScreen=new p(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null;};m.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null;},getHandler:function(){return this.outputFilter;},setHandler:function(e){this.outputFilter=e;},setPAC:function(e){this.writeScreen.setPAC(e);},setBkgData:function(e){this.writeScreen.setBkgData(e);},setMode:function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e);},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate());},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON");},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate());},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate();},cc_RU:function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e);},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0});},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON");},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT");},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT");},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate();},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate();},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset();},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText());}this.outputDataUpdate();},cc_TO:function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e);},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else {var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n];}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t);},outputDataUpdate:function(){var e=c.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory));},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e));}};var y=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new m(1,t),new m(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0};};y.prototype={getHandler:function(e){return this.channels[e].getHandler();},setHandler:function(e,t){this.channels[e].setHandler(t);},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,c.setTime(e);for(var o=0;o<t.length;o+=2)r=127&t[o],i=127&t[o+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+f([r,i])+") is dropped")):0!==r||0!==i?(c.log("DATA","["+f([t[o],t[o+1]])+"] -> ("+f([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),n||(a=this.parseChars(r,i))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):c.log("WARNING","No channel found yet. TEXT-MODE?")),n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+f([r,i])+" orig: "+f([t[o],t[o+1]])))):this.dataCounters.padding+=2;},parseCmd:function(e,t){var n;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return !1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0;},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),c.log("DEBUG","MIDROW ("+f([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0;}return !1;},parsePAC:function(e,t){var n,r;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return !1;n=e<=23?1:2,r=64<=t&&t<=95?1===n?a[e]:s[e]:1===n?o[e]:u[e];var i=this.interpretPAC(r,t);return this.channels[n-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0;},interpretPAC:function(e,t){var n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r;},parseChars:function(e,t){var r=null,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),17<=a&&a<=19){var o;o=17===a?t+80:18===a?t+112:t+144,c.log("INFO","Special char '"+n(o)+"' in channel "+r),i=[o],this.lastCmdA=e,this.lastCmdB=t;}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(i){var s=f(i);c.log("DEBUG","Char codes =  "+s.join(","));}return i;},parseBackgroundAttributes:function(e,t){var n,r,i;return ((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=l[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0);},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null;},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e);}},e.logger=c,e.PenState=d,e.CaptionScreen=p,e.Cea608Parser=y,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[],o=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s;};i<t+n;){if(r=e.getUint32(i),6==(31&e.getUint8(i+4)))for(var s=i+5,u=-1;s<i+4+r-1;){u=0;for(var l=255;255===l;)u+=l=e.getUint8(s),s++;var c=0;for(l=255;255===l;)c+=l=e.getUint8(s),s++;o(u,c,e,s)&&a.push([s,c]),s+=c;}i+=r+4;}return a;},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&l)+(127&c)!=0&&(0===u?(r[0].push(l),r[0].push(c)):1===u&&(r[1].push(l),r[1].push(c)));}return r;};}(t);},8416:(e,t,n)=>{var r=n(7688),i=n(5448),a=n(6398),o=n(2032),s=(n(5530),"undefined"!=typeof window&&window||n.g),u=s.dashjs;u||(u=s.dashjs={}),u.MediaPlayer=r.Z,u.FactoryMaker=i.Z,u.Debug=a.Z,u.Version=(0, o.e)();},6398:(e,t,n)=>{n.d(t,{Z:()=>g});var r=n(5595),i=n(8512),a=n(5448),o=1,s=2,u=3,l=4,c=5;function f(e){e=e||{};var t,n,a,f,d=this.context,g=(0, r.Z)(d).getInstance(),h=e.settings,p=[];function m(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console);}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[o,this].concat(t));}function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[s,this].concat(t));}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[u,this].concat(t));}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[l,this].concat(t));}function T(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[c,this].concat(t));}function S(e,t){var r="",o=null;n&&(o=new Date().getTime(),r+="["+(o-f)+"]"),a&&t&&t.getClassName&&(r+="["+t.getClassName()+"]",t.getType&&(r+="["+t.getType()+"]")),r.length>0&&(r+=" ");for(var s=arguments.length,u=new Array(s>2?s-2:0),l=2;l<s;l++)u[l-2]=arguments[l];Array.apply(null,u).forEach(function(e){r+=e+" ";}),p[e]&&h&&h.get().debug.logLevel>=e&&p[e](r),h&&h.get().debug.dispatchEvent&&g.trigger(i.Z.LOG,{message:r,level:e});}return t={getLogger:function(e){return {fatal:y.bind(e),error:E.bind(e),warn:v.bind(e),info:_.bind(e),debug:T.bind(e)};},setLogTimestampVisible:function(e){n=e;},setCalleeNameVisible:function(e){a=e;}},n=!0,a=!0,f=new Date().getTime(),"undefined"!=typeof window&&window.console&&(p[o]=m(window.console.error),p[s]=m(window.console.error),p[u]=m(window.console.warn),p[l]=m(window.console.info),p[c]=m(window.console.debug)),t;}f.__dashjs_factory_name="Debug";var d=a.Z.getSingletonFactory(f);d.LOG_LEVEL_NONE=0,d.LOG_LEVEL_FATAL=o,d.LOG_LEVEL_ERROR=s,d.LOG_LEVEL_WARNING=u,d.LOG_LEVEL_INFO=l,d.LOG_LEVEL_DEBUG=c,a.Z.updateSingletonFactory(f.__dashjs_factory_name,d);const g=d;},5595:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i=n(8825);function a(){var e={};function t(t,n,r){var i=-1;return e[t]?(e[t].some(function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0;}),i):i;}var n={on:function(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);var o=a.priority||0;if(!(t(n,r,i)>=0)){e[n]=e[n]||[];var s={callback:r,scope:i,priority:o};i&&i.getStreamId&&(s.streamId=i.getStreamId()),i&&i.getType&&(s.mediaType=i.getType()),a&&a.mode&&(s.mode=a.mode);var u=e[n].some(function(t,r){if(t&&o>t.priority)return e[n].splice(r,0,s),!0;});u||e[n].push(s);}},off:function(n,r,i){if(n&&r&&e[n]){var a=t(n,r,i);a<0||(e[n][a]=null);}},trigger:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,r.streamId&&(n.streamId=r.streamId),r.mediaType&&(n.mediaType=r.mediaType),e[t].filter(function(e){return !(!e||r.streamId&&e.streamId&&e.streamId!==r.streamId||r.mediaType&&e.mediaType&&e.mediaType!==r.mediaType||r.mode&&e.mode&&e.mode!==r.mode||!e.mode&&r.mode&&r.mode===i.Z.EVENT_MODE_ON_RECEIVE);}).forEach(function(e){return e&&e.callback.call(e.scope,n);});}},reset:function(){e={};}};return n;}a.__dashjs_factory_name="EventBus";var o=r.Z.getSingletonFactory(a);o.EVENT_PRIORITY_LOW=0,o.EVENT_PRIORITY_HIGH=5e3,r.Z.updateSingletonFactory(a.__dashjs_factory_name,o);const s=o;},5448:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function(){var e,t=[],n={},r={};function i(e,n){for(var r in t){var i=t[r];if(i.context===e&&i.name===n)return i.instance;}return null;}function a(e,t){return t[e];}function o(e,t,n){e in n&&(n[e]=t);}function s(t,n,r){var i,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},r);for(var u in i=t.apply({context:n},r),s=s.apply({context:n,factory:e,parent:i},r))i.hasOwnProperty(u)&&(i[u]=s[u]);}else i=t.apply({context:n},r);return i.getClassName=function(){return a;},i;}return e={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n});},getSingletonInstance:i,setSingletonInstance:function(e,n,r){for(var i in t){var a=t[i];if(a.context===e&&a.name===n)return void(t[i].instance=r);}t.push({name:n,context:e,instance:r});},deleteSingletonInstances:function(e){t=t.filter(function(t){return t.context!==e;});},getSingletonFactory:function(e){var r=a(e.__dashjs_factory_name,n);return r||(r=function(n){var r;return void 0===n&&(n={}),{getInstance:function(){return r||(r=i(n,e.__dashjs_factory_name)),r||(r=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:r})),r;}};},n[e.__dashjs_factory_name]=r),r;},getSingletonFactoryByName:function(e){return a(e,n);},updateSingletonFactory:function(e,t){o(e,t,n);},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments);}};},r[e.__dashjs_factory_name]=t),t;},getClassFactoryByName:function(e){return a(e,r);},updateClassFactory:function(e,t){o(e,t,r);}},e;}();},1264:(e,t,n)=>{n.d(t,{Z:()=>g});var r=n(5448),i=n(703),a=n(6398),o=n(3393),s=n(7855),u=n(5595),l=n(8512);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},c(e);}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function d(){var e,t,n=this.context,r=(0, u.Z)(n).getInstance(),d={"streaming.delay.liveDelay":l.Z.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":l.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":l.Z.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":l.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":l.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX},g={debug:{logLevel:a.Z.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,parseInbandPrft:!1,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:o.Z.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:o.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:o.Z.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:o.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,fragmentRequestProgressTimeout:-1,manifestRequestTimeout:1e4,retryIntervals:(e={},f(e,s.w.MPD_TYPE,500),f(e,s.w.XLINK_EXPANSION_TYPE,500),f(e,s.w.MEDIA_SEGMENT_TYPE,1e3),f(e,s.w.INIT_SEGMENT_TYPE,1e3),f(e,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),f(e,s.w.INDEX_SEGMENT_TYPE,1e3),f(e,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),f(e,s.w.LICENSE,1e3),f(e,s.w.OTHER_TYPE,1e3),f(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},f(t,s.w.MPD_TYPE,3),f(t,s.w.XLINK_EXPANSION_TYPE,1),f(t,s.w.MEDIA_SEGMENT_TYPE,3),f(t,s.w.INIT_SEGMENT_TYPE,3),f(t,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),f(t,s.w.INDEX_SEGMENT_TYPE,3),f(t,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),f(t,s.w.LICENSE,3),f(t,s.w.OTHER_TYPE,3),f(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:o.Z.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:o.Z.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:o.Z.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},h=i.Z.clone(g);function p(e,t,n){for(var a in e)e.hasOwnProperty(a)&&(t.hasOwnProperty(a)?"object"!==c(e[a])||e[a]instanceof Array||null===e[a]?(t[a]=i.Z.clone(e[a]),d[n+a]&&r.trigger(d[n+a])):p(e[a],t[a],n.slice()+a+"."):console.error("Settings parameter "+n+a+" is not supported"));}return {get:function(){return h;},update:function(e){"object"===c(e)&&p(e,h,"");},reset:function(){h=i.Z.clone(g);}};}d.__dashjs_factory_name="Settings";const g=r.Z.getSingletonFactory(d);},703:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(3875),i=n.n(r),a=n(1067);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},o(e);}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}var t,n;return t=e,n=[{key:"mixin",value:function(t,n,r){var i,a={};if(t)for(var s in n)n.hasOwnProperty(s)&&(i=n[s],s in t&&(t[s]===i||s in a&&a[s]===i)||("object"===o(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],i,r):t[s]=r(i)));return t;}},{key:"clone",value:function(t){if(!t||"object"!==o(t))return t;var n;if(t instanceof Array){n=[];for(var r=0,i=t.length;r<i;++r)r in t&&n.push(e.clone(t[r]));}else n={};return e.mixin(n,t,e.clone);}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach(function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value);}),n.href;}catch(t){return e;}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2));}return t;}},{key:"generateUuid",value:function(){var e=new Date().getTime();return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16);});}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t;}},{key:"getRelativeUrl",value:function(e,t){try{var n=new URL(e),r=new URL(t);if(n.protocol=r.protocol,n.origin!==r.origin)return t;var a=i().relative(n.pathname.substr(0,n.pathname.lastIndexOf("/")),r.pathname.substr(0,r.pathname.lastIndexOf("/"))),o=0===a.length?1:0;return a+=r.pathname.substr(r.pathname.lastIndexOf("/")+o,r.pathname.length-1),r.pathname.length<a.length?r.pathname:a;}catch(e){return t;}}},{key:"parseUserAgent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=null===e&&"undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";return (0,a.UAParser)(t);}catch(e){return {};}}}],n&&s(t,n),e;}();},2032:(e,t,n)=>{function r(){return "4.7.0";}n.d(t,{e:()=>r});},2230:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{Z:()=>i});const i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}var t,n;return t=e,(n=[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i]);}}}])&&r(t.prototype,n),e;}();},4351:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},r(e);}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},i(e,t);}function a(e,t){return !t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},o(e);}n.d(t,{Z:()=>s});const s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=o(t);if(n){var i=o(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return a(this,e);});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,s),(e=r.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CMSD_STATIC_HEADER="cmsdStaticHeader",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.INBAND_EVENTS="inbandEvents",e.INITIAL_STREAM_SWITCH="initialStreamSwitch",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",e.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD="serviceLocationLocationBlacklistAdd",e.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED="serviceLocationLocationBlacklistChanged",e.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",e.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",e.SOURCE_BUFFER_ERROR="sourceBufferError",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEEK_TARGET="seekTarget",e.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",e.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",e.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",e.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",e.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",e;}return s;}(n(8342).Z);},8512:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},r(e);}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},a(e,t);}function o(e,t){return !t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},s(e);}n.d(t,{Z:()=>u});const u=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t);}(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=s(t);if(n){var i=s(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return o(this,e);});function u(){return i(this,u),r.apply(this,arguments);}return u;}(n(4351).Z))();},8342:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{Z:()=>i});const i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}var t,n;return t=e,(n=[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i]);}}}])&&r(t.prototype,n),e;}();},9326:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(3186),i=n(7855),a=n(5448),o=n(8825),s=n(7387),u=n(1553);function l(e){var t,n,a,l,c,f=(e=e||{}).eventBus,d=e.debug,g=e.urlUtils,h=e.type,p=e.streamInfo,m=e.segmentsController,y=e.timelineConverter,E=e.baseURLController;function v(){return h;}function _(){a=null;}function T(e,t,n){var r,i,a=E.resolve(n.path),o={};return a&&t!==a.url&&g.isRelative(t)?(r=a.url,i=a.serviceLocation,o=a.queryParams,t&&(r=g.resolve(t,r))):r=t,!g.isRelative(r)&&(e.url=r,e.serviceLocation=i,e.queryParams=o,!0);}function S(e,t){if(null==t)return null;var n=new r.Z(),a=t.representation,o=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].bandwidth,u=t.media;return u=(0, s.vi)(u,"Number",t.replacementNumber),u=(0, s.vi)(u,"Time",t.replacementTime),u=(0, s.vi)(u,"Bandwidth",o),u=(0, s.Aj)(u,a.id),u=(0, s.eR)(u),n.mediaType=v(),n.type=i.w.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.mediaStartTime=t.mediaStartTime,n.duration=t.duration,n.timescale=a.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.availabilityTimeComplete=a.availabilityTimeComplete,n.wallStartTime=t.wallStartTime,n.quality=a.index,n.index=t.index,n.mediaInfo=e,n.adaptationIndex=a.adaptation.index,n.representationId=a.id,T(n,u,a)?n:void 0;}function b(e,t,r){var i=null;if(!t||!t.segmentInfoType)return i;var o=m.getSegmentByTime(t,r);return o&&(a=o,n.debug("Index for time "+r+" is "+o.index),i=S(e,o)),i;}function A(){n.debug("Dynamic stream complete"),c=!0;}return t={initialize:function(e){l=e,c=!1,m.initialize(e);},getStreamId:function(){return p.id;},getType:v,getStreamInfo:function(){return p;},getInitRequest:function(e,t){return t?function(e,t,n){var a=new r.Z(),o=t.adaptation.period,u=o.start;if(a.mediaType=n,a.type=i.w.INIT_SEGMENT_TYPE,a.range=t.range,a.availabilityStartTime=y.calcAvailabilityStartTimeFromPresentationTime(u,t,l),a.availabilityEndTime=y.calcAvailabilityEndTimeFromPresentationTime(u+o.duration,t,l),a.quality=t.index,a.mediaInfo=e,a.representationId=t.id,T(a,t.initialization,t))return a.url=(0, s.vi)(a.url,"Bandwidth",t.bandwidth),a;}(e,t,v()):null;},getSegmentRequestForTime:b,getCurrentIndex:function(){return a?a.index:-1;},getNextSegmentRequest:function(e,t){var r=null;if(!t||!t.segmentInfoType)return null;var i=a?a.index+1:0,o=m.getSegmentByIndex(t,i,a?a.mediaStartTime:-1);if(o)r=S(e,o),a=o;else {if(l&&!c)return n.debug(v()+" No segment found at index: "+i+". Wait for next loop"),null;c=!0;}return r;},isLastSegmentRequested:function(e,t){if(!e||!a)return !1;if(c)return !0;if(!isFinite(e.adaptation.period.duration))return !1;if(a.presentationStartTime+a.duration>t)return !1;if(e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.numberOfSegments)&&!isNaN(a.index)&&a.index>=e.mediaFinishedInformation.numberOfSegments-1){if(!l||e.segmentInfoType===u.Z.SEGMENT_TEMPLATE)return !0;if(l&&e.segmentInfoType===u.Z.SEGMENT_LIST&&e.adaptation.period.nextPeriodId)return !0;}return !!(l&&e.adaptation.period.nextPeriodId&&e.segmentInfoType===u.Z.SEGMENT_TIMELINE&&e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&a&&!isNaN(a.mediaStartTime)&&!isNaN(a.duration)&&a.mediaStartTime+a.duration>=e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05);},reset:function(){_(),f.off(o.Z.DYNAMIC_TO_STATIC,A,t);},getNextSegmentRequestIdempotent:function(e,t){var n=a?a.index+1:0,r=m.getSegmentByIndex(t,n,a?a.mediaStartTime:-1);return r?S(e,r):null;},getValidTimeAheadOfTargetTime:function(e,t,n,r){try{if(isNaN(e)||!t||!n)return NaN;if(e<0&&(e=0),isNaN(r)&&(r=.5),b(t,n,e))return e;if(n.adaptation.period.start+n.adaptation.period.duration<e)return NaN;for(var i=isFinite(n.adaptation.period.duration)?n.adaptation.period.start+n.adaptation.period.duration:e+30,a=Math.min(e+r,i),o=NaN,s=null;a<=i;){var u=null;if(a<=i&&(u=b(t,n,a)),u){o=a,s=u;break;}a+=r;}if(s){var l=s.startTime+s.duration;return e>s.startTime&&l-e>r?e:!isNaN(s.startTime)&&e<s.startTime&&o>s.startTime?s.startTime+.001:Math.min(l-r,o);}return o;}catch(e){return NaN;}}},n=d.getLogger(t),_(),f.on(o.Z.DYNAMIC_TO_STATIC,A,t),t;}l.__dashjs_factory_name="DashHandler";const c=a.Z.getClassFactory(l);},1553:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{Z:()=>i});const i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.init();}var t,n;return t=e,(n=[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.SUPPLEMENTAL_PROPERTY_ASARRAY="SupplementalProperty_asArray",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.INBAND="inband",this.TYPE="type",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.VIEWPOINT_ASARRAY="Viewpoint_asArray",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PATCH_LOCATION_AS_ARRAY="PatchLocation_asArray",this.LOCATION="Location",this.LOCATION_AS_ARRAY="Location_asArray",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.CLIENT_REQUIREMENT="clientRequirement",this.TTL="ttl",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",PATHWAY_PRIORITY:"PATHWAY-PRIORITY",PATHWAY_CLONES:"PATHWAY-CLONES",BASE_ID:"BASE-ID",ID:"ID",URI_REPLACEMENT:"URI-REPLACEMENT",HOST:"HOST",PARAMS:"PARAMS"},this.PRODUCER_REFERENCE_TIME_TYPE={ENCODER:"encoder",CAPTURED:"captured",APPLICATION:"application"},this.SEGMENT_ALIGNMENT="segmentAlignment",this.SUB_SEGMENT_ALIGNMENT="subsegmentAlignment";}}])&&r(t.prototype,n),e;}())();},7802:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(5448),i=n(1724),a=n(3636),o=n(1736),s=n(5246);function u(e){e=e||{};var t,n,r=this.context,u=e.dashConstants,l=e.type,c=e.segmentBaseController;function f(e){return e?e.segments?n[u.SEGMENT_BASE]:n[e.segmentInfoType]:null;}return t={initialize:function(t){n[u.SEGMENT_TIMELINE]=(0, i.Z)(r).create(e,t),n[u.SEGMENT_TEMPLATE]=(0, a.Z)(r).create(e,t),n[u.SEGMENT_LIST]=(0, o.Z)(r).create(e,t),n[u.SEGMENT_BASE]=(0, s.Z)(r).create(e,t);},updateInitData:function(e,t){return t?Promise.resolve():c.getSegmentBaseInitSegment({representation:e,mediaType:l});},updateSegmentData:function(e,t){return t?Promise.resolve():c.getSegmentList({mimeType:e.mimeType,representation:e,mediaType:l});},getSegmentByIndex:function(e,t,n){var r=f(e);return r?r.getSegmentByIndex(e,t,n):null;},getSegmentByTime:function(e,t){var n=f(e);return n?n.getSegmentByTime(e,t):null;},getMediaFinishedInformation:function(e){var t=f(e);return t?t.getMediaFinishedInformation(e):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};}},n={},t;}u.__dashjs_factory_name="SegmentsController";const l=r.Z.getClassFactory(u);},1736:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i=n(3393),a=n(7387);function o(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR);}function o(e,i){if(r(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,u=e&&!isNaN(e.startNumber)?e.startNumber:1,l=Math.max(u-1,0),c=Math.max(i-l,0),f=null;if(c<s){var d=o.SegmentURL_asArray[c];(f=(0, a.NF)(n,t,e,i))&&(f.replacementTime=(u+i-1)*e.segmentDuration,f.media=d.media?d.media:"",f.mediaRange=d.mediaRange,f.indexRange=d.indexRange);}return f;}return {getSegmentByIndex:o,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i));},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,r=e&&!isNaN(e.startNumber)?e.startNumber:1,i=Math.max(r-1,0);return t.numberOfSegments=i+n.SegmentURL_asArray.length,t;}};}o.__dashjs_factory_name="ListSegmentsGetter";const s=r.Z.getClassFactory(o);},5246:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5448),i=n(3393);function a(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR);}function r(e,t){if(n(),!e)return null;var r,i=e.segments?e.segments.length:-1;if(t<i&&(r=e.segments[t])&&r.index===t)return r;for(var a=0;a<i;a++)if((r=e.segments[a])&&r.index===t)return r;return null;}return {getSegmentByIndex:r,getSegmentByTime:function(e,t){n();var i=function(e,t){if(!e)return -1;var n,r,i,a,o,s=e.segments,u=s?s.length:null,l=-1;if(s&&u>0)for(o=0;o<u;o++)if(i=(r=s[o]).presentationStartTime,t+(n=(a=r.duration)/2)>=i&&t-n<i+a){l=r.index;break;}return l;}(e,t);return r(e,i);},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return e&&e.segments?(t.numberOfSegments=e.segments.length,t):t;}};}a.__dashjs_factory_name="SegmentBaseGetter";const o=r.Z.getClassFactory(a);},7387:(e,t,n)=>{n.d(t,{Aj:()=>o,NF:()=>c,TJ:()=>f,eR:()=>a,vi:()=>s});var r=n(2011);function i(e,t){for(;e.length<t;)e="0"+e;return e;}function a(e){return e?e.split("$$").join("$"):e;}function o(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n);}function s(e,t,n){var r,a,o,s,u,l,c=t.length,f="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((a=e.indexOf("$",r+c))<0)return e;if((o=e.indexOf("%0",r+c))>r&&o<a)switch(s=e.charAt(a-1),u=parseInt(e.substring(o+f,a-1),10),s){case"d":case"i":case"u":l=i(n.toString(),u);break;case"x":l=i(n.toString(16),u);break;case"X":l=i(n.toString(16),u).toUpperCase();break;case"o":l=i(n.toString(8),u);break;default:return e;}else l=n;e=e.substring(0,r)+l+e.substring(a+1);}}function u(e,t,n,i,a,o,s,u){var l,c=new r.Z();return c.representation=e,c.duration=t,c.presentationStartTime=n,c.mediaStartTime=i,c.availabilityStartTime=a.calcAvailabilityStartTimeFromPresentationTime(o,e,s),c.availabilityEndTime=a.calcAvailabilityEndTimeFromPresentationTime(o+t,e,s),c.wallStartTime=a.calcWallTimeForSegment(c,s),c.replacementNumber=(l=u,c.representation.startNumber+l),c.index=u,c;}function l(e,t,n,r){var i=t.adaptation.period;if(isFinite(i.duration)&&i.start+i.duration<=n.presentationStartTime)return !1;if(r){if("INF"===t.availabilityTimeOffset)return !0;var a=e.getClientReferenceTime();return n.availabilityStartTime.getTime()<=a&&(!isFinite(n.availabilityEndTime)||n.availabilityEndTime.getTime()>=a);}return !0;}function c(e,t,n,r){var i,a,o;i=n.segmentDuration,isNaN(i)&&(i=n.adaptation.period.duration),a=parseFloat((n.adaptation.period.start+r*i).toFixed(5)),o=parseFloat((a+i).toFixed(5));var s=u(n,i,a,e.calcMediaTimeFromPresentationTime(a,n),e,o,t,r);return l(e,n,s,t)?s:null;}function f(e,t,n,r,i,a,o,c,f,d){var g,h,p=r/a,m=i/a;return g=e.calcPresentationTimeFromMediaTime(p,n),l(e,n,h=u(n,m,g,p,e,g+m,t,f),t)?(h.replacementTime=d||r,o=s(o,"Number",h.replacementNumber),o=s(o,"Time",h.replacementTime),h.media=o,h.mediaRange=c,h):null;}},3636:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i=n(3393),a=n(7387);function o(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR);}function o(e,i){if(r(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;i=Math.max(i,0);var s=(0, a.NF)(n,t,e,i);if(s){s.replacementTime=Math.round((i-1)*e.segmentDuration*e.timescale,10);var u=o.media;u=(0, a.vi)(u,"Number",s.replacementNumber),u=(0, a.vi)(u,"Time",s.replacementTime),s.media=u;}return s;}return {getSegmentByIndex:o,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i));},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.segmentDuration;return isNaN(n)?t.numberOfSegments=1:t.numberOfSegments=Math.ceil(e.adaptation.period.duration/n),t;}};}o.__dashjs_factory_name="TemplateSegmentsGetter";const s=r.Z.getClassFactory(o);},1724:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i=n(3393),a=n(7387);function o(e,t){var n=(e=e||{}).timelineConverter,r=e.dashMetrics;function o(){if(!n)throw new Error(i.Z.MISSING_CONFIG_ERROR);}function s(e,t){var n,r,i,a,o,s,l,c=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,f=c.SegmentTimeline,d=c.SegmentURL_asArray,g=0,h=-1;l=e.timescale;var p=!1;for(i=0,a=(n=f.S_asArray).length;i<a&&!p;i++)for(s=0,(r=n[i]).hasOwnProperty("r")&&(s=r.r),r.hasOwnProperty("t")&&(g=r.t),s<0&&(s=u(e,n[i+1],r,l,g/l)),o=0;o<=s&&!p;o++)(p=t(g,c,d,r,l,++h,i))&&(e.segmentDuration=r.d/l),g+=r.d;}function u(e,t,i,a,o){var s;if(t&&t.hasOwnProperty("t"))s=t.t/a;else try{var u=0;if(isNaN(e.adaptation.period.start)||isNaN(e.adaptation.period.duration)||!isFinite(e.adaptation.period.duration)){var l=r.getCurrentDVRInfo();u=isNaN(l.end)?0:l.end;}else u=e.adaptation.period.start+e.adaptation.period.duration;s=n.calcMediaTimeFromPresentationTime(u,e),e.segmentDuration=i.d/a;}catch(e){s=0;}return Math.max(Math.ceil((s-o)/(i.d/a))-1,0);}return {getSegmentByIndex:function(e,r,i){if(o(),!e)return null;var u=null,l=!1;return s(e,function(r,o,s,c,f,d,g){if(l||i<0){var h=o.media,p=c.mediaRange;return s&&(h=s[g].media||"",p=s[g].mediaRange),u=(0, a.TJ)(n,t,e,r,c.d,f,h,p,d,c.tManifest),!0;}return r>=i*f-.5*c.d&&(l=!0),!1;}),u;},getSegmentByTime:function(e,r){if(o(),!e)return null;void 0===r&&(r=null);var i=null,u=n.calcMediaTimeFromPresentationTime(r,e);return s(e,function(r,o,s,l,c,f,d){var g=parseFloat((u*c).toPrecision(15));if(g<r+l.d&&g>=r){var h=o.media,p=l.mediaRange;return s&&(h=s[d].media||"",p=s[d].mediaRange),i=(0, a.TJ)(n,t,e,r,l.d,c,h,p,f,l.tManifest),!0;}return !1;}),i;},getMediaFinishedInformation:function(e){if(!e)return 0;var t,n,r,i,a,o,s,l=(e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList).SegmentTimeline,c=0,f=0,d=0;for(s=e.timescale,i=(t=l.S_asArray).length,r=0;r<i;r++)for(o=0,(n=t[r]).hasOwnProperty("r")&&(o=n.r),n.hasOwnProperty("t")&&(f=(c=n.t)/s),o<0&&(o=u(e,t[r+1],n,s,f)),a=0;a<=o;a++)d++,f=(c+=n.d)/s;return {numberOfSegments:d,mediaTimeOfLastSignaledSegment:f};}};}o.__dashjs_factory_name="TimelineSegmentsGetter";const s=r.Z.getClassFactory(o);},2011:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null;};},2610:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.schemeIdUri="",this.value="";};},7688:(e,t,n)=>{n.d(t,{Z:()=>ja});var r=n(452),i=n.n(r),a=n(3393),o=n(1553),s=n(3860),u=n(5595),l=n(8512),c=n(5448),f=n(6398),d=n(8825);function g(){var e,t,n,r,i,o,c,g,h,p,m,y,E,v,_,T,S,b,A,I,R,w,N,C,D=this.context,O=(0, u.Z)(D).getInstance();function M(){F(),v=!1,p=0,m=0,T=0,w=!1,S=!0,b=!1,N=!1,A=NaN,c&&(O.off(l.Z.DATA_UPDATE_COMPLETED,Q,e),O.off(l.Z.LOADING_PROGRESS,me,e),O.off(l.Z.MANIFEST_UPDATED,_e,e),O.off(l.Z.STREAMS_COMPOSED,Te,e),O.off(d.Z.PLAYBACK_ENDED,he,e),O.off(d.Z.STREAM_INITIALIZING,Ee,e),O.off(d.Z.REPRESENTATION_SWITCH,ve,e),O.off(d.Z.BUFFER_LEVEL_STATE_CHANGED,ee,e),X(),c.removeEventListener("canplay",J),c.removeEventListener("canplaythrough",$),c.removeEventListener("play",te),c.removeEventListener("waiting",ne),c.removeEventListener("playing",re),c.removeEventListener("pause",ie),c.removeEventListener("error",pe),c.removeEventListener("seeking",ae),c.removeEventListener("seeked",oe),c.removeEventListener("timeupdate",se),c.removeEventListener("progress",ue),c.removeEventListener("ratechange",le),c.removeEventListener("loadedmetadata",ce),c.removeEventListener("loadeddata",fe),c.removeEventListener("stalled",ye),c.removeEventListener("ended",de),c.removeEventListener("volumechange",ge)),h=null,c=null,y=null,E=null;}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return parseFloat((L(e)-B()).toFixed(5));}function L(e){var t=e||y;return t.start+t.duration;}function x(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y&&c&&c.getElement()?(e&&E&&Z(B()),c.play()):v=!0;}function F(){y&&c&&c.pause();}function k(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(y&&c&&c.getElement()){var a=isNaN(A)?c.getTime():A;e!==a&&((I=!0===r)||(A=e),t.info("Requesting seek to time: "+e+(I?" (internal)":"")),E&&i&&Z(e),c.setCurrentTime(e,n));}}function U(){if(y&&c&&E){var e=n&&n.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,t=i.getCurrentDVRInfo(e);return t&&t.range?t.range.end:0;}}function Z(e){var t=new Date(g.getClientReferenceTime()),n=o.getRegularPeriods()[0],r=g.calcPresentationTimeFromWallTime(t,n);p=r-e;}function B(){return y&&c?c.getTime():null;}function G(){return y&&c?c.isPaused():null;}function q(){return y&&c?c.isSeeking():null;}function Y(){return y&&c?c.isStalled():null;}function j(){return y&&c?c.getPlaybackRate():null;}function H(){return y&&c?c.getEnded():null;}function V(){return E;}function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!G()&&E&&0!==c.getReadyState()&&!q()&&!w){e||(e=n.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO);var r=B(),i=z(r,e),o=!isNaN(i)&&i!==r;o&&!q()&&(Y()||R||1===c.getReadyState())&&(t.debug("UpdateCurrentTime: Seek to actual time: ".concat(i," from currentTime: ").concat(r)),k(i,!1,!1));}}function z(e,t){var n=i.getCurrentDVRInfo(t),r=n?n.range:null;return r?e>r.end?Math.max(r.end-p,r.start):e>0&&e+.25<r.start&&Math.abs(e-r.start)<31536e4?b?Math.max(r.end-p,r.start):r.start:e:NaN;}function W(){null===h&&(h=setInterval(function(){var e;O.trigger(l.Z.WALLCLOCK_TIME_UPDATED,{isDynamic:E,time:new Date()}),V()&&(n.addDVRMetric(),G()?(e=Date.now(),(!_||e>_+500)&&(_=e,se())):K());},C.get().streaming.wallclockTimeUpdateInterval));}function X(){clearInterval(h),h=null;}function Q(e){var t=o.convertRepresentationToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&y.id===n.id&&(y=n);}function J(){O.trigger(l.Z.CAN_PLAY);}function $(){O.trigger(l.Z.CAN_PLAY_THROUGH);}function ee(e){e.streamId===n.getActiveStreamInfo().id&&(R=e.state===s.Z.BUFFER_EMPTY,C.get().streaming.buffer.setStallState&&c.setStallState(e.mediaType,e.state===s.Z.BUFFER_EMPTY));}function te(){t.info("Native video element event: play"),K(),W(),O.trigger(l.Z.PLAYBACK_STARTED,{startTime:B()});}function ne(){t.info("Native video element event: waiting"),O.trigger(l.Z.PLAYBACK_WAITING,{playingTime:B()});}function re(){t.info("Native video element event: playing"),I=!1,O.trigger(l.Z.PLAYBACK_PLAYING,{playingTime:B()});}function ie(){t.info("Native video element event: pause"),O.trigger(l.Z.PLAYBACK_PAUSED,{ended:H()});}function ae(){if(!I){var e=B();isNaN(A)||A===e||(e=A),A=NaN,t.info("Seeking to: "+e),W(),O.trigger(l.Z.PLAYBACK_SEEKING,{seekTime:e,streamId:y.id});}}function oe(){t.info("Native video element event: seeked"),I=!1,O.trigger(l.Z.PLAYBACK_SEEKED);}function se(){y&&O.trigger(l.Z.PLAYBACK_TIME_UPDATED,{timeToEnd:P(),time:B(),streamId:y.id});}function ue(){O.trigger(l.Z.PLAYBACK_PROGRESS,{streamId:y.id});}function le(){var e=j();t.info("Native video element event: ratechange: ",e),O.trigger(l.Z.PLAYBACK_RATE_CHANGED,{playbackRate:e});}function ce(){t.info("Native video element event: loadedmetadata"),O.trigger(l.Z.PLAYBACK_METADATA_LOADED),W();}function fe(){t.info("Native video element event: loadeddata"),O.trigger(l.Z.PLAYBACK_LOADED_DATA);}function de(){t.info("Native video element event: ended"),F(),X();var e=n?n.getActiveStreamInfo():null;e&&O.trigger(l.Z.PLAYBACK_ENDED,{isLast:e.isLast});}function ge(){O.trigger(l.Z.PLAYBACK_VOLUME_CHANGED);}function he(e){if(h&&e.isLast){t.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var n=e.seekTime?e.seekTime:L();c.setCurrentTime(n),F(),X();}}function pe(e){var t=e.target||e.srcElement;O.trigger(l.Z.PLAYBACK_ERROR,{error:t.error});}function me(e){if(!1===e.stream&&b&&!isNaN(e.request.duration)){var n=1.2*e.request.duration;n>p&&(t.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",n.toFixed(2)),p=n,m=n);}}function ye(e){O.trigger(l.Z.PLAYBACK_STALLED,{e});}function Ee(e){var n;(n=e.mediaInfo)&&n.supplementalProperties&&"true"===n.supplementalProperties[a.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]&&(t.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),b=!0);}function ve(e){var t=n.getActiveStreamInfo();e&&t&&e.currentRepresentation&&e.streamId&&e.streamId===t.id&&e.mediaType&&(e.mediaType===a.Z.VIDEO||e.mediaType===a.Z.AUDIO)&&(S=e.currentRepresentation.availabilityTimeComplete,(b=!S)&&!N&&(N=!0));}function _e(){w=!0;}function Te(){w=!1;}return e={initialize:function(t,n){y=t,!0!==n&&(c.addEventListener("canplay",J),c.addEventListener("canplaythrough",$),c.addEventListener("play",te),c.addEventListener("waiting",ne),c.addEventListener("playing",re),c.addEventListener("pause",ie),c.addEventListener("error",pe),c.addEventListener("seeking",ae),c.addEventListener("seeked",oe),c.addEventListener("timeupdate",se),c.addEventListener("progress",ue),c.addEventListener("ratechange",le),c.addEventListener("loadedmetadata",ce),c.addEventListener("loadeddata",fe),c.addEventListener("stalled",ye),c.addEventListener("ended",de),c.addEventListener("volumechange",ge),E=y.manifestInfo.isDynamic,R=!1,I=!1,O.on(l.Z.DATA_UPDATE_COMPLETED,Q,e),O.on(l.Z.LOADING_PROGRESS,me,e),O.on(l.Z.MANIFEST_UPDATED,_e,e),O.on(l.Z.STREAMS_COMPOSED,Te,e),O.on(d.Z.PLAYBACK_ENDED,he,e,{priority:u.Z.EVENT_PRIORITY_HIGH}),O.on(d.Z.STREAM_INITIALIZING,Ee,e),O.on(d.Z.REPRESENTATION_SWITCH,ve,e),O.on(d.Z.BUFFER_LEVEL_STATE_CHANGED,ee,e),v&&(v=!1,x()));},setConfig:function(e){e&&(e.streamController&&(n=e.streamController),e.serviceDescriptionController&&(r=e.serviceDescriptionController),e.dashMetrics&&(i=e.dashMetrics),e.adapter&&(o=e.adapter),e.videoModel&&(c=e.videoModel),e.timelineConverter&&(g=e.timelineConverter),e.settings&&(C=e.settings));},getTimeToStreamEnd:P,getBufferLevel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null;return n.getActiveStreamProcessors().forEach(function(n){if(!e||0===e.length||-1===e.indexOf(n.getType())){var r=n.getBufferLevel();t=null===t?r:Math.min(t,r);}}),t;},getPlaybackStalled:function(){return R;},getTime:B,getLowLatencyModeEnabled:function(){return b;},getInitialCatchupModeActivated:function(){return N;},getIsManifestUpdateInProgress:function(){return w;},getPlaybackRate:j,getPlayedRanges:function(){return y&&c?c.getPlayedRanges():null;},getEnded:H,getIsDynamic:V,getStreamController:function(){return n;},computeAndSetLiveDelay:function(e,t){var n,i,a,s=!isNaN(e)&&isFinite(e)?e:NaN,u=o.getSuggestedPresentationDelay(),l=r.getServiceDescriptionSettings();return n=isNaN(C.get().streaming.delay.liveDelay)?null===C.get().streaming.delay.liveDelayFragmentCount||isNaN(C.get().streaming.delay.liveDelayFragmentCount)||isNaN(s)?l&&!isNaN(l.liveDelay)&&l.liveDelay>0?l.liveDelay:!0===C.get().streaming.delay.useSuggestedPresentationDelay&&null!==u&&!isNaN(u)&&u>0?u:isNaN(s)?t&&!isNaN(t.minBufferTime)?4*t.minBufferTime:4*y.manifestInfo.minBufferTime:4*s:s*C.get().streaming.delay.liveDelayFragmentCount:C.get().streaming.delay.liveDelay,null!==(a=o.getAvailabilityStartTime())&&(T=a),i=t&&t.dvrWindowSize>0?Math.min(n,t.dvrWindowSize):n,p=i,m=i,i;},getLiveDelay:function(){return p;},getOriginalLiveDelay:function(){return m;},getCurrentLiveLatency:function(){if(!E||isNaN(T))return NaN;var e=B();if(isNaN(e)||0===e)return 0;var t=new Date().getTime()+1e3*g.getClientTimeOffset();return Math.max(((t-T-1e3*e)/1e3).toFixed(3),0);},play:x,isPaused:G,isStalled:Y,pause:F,isSeeking:q,getStreamEndTime:L,seek:k,seekToOriginalLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=U();if(0!==r){var i=r-(p=m);k(i,e,t,n);}},seekToCurrentLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=U();if(0!==r){var i=r-p;k(i,e,t,n);}},reset:M,updateCurrentTime:K,getAvailabilityStartTime:function(){return T;}},t=(0, f.Z)(D).getInstance().getLogger(e),M(),e;}g.__dashjs_factory_name="PlaybackController";const h=c.Z.getSingletonFactory(g);var p=n(3186),m="loading",y="executed",E="failed";function v(e){var t,n,r,i,a=(e=e||{}).eventBus,o=e.events,s=e.dashMetrics,u=e.fragmentLoader,l=e.debug,c=e.streamInfo,f=e.type;function d(e){var t;return !!e&&(t=!1,r.some(function(n){if(r=e,i=n,!isNaN(r.index)&&r.startTime===i.startTime&&r.adaptationIndex===i.adaptationIndex&&r.type===i.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality;}(e,n)||function(e,t){return e.action===p.Z.ACTION_COMPLETE&&e.action===t.action;}(e,n))return t=!0;var r,i;}),t);}function g(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5);}function h(e){r=r.filter(function(t){var n=g(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n;});}function v(e,t){t<=e+.5||(r=r.filter(function(n){var r=g(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r;}));}function _(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?g(i):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return i;}return null;}function T(e,t){s.addSchedulingInfo(e,t),s.addRequestsQueue(e.mediaType,i,r);}function S(e){e.sender===u&&(i.splice(i.indexOf(e.request),1),e.response&&!e.error&&r.push(e.request),T(e.request,e.error?E:y),a.trigger(o.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:f}));}function b(e){e.sender===u&&a.trigger(o.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:f});}function A(e){e.sender===u&&a.trigger(o.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:c.id,mediaType:f});}function I(){r=[],i=[];}return t={getStreamId:function(){return c.id;},getType:function(){return f;},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach(function(t){var a=function(e){var t;switch(e){case m:t=i;break;case y:t=r;break;default:t=[];}return t;}(t);n=n.concat(function(e,t){return t.hasOwnProperty("time")?[_(e,t.time,t.threshold)]:e.filter(function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return !1;return !0;});}(a,e));}),n;},isFragmentLoaded:d,isFragmentLoadedOrPending:function(e){var t,n=!1,r=0;if(!(n=d(e)))for(r=0;r<i.length;r++)t=i[r],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n;},removeExecutedRequestsBeforeTime:h,removeExecutedRequestsAfterTime:function(e){r=r.filter(function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e;});},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)v(n,e.start(r)),n=e.end(r);t>0&&v(n,t);}else h();},abortRequests:function(){n.debug("abort requests"),u.abort(),i=[];},executeRequest:function(e){e.action===p.Z.ACTION_DOWNLOAD?(T(e,m),i.push(e),function(e){a.trigger(o.FRAGMENT_LOADING_STARTED,{request:e},{streamId:c.id,mediaType:f}),u.load(e);}(e)):n.warn("Unknown request action.");},reset:function(){a.off(o.LOADING_COMPLETED,S,this),a.off(o.LOADING_DATA_PROGRESS,b,this),a.off(o.LOADING_ABANDONED,A,this),u&&u.reset(),I();},resetInitialSettings:I,addExecutedRequest:function(e){r.push(e);}},n=l.getLogger(t),I(),a.on(o.LOADING_COMPLETED,S,t),a.on(o.LOADING_DATA_PROGRESS,b,t),a.on(o.LOADING_ABANDONED,A,t),t;}v.__dashjs_factory_name="FragmentModel";var _=c.Z.getClassFactory(v);_.FRAGMENT_MODEL_LOADING=m,_.FRAGMENT_MODEL_EXECUTED=y,_.FRAGMENT_MODEL_CANCELED="canceled",_.FRAGMENT_MODEL_FAILED=E,c.Z.updateClassFactory(v.__dashjs_factory_name,_);const T=_;var S=n(5459);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},b(e);}function A(e,t){return A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},A(e,t);}function I(e,t){return !t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},R(e);}const w=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=R(t);if(n){var i=R(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return I(this,e);});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),(e=r.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e;}return i;}(n(2230).Z))();var N=n(1264),C=n(7855);function D(e){var t,n,r,i,o,s,u=this.context,c=(0, N.Z)(u).getInstance(),d=e.textController,g=e.eventBus,h=[],p=[],m=!1,y=e.mediaSource,E=null;function v(e){return new Promise(function(t){M(function(){i.changeType&&i.changeType(e),t();});});}function _(e){return i=d.getTextSourceBuffer(e),Promise.resolve();}function T(){if("function"==typeof i.addEventListener)try{i.addEventListener("updateend",D,!1),i.addEventListener("error",O,!1),i.addEventListener("abort",O,!1);}catch(e){s=setInterval(D,50);}else s=setInterval(D,50);}function b(e){return new Promise(function(t){i&&c.get().streaming.buffer.useAppendWindow?M(function(){try{if(!i)return void t();var n=y.duration,a=0;e&&!isNaN(e.start)&&!isNaN(e.duration)&&isFinite(e.duration)&&(n=e.start+e.duration),e&&!isNaN(e.start)&&(a=e.start),i.appendWindowEnd===n&&i.appendWindowStart===a||(i.appendWindowStart=0,i.appendWindowEnd=n+.01,i.appendWindowStart=Math.max(a-.1,0),r.debug("Updated append window for ".concat(o.type,". Set start to ").concat(i.appendWindowStart," and end to ").concat(i.appendWindowEnd))),t();}catch(e){r.warn("Failed to set append window"),t();}}):t();});}function A(e){return new Promise(function(t){i?M(function(){try{i.timestampOffset===e||isNaN(e)||(i.timestampOffset=e,r.debug("Set MSE timestamp offset to ".concat(e))),t();}catch(e){t();}}):t();});}function I(){if(!m&&p.length>0){m=!0;var e=p[0];p.splice(0,1);var t=function(){m=!1,p.length>0&&I.call(this),e&&e.data&&e.data.segmentType&&e.data.segmentType!==C.w.INIT_SEGMENT_TYPE&&delete e.data.bytes,e.promise.resolve({chunk:e.data});};try{E=e.request,0===e.data.bytes.byteLength?t.call(this):(i.appendBuffer?i.appendBuffer(e.data.bytes):i.append(e.data.bytes,e.data),M(t.bind(this)));}catch(t){r.fatal('SourceBuffer append failed "'+t+'"'),p.length>0?I():m=!1,delete e.data.bytes,e.promise.reject({chunk:e.data,error:new S.Z(t.code,t.message)});}}}function R(){h.length>0&&(i.updating||(h.shift()(),R()));}function D(){i.updating||R();}function O(e){var t,r,i=e.target||{};t=l.Z.SOURCE_BUFFER_ERROR,r={error:i,lastRequestAppended:E}||{},g.trigger(t,r,{streamId:o.streamInfo.id,mediaType:n});}function M(e){h.push(e),i.updating||R();}return t={getType:function(){return n;},getAllBufferRanges:function(){try{return i.buffered;}catch(e){return r.error("getAllBufferRanges exception: "+e.message),null;}},getBuffer:function(){return i;},append:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(r,i){e?(p.push({data:e,promise:{resolve:r,reject:i},request:n}),M(I.bind(t))):i({chunk:e,error:new S.Z(w.APPEND_ERROR_CODE,w.APPEND_ERROR_MESSAGE)});});},remove:function(e){return new Promise(function(t,n){var r=e.start,a=e.end;r>=0&&a>r?M(function(){try{i.remove(r,a),M(function(){t({from:r,to:a,unintended:!1}),e.resolve&&e.resolve();});}catch(t){n({from:r,to:a,unintended:!1,error:new S.Z(w.REMOVE_ERROR_CODE,w.REMOVE_ERROR_MESSAGE)}),e.reject&&e.reject(t);}}):t();});},abort:function(){return new Promise(function(e){try{p=[],"open"===y.readyState?M(function(){try{i&&i.abort(),e();}catch(t){e();}}):i&&i.setTextTrack&&"ended"===y.readyState?(i.abort(),e()):e();}catch(t){e();}});},reset:function(){if(i){try{h=[],function(){try{"function"==typeof i.removeEventListener&&(i.removeEventListener("updateend",D,!1),i.removeEventListener("error",O,!1),i.removeEventListener("abort",O,!1)),clearInterval(s);}catch(e){r.error(e);}}(),m=!1,p=[],i.getClassName&&"TextSourceBuffer"===i.getClassName()||(r.debug("Removing sourcebuffer from media source"),y.removeSourceBuffer(i));}catch(e){}i=null;}E=null;},updateTimestampOffset:A,initializeForStreamSwitch:function(e,t,r){n=(o=e).type;var a=o.codec;!function(e){i=e.getBuffer();}(r),T();var s=[];return s.push(new Promise(function(e){M(function(){var t=i.appendWindowStart,n=i.appendWindowEnd;i&&(i.abort(),i.appendWindowStart=t,i.appendWindowEnd=n),e();});})),s.push(b(o.streamInfo)),c.get().streaming.buffer.useChangeTypeForTrackSwitch&&s.push(v(a)),t&&void 0!==t.MSETimeOffset&&s.push(A(t.MSETimeOffset)),Promise.all(s);},initializeForFirstUse:function(e,t,r){n=(o=t).type;var s=o.codec;try{if(s.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return _(e);i=y.addSourceBuffer(s),T();var u=[];return u.push(b(o.streamInfo)),r&&void 0!==r.MSETimeOffset&&u.push(A(r.MSETimeOffset)),Promise.all(u);}catch(t){return o.type==a.Z.TEXT&&!o.isFragmented||-1!==s.indexOf('codecs="stpp')||-1!==s.indexOf('codecs="vtt')?_(e):Promise.reject(t);}},updateAppendWindow:b,changeType:v},r=(0, f.Z)(u).getInstance().getLogger(t),t;}D.__dashjs_factory_name="SourceBufferSink";const O=c.Z.getClassFactory(D);function M(e){var t,n,r,i=this.context,a=[],o=e;function s(e,t){return a=a.filter(function(n){return !((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e));}),Promise.resolve();}return t={getAllBufferRanges:function(){for(var e=[],t=0;t<a.length;t++){var n=a[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end;}var r={start:function(t){return e[t].start;},end:function(t){return e[t].end;}};return Object.defineProperty(r,"length",{get:function(){return e.length;}}),r;},append:function(e){return "InitializationSegment"!==e.segmentType?(a.push(e),a.sort(function(e,t){return e.start-t.start;}),r=null):r=e,n.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),o&&o({chunk:e}),Promise.resolve();},remove:s,abort:function(){return Promise.resolve();},discharge:function(e,t){var n=function(e,t){return a.filter(function(n){return (isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e);});}(e,t);return r&&(n.push(r),r=null),s(e,t),n;},reset:function(){a=[],r=null,o=null;},updateTimestampOffset:function(){return Promise.resolve();},waitForUpdateEnd:function(e){e();},getBuffer:function(){return this;}},n=(0, f.Z)(i).getInstance().getLogger(t),t;}M.__dashjs_factory_name="PreBufferSink";const P=c.Z.getClassFactory(M);function L(){var e={};return {save:function(t){var n=t.streamId,r=t.representationId;e[n]=e[n]||{},e[n][r]=t;},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null;},reset:function(){e={};}};}L.__dashjs_factory_name="InitCache";const x=c.Z.getSingletonFactory(L);var F=.01,k="BufferController";function U(e){e=e||{};var t,n,r,i,o,c,g,h,p,m,y,E,v,_,b,A,I,R,N,D,M,L=this.context,U=(0, u.Z)(L).getInstance(),Z=e.errHandler,B=e.fragmentModel,G=e.representationController,q=e.adapter,Y=e.textController,j=e.abrController,H=e.playbackController,V=e.streamInfo,K=e.type,z=e.settings;function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(n,r){c=e,p&&t&&"function"==typeof p.discharge?(m=p,Q(t).then(function(){n();}).catch(function(e){r(e);})):n();});}function X(e){return q.convertRepresentationToRepresentationInfo(G.getRepresentationForQuality(e));}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise(function(n,r){R&&e?c?(y=!1,$(e,t).then(function(e){n(e);}).catch(function(e){r(e);})):(y=!0,J().then(function(e){n(e);}).catch(function(e){r(e);})):n(null);});}function J(){var e=this;return new Promise(function(t,n){var r=j.getQualityFor(K,V.id);p=P(L).create(ie.bind(e)),_e(X(r)).then(function(){t(p);}).catch(function(){n();});});}function $(e,t){return new Promise(function(r,i){var o=j.getQualityFor(K,V.id);p=O(L).create({mediaSource:c,textController:Y,eventBus:U}),function(e,t,n){var r=X(n);return t&&t[K]&&(K===a.Z.VIDEO||K===a.Z.AUDIO)?p.initializeForStreamSwitch(e,r,t[K]):p.initializeForFirstUse(V,e,r);}(e,t,o).then(function(){return _e(X(o));}).then(function(){r(p);}).catch(function(e){n.fatal("Caught error on create SourceBuffer: "+e),Z.error(new S.Z(w.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,w.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+K)),i(e);});});}function ee(e){z.get().streaming.cacheInitSegments&&(n.info("Init fragment finished loading saving to",K+"'s init cache"),R.save(e.chunk)),n.debug("Append Init fragment",K," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),ne(e.chunk);}function te(e){ne(e.chunk,e.request);}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;p.append(e,t).then(function(e){ie(e);}).catch(function(e){ie(e);}),e.mediaInfo.type===a.Z.VIDEO&&Ne(l.Z.VIDEO_CHUNK_RECEIVED,{chunk:e});}function re(e){if(e&&e.length>0)for(var t=0,r=e.length;t<r;t++)n.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",H.getTime());}function ie(e){if(e.error)return 22===e.error.code&&function(){if(I=!0,o=.8*Ie(),n.warn("Quota exceeded, Critical Buffer: "+o),o>0){var e=Math.max(.2*o,1),t=o-e,r=Math.min(z.get().streaming.buffer.bufferTimeAtTopQuality,.9*t),i=Math.min(z.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*t),a={streaming:{buffer:{bufferToKeep:parseFloat(e.toFixed(5)),bufferTimeAtTopQuality:parseFloat(r.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(i.toFixed(5))}}};z.update(a);}}(),void(22!==e.error.code&&we()||(n.warn("Clearing playback buffer to overcome quota exceed situation"),Ne(l.Z.QUOTA_EXCEEDED,{criticalBufferLevel:o,quotaExceededTime:e.chunk.start}),ye(me())));if(p&&(fe(),I=!1,(_=e.chunk)&&_.endFragment)){_&&!isNaN(_.index)&&(g=Math.max(_.index,g),de());var t=p.getAllBufferRanges();_.segmentType===C.w.MEDIA_SEGMENT_TYPE&&(re(t),se(),function(){if(!isNaN(M)&&!y)if(K===a.Z.AUDIO||K===a.Z.VIDEO){var e=H.getTime(),t=ce(e,0),n=ce(M,0);if(t&&n&&t.start===n.start)M=NaN;else {var r=G.getCurrentRepresentation().segmentDuration,i=ce(M,r);i&&(z.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(e-M)>r?M<=i.end&&H.seek(Math.max(M,i.start),!1,!0):e<i.start&&H.seek(i.start,!1,!0));}}else M=NaN;}());var r=!1;E&&(E.indexOf(_)>0&&(r=!0),E=null),_&&!r&&Ne(l.Z.BYTES_APPENDED_END_FRAGMENT,{quality:_.quality,startTime:_.start,index:_.index,bufferedRanges:t,segmentType:_.segmentType,mediaType:K});}}function ae(){return new Promise(function(e,t){var n=oe();if(!n||0===n.length)return se(),void e();ye(n).then(function(){e();}).catch(function(e){t(e);});});}function oe(e){var t=[],r=p.getAllBufferRanges();if(!r||0===r.length)return t;if(!e&&0!==e||isNaN(e))t.push({start:r.start(0),end:r.end(r.length-1)+.5});else {var i=function(e,t){var n=z.get().streaming.buffer.bufferToKeep,r=t.start(0);if(e-r>n){var i=Math.max(0,e-n),a=B.getRequests({state:T.FRAGMENT_MODEL_EXECUTED,time:e,threshold:F})[0];if(a&&(i=Math.min(a.startTime,i)),i>0)return {start:r,end:i};}return null;}(e,r),a=function(e,t){var r=t.end(t.length-1)+.5,i=Re(e),a=V.manifestInfo.duration>=z.get().streaming.buffer.longFormContentDurationThreshold?z.get().streaming.buffer.bufferTimeAtTopQualityLongForm:z.get().streaming.buffer.bufferTimeAtTopQuality,o=isNaN(i)?e:Math.min(i,e+a);if(o>=t.end(t.length-1))return null;var s=B.getRequests({state:T.FRAGMENT_MODEL_EXECUTED,time:e,threshold:F})[0];if(s&&(o=Math.max(s.startTime+s.duration,o)),z.get().streaming.buffer.avoidCurrentTimeRangePruning)for(var u=0;u<t.length;u++)if(t.start(u)<=e&&e<=t.end(u)&&t.start(u)<=o&&o<=t.end(u)){var l=o;o=u+1<t.length?t.start(u+1):t.end(u)+1,n.debug("Buffered range ["+t.start(u)+", "+t.end(u)+"] overlaps with targetTime "+e+" and range to be pruned ["+l+", "+r+"], using ["+o+", "+r+"] instead"+(o<r?"":" (no actual pruning)"));break;}return o<t.end(t.length-1)?{start:o,end:r}:null;}(e,r);i&&t.push(i),a&&t.push(a);}return t;}function se(){(!D||K===a.Z.TEXT&&Y.isTextEnabled())&&fe();}function ue(){ge();}function le(){ge(),M=NaN;}function ce(e,t){var n,r,i=p.getAllBufferRanges(),a=0,o=0,s=null,u=null,l=0,c=isNaN(t)?.15:t;if(null!=i){for(r=0,n=i.length;r<n;r++)if(a=i.start(r),o=i.end(r),null===s)l=Math.abs(a-e),(e>=a&&e<o||l<=c)&&(s=a,u=o);else {if(!((l=a-u)<=c))break;u=o;}if(null!==s)return {start:s,end:u};}return null;}function fe(){if(H){var e=H.getTime()||0;y&&(e=isNaN(M)?0:M);var t=z.get().streaming.gaps.jumpGaps&&!isNaN(z.get().streaming.gaps.smallGapLimit)?z.get().streaming.gaps.smallGapLimit:NaN;i=Math.max(function(e,t){var n;return z.get().streaming.gaps.jumpGaps&&(t=z.get().streaming.gaps.smallGapLimit),null===(n=ce(e,t))?0:n.end-e;}(e,t),0),Ne(l.Z.BUFFER_LEVEL_UPDATED,{mediaType:K,bufferLevel:i}),ge();}}function de(){var e=g>=h-1,t=H.getTimeToStreamEnd(V)-i<1e-5;!e&&!t||r||(Ae(!0),n.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(V.id," and type ").concat(K)));}function ge(){K!==a.Z.AUDIO&&K!==a.Z.VIDEO||((!H.getLowLatencyModeEnabled()&&i<z.get().streaming.buffer.stallThreshold||0===i)&&!r?he(s.Z.BUFFER_EMPTY):(r||i>=z.get().streaming.buffer.stallThreshold||H.getLowLatencyModeEnabled()&&i>0)&&he(s.Z.BUFFER_LOADED));}function he(e){v===e||e===s.Z.BUFFER_EMPTY&&0===H.getTime()||K===a.Z.TEXT&&!Y.isTextEnabled()||(v=e,Ne(l.Z.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Ne(e===s.Z.BUFFER_LOADED?l.Z.BUFFER_LOADED:l.Z.BUFFER_EMPTY),n.debug(e===s.Z.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"));}function pe(){p&&K!==a.Z.TEXT&&(r||ye(me()));}function me(){var e=[],t=p.getAllBufferRanges();if(!t||0===t.length)return e;var n=H.getTime(),r=Math.max(0,n-z.get().streaming.buffer.bufferToKeep),i=B.getRequests({state:T.FRAGMENT_MODEL_EXECUTED,time:n,threshold:F})[0];if(i)r=Math.min(i.startTime,r);else if(0===n&&H.getIsDynamic())return [];if(t.start(0)<=r){for(var a={start:0,end:r},o=0;o<t.length&&t.end(o)<=r;o++)a.end=t.end(o);a.start<a.end&&e.push(a);}return e;}function ye(e){return new Promise(function(t,n){if(e&&p&&0!==e.length){var r=[];e.forEach(function(e){r.push(function(e){return new Promise(function(t,n){e.resolve=t,e.reject=n,N.push(e);});}(e));}),A||Ee(),Promise.all(r).then(function(){t();}).catch(function(e){n(e);});}else t();});}function Ee(){try{if(0===N.length||!p)return n.debug("Nothing to prune, halt pruning"),N=[],void(A=!1);var e=p.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return n.debug("SourceBuffer is empty (or does not exist), halt pruning"),N=[],void(A=!1);var t=N.shift();n.debug("".concat(K,": Removing buffer from: ").concat(t.start," to ").concat(t.end)),A=!0,H.getTime()<t.end&&Ae(!1),p.remove(t).then(function(e){ve(e);}).catch(function(e){ve(e);});}catch(e){A=!1;}}function ve(e){n.debug("onRemoved buffer from:",e.from,"to",e.to),re(p.getAllBufferRanges()),0===N.length&&(A=!1,fe()),e.unintended&&(n.warn("Detected unintended removal from:",e.from,"to",e.to,"setting streamprocessor time to",e.from),Ne(l.Z.SEEK_TARGET,{time:e.from})),A?Ee():(D?D=!1:fe(),Ne(l.Z.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:we(),quotaExceeded:I}));}function _e(e){return new Promise(function(t){e&&void 0!==e.MSETimeOffset&&p&&p.updateTimestampOffset?p.updateTimestampOffset(e.MSETimeOffset).then(function(){t();}).catch(function(){t();}):t();});}function Te(){return p&&!r?p.updateAppendWindow(V):Promise.resolve();}function Se(){++b*(z.get().streaming.wallclockTimeUpdateInterval/1e3)>=z.get().streaming.buffer.bufferPruningInterval&&(b=0,pe());}function be(){ge();}function Ae(e){(r=e)?Ne(l.Z.BUFFERING_COMPLETED):h=Number.POSITIVE_INFINITY;}function Ie(){try{var e,t,n=p.getAllBufferRanges(),r=0;if(!n)return r;for(t=0,e=n.length;t<e;t++)r+=n.end(t)-n.start(t);return r;}catch(e){return 0;}}function Re(e){try{var t=e,n=p.getAllBufferRanges();if(!n||0===n.length)return NaN;for(var r=0;t===e&&r<n.length;){var i=n.start(r),a=n.end(r);t>=i&&t<=a&&(t=a),r+=1;}return t===e?NaN:t;}catch(e){}}function we(){var e=Ie();return isNaN(e)||e<o;}function Ne(e,t){var n=t||{};U.trigger(e,n,{streamId:V.id,mediaType:K});}function Ce(e,t){if(o=Number.POSITIVE_INFINITY,v=void 0,h=Number.POSITIVE_INFINITY,g=0,_=null,r=!1,A=!1,I=!1,i=0,b=0,N=[],M=NaN,y=!1,p){var n=p;p=null,e||t||n.abort().then(function(){n.reset(t),n=null;});}D=!1;}return t={initialize:function(e){W(e),U.on(l.Z.INIT_FRAGMENT_LOADED,ee,t),U.on(l.Z.MEDIA_FRAGMENT_LOADED,te,t),U.on(l.Z.WALLCLOCK_TIME_UPDATED,Se,t),U.on(d.Z.PLAYBACK_PLAYING,le,t),U.on(d.Z.PLAYBACK_PROGRESS,se,t),U.on(d.Z.PLAYBACK_TIME_UPDATED,se,t),U.on(d.Z.PLAYBACK_RATE_CHANGED,be,t),U.on(d.Z.PLAYBACK_STALLED,ue,t);},getStreamId:function(){return V.id;},getType:function(){return K;},getBufferControllerType:function(){return k;},createBufferSink:Q,dischargePreBuffer:function(){if(p&&m&&"function"==typeof m.discharge){var e=m.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+K+"PreBuffer discharge, adding buffer for:",r=0;r<e.length;r++)t+=" start: "+e.start(r)+", end: "+e.end(r)+";";n.debug(t);}else n.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");E=[];for(var i=m.discharge(),a=null,o=0;o<i.length;o++){var s=i[o];if(s.segmentType!==C.w.INIT_SEGMENT_TYPE){var u=R.extract(s.streamId,s.representationId);u&&a!==u&&(E.push(u),p.append(u),a=u);}E.push(s),p.append(s);}m.reset(),m=null;}},getBuffer:function(){return p;},getBufferLevel:function(){return i;},getRangeAt:ce,hasBufferAtTime:function(e){try{var t=p.getAllBufferRanges();if(!t||0===t.length)return !1;for(var r=0;r<t.length;){var i=t.start(r),a=t.end(r);if(e>=i&&e<=a)return !0;r+=1;}return !1;}catch(e){return n.error(e),!1;}},pruneBuffer:pe,setMediaSource:W,getMediaSource:function(){return c;},appendInitSegmentFromCache:function(e){var t=R.extract(V.id,e);return !!t&&(n.info("Append Init fragment",K," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),ne(t),!0);},getIsBufferingCompleted:function(){return r;},setIsBufferingCompleted:Ae,getIsPruningInProgress:function(){return A;},reset:function(e,t){U.off(l.Z.INIT_FRAGMENT_LOADED,ee,this),U.off(l.Z.MEDIA_FRAGMENT_LOADED,te,this),U.off(l.Z.WALLCLOCK_TIME_UPDATED,Se,this),U.off(d.Z.PLAYBACK_PLAYING,le,this),U.off(d.Z.PLAYBACK_PROGRESS,se,this),U.off(d.Z.PLAYBACK_TIME_UPDATED,se,this),U.off(d.Z.PLAYBACK_RATE_CHANGED,be,this),U.off(d.Z.PLAYBACK_STALLED,ue,this),Ce(e,t);},prepareForPlaybackSeek:function(){return r&&Ae(!1),p.abort();},prepareForReplacementTrackSwitch:function(e){return new Promise(function(t,n){p.abort().then(function(){return Te();}).then(function(){return z.get().streaming.buffer.useChangeTypeForTrackSwitch?p.changeType(e):Promise.resolve();}).then(function(){return ae();}).then(function(){Ae(!1),t();}).catch(function(e){n(e);});});},prepareForNonReplacementTrackSwitch:function(e){return new Promise(function(t,n){Te().then(function(){return z.get().streaming.buffer.useChangeTypeForTrackSwitch?p.changeType(e):Promise.resolve();}).then(function(){t();}).catch(function(e){n(e);});});},prepareForForceReplacementQualitySwitch:function(e){return new Promise(function(t,n){p.abort().then(function(){return Te();}).then(function(){return ae();}).then(function(){return _e(e);}).then(function(){Ae(!1),t();}).catch(function(e){n(e);});});},updateAppendWindow:Te,getAllRangesWithSafetyFactor:oe,getContinuousBufferTimeForTargetTime:Re,clearBuffers:ye,pruneAllSafely:ae,updateBufferTimestampOffset:_e,setSeekTarget:function(e){M=e;},segmentRequestingCompleted:function(e){isNaN(e)||(h=e,de());}},n=(0, f.Z)(L).getInstance().getLogger(t),R=x(L).getInstance(),Ce(),t;}U.__dashjs_factory_name=k;const Z=c.Z.getClassFactory(U);var B="NotFragmentedTextBufferController";function G(e){e=e||{};var t,n,r,i,a,o,s=this.context,c=(0, u.Z)(s).getInstance(),f=e.textController,d=e.errHandler,g=e.streamInfo,h=e.type;function p(e){i=e;}function m(e){var t,r;n!==e&&(n=e)&&(t=l.Z.BUFFERING_COMPLETED,r={},c.trigger(t,r,{streamId:g.id,mediaType:h}));}function y(e){e.chunk.bytes&&!n&&(o.save(e.chunk),a.append(e.chunk),m(!0));}return t={initialize:function(e){p(e);},getStreamId:function(){return g.id;},getType:function(){return h;},getBufferControllerType:function(){return B;},createBufferSink:function(e){return new Promise(function(t,n){try{(a=O(s).create({mediaSource:i,textController:f,eventBus:c})).initializeForFirstUse(g,e),r||(a.getBuffer()&&"function"==typeof a.getBuffer().initialize&&a.getBuffer().initialize(),r=!0),t(a);}catch(e){d.error(new S.Z(w.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,w.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+h)),n(e);}});},dischargePreBuffer:function(){},getBuffer:function(){return a;},getBufferLevel:function(){return 0;},getRangeAt:function(){return null;},pruneBuffer:function(){},hasBufferAtTime:function(){return !0;},getAllRangesWithSafetyFactor:function(){return [];},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY;},setMediaSource:p,getMediaSource:function(){return i;},appendInitSegmentFromCache:function(e){return null!==o.extract(g.id,e);},getIsBufferingCompleted:function(){return n;},setIsBufferingCompleted:m,getIsPruningInProgress:function(){return !1;},reset:function(e){c.off(l.Z.INIT_FRAGMENT_LOADED,y,t),!e&&a&&(a.abort(),a.reset(),a=null);},clearBuffers:function(){return Promise.resolve();},prepareForPlaybackSeek:function(){return Promise.resolve();},prepareForReplacementTrackSwitch:function(){return n=!1,Promise.resolve();},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve();},pruneAllSafely:function(){return Promise.resolve();},updateBufferTimestampOffset:function(){return Promise.resolve();},segmentRequestingCompleted:function(){}},r=!1,i=null,n=!1,o=x(s).getInstance(),c.on(l.Z.INIT_FRAGMENT_LOADED,y,t),t;}G.__dashjs_factory_name=B;const q=c.Z.getClassFactory(G);function Y(e){e=e||{};var t,n,r,i,o,c,g,h,p,m,y,E,v=this.context,_=(0, u.Z)(v).getInstance(),S=e.dashMetrics,b=e.mediaPlayerModel,A=e.fragmentModel,I=e.abrController,R=e.playbackController,w=e.textController,N=e.type,C=e.bufferController,D=e.representationController,O=e.settings;function M(e){if(!C.getIsBufferingCompleted()){P();var t=isNaN(e)?0:e;o=setTimeout(L,t);}}function P(){o&&(clearTimeout(o),o=null);}function L(){try{if(function(){try{return N===a.Z.TEXT&&!w.isTextEnabled()||R.isPaused()&&(!R.getStreamController().getInitialPlayback()||!R.getStreamController().getAutoPlay())&&!O.get().streaming.scheduling.scheduleWhilePaused;}catch(e){return !1;}}())return void P();if(function(){try{return D.getCurrentRepresentationInfo()&&(isNaN(p)||m||(e=n.id,t=I.getMaxAllowedIndexFor(N,e),!(!isNaN(h)&&h==t||(r.info("Top quality "+N+" index has changed from "+h+" to "+t),h=t,0)))||function(){var e=D.getCurrentRepresentationInfo();return !N||!e||S.getCurrentBufferLevel(N)<x();}());}catch(e){return !1;}var e,t;}()){var e=!1;E&&(e=I.checkPlaybackQuality(N,n.id)),e||(i=D.getCurrentRepresentationInfo(),y||i.quality!==p||m?(m?(r.debug("Switch track for "+N+", representation id = "+i.id),m=!1):r.debug("Quality has changed, get init request for representationid = "+i.id),_.trigger(l.Z.INIT_FRAGMENT_NEEDED,{representationId:i.id,sender:t},{streamId:n.id,mediaType:N}),E=!1,y=!1):(r.debug("Media segment needed for ".concat(N," and stream id ").concat(n.id)),_.trigger(l.Z.MEDIA_FRAGMENT_NEEDED,{},{streamId:n.id,mediaType:N}),E=!0));}else M(R.getLowLatencyModeEnabled()?O.get().streaming.scheduling.lowLatencyTimeout:O.get().streaming.scheduling.defaultTimeout);}catch(e){M(R.getLowLatencyModeEnabled()?O.get().streaming.scheduling.lowLatencyTimeout:O.get().streaming.scheduling.defaultTimeout);}var i;}function x(){var e=NaN,t=D.getCurrentRepresentationInfo();return N&&t?(e=N===a.Z.TEXT?function(){try{if(w.isTextEnabled()){var e=D.getCurrentRepresentationInfo();if(isNaN(e.fragmentDuration)){var t=S.getCurrentSchedulingInfo(s.Z.SCHEDULING_INFO);return t?t.duration:0;}return e.fragmentDuration;}return 0;}catch(e){return 0;}}():N===a.Z.AUDIO&&c?function(){try{var e=S.getCurrentBufferLevel(a.Z.VIDEO),t=D.getCurrentRepresentationInfo();return isNaN(t.fragmentDuration)?e+1:Math.max(e+1,t.fragmentDuration);}catch(e){return 0;}}():function(){try{var e=D.getCurrentRepresentationInfo().mediaInfo.streamInfo;return I.isPlayingAtTopQuality(e)?e.manifestInfo.duration>=O.get().streaming.buffer.longFormContentDurationThreshold?O.get().streaming.buffer.bufferTimeAtTopQualityLongForm:O.get().streaming.buffer.bufferTimeAtTopQuality:b.getStableBufferTime();}catch(e){return b.getStableBufferTime();}}(),e):e;}function F(){k(!0);}function k(e){if(R&&A){var t=A.getRequests({state:T.FRAGMENT_MODEL_EXECUTED,time:R.getTime(),threshold:0})[0];t&&R.getTime()>=t.startTime&&((!g.mediaInfo||t.mediaInfo.type===g.mediaInfo.type&&t.mediaInfo.id!==g.mediaInfo.id)&&e&&_.trigger(l.Z.TRACK_CHANGE_RENDERED,{mediaType:N,oldMediaInfo:g.mediaInfo,newMediaInfo:t.mediaInfo,streamId:n.id}),t.quality===g.quality&&t.adaptationIndex===g.adaptationIndex||!e||(r.debug("Quality change rendered for streamId ".concat(n.id," and type ").concat(N)),_.trigger(l.Z.QUALITY_CHANGE_RENDERED,{mediaType:N,oldQuality:g.quality,newQuality:t.quality,streamId:n.id})),g={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex});}}function U(){A.abortRequests(),P();}function Z(){O.get().streaming.scheduling.scheduleWhilePaused||M();}function B(e){S.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()});}function G(){E=!0,i=0,p=NaN,g={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},h=NaN,m=!1,y=!1;}return t={initialize:function(e){c=e,_.on(l.Z.URL_RESOLUTION_FAILED,U,t),_.on(d.Z.PLAYBACK_STARTED,Z,t),_.on(d.Z.PLAYBACK_RATE_CHANGED,B,t),_.on(d.Z.PLAYBACK_TIME_UPDATED,F,t);},getType:function(){return N;},getStreamId:function(){return n.id;},setTimeToLoadDelay:function(e){i=e;},getTimeToLoadDelay:function(){return i;},setSwitchTrack:function(e){m=e;},getSwitchTrack:function(){return m;},startScheduleTimer:M,clearScheduleTimer:P,reset:function(){_.off(l.Z.URL_RESOLUTION_FAILED,U,t),_.off(d.Z.PLAYBACK_STARTED,Z,t),_.off(d.Z.PLAYBACK_RATE_CHANGED,B,t),_.off(d.Z.PLAYBACK_TIME_UPDATED,F,t),P(),k(!1),G(),n=null;},getBufferTarget:x,getPlaybackController:function(){return R;},setCheckPlaybackQuality:function(e){E=e;},setInitSegmentRequired:function(e){y=e;},setLastInitializedQuality:function(e){p=e;}},r=(0, f.Z)(v).getInstance().getLogger(t),G(),n=e.streamInfo,t;}Y.__dashjs_factory_name="ScheduleController";const j=c.Z.getClassFactory(Y);var H=n(7387);function V(e){var t,n,r,i,o,s,u=(e=e||{}).eventBus,l=e.events,c=e.abrController,f=e.dashMetrics,g=e.playbackController,h=e.timelineConverter,p=e.type,m=e.streamInfo,y=e.dashConstants,E=e.segmentsController,v=e.isDynamic,_=e.adapter;function T(){return p;}function S(){if(!(c&&f&&g&&h))throw new Error(a.Z.MISSING_CONFIG_ERROR);}function b(){return r;}function A(){return s;}function I(){n=null,r=!0,i=[],o=null;}function R(e){return new Promise(function(t,n){var r=e.hasInitialization(),a=e.hasSegments(),o=[];o.push(E.updateInitData(e,r)),o.push(E.updateSegmentData(e,a)),Promise.all(o).then(function(n){var r;n[0]&&!n[0].error&&(e=function(e,t){return t&&!t.error&&t.representation?t.representation:e;}(e,n[0])),n[1]&&!n[1].error&&(e=function(e,t){if(t&&!t.error){var n,r,i,a,o=t.segments,s=[],u=0;for(n=0,r=o?o.length:0;n<r;n++)i=o[n],(a=(0, H.TJ)(h,v,e,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,u))&&(s.push(a),a=null,u++);return s.length>0&&(e.segments=s),e;}}(e,n[1])),(r=e).mediaFinishedInformation=E.getMediaFinishedInformation(r),function(e){if(b()){var t,n,r=f.getCurrentManifestUpdate(),a=!1;if(r){for(var o=0;o<r.representationInfo.length;o++)if((t=r.representationInfo[o]).index===e.index&&t.mediaType===T()){a=!0;break;}a||f.addManifestUpdateRepresentationInfo(e,T());}if(function(){for(var e=0,t=i.length;e<t;e++){var n=i[e].segmentInfoType;if(!i[e].hasInitialization()||(n===y.SEGMENT_BASE||n===y.BASE_URL)&&!i[e].segments)return !1;}return !0;}()){c.setPlaybackQuality(p,m,(n=s,i.indexOf(n)));var u=f.getCurrentDVRInfo(p);u&&f.updateManifestUpdateInfo({latency:u.range.end-g.getTime()}),f.getCurrentRepresentationSwitch(A().adaptation.type)||w(),C();}}}(e),t();}).catch(function(e){n(e);});});}function w(){S();var e=new Date(),t=A(),n=1e3*g.getTime();t&&f.addRepresentationSwitch(t.adaptation.type,e,n,t.id),u.trigger(d.Z.REPRESENTATION_SWITCH,{mediaType:p,streamId:m.id,currentRepresentation:t,numberOfRepresentations:i.length},{streamId:m.id,mediaType:p});}function N(e){return null==e||e>=i.length?null:i[e];}function C(e){r=!1,u.trigger(l.DATA_UPDATE_COMPLETED,{data:n,currentRepresentation:s,error:e},{streamId:m.id,mediaType:p});}function D(e){s=e,o=_.convertRepresentationToRepresentationInfo(s);}function O(e){if(e.newDuration){var t=A();t&&t.adaptation.period&&(t.adaptation.period.duration=e.newDuration);}}return t={getStreamId:function(){return m.id;},getType:T,getData:function(){return n;},isUpdating:b,updateData:function(e,t,o,s,u){if(S(),r=!0,i=t,D(N(u)),n=e,o!==a.Z.VIDEO&&o!==a.Z.AUDIO&&(o!==a.Z.TEXT||!s))return C(),Promise.resolve();for(var l=[],c=0,f=i.length;c<f;c++){var d=i[c];l.push(R(d));}return Promise.all(l);},getCurrentRepresentation:A,getCurrentRepresentationInfo:function(){return o;},getRepresentationForQuality:N,prepareQualityChange:function(e){D(N(e)),w();},reset:function(){u.off(d.Z.MANIFEST_VALIDITY_CHANGED,O,t),I();}},I(),u.on(d.Z.MANIFEST_VALIDITY_CHANGED,O,t),t;}V.__dashjs_factory_name="RepresentationController";const K=c.Z.getClassFactory(V);var z=n(3106),W=n(9326),X=n(7473),Q=n(2594);function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}var $=function e(){J(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[];};$.INITIAL_PLAYOUT_START_REASON="initial_playout",$.SEEK_START_REASON="seek",$.RESUME_FROM_PAUSE_START_REASON="resume",$.METRICS_COLLECTION_START_REASON="metrics_collection_start";var ee=function e(){J(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null;};ee.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",ee.REBUFFERING_REASON="rebuffering",ee.USER_REQUEST_STOP_REASON="user_request",ee.END_OF_PERIOD_STOP_REASON="end_of_period",ee.END_OF_CONTENT_STOP_REASON="end_of_content",ee.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",ee.FAILURE_STOP_REASON="failure";var te=n(7802);function ne(){return {ntpToUTC:function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime();}};}ne.__dashjs_factory_name="TimeUtils";const re=c.Z.getSingletonFactory(ne);function ie(e){e=e||{};var t,n,r,i,c,g,h,p,m,y,E,v,_,b,A=this.context,I=(0, u.Z)(A).getInstance(),R=e.streamInfo,N=e.type,D=e.errHandler,O=e.mimeType,M=e.timelineConverter,P=e.adapter,L=e.manifestModel,x=e.mediaPlayerModel,F=e.fragmentModel,k=e.abrController,U=e.playbackController,B=e.mediaController,G=e.textController,Y=e.dashMetrics,H=e.settings,V=e.boxParser,J=e.segmentBlacklistController;function $(){return R.id;}function ne(){return N;}function ie(){return P.getIsTextTrack(p.getData());}function ae(){c=[],i=null,_=0,m=!1,y=!1,b=null;}function oe(e){return !isNaN(e)&&!isNaN(R.duration)&&isFinite(R.duration)&&e>=R.start+R.duration;}function se(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.sender)if(U.getIsManifestUpdateInProgress())de();else if((!ie()||G.isTextEnabled())&&g&&e.representationId&&!g.appendInitSegmentFromCache(e.representationId)){var n=p.getCurrentRepresentation();if(0===n.range)return void ue();var r=E?E.getInitRequest(i,n):null;r?F.executeRequest(r):t&&(h.setInitSegmentRequired(!0),de());}}function ue(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(U.getIsManifestUpdateInProgress()||g.getIsPruningInProgress())de();else {var n=fe();n?(m=!1,le(n)):ce(t);}}function le(e){isNaN(e.startTime+e.duration)||(_=e.startTime+e.duration),e.delayLoadingTime=new Date().getTime()+h.getTimeToLoadDelay(),h.setTimeToLoadDelay(0),function(e){var t=e.url;return e.range&&(t=t.concat("_",e.range)),J.contains(t);}(e)?(n.warn("Fragment request url ".concat(e.url," for stream id ").concat(R.id," and media type ").concat(N," is on the ignore list and will be skipped")),de()):(n.debug("Next fragment request url for stream id ".concat(R.id," and media type ").concat(N," is ").concat(e.url)),F.executeRequest(e));}function ce(e){var t,a=p.getCurrentRepresentation();if(!H.get().streaming.gaps.enableSeekFix||!m&&0!==U.getTime()||(r?r&&a.segmentInfoType===o.Z.SEGMENT_TIMELINE&&(t=E.getValidTimeAheadOfTargetTime(_,i,a,H.get().streaming.gaps.threshold)):t=E.getValidTimeAheadOfTargetTime(_,i,a,H.get().streaming.gaps.threshold),isNaN(t)||t===_)){if(E.isLastSegmentRequested(a,_)){var s=E.getCurrentIndex();return n.debug("Segment requesting for stream ".concat(R.id," has finished")),I.trigger(l.Z.STREAM_REQUESTING_COMPLETED,{segmentIndex:s},{streamId:R.id,mediaType:N}),g.segmentRequestingCompleted(s),void h.clearScheduleTimer();}e&&de();}else U.isSeeking()||0===U.getTime()?(n.warn("Adjusting playback time ".concat(t," because of gap in the manifest. Seeking by ").concat(t-_)),U.seek(t,!1,!1)):(n.warn("Adjusting buffering time ".concat(t," because of gap in the manifest. Adjusting time by ").concat(t-_)),Le(t),e&&de());}function fe(){var e,t=we();if(isNaN(_)||ne()===a.Z.TEXT&&!G.isTextEnabled())return null;if(E){var n=p&&t?p.getRepresentationForQuality(t.quality):null;e=m?E.getSegmentRequestForTime(i,n,_):E.getNextSegmentRequest(i,n);}return e;}function de(){h.startScheduleTimer(U.getLowLatencyModeEnabled()?H.get().streaming.scheduling.lowLatencyTimeout:H.get().streaming.scheduling.defaultTimeout);}function ge(e){e.error||g.getIsBufferingCompleted()||g.updateBufferTimestampOffset(e.currentRepresentation);}function he(e){Y.addBufferState(N,e.state,h.getBufferTarget()),e.state!==s.Z.BUFFER_EMPTY||U.isSeeking()||(n.info("Buffer is empty! Stalling!"),Y.pushPlayListTraceMetrics(new Date(),ee.REBUFFERING_REASON));}function pe(e){F.syncExecutedRequestsWithBufferedRange(g.getBuffer().getAllBufferRanges(),R.duration),e.quotaExceeded&&e.from>U.getTime()&&Le(e.from),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&h.startScheduleTimer();}function me(e){if(e&&e.lastRequestAppended&&e.lastRequestAppended.url){var t=e.lastRequestAppended.url;e.lastRequestAppended.range&&(t=t.concat("_",e.lastRequestAppended.range)),n.warn("Blacklisting segment with url ".concat(t)),J.add(t);}}function ye(e){if(n.debug("Appended bytes for ".concat(e.mediaType," and stream id ").concat(e.streamId)),e.segmentType===C.w.INIT_SEGMENT_TYPE){var t=e.quality;h.setLastInitializedQuality(t),n.info("["+N+"] lastInitializedRepresentationInfo changed to "+e.quality);}b?Ee(b):h.startScheduleTimer(0);}function Ee(e){var t=F.getRequests({state:T.FRAGMENT_MODEL_LOADING});if(t&&t.length>0)return n.debug("Preparing for default quality switch: Waiting for ongoing segment request to be finished before applying switch."),void(b=e);g.updateBufferTimestampOffset(e).then(function(){i.segmentAlignment||i.subSegmentAlignment?h.startScheduleTimer():Me(),b=null,y=!1;}).catch(function(){b=null,y=!1;});}function ve(e){n.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),U.isSeeking()||h.getSwitchTrack()||y||(n.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),e.request&&e.request.isInitializationRequest()?h.setInitSegmentRequired(!0):Le(e.request.startTime+e.request.duration/2),h.startScheduleTimer(0));}function _e(e){n.info("OnFragmentLoadingCompleted for stream id "+R.id+" and media type "+N+" - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),ie()&&h.startScheduleTimer(0),e.error&&e.request.serviceLocation&&function(e){n.info("Fragment loading completed with an error"),e&&e.request&&e.request.type&&(e.request.type===C.w.INIT_SEGMENT_TYPE?se({representationId:e.request.representationId,sender:{}},!1):e.request.type===C.w.MEDIA_SEGMENT_TYPE&&(Le(e.request.startTime+e.request.duration/2),ue({},!1)));}(e);}function Te(){Le(U.getTime()),Re().startScheduleTimer();}function Se(e){var t=e.currentTrackInfo;if(t){var n=c.find(function(e){return e.index===t.index&&e.lang===t.lang;});n&&Ie(n).then(function(){g.setIsBufferingCompleted(!1),Le(U.getTime()),h.setInitSegmentRequired(!0),h.startScheduleTimer();});}}function be(e){Le(e.quotaExceededTime),h.clearScheduleTimer();}function Ae(){return g?g.getBuffer():null;}function Ie(e){e===i||e&&i&&e.type!==i.type||(i=e);var t=P.getRealAdaptation(R,i),n=P.getVoRepresentations(i);if(p){var o,s=p.getData(),u=k.getMaxAllowedIndexFor(N,R.id),l=k.getMinAllowedIndexFor(N,R.id),c=null;return null!==s&&s.id===t.id||N===a.Z.TEXT?o=k.getQualityFor(N,R.id):(c=k.getThroughputHistory().getAverageThroughput(N,r)||k.getInitialBitrateFor(N,R.id),o=k.getQualityForBitrate(i,c,R.id)),void 0!==l&&o<l&&(o=l),o>u&&(o=u),p.updateData(t,n,N,i.isFragmented,o);}return Promise.resolve();}function Re(){return h;}function we(e){var t;return void 0!==e?((0, z.SE)(e),t=p?p.getRepresentationForQuality(e):null):t=p?p.getCurrentRepresentation():null,P.convertRepresentationToRepresentationInfo(t);}function Ne(){return !!g&&g.getIsBufferingCompleted();}function Ce(e){if(H.get().streaming.enableManifestTimescaleMismatchFix){var t=e.chunk,n=t.bytes,r=we(t.quality),i=p&&r?p.getRepresentationForQuality(r.quality):null;r&&i&&(i.timescale=V.getMediaTimescaleFromMoov(n));}}function De(e){var t=e.chunk,n=t.bytes,r=t.quality,i=we(r),a=p&&i?p.getRepresentationForQuality(i.quality):null;if(i&&a){var s;if(H.get().streaming.parseInbandPrft&&e.request.type===C.w.MEDIA_SEGMENT_TYPE){var u=function(e,t){var n=e.getBoxes("prft"),r=[];return n.forEach(function(e){r.push(function(e,t){var n="unknown";switch(e.flags){case 0:n=o.Z.PRODUCER_REFERENCE_TIME_TYPE.ENCODER;break;case 16:n=o.Z.PRODUCER_REFERENCE_TIME_TYPE.APPLICATION;break;case 24:n=o.Z.PRODUCER_REFERENCE_TIME_TYPE.CAPTURED;}var r=1e3*e.ntp_timestamp_sec+e.ntp_timestamp_frac/Math.pow(2,32)*1e3;return {type:n,ntpTimestamp:r=re(A).getInstance().ntpToUTC(r),mediaTime:e.media_time/t};}(e,t));}),r;}(s=s||V.parse(n),a.timescale);u&&u.length&&I.trigger(d.Z.INBAND_PRFT,{data:u},{streamId:R.id,mediaType:N});}var c=P.getEventsFor(i.mediaInfo,null,R),f=P.getEventsFor(i,a,R);if(c&&c.length>0||f&&f.length>0){var g=F.getRequests({state:T.FRAGMENT_MODEL_EXECUTED,quality:r,index:t.index})[0],h=function(e,t,n,r){try{for(var i={},a=[],o=n.concat(r),s=0,u=o.length;s<u;s++)i[o[s].schemeIdUri+"/"+o[s].value]=o[s];var l=e.getBoxes("emsg");if(!l||0===l.length)return a;for(var c=e.getBox("sidx"),f=!c||isNaN(c.earliest_presentation_time)||isNaN(c.timescale)?t&&!isNaN(t.mediaStartTime)?t.mediaStartTime:0:c.earliest_presentation_time/c.timescale,d=Math.max(f,0),g=p.getCurrentRepresentation(),h=0,m=l.length;h<m;h++){var y=P.getEvent(l[h],i,d,g);y&&a.push(y);}return a;}catch(e){return [];}}(s=s||V.parse(n),g,c,f);I.trigger(l.Z.INBAND_EVENTS,{events:h},{streamId:R.id});}}}function Oe(){var e=U.getTime();H.get().streaming.buffer.flushBufferAtTrackSwitch&&U.seek(e+.001,!1,!0),Le(e),g.setSeekTarget(e),h.startScheduleTimer();}function Me(){var e=U.getTime(),t=g.getContinuousBufferTimeForTargetTime(e);Le(isNaN(t)?e:t),h.startScheduleTimer();}function Pe(e){e&&!isNaN(e.time)&&(Le(e.time),g.setSeekTarget(e.time));}function Le(e){_=e,m=!0;}return t={initialize:function(n,i,s){v=(0, te.Z)(A).create({events:l.Z,eventBus:I,streamInfo:R,timelineConverter:M,dashConstants:o.Z,segmentBaseController:e.segmentBaseController,type:N}),E=(0, W.Z)(A).create({streamInfo:R,type:N,timelineConverter:M,dashMetrics:Y,mediaPlayerModel:x,baseURLController:e.baseURLController,errHandler:D,segmentsController:v,settings:H,boxParser:V,events:l.Z,eventBus:I,errors:w,debug:(0, f.Z)(A).getInstance(),requestModifier:(0, X.Z)(A).getInstance(),dashConstants:o.Z,constants:a.Z,urlUtils:(0, Q.Z)(A).getInstance()}),r=R.manifestInfo.isDynamic,E.initialize(r),k.registerStreamType(N,t),p=K(A).create({streamInfo:R,type:N,abrController:k,dashMetrics:Y,playbackController:U,timelineConverter:M,dashConstants:o.Z,events:l.Z,eventBus:I,errors:w,isDynamic:r,adapter:P,segmentsController:v}),g=function(e,t){return e?e!==a.Z.TEXT||t?Z(A).create({streamInfo:R,type:e,mediaPlayerModel:x,manifestModel:L,fragmentModel:F,errHandler:D,mediaController:B,representationController:p,adapter:P,textController:G,abrController:k,playbackController:U,settings:H}):q(A).create({streamInfo:R,type:e,mimeType:O,fragmentModel:F,textController:G,errHandler:D,settings:H}):(D.error(new S.Z(w.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,w.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null);}(N,s),g&&g.initialize(n),(h=j(A).create({streamInfo:R,type:N,mimeType:O,adapter:P,dashMetrics:Y,mediaPlayerModel:x,fragmentModel:F,abrController:k,playbackController:U,textController:G,mediaController:B,bufferController:g,representationController:p,settings:H})).initialize(i),_=0,m=!1;},getStreamId:$,getType:ne,isUpdating:function(){return !!p&&p.isUpdating();},getBufferController:function(){return g;},dischargePreBuffer:function(){g.dischargePreBuffer();},getFragmentModel:function(){return F;},getScheduleController:Re,getRepresentationController:function(){return p;},getRepresentationInfo:we,getBufferLevel:function(){return g?g.getBufferLevel():0;},isBufferingCompleted:Ne,createBufferSinks:function(e){var t=Ae();return t?Promise.resolve(t):g?g.createBufferSink(i,e):Promise.resolve(null);},updateStreamInfo:function(e){return R=e,Ne()?Promise.resolve():g.updateAppendWindow();},getStreamInfo:function(){return R;},selectMediaInfo:Ie,clearMediaInfoArray:function(){c=[];},addMediaInfo:function(e){-1===c.indexOf(e)&&c.push(e);},prepareTrackSwitch:function(){return new Promise(function(e){n.debug("Preparing track switch for type ".concat(N));var t=N===a.Z.TEXT||H.get().streaming.trackSwitchMode[N]===a.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&U.getTimeToStreamEnd(R)>H.get().streaming.buffer.stallThreshold;if(g.getIsBufferingCompleted()&&!t)return g.prepareForNonReplacementTrackSwitch(i.codec).then(function(){I.trigger(l.Z.BUFFERING_COMPLETED,{},{streamId:R.id,mediaType:N});}).catch(function(){I.trigger(l.Z.BUFFERING_COMPLETED,{},{streamId:R.id,mediaType:N});}),void e();h.clearScheduleTimer(),h.setSwitchTrack(!0),t?(I.trigger(l.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:N,streamId:R.id},{mediaType:N,streamId:R.id}),F.abortRequests(),g.prepareForReplacementTrackSwitch(i.codec).then(function(){var e=we();return g.updateBufferTimestampOffset(e);}).then(function(){Oe(),e();}).catch(function(){Oe(),e();})):g.prepareForNonReplacementTrackSwitch(i.codec).then(function(){Me(),e();}).catch(function(){Me(),e();});});},prepareQualityChange:function(e){b&&n.warning("Canceling queued representation switch to ".concat(b.quality," for ").concat(N)),n.debug("Preparing quality switch for type ".concat(N));var t=e.newQuality;y=!0,h.clearScheduleTimer(),p.prepareQualityChange(t);var r=we(t);e.reason&&e.reason.forceReplace?function(e){F.abortRequests(),I.trigger(l.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:N,streamId:R.id},{mediaType:N,streamId:R.id}),g.prepareForForceReplacementQualitySwitch(e).then(function(){Oe(),y=!1;}).catch(function(){Oe(),y=!1;});}(r):H.get().streaming.buffer.fastSwitchEnabled?function(e){var t=U.getTime(),n=1.5*(isNaN(e.fragmentDuration)?1:e.fragmentDuration),r=F.getRequests({state:T.FRAGMENT_MODEL_EXECUTED,time:t+n,threshold:0})[0];if(r&&!ie()){var i=g.getBufferLevel(),a=k.getAbandonmentStateFor(R.id,N);r.quality<e.quality&&i>=n&&a!==s.Z.ABANDON_LOAD?g.updateBufferTimestampOffset(e).then(function(){F.abortRequests(),Le(t+n),h.setCheckPlaybackQuality(!1),h.startScheduleTimer(),y=!1;}).catch(function(){y=!1;}):Ee(e);}else h.startScheduleTimer(),y=!1;}(r):Ee(r),Y.pushPlayListTraceMetrics(new Date(),ee.REPRESENTATION_SWITCH_STOP_REASON),Y.createPlaylistTraceMetrics(r.id,1e3*U.getTime(),U.getPlaybackRate());},getMediaInfo:function(){return i;},getMediaSource:function(){return g.getMediaSource();},setMediaSource:function(e){return g.setMediaSource(e,i);},getBuffer:Ae,setExplicitBufferingTime:Le,finalisePlayList:function(e,t){Y.pushPlayListTraceMetrics(e,t);},probeNextRequest:function(){var e=we(),t=p&&e?p.getRepresentationForQuality(e.quality):null;return E.getNextSegmentRequestIdempotent(i,t);},prepareInnerPeriodPlaybackSeeking:function(e){return new Promise(function(t){if(g.hasBufferAtTime(e.seekTime))return g.pruneBuffer(),oe(g.getContinuousBufferTimeForTargetTime(e.seekTime))&&g.setIsBufferingCompleted(!0),void t();h.clearScheduleTimer(),F.abortRequests(),g.prepareForPlaybackSeek().then(function(){var t=g.getAllRangesWithSafetyFactor(e.seekTime);return g.clearBuffers(t);}).then(function(){var n=g.getContinuousBufferTimeForTargetTime(e.seekTime);if(oe(n))g.setIsBufferingCompleted(!0),t();else {var r=isNaN(n)?e.seekTime:n;Le(r),g.setSeekTarget(r);var i=[];i.push(g.updateAppendWindow());var a=we();i.push(g.updateBufferTimestampOffset(a)),Promise.all(i).then(function(){h.setInitSegmentRequired(!0),h.setCheckPlaybackQuality(!1),h.startScheduleTimer(),t();});}}).catch(function(e){n.error(e);});});},prepareOuterPeriodPlaybackSeeking:function(){return new Promise(function(e,t){try{h.clearScheduleTimer(),F.abortRequests(),g.prepareForPlaybackSeek().then(function(){return g.pruneAllSafely();}).then(function(){e();});}catch(e){t(e);}});},reset:function(e,n){E&&E.reset(),g&&(g.reset(e,n),g=null),h&&(h.reset(),h=null),p&&(p.reset(),p=null),v&&(v=null),k&&k.unRegisterStreamType($(),N),I.off(l.Z.DATA_UPDATE_COMPLETED,ge,t),I.off(l.Z.INIT_FRAGMENT_NEEDED,se,t),I.off(l.Z.MEDIA_FRAGMENT_NEEDED,ue,t),I.off(l.Z.INIT_FRAGMENT_LOADED,Ce,t),I.off(l.Z.MEDIA_FRAGMENT_LOADED,De,t),I.off(l.Z.BUFFER_LEVEL_STATE_CHANGED,he,t),I.off(l.Z.BUFFER_CLEARED,pe,t),I.off(l.Z.SEEK_TARGET,Pe,t),I.off(l.Z.FRAGMENT_LOADING_ABANDONED,ve,t),I.off(l.Z.FRAGMENT_LOADING_COMPLETED,_e,t),I.off(l.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Te,t),I.off(l.Z.SET_NON_FRAGMENTED_TEXT,Se,t),I.off(l.Z.QUOTA_EXCEEDED,be,t),I.off(l.Z.SOURCE_BUFFER_ERROR,me,t),I.off(l.Z.BYTES_APPENDED_END_FRAGMENT,ye,t),ae(),N=null,R=null;}},n=(0, f.Z)(A).getInstance().getLogger(t),ae(),I.on(l.Z.DATA_UPDATE_COMPLETED,ge,t,{priority:u.Z.EVENT_PRIORITY_HIGH}),I.on(l.Z.INIT_FRAGMENT_NEEDED,se,t),I.on(l.Z.MEDIA_FRAGMENT_NEEDED,ue,t),I.on(l.Z.INIT_FRAGMENT_LOADED,Ce,t),I.on(l.Z.MEDIA_FRAGMENT_LOADED,De,t),I.on(l.Z.BUFFER_LEVEL_STATE_CHANGED,he,t),I.on(l.Z.BUFFER_CLEARED,pe,t),I.on(l.Z.SEEK_TARGET,Pe,t),I.on(l.Z.FRAGMENT_LOADING_ABANDONED,ve,t),I.on(l.Z.FRAGMENT_LOADING_COMPLETED,_e,t),I.on(l.Z.QUOTA_EXCEEDED,be,t),I.on(l.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Te,t),I.on(l.Z.SET_NON_FRAGMENTED_TEXT,Se,t),I.on(l.Z.SOURCE_BUFFER_ERROR,me,t),I.on(l.Z.BYTES_APPENDED_END_FRAGMENT,ye,t),t;}ie.__dashjs_factory_name="StreamProcessor";const ae=c.Z.getClassFactory(ie),oe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null;};var se=n(9032);function ue(e,t){if(e){if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0;}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r;}function ce(e){e=e||{};var t,n,r=this.context,i=e.requestModifier,o=e.lowLatencyThroughputModel,s=e.boxParser,u=(0, N.Z)(r).getInstance();function l(e){var t,r=new Date(),l=e.request,d=new Headers();if(l.range&&d.append("Range","bytes="+l.range),e.headers)for(var g in e.headers){var h=e.headers[g];h&&d.append(g,h);}l.requestStartDate||(l.requestStartDate=r),i&&i.modifyRequestHeader&&i.modifyRequestHeader({setRequestHeader:function(e,t){d.append(e,t);}},{url:e.url}),"function"==typeof window.AbortController&&(t=new AbortController(),e.abortController=t,t.signal.onabort=e.onabort);var p={method:e.method,headers:d,credentials:e.withCredentials?"include":void 0,signal:t?t.signal:void 0},m=u.get().streaming.abr.fetchThroughputCalculationMode,y=Date.now(),E=0;new Promise(function(e){if(m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&o&&(E=o.getThroughputCapacityDelayMS(l,1e3*n.getCurrentBufferLevel(l.mediaType))))return setTimeout(e,E);e();}).then(function(){var t=Date.now();fetch(e.url,p).then(function(r){e.response||(e.response={}),e.response.status=r.status,e.response.statusText=r.statusText,e.response.responseURL=r.url,r.ok||e.onerror();var i,u="",d=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ue(e))){n&&(e=n);var r=0,i=function(){};return {s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function(e){throw e;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var a,o=!0,s=!1;return {s:function(){n=e[Symbol.iterator]();},n:function(){var e=n.next();return o=e.done,e;},e:function(e){s=!0,a=e;},f:function(){try{o||null==n.return||n.return();}finally{if(s)throw a;}}};}(r.headers.keys());try{for(d.s();!(i=d.n()).done;){var g=i.value;u+=g+": "+r.headers.get(g)+"\r\n";}}catch(e){d.e(e);}finally{d.f();}if(e.response.responseHeaders=u,!r.body)return r.arrayBuffer().then(function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend();});var h,p,v,_,T=parseInt(r.headers.get("Content-Length"),10),S=0,b=!1,A=new Uint8Array(),I=0;if(m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&o){var R=t,w=0,N=(v=r.body.tee(),_=2,function(e){if(Array.isArray(e))return e;}(v)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e;}finally{try{r||null==s.return||s.return();}finally{if(i)throw a;}}return n;}}(v,_)||ue(v,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}()),C=N[0],D=N[1];h=C.getReader(),p=[],h.read().then(function r(i){var a=i.value,s=i.done;if(w=Date.now(),a&&a.length){var c=w-R,f=a.length;p.push({chunkDownloadTimeRelativeMS:w-t,chunkDownloadDurationMS:c,chunkBytes:f,kbps:Math.round(8*f/(c/1e3)),bufferLevel:n.getCurrentBufferLevel(l.mediaType)});}if(s){var d=w-t,g=p.reduce(function(e,t){return e+t.chunkBytes;},0);return o.addMeasurement(l,d,p,y,E,u),void e.progress({loaded:g,total:g,lengthComputable:!0,time:o.getEstimatedDownloadDurationMS(l),stream:!0});}return R=Date.now(),h.read().then(r);}),e.reader=D.getReader();}else e.reader=r.body.getReader();var O=[],M=[],P=[],L=!0;c(e,function t(n){var r=n.value;if(n.done){if(A){if(m!==a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var i=null,o=null;m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(i=function(e,t){try{var n,r;n=e.filter(function(t,n){return n<e.length-1;}),r=t.filter(function(e,n){return n<t.length-1;});var i=[];if(n.length>1){for(var a=0,o=0,s=0;s<n.length;s++)if(n[s]&&r[s]){var u=r[s].ts-n[s].ts;if(u>1)i.push(8*r[s].bytes/u),o=0;else {0===o&&(o=n[s].ts,a=0);var l=r[s].ts-o;l>1?(a+=r[s].bytes,i.push(8*a/l),o=0):a+=r[s].bytes;}}if(i.length>0)return i.reduce(function(e,t){return e+t;},0)/i.length;}return null;}catch(e){return null;}}(M,P),i&&(o=8*S/i)):m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(o=f(O,S)),e.progress({loaded:S,total:isNaN(T)?S:T,lengthComputable:!0,time:o,stream:!0});}e.response.response=A.buffer;}return e.onload(),void e.onend();}if(r&&r.length>0){A=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n;}(A,r),S+=r.length,O.push({ts:Date.now(),bytes:r.length}),m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&L&&s.findLastTopIsoBoxCompleted(["moof"],A,I).found&&(L=!1,M.push({ts:performance.now(),bytes:r.length}));var u=s.findLastTopIsoBoxCompleted(["moov","mdat"],A,I);if(u.found){var l,d=u.lastCompletedOffset+u.size;m!==a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||L||(L=!0,P.push({ts:performance.now(),bytes:A.length})),d===A.length?(l=A,A=new Uint8Array()):(l=new Uint8Array(A.subarray(0,d)),A=A.subarray(d)),e.progress({data:l.buffer,lengthComputable:!1,noTrace:!0}),I=0;}else I=u.lastCompletedOffset,b||(e.progress({lengthComputable:!1,noTrace:!0}),b=!0);}c(e,t);});}).catch(function(t){e.onerror&&e.onerror(t);});});}function c(e,t){e.reader.read().then(t).catch(function(t){e.onerror&&200===e.response.status&&e.onerror(t);});}function f(e,t){try{if((e=e.filter(function(n){return n.bytes>t/4/e.length;})).length>1){var n=0,r=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach(function(t,i){var a=e[i+1];if(a){var o=a.ts-t.ts;n+=o<r?o:0;}}),n;}return null;}catch(e){return null;}}return t={load:function(e){i&&i.modifyRequest?(0, X.k)(e,i).then(function(){return l(e);}):l(e);},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort();}catch(e){}},calculateDownloadedTime:f,setup:function(e){n=e.dashMetrics;}},t;}ce.__dashjs_factory_name="FetchLoader";const fe=c.Z.getClassFactory(ce);var de=n(1180);function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const he=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.frameRate=null;}var t,n;return t=e,(n=[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range;}},{key:"hasSegments",value:function(){return this.segmentInfoType!==o.Z.BASE_URL&&this.segmentInfoType!==o.Z.SEGMENT_BASE&&!this.indexRange;}}])&&ge(t.prototype,n),e;}(),pe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.period=null,this.index=-1,this.type=null;};var me=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null;};me.DEFAULT_ID="defaultId";const ye=me,Ee=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN;};var ve=n(2610);const _e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.type="",this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN;};var Te=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.queryParams={};};Te.DEFAULT_DVB_PRIORITY=1,Te.DEFAULT_DVB_WEIGHT=1;const Se=Te,be=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0;},Ae=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null;},Ie=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.defaultServiceLocation=null,this.defaultServiceLocationArray=[],this.queryBeforeStart=!1,this.serverUrl=null,this.clientRequirement=!0;};function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const we=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.schemeIdUri=null,this.value=null,this.id=null;}var t,n;return t=e,(n=[{key:"init",value:function(e){return e&&(this.schemeIdUri=e.schemeIdUri?e.schemeIdUri:null,this.value=e.value?e.value:null,this.id=e.id?e.id:null),this;}}])&&Re(t.prototype,n),e;}();var Ne=n(3101),Ce=n.n(Ne);function De(){return {areEqual:function(e,t){return Ce()(e,t);}};}De.__dashjs_factory_name="ObjectUtils";const Oe=c.Z.getSingletonFactory(De);var Me=n(7803);const Pe=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=t||"",this.serviceLocation=n||null,this.queryParams={};},Le=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=t||"",this.serviceLocation=n||null,this.ttl=r||NaN,this.queryParams={};};function xe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Fe(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return {s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function(e){throw e;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var a,o=!0,s=!1;return {s:function(){n=e[Symbol.iterator]();},n:function(){var e=n.next();return o=e.done,e;},e:function(e){s=!0,a=e;},f:function(){try{o||null==n.return||n.return();}finally{if(s)throw a;}}};}function Fe(e,t){if(e){if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(e,t):void 0;}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r;}function Ue(){var e,t,n,r,i=this.context,s=(0, Q.Z)(i).getInstance(),u=Number.isInteger||function(e){return "number"==typeof e&&isFinite(e)&&Math.floor(e)===e;};function l(e,t){if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.Representation_asArray&&e.Representation_asArray.length){var n=v(e.Representation_asArray[0]);if(n&&n.length>0&&Me.Y.indexOf(n[0].schemeIdUri)>=0)return t===a.Z.IMAGE;}if(e.ContentComponent_asArray&&e.ContentComponent_asArray.length>0){if(e.ContentComponent_asArray.length>1)return t===a.Z.MUXED;if(e.ContentComponent_asArray[0].contentType===t)return !0;}var r=t===a.Z.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(t);if(e.Representation_asArray&&e.Representation_asArray.length){var i=e.Representation_asArray[0].codecs;if(r.test(i))return !0;}if(e.hasOwnProperty(o.Z.MIME_TYPE))return r.test(e.mimeType);if(e.Representation_asArray)for(var s,u=0;u<e.Representation_asArray.length;u++)if((s=e.Representation_asArray[u]).hasOwnProperty(o.Z.MIME_TYPE))return r.test(s.mimeType);return !1;}function c(e){if(!e)throw new Error("adaptation is not defined");if(e.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)||e.hasOwnProperty(o.Z.SEGMENT_TIMELINE)||e.hasOwnProperty(o.Z.SEGMENT_LIST)||e.hasOwnProperty(o.Z.SEGMENT_BASE))return !0;if(e.Representation_asArray&&e.Representation_asArray.length>0){var t=e.Representation_asArray[0];if(t.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)||t.hasOwnProperty(o.Z.SEGMENT_TIMELINE)||t.hasOwnProperty(o.Z.SEGMENT_LIST)||t.hasOwnProperty(o.Z.SEGMENT_BASE))return !0;}return !1;}function d(e){return l(e,a.Z.VIDEO);}function g(e){return l(e,a.Z.TEXT);}function h(e){return l(e,a.Z.IMAGE);}function p(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth;}),e;}function m(e,t){return e&&e.Period_asArray&&u(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[];}function y(e){return e&&e.Period_asArray?e.Period_asArray:[];}function E(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===o.Z.DYNAMIC),t;}function v(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return {schemeIdUri:e.schemeIdUri,value:e.value};}):null;}function _(e){if(!e||!e.S_asArray)return NaN;var t=e.S_asArray[0],n=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:n.t-t.t;}function T(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=ye.DEFAULT_ID+"_"+t;return e.hasOwnProperty(o.Z.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n;}function b(e,t,n){var r,i=[];if(!e)return i;for(r=0;r<e.length;r++){var s=new be();if(s.timescale=1,s.representation=t,!e[r].hasOwnProperty(a.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");s.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty(o.Z.TIMESCALE)&&(s.timescale=e[r].timescale),e[r].hasOwnProperty(o.Z.VALUE)&&(s.value=e[r].value),i.push(s),s.period=n;}return i;}function A(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some(function(n){if(n){var i=new Se(),a=n.__text||n;return s.isRelative(a)&&(r=!0,e.baseUri&&(a=s.resolve(a,e.baseUri))),i.url=a,n.hasOwnProperty(o.Z.SERVICE_LOCATION)&&n.serviceLocation.length?i.serviceLocation=n.serviceLocation:i.serviceLocation=a,n.hasOwnProperty(o.Z.DVB_PRIORITY)&&(i.dvb_priority=n[o.Z.DVB_PRIORITY]),n.hasOwnProperty(o.Z.DVB_WEIGHT)&&(i.dvb_weight=n[o.Z.DVB_WEIGHT]),n.hasOwnProperty(o.Z.AVAILABILITY_TIME_OFFSET)&&(i.availabilityTimeOffset=n[o.Z.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(o.Z.AVAILABILITY_TIME_COMPLETE)&&(i.availabilityTimeComplete="false"!==n[o.Z.AVAILABILITY_TIME_COMPLETE]),t.push(i),r;}}),t;}function I(e){var t=new Ie();return t.serverUrl=e.__text,e.hasOwnProperty(o.Z.DEFAULT_SERVICE_LOCATION)&&(t.defaultServiceLocation=e[o.Z.DEFAULT_SERVICE_LOCATION],t.defaultServiceLocationArray=t.defaultServiceLocation.split(" ")),e.hasOwnProperty(o.Z.QUERY_BEFORE_START)&&(t.queryBeforeStart="true"===e[o.Z.QUERY_BEFORE_START].toLowerCase()),e.hasOwnProperty(o.Z.CLIENT_REQUIREMENT)&&(t.clientRequirement="false"!==e[o.Z.CLIENT_REQUIREMENT].toLowerCase()),t;}return e={getIsTypeOf:l,getIsText:g,getIsFragmented:c,getProducerReferenceTimesForAdaptation:function(e){var t=e&&e.hasOwnProperty(o.Z.PRODUCERREFERENCETIME_ASARRAY)?e[o.Z.PRODUCERREFERENCETIME_ASARRAY]:[];(e&&e.hasOwnProperty(o.Z.REPRESENTATION_ASARRAY)?e[o.Z.REPRESENTATION_ASARRAY]:[]).forEach(function(e){var n;e.hasOwnProperty(o.Z.PRODUCERREFERENCETIME_ASARRAY)&&t.push.apply(t,function(e){if(Array.isArray(e))return ke(e);}(n=e[o.Z.PRODUCERREFERENCETIME_ASARRAY])||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e);}(n)||Fe(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}());});var n=[];return t.forEach(function(e){var t=new Ae();e.hasOwnProperty(o.Z.ID)&&(t[o.Z.ID]=e[o.Z.ID],e.hasOwnProperty(o.Z.WALL_CLOCK_TIME)&&(t[o.Z.WALL_CLOCK_TIME]=e[o.Z.WALL_CLOCK_TIME],e.hasOwnProperty(o.Z.PRESENTATION_TIME)&&(t[o.Z.PRESENTATION_TIME]=e[o.Z.PRESENTATION_TIME],e.hasOwnProperty(o.Z.INBAND)&&(t[o.Z.INBAND]="false"!==e[o.Z.INBAND]),e.hasOwnProperty(o.Z.TYPE)&&(t[o.Z.TYPE]=e[o.Z.TYPE]),n.push(t))));}),n;},getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(o.Z.LANG)&&(t=e.lang),t;},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.VIEWPOINT_ASARRAY)&&e[o.Z.VIEWPOINT_ASARRAY].length?e[o.Z.VIEWPOINT_ASARRAY].map(function(e){return new we().init(e);}):[];},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ROLE_ASARRAY)&&e[o.Z.ROLE_ASARRAY].length?e[o.Z.ROLE_ASARRAY].map(function(e){return new we().init(e);}):[];},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ACCESSIBILITY_ASARRAY)&&e[o.Z.ACCESSIBILITY_ASARRAY].length?e[o.Z.ACCESSIBILITY_ASARRAY].map(function(e){return new we().init(e);}):[];},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map(function(e){return new we().init(e);}):[];},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map(function(e){return new we().init(e);}):[];},getAdaptationForIndex:function(e,t,n){var r=m(t,n);return r.length>0&&u(e)?r[e]:null;},getIndexForAdaptation:function(e,t,n){if(!e)return -1;for(var r=m(t,n),a=0;a<r.length;a++)if(Oe(i).getInstance().areEqual(r[a],e))return a;return -1;},getAdaptationForId:function(e,t,n){var r,i,a=m(t,n);for(r=0,i=a.length;r<i;r++)if(a[r].hasOwnProperty(o.Z.ID)&&a[r].id===e)return a[r];return null;},getAdaptationsForType:function(e,t,n){var r,i,a=m(e,t),o=[];for(r=0,i=a.length;r<i;r++)l(a[r],n)&&o.push(p(a[r]));return o;},getRealPeriods:y,getRealPeriodForIndex:function(e,t){var n=y(t);return n.length>0&&u(e)?n[e]:null;},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=u(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'));}return r&&(r=r.replace(/\sprofiles=[^;]*/g,"")),r;},getSelectionPriority:function(e){try{var t=e&&void 0!==e.selectionPriority?parseInt(e.selectionPriority):1;return isNaN(t)?1:t;}catch(e){return 1;}},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null;},getKID:function(e){return e&&e.hasOwnProperty(o.Z.CENC_DEFAULT_KID)?e[o.Z.CENC_DEFAULT_KID]:null;},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return [];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t;},getContentProtectionData:function(e){return e&&e.hasOwnProperty(o.Z.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null;},getIsDynamic:E,getId:function(e){return e&&e[o.Z.ID]||null;},hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n;},getDuration:function(e){return e&&e.hasOwnProperty(o.Z.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE;},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN;},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(o.Z.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1);},getPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.PUBLISH_TIME)?new Date(e[o.Z.PUBLISH_TIME]):null;},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0;},getBitrateListForAdaptation:function(e){var t=p(e);return (t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map(function(e){return {bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null};});},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&u(e)?t.Representation_asArray[e]:null;},getRepresentationsForAdaptation:function(e){var t,n,r,i,a=[],s=function(e){if(e&&e.period&&u(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&u(e.index))return p(t.AdaptationSet_asArray[e.index]);}}(e);if(s&&s.Representation_asArray){if(e&&e.period&&u(e.period.index)){var l=A(e.period.mpd.manifest);l&&(n=l[0]);}for(var f=0,d=s.Representation_asArray.length;f<d;++f){var h=s.Representation_asArray[f],m=new he();if(m.index=f,m.adaptation=e,h.hasOwnProperty(o.Z.ID)&&(m.id=h.id),h.hasOwnProperty(o.Z.CODECS)&&(m.codecs=h.codecs),h.hasOwnProperty(o.Z.MIME_TYPE)&&(m.mimeType=h[o.Z.MIME_TYPE]),h.hasOwnProperty(o.Z.CODEC_PRIVATE_DATA)&&(m.codecPrivateData=h.codecPrivateData),h.hasOwnProperty(o.Z.BANDWITH)&&(m.bandwidth=h.bandwidth),h.hasOwnProperty(o.Z.WIDTH)&&(m.width=h.width),h.hasOwnProperty(o.Z.HEIGHT)&&(m.height=h.height),h.hasOwnProperty(o.Z.SCAN_TYPE)&&(m.scanType=h.scanType),h.hasOwnProperty(o.Z.MAX_PLAYOUT_RATE)&&(m.maxPlayoutRate=h.maxPlayoutRate),h.hasOwnProperty(o.Z.SEGMENT_BASE)?(t=h.SegmentBase,m.segmentInfoType=o.Z.SEGMENT_BASE):h.hasOwnProperty(o.Z.SEGMENT_LIST)?(t=h.SegmentList).hasOwnProperty(o.Z.SEGMENT_TIMELINE)?m.segmentInfoType=o.Z.SEGMENT_TIMELINE:m.segmentInfoType=o.Z.SEGMENT_LIST:h.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)?((t=h.SegmentTemplate).hasOwnProperty(o.Z.SEGMENT_TIMELINE)?m.segmentInfoType=o.Z.SEGMENT_TIMELINE:m.segmentInfoType=o.Z.SEGMENT_TEMPLATE,t.hasOwnProperty(o.Z.INITIALIZATION_MINUS)&&(m.initialization=t.initialization.split("$Bandwidth$").join(h.bandwidth).split("$RepresentationID$").join(h.id))):m.segmentInfoType=o.Z.BASE_URL,m.essentialProperties=v(h),t){if(t.hasOwnProperty(o.Z.INITIALIZATION)){var y=t.Initialization;y.hasOwnProperty(o.Z.SOURCE_URL)&&(m.initialization=y.sourceURL),y.hasOwnProperty(o.Z.RANGE)&&(m.range=y.range);}else g(s)&&c(s)&&s.mimeType&&-1===s.mimeType.indexOf("application/mp4")&&(m.range=0);t.hasOwnProperty(o.Z.TIMESCALE)&&(m.timescale=t.timescale),t.hasOwnProperty(o.Z.DURATION)?m.segmentDuration=t.duration/m.timescale:h.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)&&(t=h.SegmentTemplate).hasOwnProperty(o.Z.SEGMENT_TIMELINE)&&(m.segmentDuration=_(t.SegmentTimeline)/m.timescale),t.hasOwnProperty(o.Z.MEDIA)&&(m.media=t.media),t.hasOwnProperty(o.Z.START_NUMBER)&&(m.startNumber=t.startNumber),t.hasOwnProperty(o.Z.INDEX_RANGE)&&(m.indexRange=t.indexRange),t.hasOwnProperty(o.Z.PRESENTATION_TIME_OFFSET)&&(m.presentationTimeOffset=t.presentationTimeOffset/m.timescale),t.hasOwnProperty(o.Z.AVAILABILITY_TIME_OFFSET)?m.availabilityTimeOffset=t.availabilityTimeOffset:n&&void 0!==n.availabilityTimeOffset&&(m.availabilityTimeOffset=n.availabilityTimeOffset),t.hasOwnProperty(o.Z.AVAILABILITY_TIME_COMPLETE)?m.availabilityTimeComplete="false"!==t.availabilityTimeComplete:n&&void 0!==n.availabilityTimeComplete&&(m.availabilityTimeComplete=n.availabilityTimeComplete);}m.MSETimeOffset=(i=(r=m).presentationTimeOffset,r.adaptation.period.start-i),m.path=[e.period.index,e.index,f],a.push(m);}}return a;},getAdaptationsForPeriod:function(e){var n,r,i,s=e&&u(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,c=[];if(s&&s.AdaptationSet_asArray)for(i=0;i<s.AdaptationSet_asArray.length;i++)r=s.AdaptationSet_asArray[i],n=new pe(),r.hasOwnProperty(o.Z.ID)&&(n.id=r.id),n.index=i,n.period=e,l(r,a.Z.MUXED)?n.type=a.Z.MUXED:l(r,a.Z.AUDIO)?n.type=a.Z.AUDIO:d(r)?n.type=a.Z.VIDEO:g(r)?n.type=a.Z.TEXT:h(r)?n.type=a.Z.IMAGE:t.warn("Unknown Adaptation stream type"),c.push(n);return c;},getRegularPeriods:function(e){var r,i,s=!!e&&E(e.manifest),u=[],l=null,c=null,f=null,d=null;for(i=0,r=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;i<r;i++)(c=e.manifest.Period_asArray[i]).hasOwnProperty(o.Z.START)?(d=new ye()).start=c.start:null!==l&&l.hasOwnProperty(o.Z.DURATION)&&null!==f?(d=new ye()).start=parseFloat((f.start+f.duration).toFixed(5)):0!==i||s||((d=new ye()).start=0),null!==f&&isNaN(f.duration)&&(null!==d?f.duration=parseFloat((d.start-f.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==d&&(d.id=T(c,i),d.index=i,d.mpd=e,c.hasOwnProperty(o.Z.DURATION)&&(d.duration=c.duration),f&&(f.nextPeriodId=d.id),u.push(d),l=c,f=d),c=null,d=null;return 0===u.length||null!==f&&isNaN(f.duration)&&(f.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error(a.Z.MISSING_CONFIG_ERROR);}();var t,r=E(e.mpd.manifest);return e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:r?t=Number.POSITIVE_INFINITY:n.error(new S.Z(w.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),t;}(f)-f.start).toFixed(5))),u;},getMpd:function(e){var t=new Ee();return e&&(t.manifest=e,e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(o.Z.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(o.Z.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(o.Z.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(o.Z.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(o.Z.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(o.Z.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(o.Z.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t;},getEventsForPeriod:function(e){var t,n,i=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,s=i?i.Period_asArray:null,l=s&&e&&u(e.index)?s[e.index].EventStream_asArray:null,c=[];if(l)for(t=0;t<l.length;t++){var f=new be();if(f.period=e,f.timescale=1,!l[t].hasOwnProperty(a.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(f.schemeIdUri=l[t][a.Z.SCHEME_ID_URI],l[t].hasOwnProperty(o.Z.TIMESCALE)&&(f.timescale=l[t][o.Z.TIMESCALE]),l[t].hasOwnProperty(o.Z.VALUE)&&(f.value=l[t][o.Z.VALUE]),l[t].hasOwnProperty(o.Z.PRESENTATION_TIME_OFFSET)&&(f.presentationTimeOffset=l[t][o.Z.PRESENTATION_TIME_OFFSET]),n=0;l[t].Event_asArray&&n<l[t].Event_asArray.length;n++){var d=l[t].Event_asArray[n],g=new _e();g.presentationTime=0,g.eventStream=f,d.hasOwnProperty(o.Z.PRESENTATION_TIME)&&(g.presentationTime=d.presentationTime);var h=f.presentationTimeOffset?f.presentationTimeOffset/f.timescale:0;g.calculatedPresentationTime=g.presentationTime/f.timescale+e.start-h,d.hasOwnProperty(o.Z.DURATION)&&(g.duration=d.duration/f.timescale),d.hasOwnProperty(o.Z.ID)?g.id=d.id:g.id=null,d.Signal&&d.Signal.Binary?g.messageData=r.decodeArray(d.Signal.Binary.toString()):g.messageData=d.messageData||d.__cdata||d.__text,c.push(g);}}return c;},getEssentialPropertiesForRepresentation:v,getEventStreamForAdaptationSet:function(e,t,n){var r,i,a;return e&&e.Period_asArray&&t&&t.period&&u(t.period.index)&&(i=e.Period_asArray[t.period.index])&&i.AdaptationSet_asArray&&u(t.index)&&(a=i.AdaptationSet_asArray[t.index])&&(r=a.InbandEventStream_asArray),b(r,null,n);},getEventStreamForRepresentation:function(e,t,n){var r,i,a,o;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&u(t.adaptation.period.index)&&(i=e.Period_asArray[t.adaptation.period.index])&&i.AdaptationSet_asArray&&u(t.adaptation.index)&&(a=i.AdaptationSet_asArray[t.adaptation.index])&&a.Representation_asArray&&u(t.index)&&(o=a.Representation_asArray[t.index])&&(r=o.InbandEventStream_asArray),b(r,t,n);},getUTCTimingSources:function(e){var t=E(e),n=!!e&&e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,i=[];return (t||n)&&r&&r.forEach(function(e){var t=new ve.Z();e.hasOwnProperty(a.Z.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(o.Z.VALUE)&&(t.value=e.value.toString(),i.push(t)));}),i;},getBaseURLsFromElement:A,getRepresentationSortFunction:function(){return function(e,t){return e.bandwidth-t.bandwidth;};},getContentSteering:function(e){if(e&&e.hasOwnProperty(o.Z.CONTENT_STEERING_AS_ARRAY))return I(e[o.Z.CONTENT_STEERING_AS_ARRAY][0]);},getLocation:function(e){return e&&e.hasOwnProperty(o.Z.LOCATION_AS_ARRAY)?e[o.Z.LOCATION_AS_ARRAY].map(function(e){var t=e.__text||e,n=e.hasOwnProperty(o.Z.SERVICE_LOCATION)?e[o.Z.SERVICE_LOCATION]:null;return new Pe(t,n);}):[];},getPatchLocation:function(e){return e&&e.hasOwnProperty(o.Z.PATCH_LOCATION_AS_ARRAY)?e[o.Z.PATCH_LOCATION_AS_ARRAY].map(function(e){var t=e.__text||e,n=e.hasOwnProperty(o.Z.SERVICE_LOCATION)?e[o.Z.SERVICE_LOCATION]:null,r=e.hasOwnProperty(o.Z.TTL)?1e3*parseFloat(e[o.Z.TTL]):NaN;return new Le(t,n,r);}):[];},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(o.Z.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null;},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null;},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(o.Z.SERVICE_DESCRIPTION)){var n,r=xe(e.ServiceDescription_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=null,s=null,u=null,l=null,c=null,f=null,d=null;for(var g in i)i.hasOwnProperty(g)&&(g===o.Z.ID?a=i[g]:g===o.Z.SERVICE_DESCRIPTION_SCOPE?s=i[g].schemeIdUri:g===o.Z.SERVICE_DESCRIPTION_LATENCY?u={target:parseInt(i[g].target),max:parseInt(i[g].max),min:parseInt(i[g].min),referenceId:parseInt(i[g].referenceId)}:g===o.Z.SERVICE_DESCRIPTION_PLAYBACK_RATE?l={max:parseFloat(i[g].max),min:parseFloat(i[g].min)}:g===o.Z.SERVICE_DESCRIPTION_OPERATING_QUALITY?c={mediaType:i[g].mediaType,max:parseInt(i[g].max),min:parseInt(i[g].min),target:parseInt(i[g].target),type:i[g].type,maxQualityDifference:parseInt(i[g].maxQualityDifference)}:g===o.Z.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH?f={mediaType:i[g].mediaType,max:parseInt(i[g].max),min:parseInt(i[g].min),target:parseInt(i[g].target)}:g===o.Z.CONTENT_STEERING&&(d=I(i[g])));t.push({id:a,schemeIdUri:s,latency:u,playbackRate:l,operatingQuality:c,operatingBandwidth:f,contentSteering:d});}}catch(e){r.e(e);}finally{r.f();}}return t;},getSegmentAlignment:function(e){return !(!e||!e.hasOwnProperty(o.Z.SEGMENT_ALIGNMENT))&&"true"===e[o.Z.SEGMENT_ALIGNMENT];},getSubSegmentAlignment:function(e){return !(!e||!e.hasOwnProperty(o.Z.SUB_SEGMENT_ALIGNMENT))&&"true"===e[o.Z.SUB_SEGMENT_ALIGNMENT];},getSupplementalPropertiesForAdaptation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var n,r=xe(e.SupplementalProperty_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hasOwnProperty(a.Z.SCHEME_ID_URI)&&i.hasOwnProperty(o.Z.VALUE)&&(t[i[a.Z.SCHEME_ID_URI]]=i[o.Z.VALUE]);}}catch(e){r.e(e);}finally{r.f();}}return t;},getSupplementalPropertiesAsArrayForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map(function(e){return new we().init(e);}):[];},getSupplementalPropertiesForRepresentation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var n,r=xe(e.SupplementalProperty_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hasOwnProperty(a.Z.SCHEME_ID_URI)&&i.hasOwnProperty(o.Z.VALUE)&&(t[i[a.Z.SCHEME_ID_URI]]=i[o.Z.VALUE]);}}catch(e){r.e(e);}finally{r.f();}}return t;},getSupplementalPropertiesAsArrayForRepresentation:function(e){return e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map(function(e){return new we().init(e);}):[];},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(r=e.BASE64));}},t=(0, f.Z)(i).getInstance().getLogger(e),e;}Ue.__dashjs_factory_name="DashManifestModel";const Ze=c.Z.getSingletonFactory(Ue);var Be=n(703);function Ge(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qe(e,t):void 0;}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return {s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function(e){throw e;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var a,o=!0,s=!1;return {s:function(){n=e[Symbol.iterator]();},n:function(){var e=n.next();return o=e.done,e;},e:function(e){s=!0,a=e;},f:function(){try{o||null==n.return||n.return();}finally{if(s)throw a;}}};}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r;}function Ye(){var e,t,n,r,i,o,s,l,c,f,g=this.context,h=(0, u.Z)(g).getInstance(),p=(0, N.Z)(g).getInstance();function m(){n={pr:1,nor:null,st:null,sf:null,sid:"".concat(Be.Z.generateUuid()),cid:null},c={},l={},f={},E();}function y(){E();}function E(){if(o){var e=o.getStreamController();if(e&&"function"==typeof e.getActiveStream){var t=e.getActiveStream();t&&(s=t.getProcessors());}}}function v(e,t){var n,r={},i=Ge(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e[a]&&(r[a]=e[a]);}}catch(e){i.e(e);}finally{i.f();}return r;}function _(e){var t=p.get().streaming.cmcd.enabledKeys;return e.filter(function(e){return t.includes(e);});}function T(e){try{return e.type===C.w.MPD_TYPE?((u=S()).ot="m",u):e.type===C.w.MEDIA_SEGMENT_TYPE?(t=e.mediaType,f.hasOwnProperty(t)||(f[t]=!1),l.hasOwnProperty(t)||(l[t]=!1),c.hasOwnProperty(t)||(c[t]=!1),function(e){var t,u=S(),d=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3);}catch(e){return null;}}(e),g=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration);}catch(e){return null;}}(e),h=function(e){try{return 100*parseInt(r.getThroughputHistory().getSafeAverageThroughput(e)/100);}catch(e){return null;}}(e.mediaType),m=function(e){try{var t=n.pr,r=i.getCurrentBufferLevel(e);return isNaN(t)||isNaN(r)?null:100*parseInt(r/t*10);}catch(e){return null;}}(e.mediaType),y=b(e.mediaType),E=function(e){try{var t=r.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3);}catch(e){return null;}}(e.mediaType),v=n.pr,_=function(e){if(s&&0!==s.length){var t,n=Ge(s);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.getType()===e)return r.probeNextRequest();}}catch(e){n.e(e);}finally{n.f();}}}(e.mediaType);e.mediaType===a.Z.VIDEO&&(t="v"),e.mediaType===a.Z.AUDIO&&(t="a"),e.mediaType===a.Z.TEXT&&(t="application/mp4"===e.mediaInfo.mimeType?"tt":"c");var T=p.get().streaming.cmcd.rtp;return T||(T=function(e){var t=o.getPlaybackRate();t||(t=1);var n=e.quality,r=e.mediaType,i=e.mediaInfo,a=e.duration,s=b(r);0===s&&(s=500);var u=i.bitrateList[n].bandwidth*a/1e3/(s/t/1e3),l=p.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(p.get().streaming.cmcd.rtpSafetyFactor)?p.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(u*l/100)+1);}(e)),u.rtp=T,_&&(e.url!==_.url?u.nor=encodeURIComponent(Be.Z.getRelativeUrl(e.url,_.url)):_.range&&(u.nrr=_.range)),d&&(u.br=d),t&&(u.ot=t),isNaN(g)||(u.d=g),isNaN(h)||(u.mtp=h),isNaN(m)||(u.dl=m),isNaN(y)||(u.bl=y),isNaN(E)||(u.tb=E),isNaN(v)||1===v||(u.pr=v),c[e.mediaType]&&(u.bs=!0,c[e.mediaType]=!1),!l[e.mediaType]&&f[e.mediaType]||(u.su=!0,l[e.mediaType]=!1,f[e.mediaType]=!0),u;}(e)):e.type===C.w.INIT_SEGMENT_TYPE?function(){var e=S();return e.ot="i",e.su=!0,e;}():e.type===C.w.OTHER_TYPE||e.type===C.w.XLINK_EXPANSION_TYPE?function(){var e=S();return e.ot="o",e;}():e.type===C.w.LICENSE?function(e){var t=S();return t.ot="k",t;}():null;}catch(e){return null;}var t,u;}function S(){var e={},t=p.get().streaming.cmcd.cid?p.get().streaming.cmcd.cid:n.cid;return e.v=1,e.sid=p.get().streaming.cmcd.sid?p.get().streaming.cmcd.sid:n.sid,e.sid="".concat(e.sid),t&&(e.cid="".concat(t)),isNaN(n.pr)||1===n.pr||null===n.pr||(e.pr=n.pr),n.st&&(e.st=n.st),n.sf&&(e.sf=n.sf),e;}function b(e){try{var t=i.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t);}catch(e){return null;}}function A(e){try{n.pr=e.playbackRate;}catch(e){}}function I(t){try{var r=e.getIsDynamic(t.data)?"l":"v",i=t.protocol&&"MSS"===t.protocol?"s":"d";n.st="".concat(r),n.sf="".concat(i);}catch(e){}}function R(e){try{e.state&&e.mediaType&&e.state===d.Z.BUFFER_EMPTY&&(c[e.mediaType]||(c[e.mediaType]=!0),l[e.mediaType]||(l[e.mediaType]=!0));}catch(e){}}function w(){for(var e in c)c.hasOwnProperty(e)&&(c[e]=!0);for(var t in l)l.hasOwnProperty(t)&&(l[t]=!0);}function D(e){try{if(!e)return null;var t=Object.keys(e).sort(function(e,t){return e.localeCompare(t);}),n=t.length,r=t.reduce(function(t,r,i){return "v"===r&&1===e[r]||("string"==typeof e[r]&&"ot"!==r&&"sf"!==r&&"st"!==r?t+="".concat(r,"=").concat(JSON.stringify(e[r])):t+="".concat(r,"=").concat(e[r]),i<n-1&&(t+=",")),t;},"");return (r=r.replace(/=true/g,"")).replace(/,\s*$/,"");}catch(e){return null;}}return t={getQueryParameter:function(e){try{if(p.get().streaming.cmcd&&p.get().streaming.cmcd.enabled){var t=T(e),n=function(e){try{var t=p.get().streaming.cmcd.enabledKeys;return Object.keys(e).filter(function(e){return t.includes(e);}).reduce(function(t,n){return t[n]=e[n],t;},{});}catch(t){return e;}}(t),r=D(n);return h.trigger(de.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:r}),{key:"CMCD",value:r};}return null;}catch(e){return null;}},getHeaderParameters:function(e){try{if(p.get().streaming.cmcd&&p.get().streaming.cmcd.enabled){var t=T(e),n=v(t,_(["br","d","ot","tb"])),r=v(t,_(["bl","dl","mtp","nor","nrr","su"])),i=v(t,_(["bs","rtp"])),a=v(t,_(["cid","pr","sf","sid","st","v"])),o={"CMCD-Object":D(n),"CMCD-Request":D(r),"CMCD-Status":D(i),"CMCD-Session":D(a)};return h.trigger(de.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,headers:o}),o;}return null;}catch(e){return null;}},setConfig:function(e){e&&(e.abrController&&(r=e.abrController),e.dashMetrics&&(i=e.dashMetrics),e.playbackController&&(o=e.playbackController));},reset:function(){h.off(d.Z.PLAYBACK_RATE_CHANGED,A,this),h.off(d.Z.MANIFEST_LOADED,I,this),h.off(d.Z.BUFFER_LEVEL_STATE_CHANGED,R,t),h.off(d.Z.PLAYBACK_SEEKED,w,t),m();},initialize:function(){h.on(d.Z.PLAYBACK_RATE_CHANGED,A,t),h.on(d.Z.MANIFEST_LOADED,I,t),h.on(d.Z.BUFFER_LEVEL_STATE_CHANGED,R,t),h.on(d.Z.PLAYBACK_SEEKED,w,t),h.on(d.Z.PERIOD_SWITCH_COMPLETED,y,t);}},e=Ze(g).getInstance(),m(),t;}Ye.__dashjs_factory_name="CmcdModel";const je=c.Z.getSingletonFactory(Ye);function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},He(e);}function Ve(e,t){Ve=function(e,t){return new a(e,void 0,t);};var n=ze(RegExp),r=RegExp.prototype,i=new WeakMap();function a(e,t,r){var a=n.call(this,e,t);return i.set(a,r||i.get(e)),a;}function o(e,t){var n=i.get(t);return Object.keys(n).reduce(function(t,r){return t[r]=e[n[r]],t;},Object.create(null));}return Ke(a,n),a.prototype.exec=function(e){var t=r.exec.call(this,e);return t&&(t.groups=o(t,this)),t;},a.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=i.get(this);return r[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return "$"+n[t];}));}if("function"==typeof t){var a=this;return r[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==He(e[e.length-1])&&e.push(o(e,a)),t.apply(this,e);});}return r[Symbol.replace].call(this,e,t);},Ve.apply(this,arguments);}function Ke(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t);}function ze(e){var t="function"==typeof Map?new Map():void 0;return ze=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r);}function r(){return We(e,arguments,Je(this).constructor);}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Qe(r,e);},ze(e);}function We(e,t,n){return We=Xe()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r))();return n&&Qe(i,n.prototype),i;},We.apply(null,arguments);}function Xe(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}function Qe(e,t){return Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},Qe(e,t);}function Je(e){return Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},Je(e);}var $e="static",et="dynamic",tt="cmsd-",nt=tt+$e,rt=tt+et,it="stream",at=["mb","st","sf","v"],ot={video:"v",audio:"a",text:"tt",stream:it},st=/^[-0-9]/;function ut(){var e,t,n,r,i=this.context,a=(0, u.Z)(i).getInstance();function o(){n={},r={};}function s(e){e&&Object.keys(e).forEach(function(t){at.includes(t)||delete e[t];});}function c(e){return !e||"false"!==e.toLowerCase()&&(st.test(e)?parseInt(e,10):e.replace(/["]+/g,""));}function d(e){try{for(var n={},r=e.split(","),i=0;i<r.length;i++){var a=r[i].split("="),o=a[0],s=c(a[1]);n[o]=s;}return n;}catch(e){t.error("Failed to parse CMSD-Static response header value:",e);}}function g(e){try{for(var n={},r=e.split(","),i=r[r.length-1].split(";"),a=1;a<i.length;a++){var o=i[a].split("="),s=o[0],u=c(o[1]);n[s]=u;}return n;}catch(e){return t.error("Failed to parse CMSD-Dynamic response header value:",e),[];}}function h(e){return ot[e]||"o";}function p(e,t,i){var a=e===$e?n:r,o=a[t]||{},s=a[it]||{};return o[i]||s[i];}return e={setConfig:function(){},initialize:function(){},reset:function(){o();},parseResponseHeaders:function(e,t){for(var i=null,o=null,u=e.split("\r\n"),c=u.length-1;c>=0;c--){var f=u[c].match(Ve(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(f&&f.groups){var p=f.groups.key.toLowerCase(),m=f.groups.value;switch(p){case nt:i=d(m),a.trigger(l.Z.CMSD_STATIC_HEADER,i);break;case rt:o||(o=g(m));}}}var y=it;return i&&i.ot?y=i.ot:t&&(y=h(t)),s(n[y]),s(r[y]),i&&(n[y]=Object.assign(n[y]||{},i)),o&&(r[y]=Object.assign(r[y]||{},o)),{static:i,dynamic:o};},getMaxBitrate:function(e){var t=h(e);return p(et,t,"mb")||-1;},getEstimatedThroughput:function(e){var t=h(e);return p(et,t,"etp")||null;},getResponseDelay:function(e){var t=h(e);return p(et,t,"rd")||null;},getRoundTripTime:function(e){var t=h(e);return p(et,t,"rtt")||null;}},t=(0, f.Z)(i).getInstance().getLogger(e),o(),e;}ut.__dashjs_factory_name="CmsdModel";const lt=c.Z.getSingletonFactory(ut);function ct(){var e,t,n=this.context,r={};function i(){t=(0, f.Z)(n).getInstance().getLogger(e);}function a(e){for(var t={},n=0,r=0,i=0,a=0,o=e.length,s=0;s<o;++s)n+=e[s].chunkDownloadTimeRelativeMS,r+=e[s].bufferLevel,i+=e[s].chunkDownloadTimeRelativeMS*e[s].bufferLevel,a+=e[s].chunkDownloadTimeRelativeMS*e[s].chunkDownloadTimeRelativeMS;return t.m=(i-n*r/o)/(a-n*n/o),t.b=r/o-t.m*n/o,function(e){return t.m*e+t.b;};}function o(e){var t,n=!0,r=e.reduce(function(e,t){return e+t.bufferLevelAtSegmentEnd;},0)/e.length;return e.forEach(function(e){Math.abs(e.bufferLevelAtSegmentEnd/e.bufferLevelAtSegmentStart)<.95&&(n=!1),e.bufferLevelAtSegmentEnd/r<.8&&(n=!1),t?t>e.bitrate&&(n=!1):t=e.bitrate;}),n;}return e={setup:i,addMeasurement:function(e,t,n,i,o){e&&e.mediaType&&!r[e.mediaType]&&(r[e.mediaType]=[]);var s=e.mediaInfo.bitrateList.find(function(t){return t.id===e.representationId;});r[e.mediaType].push({index:e.index,repId:e.representationId,mediaType:e.mediaType,requestTimeMS:i,adjustedAvailabilityStartTimeMS:e.availabilityStartTime.getTime(),segDurationMS:1e3*e.duration,chunksDurationMS:n.reduce(function(e,t){return e+t.chunkDownloadDurationMS;},0),segmentBytes:n.reduce(function(e,t){return e+t.chunkBytes;},0),bitrate:s&&s.bandwidth,bitrateList:e.mediaInfo.bitrateList,chunkMeasurements:n,fetchDownloadDurationMS:t,throughputCapacityDelayMS:o,getEstimatedBufferLevel:a(n.slice(1))}),r[e.mediaType].length>10&&r[e.mediaType].shift();},getThroughputCapacityDelayMS:function(e,t){var n=r[e.mediaType]&&r[e.mediaType].slice(-3);return !n||n.length<3?0:o(n)?t/4>250?250:t/4:0;},getEstimatedDownloadDurationMS:function(e){var n=r[e.mediaType].slice(-1).pop(),i=r[e.mediaType].slice(-3),a=n.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;n.bufferLevelAtSegmentStart=n.getEstimatedBufferLevel(a/2),n.bufferLevelAtSegmentEnd=n.getEstimatedBufferLevel(a);var s=o(i),u=s?.6:.8;if(n.isBufferStable&&1.05*n.segDurationMS<n.fetchDownloadDurationMS)return n.fetchDownloadDurationMS;if(!s||n.segDurationMS<n.fetchDownloadDurationMS)return .8*n.fetchDownloadDurationMS;if(n.adjustedAvailabilityStartTimeMS<=n.requestTimeMS+n.throughputCapacityDelayMS-n.segDurationMS)return .8*n.fetchDownloadDurationMS;for(var l=n.requestTimeMS+n.throughputCapacityDelayMS-n.adjustedAvailabilityStartTimeMS,c=0,f=0,d=0,g=0;g<n.chunkMeasurements.length;g++){var h=n.chunkMeasurements[g];if(l<f+h.chunkDownloadDurationMS)break;f+=h.chunkDownloadDurationMS,c+=h.chunkBytes,d++;}if(l<0&&t.warn("request time was before adjusted availibitly start time"),c&&f&&d>.2*n.chunkMeasurements.length){var p=c/f,m=n.segmentBytes/p;return n.fetchDownloadDurationMS<m?n.fetchDownloadDurationMS*u:m*u;}var y=n.bitrate;return n.bitrateList.some(function(e){if(e.bandwidth>n.bitrate)return y=e.bandwidth,!0;}),y===n.bitrate?n.fetchDownloadDurationMS*u:u*n.segmentBytes*8*1e3/y;}},i(),e;}ct.__dashjs_factory_name="LowLatencyThroughputModel";const ft=c.Z.getSingletonFactory(ct);var dt=n(5717);function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function ht(e){e=e||{};var t,n,r,i,o,s,c,d,g,h,p,m=this.context,y=e.errHandler,E=e.dashMetrics,v=e.mediaPlayerModel,_=e.requestModifier,T=e.boxParser,b=e.errors,A=e.requestTimeout||0,I=(0, u.Z)(m).getInstance(),R=(0, N.Z)(m).getInstance();function w(e,t){var u,f=e.request,p=[],b=!0,N=!0,D=new Date(),O=D,M=0,P=null,L=null;if(!_||!E||!y)throw new Error("config object is not correct or missing");var x,F=function(e){if(N=!1,f.requestStartDate=D,f.requestEndDate=new Date(),f.firstByteDate=f.firstByteDate||D,f.fileLoaderType=L,!f.checkExistenceOnly){var t=u.response?u.response.responseURL:null,n=u.response?u.response.status:null,r=u.response&&u.response.getAllResponseHeaders?u.response.getAllResponseHeaders():u.response?u.response.responseHeaders:null,i=R.get().streaming.cmsd&&R.get().streaming.cmsd.enabled?c.parseResponseHeaders(r,f.mediaType):null;E.addHttpRequest(f,t,n,r,e?p:null,i),f.type===C.w.MPD_TYPE&&(E.addManifestUpdate(f),I.trigger(l.Z.MANIFEST_LOADING_FINISHED,{request:f}));}},k=function(){if(P&&(clearTimeout(P),P=null),-1!==n.indexOf(u)&&(n.splice(n.indexOf(u),1),N))if(F(!1),t>0){try{R.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&f.type===C.w.MEDIA_SEGMENT_TYPE&&v.getRetryAttemptsForType(C.w.MEDIA_SEGMENT_TYPE)===t&&I.trigger(l.Z.ATTEMPT_BACKGROUND_SYNC);}catch(e){}t--;var r={config:e};i.push(r),r.timeout=setTimeout(function(){-1!==i.indexOf(r)&&(i.splice(i.indexOf(r),1),w(e,t));},v.getRetryIntervalsForType(f.type));}else {if(f.type===C.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;y.error(new S.Z(o[f.type],f.url+" is not available",{request:f,response:u.response})),e.error&&e.error(f,"error",u.response.statusText,u.response),e.complete&&e.complete(f,u.response.statusText);}};f.hasOwnProperty("availabilityTimeComplete")&&!1===f.availabilityTimeComplete&&window.fetch&&"arraybuffer"===f.responseType&&f.type===C.w.MEDIA_SEGMENT_TYPE?((x=fe(m).create({requestModifier:_,lowLatencyThroughputModel:g,boxParser:T})).setup({dashMetrics:E}),L=a.Z.FILE_LOADER_TYPES.FETCH):(x=(0, se.Z)(m).create({requestModifier:_}),L=a.Z.FILE_LOADER_TYPES.XHR);var U=null,Z=_.modifyRequestURL?_.modifyRequestURL(f.url):f.url;if(R.get().streaming.cmcd&&R.get().streaming.cmcd.enabled){var B=R.get().streaming.cmcd.mode;if(B===a.Z.CMCD_MODE_QUERY){var G=function(e){try{var t=[],n=s.getQueryParameter(e);return n&&t.push(n),t;}catch(e){return [];}}(f);Z=Be.Z.addAditionalQueryParameterToUrl(Z,G);}else B===a.Z.CMCD_MODE_HEADER&&(U=s.getHeaderParameters(f));}var q=f.checkExistenceOnly?C.w.HEAD:C.w.GET,Y=d.getXHRWithCredentialsForType(f.type);if(f.queryParams){var j=Object.keys(f.queryParams).map(function(e){return {key:e,value:f.queryParams[e]};});Z=Be.Z.addAditionalQueryParameterToUrl(Z,j);}f.url=Z,u={url:Z,method:q,withCredentials:Y,request:f,onload:function(){u.response.status>=200&&u.response.status<=299&&(F(!0),e.success&&e.success(u.response.response,u.response.statusText,u.response.responseURL),e.complete&&e.complete(f,u.response.statusText));},onend:k,onerror:k,progress:function(t){var n=new Date();b&&(b=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(f.firstByteDate=n)),t.lengthComputable&&(f.bytesLoaded=t.loaded,f.bytesTotal=t.total),t.noTrace||(p.push({s:O,d:t.time?t.time:n.getTime()-O.getTime(),b:[t.loaded?t.loaded-M:0]}),O=n,M=t.loaded),P&&(clearTimeout(P),P=null),R.get().streaming.fragmentRequestProgressTimeout>0&&(P=setTimeout(function(){h.warn("Abort request "+u.url+" due to progress timeout"),u.response.onabort=null,u.loader.abort(u),k();},R.get().streaming.fragmentRequestProgressTimeout)),e.progress&&t&&e.progress(t);},onabort:function(){P&&(clearTimeout(P),P=null),e.abort&&e.abort(f);},ontimeout:function(e){var t;if(e.lengthComputable){var n=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+n.toFixed(3)+"% Completed";}else t="Request timeout: non-computable download size";h.warn(t);},loader:x,timeout:A,headers:U};var H=new Date().getTime();if(isNaN(f.delayLoadingTime)||H>=f.delayLoadingTime)n.push(u),x.load(u);else {var V={httpRequest:u};r.push(V),V.delayTimeout=setTimeout(function(){if(-1!==r.indexOf(V)){r.splice(r.indexOf(V),1);try{D=new Date(),O=D,n.push(V.httpRequest),x.load(V.httpRequest);}catch(e){V.httpRequest.onerror();}}},f.delayLoadingTime-H);}}return t={load:function(e){e.request?w(e,v.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error");},abort:function(){i.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request);}),i=[],r.forEach(function(e){return clearTimeout(e.delayTimeout);}),r=[],n.forEach(function(e){e.request.type!==C.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e));}),n=[];}},h=(0, f.Z)(m).getInstance().getLogger(t),n=[],r=[],i=[],s=je(m).getInstance(),c=lt(m).getInstance(),g=ft(m).getInstance(),d=(0, dt.Z)(m).getInstance(),gt(p={},C.w.MPD_TYPE,b.DOWNLOAD_ERROR_ID_MANIFEST_CODE),gt(p,C.w.XLINK_EXPANSION_TYPE,b.DOWNLOAD_ERROR_ID_XLINK_CODE),gt(p,C.w.INIT_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),gt(p,C.w.MEDIA_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),gt(p,C.w.INDEX_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),gt(p,C.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),gt(p,C.w.OTHER_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),o=p,t;}ht.__dashjs_factory_name="HTTPLoader";const pt=c.Z.getClassFactory(ht);function mt(){var e;function t(){e={};}function n(){t();}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return pt;},registerLoader:function(t,n){e[t]=n;},unregisterLoader:function(t){e[t]&&delete e[t];},unregisterAllLoader:t,reset:n};}mt.__dashjs_factory_name="SchemeLoaderFactory";const yt=c.Z.getSingletonFactory(mt);function Et(e){e=e||{};var t,n,r=this.context;return t=yt(r).getInstance(),{load:function(i){if(!n){var a=t.getLoader(i&&i.request?i.request.url:null);n=a(r).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,requestTimeout:isNaN(e.requestTimeout)?0:e.requestTimeout,errors:e.errors});}n.load(i);},abort:function(){n&&n.abort();}};}Et.__dashjs_factory_name="URLLoader";const vt=c.Z.getClassFactory(Et);function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_t(e);}function Tt(e,t){return Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},Tt(e,t);}function St(e,t){return !t||"object"!==_t(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function bt(e){return bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},bt(e);}const At=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=bt(t);if(n){var i=bt(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return St(this,e);});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),(t=r.call(this,e)).checkForExistenceOnly=!0,t;}return i;}(p.Z);function It(e){e=e||{};var t,n,r=this.context,i=e.eventBus,o=e.events,s=e.urlUtils,u=e.errors,l=e.streamId;return t={checkForExistence:function(e){var t=function(t){i.trigger(o.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t});};if(e){var r=new At(e.url);n.load({request:r,success:function(){t(!0);},error:function(){t(!1);}});}else t(!1);},load:function(e){var r=function(n,r){i.trigger(o.LOADING_COMPLETED,{request:e,response:n||null,error:r||null,sender:t});};e?n.load({request:e,progress:function(n){i.trigger(o.LOADING_PROGRESS,{request:e,stream:n.stream,streamId:l}),n.data&&i.trigger(o.LOADING_DATA_PROGRESS,{request:e,response:n.data||null,error:null,sender:t});},success:function(e){r(e);},error:function(e,t,n){r(void 0,new S.Z(u.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,n,t));},abort:function(e){e&&i.trigger(o.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:t});}}):r(void 0,new S.Z(u.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,u.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE));},abort:function(){n&&n.abort();},reset:function(){n&&(n.abort(),n=null);}},n=vt(r).create({errHandler:e.errHandler,errors:u,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:s,constants:a.Z,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),t;}It.__dashjs_factory_name="FragmentLoader";const Rt=c.Z.getClassFactory(It);function wt(){return {modifyResponseAsync:function(e){return Promise.resolve(e);}};}wt.__dashjs_factory_name="SegmentResponseModifier";const Nt=c.Z.getSingletonFactory(wt);function Ct(e){e=e||{};var t,n,r,i=this.context,o=(0, u.Z)(i).getInstance(),s=e.errHandler,c=e.mediaPlayerModel,g=e.dashMetrics,h=(0, f.Z)(i).getInstance(),p=Nt(i).getInstance(),m=e.streamInfo;function y(){return m.id;}function E(){for(var e in r)r[e].reset();r={};}function v(e){if(e.sender){var t=e.request,r=e.response,i=t.isInitializationRequest(),s=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType===a.Z.AUDIO||t.mediaType===a.Z.VIDEO||t.mediaType===a.Z.TEXT&&t.mediaInfo.isFragmented)&&o.trigger(l.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD,{entry:e.request.serviceLocation}),r&&s){var u=function(e,t,n,r){var i=new oe();return i.streamId=n,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=r,i;}(r,t,m.id,e.type!==l.Z.FRAGMENT_LOADING_PROGRESS);p.modifyResponseAsync(u).then(function(e){o.trigger(i?l.Z.INIT_FRAGMENT_LOADED:l.Z.MEDIA_FRAGMENT_LOADED,{chunk:e,request:t},{streamId:s.id,mediaType:t.mediaType});}).catch(function(e){n.error(e),o.trigger(i?l.Z.INIT_FRAGMENT_LOADED:l.Z.MEDIA_FRAGMENT_LOADED,{chunk:u,request:t},{streamId:s.id,mediaType:t.mediaType});});}else n.warn("No "+t.mediaType+" bytes to push or stream is inactive.");}}return t={getStreamId:y,getModel:function(t){var n=r[t];return n||(n=T(i).create({streamInfo:m,type:t,dashMetrics:g,fragmentLoader:Rt(i).create({dashMetrics:g,mediaPlayerModel:c,errHandler:s,requestModifier:(0, X.Z)(i).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:o,events:l.Z,errors:w,dashConstants:e.dashConstants,urlUtils:e.urlUtils,streamId:y()}),debug:h,eventBus:o,events:l.Z}),r[t]=n),n;},reset:function(){o.off(d.Z.FRAGMENT_LOADING_COMPLETED,v,this),o.off(d.Z.FRAGMENT_LOADING_PROGRESS,v,this),E();}},n=h.getLogger(t),E(),o.on(d.Z.FRAGMENT_LOADING_COMPLETED,v,t),o.on(d.Z.FRAGMENT_LOADING_PROGRESS,v,t),t;}Ct.__dashjs_factory_name="FragmentController";const Dt=c.Z.getClassFactory(Ct),Ot=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null;},Mt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN;};function Pt(e){var t,n,r=this.context,i=e.streamInfo;function o(e){n.setTrackByIndex(e);}function s(){n&&n.reset();}return t={getStreamId:function(){return i.id;},initialize:function(){n.addTracks();var e=n.getTracks();e&&e.length>0&&o(0);},provide:function(e,t){if("function"==typeof t){var r,i,a=n.getCurrentTrack();if(!a||a.segmentDuration<=0||null==e)t(null);else {(i=n.getThumbnailRequestForTime(e))&&(a.segmentDuration=i.duration),r=e%a.segmentDuration;var o=Math.floor(r*a.tilesHor*a.tilesVert/a.segmentDuration),s=new Ot();if(s.width=Math.floor(a.widthPerTile),s.height=Math.floor(a.heightPerTile),s.x=Math.floor(o%a.tilesHor)*a.widthPerTile,s.y=Math.floor(o/a.tilesHor)*a.heightPerTile,"readThumbnail"in a)return a.readThumbnail(e,function(e){s.url=e,t(s);});if(i)s.url=i.url,a.segmentDuration=NaN;else {var u=Math.floor(e/a.segmentDuration);s.url=function(e,t){var n=t+e.startNumber,r=(0, H.vi)(e.templateUrl,"Number",n);return r=(0, H.vi)(r,"Time",(n-1)*e.segmentDuration*e.timescale),r=(0, H.vi)(r,"Bandwidth",e.bandwidth),(0, H.eR)(r);}(a,u);}t(s);}}},setTrackByIndex:o,getCurrentTrackIndex:function(){return n.getCurrentTrackIndex();},getBitrateList:function(){var e=n.getTracks(),t=0;return e.map(function(e){var n=new Mt();return n.mediaType=a.Z.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n;});},reset:s},s(),n=(0, Me.Z)(r).create({streamInfo:i,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController}),t;}Pt.__dashjs_factory_name="ThumbnailController";const Lt=c.Z.getClassFactory(Pt);var xt=n(7417);function Ft(e){var t;e=e||{};var n=[],r=(0, u.Z)(this.context).getInstance(),i=e.updateEventName,a=e.addBlacklistEventName;function o(e){-1===n.indexOf(e)&&(n.push(e),r.trigger(i,{entry:e}));}return t={add:o,contains:function(e){return !!(n.length&&e&&e.length)&&-1!==n.indexOf(e);},reset:function(){n=[];}},a&&r.on(a,function(e){o(e.entry);},t),t;}Ft.__dashjs_factory_name="BlackListController";const kt=c.Z.getClassFactory(Ft);var Ut=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT,a.Z.MUXED,a.Z.IMAGE];function Zt(e){e=e||{};var t,n,r,i,s,c,d,g,h,p,m,y,E,v,_,T,b,A,I=this.context,R=(0, u.Z)(I).getInstance(),N=(0, Q.Z)(I).getInstance(),C=e.manifestModel,D=e.mediaPlayerModel,O=e.dashMetrics,M=e.manifestUpdater,P=e.adapter,L=e.timelineConverter,x=e.capabilities,F=e.errHandler,k=e.abrController,U=e.playbackController,Z=e.eventController,B=e.mediaController,G=e.protectionController,q=e.textController,Y=e.videoModel,j=e.streamInfo,H=e.settings;function V(e,t){return new Promise(function(i,o){ne(),p=!0,ie();var s=Y.getElement(),u=[];Ut.forEach(function(t){(t!==a.Z.TEXT||e)&&(t!==a.Z.VIDEO||!s||s&&/^VIDEO$/i.test(s.nodeName))&&u.push(K(t,e));}),Promise.all(u).then(function(){return e=t,new Promise(function(t){var n={},i=r.map(function(t){return t.createBufferSinks(e);});Promise.all(i).then(function(e){e.forEach(function(e){e&&(n[e.getType()]=e);}),t(n);}).catch(function(){t(n);});});var e;}).then(function(t){if(p=!1,0===r.length){var a="No streams to play.";F.error(new S.Z(w.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,C.getValue())),n.fatal(a);}else oe();e&&q.createTracks(j),i(t);}).catch(function(e){o(e);});});}function K(t,i){var s,u=P.getAllMediaInfoForType(j,t),c=[],f=null;if(!u||0===u.length)return n.info("No "+t+" data."),Promise.resolve();t===a.Z.VIDEO&&(d=!0),t===a.Z.AUDIO&&(g=!0);for(var h=0,p=u.length;h<p;h++)f=u[h],t===a.Z.TEXT&&f.isEmbedded&&(q.addEmbeddedTrack(j,f),c.push(f)),z(f)&&B.addTrack(f);if(c.length>0&&(B.setInitialMediaSettingsForType(t,j),q.addMediaInfosToBuffer(j,t,c)),u=u.filter(function(e){return !e.isEmbedded;}),0===u.length)return Promise.resolve();if(t===a.Z.IMAGE)return (y=Lt(I).create({streamInfo:j,adapter:P,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:T,eventBus:R,events:l.Z,dashConstants:o.Z,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController})).initialize(),Promise.resolve();R.trigger(l.Z.STREAM_INITIALIZING,{streamInfo:j,mediaInfo:f}),B.setInitialMediaSettingsForType(t,j);var v=function(t,n){var i=t&&t.length>0?t[0]:null,o=m.getModel(i?i.type:null),s=i?i.type:null,u=i?i.mimeType:null,l=i?i.isFragmented:null,c=ae(I).create({streamInfo:j,type:s,mimeType:u,timelineConverter:L,adapter:P,manifestModel:C,mediaPlayerModel:D,fragmentModel:o,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,segmentBaseController:e.segmentBaseController,abrController:k,playbackController:U,mediaController:B,textController:q,errHandler:F,settings:H,boxParser:_,segmentBlacklistController:E});c.initialize(n,d,l),r.push(c);for(var f=0;f<t.length;f++)c.addMediaInfo(t[f]);return s===a.Z.TEXT&&q.addMediaInfosToBuffer(j,s,t,o),c;}(u,i);return (s=B.getCurrentTrackFor(t,j.id))?(k.updateTopQualityIndex(s),v.selectMediaInfo(t===a.Z.TEXT&&s.isEmbedded?u[0]:s)):Promise.resolve();}function z(e){var t,r=e?e.type:null;return r===a.Z.MUXED?(t="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",n.fatal(t),F.error(new S.Z(w.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,t,C.getValue())),!1):!(r!==a.Z.TEXT&&r!==a.Z.IMAGE&&e.contentProtection&&!x.supportsEncryptedMedia()&&(F.error(new S.Z(w.CAPABILITY_MEDIAKEYS_ERROR_CODE,w.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),1));}function W(e){for(var t=r?r.length:0,n=0;n<t;n++){var i=r[n].getFragmentModel();i.abortRequests(),i.resetInitialSettings(),r[n].reset(!1,e);}q&&q.deactivateStream(j),r=[],s=!1,c=!1,me(!1),J(!1),R.trigger(l.Z.STREAM_DEACTIVATED,{streamInfo:j});}function X(e){W(e),i=!1,d=!1,g=!1,h={},p=!1,b=!1,A=[];}function J(e){b=e;}function $(){return j?j.start:NaN;}function ee(){return j?j.id:null;}function te(){return j;}function ne(){if(!Y||!k)throw new Error(a.Z.MISSING_CONFIG_ERROR);}function re(e){e.error&&(F.error(e.error),n.fatal(e.error.message));}function ie(){if(Z){var e=P.getEventsFor(j);e&&e.length>0&&Z.addInlineEvents(e,j.id);}}function oe(){for(var e=r.length,t=h.audio||h.video?new S.Z(w.DATA_UPDATE_FAILED_ERROR_CODE,w.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,n=0;n<e;n++)if(r[n].isUpdating()||p)return;if(G){G.clearMediaInfoArray();for(var o=0;o<e&&r[o];o++){var s=r[o].getType(),u=r[o].getMediaInfo();if(s===a.Z.AUDIO||s===a.Z.VIDEO||s===a.Z.TEXT&&u.isFragmented){var c=r[o].getMediaInfo();c&&G.initializeForMedia(c);}}G.handleKeySystemFromManifest();}t?F.error(t):i||(i=!0,Y.waitForReadyState(a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){R.trigger(l.Z.STREAM_INITIALIZED,{streamInfo:j});}));}function se(){var e=de(),t=e.length;if(0!==t){for(var r=0;r<t;r++)if(!e[r].isBufferingCompleted()&&(e[r].getType()===a.Z.AUDIO||e[r].getType()===a.Z.VIDEO))return void n.debug("onBufferingCompleted - One streamProcessor has finished but",e[r].getType(),"one is not buffering completed");n.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),c=!0,R.trigger(l.Z.STREAM_BUFFERING_COMPLETED,{streamInfo:j},{streamInfo:j});}else n.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");}function ue(e){h[e.mediaType]=e.error,oe();}function le(e){Z&&Z.addInbandEvents(e.events,j.id);}function ce(e){return e&&e.type?fe(e.type):null;}function fe(e){return e?de().filter(function(t){return t.getType()===e;})[0]:null;}function de(){for(var e,t,n=[],i=0;i<r.length;i++)(e=(t=r[i]).getType())!==a.Z.AUDIO&&e!==a.Z.VIDEO&&e!==a.Z.TEXT||n.push(t);return n;}function ge(e,t){var n=te(),r=t.getStreamInfo();if(!r||!n)return !0;var i=P.getAdaptationForType(r.index,e,r),a=P.getAdaptationForType(n.index,e,n);return i&&a?!(!he(a)&&he(i)):!i&&!a;}function he(e){return !!e&&!!(e.ContentProtection||e.Representation_asArray&&e.Representation_asArray.length>0&&e.Representation_asArray[0].ContentProtection);}function pe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return !1;var r=e.getStreamInfo(),i=n?n.getStreamInfo():te();if(!r||!i)return !1;var a=P.getAdaptationForType(r.index,t,r),o=P.getAdaptationForType(i.index,t,i);if(!a||!o)return !a&&!o;var s=a&&o&&a.mimeType===o.mimeType,u=o.Representation_asArray.map(function(e){return e.codecs;}),l=a.Representation_asArray.map(function(e){return e.codecs;}),c=l.some(function(e){return u.indexOf(e)>-1;}),f=l.some(function(e){return u.some(function(t){return x.codecRootCompatibleWithCodec(t,e);});});return c||f&&s;}function me(e){v=e;}function ye(){return v;}return t={initialize:function(){R.on(l.Z.BUFFERING_COMPLETED,se,t),R.on(l.Z.DATA_UPDATE_COMPLETED,ue,t),R.on(l.Z.INBAND_EVENTS,le,t),G&&(R.on(l.Z.KEY_ERROR,re,t),R.on(l.Z.SERVER_CERTIFICATE_UPDATED,re,t),R.on(l.Z.LICENSE_REQUEST_COMPLETE,re,t),R.on(l.Z.KEY_SYSTEM_SELECTED,re,t),R.on(l.Z.KEY_SESSION_CREATED,re,t),R.on(l.Z.KEY_STATUSES_CHANGED,re,t)),q.initializeForStream(j),R.trigger(l.Z.STREAM_UPDATED,{streamInfo:j});},getStreamId:function(){return j?j.id:null;},activate:function(e,t){return new Promise(function(n,r){if(!s)return ye()?(s=!0,R.trigger(l.Z.STREAM_ACTIVATED,{streamInfo:j}),void n(t)):void function(e,t){return V(e,t);}(e,t).then(function(e){s=!0,R.trigger(l.Z.STREAM_ACTIVATED,{streamInfo:j}),n(e);}).catch(function(e){r(e);});n(t);});},deactivate:W,getIsActive:function(){return s;},getDuration:function(){return j?j.duration:NaN;},getStartTime:$,getId:ee,getStreamInfo:te,getHasAudioTrack:function(){return g;},getHasVideoTrack:function(){return d;},startPreloading:function(e,t){return new Promise(function(i,a){ye()?a():(n.info("[startPreloading] Preloading next stream with id ".concat(ee())),me(!0),V(e,t).then(function(){for(var e=0;e<r.length&&r[e];e++)r[e].setExplicitBufferingTime($()),r[e].getScheduleController().startScheduleTimer();i();}).catch(function(){me(!1),a();}));});},initializeForTextWithMediaSource:function(e){return new Promise(function(t,n){K(a.Z.TEXT,e).then(function(){return (e=fe(a.Z.TEXT))?e.createBufferSinks():Promise.resolve();var e;}).then(function(){q.createTracks(j),t();}).catch(function(e){n(e);});});},getThumbnailController:function(){return y;},getBitrateListFor:function(e){if(ne(),e===a.Z.IMAGE)return y?y.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<r.length;n++)if((t=r[n]).getType()===e)return t.getMediaInfo();return null;}(e);return k.getBitrateList(t);},updateData:function(e){return new Promise(function(t){p=!0,j=e,Z&&ie();for(var n=[],i=0,a=r.length;i<a;i++){var o=r[i],s=o.getMediaInfo();n.push(o.updateStreamInfo(j));var u=P.getAllMediaInfoForType(j,o.getType());if(u=u.filter(function(e){return !e.isEmbedded;})){o.clearMediaInfoArray();for(var c=0;c<u.length;c++){var f=u[c];o.addMediaInfo(u[c]),P.areMediaInfosEqual(s,f)&&(k.updateTopQualityIndex(f),n.push(o.selectMediaInfo(f)));}}}Promise.all(n).then(function(){for(n=[];A.length>0;){var e=A.pop(),t=e.newMediaInfo,r=ce(e.oldMediaInfo);if(!r)return;n.push(r.prepareTrackSwitch()),n.push(r.selectMediaInfo(t));}return Promise.all(n);}).then(function(){p=!1,oe(),R.trigger(l.Z.STREAM_UPDATED,{streamInfo:j}),t();});});},reset:function(e){m&&(m.reset(),m=null),k&&j&&k.clearDataForStream(j.id),E&&(E.reset(),E=null),X(e),j=null,R.off(l.Z.DATA_UPDATE_COMPLETED,ue,t),R.off(l.Z.BUFFERING_COMPLETED,se,t),R.off(l.Z.INBAND_EVENTS,le,t),G&&(R.off(l.Z.KEY_ERROR,re,t),R.off(l.Z.SERVER_CERTIFICATE_UPDATED,re,t),R.off(l.Z.LICENSE_REQUEST_COMPLETE,re,t),R.off(l.Z.KEY_SYSTEM_SELECTED,re,t),R.off(l.Z.KEY_SESSION_CREATED,re,t),R.off(l.Z.KEY_STATUSES_CHANGED,re,t));},getProcessors:de,setMediaSource:function(e){return new Promise(function(t,i){for(var a=[],o=0;o<r.length;)z(r[o].getMediaInfo())?(a.push(r[o].setMediaSource(e)),o++):(r[o].reset(),r.splice(o,1));Promise.all(a).then(function(){for(var e=0;e<r.length;e++)r[e].dischargePreBuffer();if(0===r.length){var i="No streams to play.";F.error(new S.Z(w.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i+"nostreams",C.getValue())),n.fatal(i);}t();}).catch(function(e){n.error(e),i(e);});});},isMediaCodecCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return pe(e,a.Z.VIDEO,t)&&pe(e,a.Z.AUDIO,t);},isProtectionCompatible:function(e){return !e||ge(a.Z.VIDEO,e)&&ge(a.Z.AUDIO,e);},getPreloaded:ye,getIsEndedEventSignaled:function(){return b;},setIsEndedEventSignaled:J,getAdapter:function(){return P;},getHasFinishedBuffering:function(){return c;},setPreloaded:me,startScheduleControllers:function(){for(var e=r.length,t=0;t<e&&r[t];t++)r[t].getScheduleController().startScheduleTimer();},prepareTrackChange:function(e){if(s&&j){c=!1;var t=e.newMediaInfo,r=C.getValue();P.setCurrentMediaInfo(j.id,t.type,t);var i=ce(t);if(i){var o=U.getTime();n.info("Stream -  Process track changed at current time "+o),r.refreshManifestOnSwitchTrack?(A.push(e),M.getIsUpdating()||(n.debug("Stream -  Refreshing manifest for switch track"),M.refreshManifest())):i.selectMediaInfo(t).then(function(){t.type!==a.Z.VIDEO&&t.type!==a.Z.AUDIO||k.updateTopQualityIndex(t),i.prepareTrackSwitch();});}}},prepareQualityChange:function(e){var t=fe(e.mediaType);t&&t.prepareQualityChange(e);}},function(){try{T=(0,f.Z)(I).getInstance(),n=T.getLogger(t),X(),_=(0,xt.Z)(I).getInstance(),E=kt(I).create({updateEventName:l.Z.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:l.Z.SEGMENT_LOCATION_BLACKLIST_ADD}),m=Dt(I).create({streamInfo:j,mediaPlayerModel:D,dashMetrics:O,errHandler:F,settings:H,boxParser:_,dashConstants:o.Z,urlUtils:N});}catch(e){throw e;}}(),t;}Zt.__dashjs_factory_name="Stream";const Bt=c.Z.getClassFactory(Zt),Gt=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=t||null,this.type=C.w.CONTENT_STEERING_TYPE,this.responseType="json";},qt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.version=null,this.ttl=300,this.reloadUri=null,this.pathwayPriority=[],this.pathwayClones=[];};function Yt(){var e,t,n,r,i,a,s,u,l,c,g,h,p,m,y,E=this.context,v=(0, Q.Z)(E).getInstance();function _(e){I(e,"baseUrl");}function T(e){I(e,"location");}function S(e){if(e&&e.request&&e.request.serviceLocation&&e.request.requestStartDate&&e.request.requestEndDate&&!isNaN(e.request.bytesTotal)){var t=e.request.serviceLocation,n=e.request.requestEndDate.getTime()-e.request.requestStartDate.getTime();A(t,parseInt(8*e.request.bytesTotal/n*1e3));}}function b(e){e&&e.httpRequest&&e.httpRequest._serviceLocation&&!isNaN(e.throughput)&&A(e.httpRequest._serviceLocation,1e3*e.throughput);}function A(e,t){i[e]||(i[e]=[]),i[e].push(t),i[e].length>4&&i[e].shift();}function I(e,t){if(e&&e.request&&e.request.serviceLocation){var n=e.request.serviceLocation;-1===r[t].all.indexOf(n)&&r[t].all.push(n),r[t].current=n;}}function R(){var e=g.getValue(),t=y.getContentSteering(e);return t||(t=p.getServiceDescriptionSettings().contentSteering),t;}function N(){return new Promise(function(e){try{var a=R();if(!a||!a.serverUrl)return void e();var u=function(e){var t=e.serverUrl;n&&n.reloadUri&&(t=v.isRelative(n.reloadUri)?v.resolve(n.reloadUri,e.serverUrl):n.reloadUri);var a=[],o=r.baseUrl.all.concat(r.location.all);if(o.length>0){var s=o.map(function(e){var t=function(e){if(!e||!i[e]||0===i[e].length)return -1;var t=i[e].reduce(function(e,t){return e+t;})/i[e].length;return parseInt(t);}(e);return {serviceLocation:e,throughput:t};});s.sort(function(e,t){return t.throughput-e.throughput;});var u="",l="";s.forEach(function(e,t){0!==t&&(u="".concat(u,","),e.throughput>-1&&(l="".concat(l,","))),u="".concat(u).concat(e.serviceLocation),e.throughput>-1&&(l="".concat(l).concat(e.throughput));}),a.push({key:"_DASH_pathway",value:'"'.concat(u,'"')}),a.push({key:"_DASH_throughput",value:l});}return t=Be.Z.addAditionalQueryParameterToUrl(t,a);}(a),l=new Gt(u);s.load({request:l,success:function(t){!function(e){e&&e[o.Z.CONTENT_STEERING_RESPONSE.VERSION]&&1===parseInt(e[o.Z.CONTENT_STEERING_RESPONSE.VERSION])&&((n=new qt()).version=e[o.Z.CONTENT_STEERING_RESPONSE.VERSION],e[o.Z.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(e[o.Z.CONTENT_STEERING_RESPONSE.TTL])&&(n.ttl=e[o.Z.CONTENT_STEERING_RESPONSE.TTL]),e[o.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(n.reloadUri=e[o.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]),e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]&&(n.pathwayPriority=e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]),e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES]&&(n.pathwayClones=e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES],n.pathwayClones=n.pathwayClones.filter(function(e){return function(e){return e[o.Z.CONTENT_STEERING_RESPONSE.BASE_ID]&&e[o.Z.CONTENT_STEERING_RESPONSE.ID]&&e[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT]&&e[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.HOST];}(e);})),O());}(t),m.trigger(d.Z.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:n,url:u}),e();},error:function(r,i,a,o){!function(e,r){try{switch(t.warn("Error fetching data from content steering server",e),r.status){case 410:break;case 429:var i=r&&r.getResponseHeader?r.getResponseHeader("retry-after"):null;null!==i&&(n||(n={}),n.ttl=parseInt(i)),O();break;default:O();}}catch(e){t.error(e);}}(r,o),e(r);},complete:function(){r.baseUrl.all=C(r.baseUrl),r.location.all=C(r.location);}});}catch(t){e(t);}});}function C(e){return e.all&&0!==e.all.length&&e.current?e.all.filter(function(t){return t===e.current;}):[];}function D(e){try{var r=[];return e&&0!==e.length&&n&&n.pathwayClones&&0!==n.pathwayClones.length?(n.pathwayClones.forEach(function(t){var n=e.filter(function(e){return t[o.Z.CONTENT_STEERING_RESPONSE.BASE_ID]===e.serviceLocation;}),i=null;if(n&&n.length>0&&(i=n[0]),i){var a=new URL(i.url),s={synthesizedUrl:"".concat(t[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.HOST]).concat(a.pathname),serviceLocation:t[o.Z.CONTENT_STEERING_RESPONSE.ID],queryParams:t[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.PARAMS],reference:i};r.push(s);}}),r):r;}catch(e){return t.error(e),[];}}function O(){n&&n.ttl&&!isNaN(n.ttl)&&(a&&clearTimeout(a),a=setTimeout(function(){N();},1e3*n.ttl));}function M(){a&&clearTimeout(a),a=null;}function P(){n=null,i={},r={baseUrl:{current:null,all:[]},location:{current:null,all:[]}},M();}return e={reset:function(){P(),m.off(d.Z.FRAGMENT_LOADING_STARTED,_,e),m.off(d.Z.MANIFEST_LOADING_STARTED,T,e),m.off(d.Z.MANIFEST_LOADING_FINISHED,S,e),m.off(d.Z.THROUGHPUT_MEASUREMENT_STORED,b,e);},setConfig:function(e){e&&(e.adapter&&(y=e.adapter),e.errHandler&&(u=e.errHandler),e.dashMetrics&&(l=e.dashMetrics),e.mediaPlayerModel&&(c=e.mediaPlayerModel),e.requestModifier&&(h=e.requestModifier),e.manifestModel&&(g=e.manifestModel),e.serviceDescriptionController&&(p=e.serviceDescriptionController),e.eventBus&&(m=e.eventBus));},loadSteeringData:N,getCurrentSteeringResponseData:function(){return n;},shouldQueryBeforeStart:function(){var e=R();return !!e&&e.queryBeforeStart;},getSteeringDataFromManifest:R,stopSteeringRequestTimer:M,getSynthesizedBaseUrlElements:function(e){try{return D(e).map(function(e){var t=new Se(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t.dvb_priority=e.reference.dvb_priority,t.dvb_weight=e.reference.dvb_weight,t.availabilityTimeOffset=e.reference.availabilityTimeOffset,t.availabilityTimeComplete=e.reference.availabilityTimeComplete,t;});}catch(e){return t.error(e),[];}},getSynthesizedLocationElements:function(e){try{return D(e).map(function(e){var t=new Pe(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t;});}catch(e){return t.error(e),[];}},initialize:function(){s=vt(E).create({errHandler:u,dashMetrics:l,mediaPlayerModel:c,requestModifier:h,errors:w}),m.on(d.Z.FRAGMENT_LOADING_STARTED,_,e),m.on(d.Z.MANIFEST_LOADING_STARTED,T,e),m.on(d.Z.MANIFEST_LOADING_FINISHED,S,e),m.on(d.Z.THROUGHPUT_MEASUREMENT_STORED,b,e);}},t=(0, f.Z)(E).getInstance().getLogger(e),P(),e;}Yt.__dashjs_factory_name="ContentSteeringController";const jt=c.Z.getSingletonFactory(Yt);function Ht(){var e,t,n,r=this.context,i=(0, N.Z)(r).getInstance();return e={select:function(e){if(!e||0===e.length)return null;var r=null;return i.get().streaming.applyContentSteering&&(r=function(e){var r=n.getCurrentSteeringResponseData();return r&&r.pathwayPriority&&r.pathwayPriority.length>0?function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0,i=null,a=function(){var a=e[r],o=n.findIndex(function(e){return e.serviceLocation&&e.serviceLocation===a;});if(-1!==o&&!t.contains(n[o].serviceLocation))return i=n[o],"break";r+=1;};r<e.length&&"break"!==a(););return i;}(r.pathwayPriority,e):null;}(e)),r||(r=function(e){return e[0];}(e)),r;},setConfig:function(e){e.blacklistController&&(t=e.blacklistController),e.contentSteeringController&&(n=e.contentSteeringController);},reset:function(){t.reset();}},t=kt(r).create({updateEventName:l.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:l.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD}),n=jt(r).getInstance(),e;}Ht.__dashjs_factory_name="LocationSelector";const Vt=c.Z.getClassFactory(Ht);function Kt(){var e,t,n,r,i,a,s,c,g,h,p,m,y,E,v=this.context,_=(0, u.Z)(v).getInstance(),T=(0, Q.Z)(v).getInstance();function S(){n=NaN,s=!1,i=!0,a=!1,b();}function b(){null!==r&&(clearTimeout(r),r=null);}function A(e){b(),a||(isNaN(e)&&!isNaN(n)&&(e=1e3*n),isNaN(e)||(t.debug("Refresh manifest in "+e+" milliseconds."),r=setTimeout(C,e)));}function I(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s=!0;var t=g.getValue(),n=t.url,r=null,i=p.getPatchLocation(t),a=h.select(i),o=null;if(a&&!e)n=a.url,r=a.serviceLocation,o=a.queryParams;else {var u=R(t),l=h.select(u);l&&(n=l.url,r=l.serviceLocation,o=l.queryParams);}T.isRelative(n)&&(n=T.resolve(n,t.url)),c.load(n,r,o);}function R(e){var t=p.getLocation(e),n=y.getSynthesizedLocationElements(t);return t.concat(n);}function N(e){if(e){if(p.getIsPatch(e)){var r=e;e=g.getValue();var u=p.isPatchValid(e,r),c=u;if(u){var f=p.getPublishTime(e);c=p.applyPatchToManifest(e,r);var d=p.getPublishTime(e);c=f.getTime()!=d.getTime();}if(!c)return t.debug("Patch provided is invalid, performing full manifest refresh"),void I(!0);e.loadedTime=new Date();}}else (e=g.getValue()).loadedTime=new Date();if(g.getValue()&&g.getValue().type===o.Z.DYNAMIC&&e.type===o.Z.STATIC)return _.trigger(l.Z.DYNAMIC_TO_STATIC),s=!1,void(a=!0);g.setValue(e);var h=new Date(),m=(h.getTime()-e.loadedTime.getTime())/1e3;1e3*(n=p.getManifestUpdatePeriod(e,m))>2147483647&&(n=2147483.647),_.trigger(l.Z.MANIFEST_UPDATED,{manifest:e}),t.info("Manifest has been refreshed at "+h+"["+h.getTime()/1e3+"] "),i||A();}function C(){i||(s?A(E.get().streaming.manifestUpdateRetryInterval):I());}function D(e){e.error?e.error.code===w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&m.error(e.error):N(e.manifest);}function O(){i=!1,A();}function M(){(i=!E.get().streaming.scheduling.scheduleWhilePaused)&&b();}function P(){s=!1;}return e={initialize:function(){S(),_.on(l.Z.STREAMS_COMPOSED,P,this),_.on(d.Z.PLAYBACK_STARTED,O,this),_.on(d.Z.PLAYBACK_PAUSED,M,this),_.on(l.Z.INTERNAL_MANIFEST_LOADED,D,this);},setManifest:function(e){N(e);},refreshManifest:I,getIsUpdating:function(){return s;},setConfig:function(e){e&&(e.manifestModel&&(g=e.manifestModel),e.adapter&&(p=e.adapter),e.manifestLoader&&(c=e.manifestLoader),e.errHandler&&(m=e.errHandler),e.locationSelector&&(h=e.locationSelector),e.settings&&(E=e.settings),e.contentSteeringController&&(y=e.contentSteeringController));},reset:function(){_.off(d.Z.PLAYBACK_STARTED,O,this),_.off(d.Z.PLAYBACK_PAUSED,M,this),_.off(l.Z.STREAMS_COMPOSED,P,this),_.off(l.Z.INTERNAL_MANIFEST_LOADED,D,this),S();}},t=(0, f.Z)(v).getInstance().getLogger(e),h=Vt(v).create(),e;}Kt.__dashjs_factory_name="ManifestUpdater";const zt=c.Z.getClassFactory(Kt);function Wt(){var e,t,n,r,i,a,o,s,c,d,g,h,p,m,y,E,v=this.context,_=(0, u.Z)(v).getInstance(),T=(0, Q.Z)(v).getInstance();function b(){s=[],c=[],d=null,g=null,p=null,h=NaN,n=!1,r=!1,m=i.get().streaming.utcSynchronization.timeBetweenSyncAttempts;}function A(){i.get().streaming.utcSynchronization.enabled&&!n&&!r&&p&&p.value&&p.schemeIdUri&&!isNaN(h)&&!isNaN(i.get().streaming.utcSynchronization.backgroundAttempts)&&(g&&(Date.now()-g)/1e3<30||(s=[],r=!0,I(isNaN(i.get().streaming.utcSynchronization.backgroundAttempts)?2:i.get().streaming.utcSynchronization.backgroundAttempts)));}function I(e){try{if(e<=0)return void B();var t=Date.now();a[p.schemeIdUri](p.value,function(n){var r=Date.now(),i=N(t,r,n);s.push(i),I(e-1);},function(){B();});}catch(e){B();}}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||0;if(!c||0===c.length||t>=c.length)D();else {var n=c[t];if(n){if(a.hasOwnProperty(n.schemeIdUri)){var r=new Date().getTime();a[n.schemeIdUri](n.value,function(e){var t=new Date().getTime(),i=N(r,t,e);p=n,D(i);},function(){R(t+1);});}else R(t+1);}else D();}}function N(e,t,n){return n-(t-(t-e)/2);}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,t=isNaN(e);t&&i.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?U():Z(t,e);}function O(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t,n,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime();}(e)),t;}function M(e){return Date.parse(e);}function P(e){return Date.parse(e);}function L(e,t,n){n();}function x(e,t,n){var r=O(e);isNaN(r)?n():t(r);}function F(e,t,n,r,i){var a,o,s=!1,u=new XMLHttpRequest(),l=i?C.w.HEAD:C.w.GET,c=t.match(/\S+/g);if(t=c.shift(),a=function(){s||(s=!0,c.length?F(e,c.join(" "),n,r,i):r());},o=function(){var t,r;200===u.status&&(t=i?u.getResponseHeader("Date"):u.response,r=e(t),isNaN(r)||(n(r),s=!0));},T.isRelative(t)){var f=E.resolve();f&&(t=T.resolve(t,f.url));}u.open(l,t),u.timeout=5e3,u.onload=o,u.onloadend=a,u.send();}function k(e,t,n){F(P,e,t,n,!0);}function U(){var e=o.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?Z(!0):Z(!1,t-Date.now());}function Z(e,r){if(isNaN(h)||isNaN(r)||e||function(e){try{var n,r=G(e),a=isNaN(m)?30:m,o=isNaN(i.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:i.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,s=isNaN(i.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:i.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,u=isNaN(i.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:i.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;r?(n=Math.min(a*o,s),t.debug("Increasing timeBetweenSyncAttempts to ".concat(n))):(n=Math.max(a/o,u),t.debug("Decreasing timeBetweenSyncAttempts to ".concat(n))),m=n;}catch(e){}}(r),!e&&!isNaN(r)){d=Date.now(),n=!1;var a=isNaN(h);h=r,a&&A(),t.debug("Completed UTC sync. Setting client - server offset to ".concat(r));}e&&(p=null,n=!1,y.error(new S.Z(w.TIME_SYNC_FAILED_ERROR_CODE,w.TIME_SYNC_FAILED_ERROR_MESSAGE))),_.trigger(l.Z.UPDATE_TIME_SYNC_OFFSET,{offset:r}),_.trigger(l.Z.TIME_SYNCHRONIZATION_COMPLETED);}function B(){if(s&&0!==s.length){var e=s.reduce(function(e,t){return e+t;},0)/s.length;G(e)?t.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(t.debug("Completed background UTC sync. Setting client - server offset to ".concat(e)),h=e,_.trigger(l.Z.UPDATE_TIME_SYNC_OFFSET,{offset:h})),r=!1,g=Date.now();}}function G(e){try{if(isNaN(h))return !0;var t=i.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(i.get().streaming.utcSynchronization.maximumAllowedDrift)?i.get().streaming.utcSynchronization.maximumAllowedDrift:100;return e>=h-t&&e<=h+t;}catch(e){return !0;}}return e={initialize:function(){b(),a={"urn:mpeg:dash:utc:http-head:2014":k,"urn:mpeg:dash:utc:http-xsdate:2014":F.bind(null,O),"urn:mpeg:dash:utc:http-iso:2014":F.bind(null,M),"urn:mpeg:dash:utc:direct:2014":x,"urn:mpeg:dash:utc:http-head:2012":k,"urn:mpeg:dash:utc:http-xsdate:2012":F.bind(null,O),"urn:mpeg:dash:utc:http-iso:2012":F.bind(null,M),"urn:mpeg:dash:utc:direct:2012":x,"urn:mpeg:dash:utc:http-ntp:2014":L,"urn:mpeg:dash:utc:ntp:2014":L,"urn:mpeg:dash:utc:sntp:2014":L};},attemptSync:function(e,t){c=e,n||(function(e){try{if(!e||!i.get().streaming.utcSynchronization.enabled)return !1;var t=isNaN(m)?30:m;return !(d&&t&&!isNaN(t))||(Date.now()-d)/1e3>=t;}catch(e){return !0;}}(t)?(n=!0,R()):_.trigger(l.Z.TIME_SYNCHRONIZATION_COMPLETED));},setConfig:function(e){e&&(e.dashMetrics&&(o=e.dashMetrics),e.baseURLController&&(E=e.baseURLController),e.errHandler&&(y=e.errHandler),e.settings&&(i=e.settings));},reset:function(){b(),_.off(l.Z.ATTEMPT_BACKGROUND_SYNC,A,e);}},t=(0, f.Z)(v).getInstance().getLogger(e),_.on(l.Z.ATTEMPT_BACKGROUND_SYNC,A,e),e;}Wt.__dashjs_factory_name="TimeSyncController";var Xt=c.Z.getSingletonFactory(Wt);Xt.HTTP_TIMEOUT_MS=5e3,c.Z.updateSingletonFactory(Wt.__dashjs_factory_name,Xt);const Qt=Xt;function Jt(){var e,t,n,r=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return "MediaSource"in window?t=new MediaSource():e&&(t=new WebKitMediaSource()),t;},attachMediaSource:function(e){var n=window.URL.createObjectURL(t);return e.setSource(n),n;},detachMediaSource:function(e){e.setSource(null);},setDuration:function e(r){t&&"open"===t.readyState&&(null===r&&isNaN(r)||t.duration!==r&&(function(e){for(var t=e.sourceBuffers,n=0;n<t.length;n++)if(t[n].updating)return !0;return !1;}(t)?setTimeout(e.bind(null,r),50):(n.info("Set MediaSource duration:"+r),t.duration=r)));},setSeekable:function(e,n){t&&"function"==typeof t.setLiveSeekableRange&&"function"==typeof t.clearLiveSeekableRange&&"open"===t.readyState&&e>=0&&e<n&&(t.clearLiveSeekableRange(),t.setLiveSeekableRange(e,n));},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,r=0;r<t.length;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return;}n.info("call to mediaSource endOfStream"),e.endOfStream();}}},n=(0, f.Z)(r).getInstance().getLogger(e),e;}Jt.__dashjs_factory_name="MediaSourceController";const $t=c.Z.getSingletonFactory(Jt);function en(){var e,t,n,r,i,a,o,s,l,c,g,h="urn:mpeg:dash:event:2012",p="discarded",m="updated",y="added",E=this.context,v=(0, u.Z)(E).getInstance();function _(){if(!o||!s)throw new Error("setConfig function has to be called previously");}function T(){g=!1,n={},r={},i=null,c=!1,a=Date.now()/1e3;}function S(){try{if(!c){c=!0;var e=s.getTime(),i=e-a;i=a>0?Math.max(0,i):0,b(r,i,e),b(n,i,e),A(r),A(n),a=e,c=!1;}}catch(e){c=!1,t.error(e);}}function b(e,n,r){try{N(e,function(i){if(void 0!==i){var a=isNaN(i.duration)?0:i.duration;i.calculatedPresentationTime<=r&&i.calculatedPresentationTime+n+a>=r?D(i,d.Z.EVENT_MODE_ON_START):(C(r,a+n,i.calculatedPresentationTime)||function(e){try{var n=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>n;}catch(e){return t.error(e),!1;}}(i))&&(t.debug("Removing event ".concat(i.id," from period ").concat(i.eventStream.period.id," as it is expired or invalid")),function(e,n){try{var r=n.eventStream.schemeIdUri,i=n.eventStream.period.id,a=n.eventStream.value,o=n.id;e[i][r]=e[i][r].filter(function(e){return a&&e.eventStream.value&&e.eventStream.value!==a||e.id!==o;}),0===e[i][r].length&&delete e[i][r];}catch(e){t.error(e);}}(e,i));}});}catch(e){t.error(e);}}function A(e){try{for(var n in e)e.hasOwnProperty(n)&&0===Object.keys(e[n]).length&&delete e[n];}catch(e){t.error(e);}}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.eventStream.schemeIdUri,i=e.eventStream.value,a=e.id,o=p;t[r]||(t[r]=[]);var s=t[r].findIndex(function(e){return (!i||e.eventStream.value&&e.eventStream.value===i)&&e.id===a;});if(-1===s)t[r].push(e),e.triggeredReceivedEvent=!1,e.triggeredStartEvent=!1,o=y;else if(n){var u=t[r][s];e.triggeredReceivedEvent=u.triggeredReceivedEvent,e.triggeredStartEvent=u.triggeredStartEvent,t[r][s]=e,o=m;}return o;}function R(e){try{if(1==e.eventStream.value){var n,r=e.calculatedPresentationTime;n=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,v.trigger(d.Z.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:n,newManifestValidAfter:NaN},{mode:d.Z.EVENT_MODE_ON_START});}}catch(e){t.error(e);}}function w(e){try{var n=s.getTime();N(e,function(e){var t=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.duration)?e.eventStream.period.duration:NaN,r=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.start)?e.eventStream.period.start:NaN;if(!isNaN(t)&&!isNaN(r)){var i=e.calculatedPresentationTime;Math.abs(i-n)<300&&D(e,d.Z.EVENT_MODE_ON_START);}});}catch(e){t.error(e);}}function N(e,n){try{if(e)for(var r=Object.keys(e),i=0;i<r.length;i++)for(var a=e[r[i]],o=Object.keys(a),s=0;s<o.length;s++)a[o[s]].forEach(function(e){void 0!==e&&n(e);});}catch(e){t.error(e);}}function C(e,n,r){try{return e-n>r;}catch(e){return t.error(e),!1;}}function D(e,n){try{var r=s.getTime(),i=e.id;if(n===d.Z.EVENT_MODE_ON_RECEIVE&&!e.triggeredReceivedEvent)return t.debug("Received event ".concat(i)),e.triggeredReceivedEvent=!0,void v.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n});e.triggeredStartEvent||(e.eventStream.schemeIdUri===h&&1==e.eventStream.value?0===e.duration&&0===e.presentationTimeDelta||(t.debug("Starting manifest refresh event ".concat(i," at ").concat(r)),function(){try{_(),o.refreshManifest();}catch(e){t.error(e);}}()):"urn:mpeg:dash:event:callback:2015"===e.eventStream.schemeIdUri&&1==e.eventStream.value?(t.debug("Starting callback event ".concat(i," at ").concat(r)),function(e){try{(0,se.Z)(E).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}});}catch(e){t.error(e);}}(e.messageData)):(t.debug("Starting event ".concat(i," from period ").concat(e.eventStream.period.id," at ").concat(r)),v.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n})),e.triggeredStartEvent=!0);}catch(e){t.error(e);}}return e={addInlineEvents:function(e,r){try{if(_(),n[r]||(n[r]={}),e)for(var i=0;i<e.length;i++){var a=e[i];if(!C(s.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)){var o=I(a,n[r],!0);o===y?(t.debug("Added inline event with id ".concat(a.id," from period ").concat(r)),D(a,d.Z.EVENT_MODE_ON_RECEIVE)):o===m&&t.debug("Updated inline event with id ".concat(a.id," from period ").concat(r));}}}catch(e){throw e;}},addInbandEvents:function(e,n){try{_(),r[n]||(r[n]={});for(var i=0;i<e.length;i++){var a=e[i];C(s.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)||(I(a,r[n],!1)===y?(a.eventStream.schemeIdUri===h&&R(a),t.debug("Added inband event with id ".concat(a.id," from period ").concat(n)),D(a,d.Z.EVENT_MODE_ON_RECEIVE)):t.debug("Inband event with scheme_id_uri ".concat(a.eventStream.schemeIdUri,", value ").concat(a.eventStream.value,", period id ").concat(n," and event id ").concat(a.id," was ignored because it has been added before.")));}S();}catch(e){throw e;}},getInbandEvents:function(){return r;},getInlineEvents:function(){return n;},start:function(){try{_(),t.debug("Start Event Controller");var e=l.get().streaming.eventControllerRefreshDelay;g||isNaN(e)||(g=!0,i=setInterval(S,e));}catch(e){throw e;}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(o=e.manifestUpdater),e.playbackController&&(s=e.playbackController),e.settings&&(l=e.settings);}catch(e){throw e;}},reset:function(){((function(){try{null!==i&&g&&(clearInterval(i),i=null,g=!1,function(){try{w(r),w(n);}catch(e){t.error(e);}}());}catch(e){throw e;}}))(),T();}},t=(0, f.Z)(E).getInstance().getLogger(e),T(),e;}en.__dashjs_factory_name="EventController";const tn=c.Z.getSingletonFactory(en),nn={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}};function rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r;}function an(){var e,t,n,r,i,o,c,g,h,p,m,y,E,v,_,T,b,A,I,R,N,C,D,O,M,P,L,F,k,U,Z,B,G,q,Y,j,H,V,K,z,W,X,Q,J,te,ne,re,ie,ae=this.context,oe=(0, u.Z)(ae).getInstance();function se(){if(!(o&&o.hasOwnProperty("load")&&N&&N.hasOwnProperty("initialize")&&N.hasOwnProperty("reset")&&N.hasOwnProperty("getClientTimeOffset")&&c&&R&&h&&G))throw new Error(a.Z.MISSING_CONFIG_ERROR);}function ue(){if(!i||!i.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously");}function le(){!function(){try{var e=g.getStreamsInfo();if(!D&&0===e.length)throw new Error("There are no periods in the MPD");D&&e.length>0&&h.updateManifestUpdateInfo({currentTime:G.getTime(),buffered:B.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:N.getClientTimeOffset()}),C.length>0&&function(e){0!==e.length?C=C.filter(function(n){var r=e.filter(function(e){return e.id===n.getId();}).length>0||n.getId()===D.getId();return r||(t.debug("Removing stream ".concat(n.getId())),n.reset(!0)),r;}):t.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.");}(e);for(var n=[],r=0,i=e.length;r<i;r++){var a=e[r];n.push(fe(a)),h.addManifestUpdateStreamInfo(a);}Promise.all(n).then(function(){return new Promise(function(t,n){D?t():de(e,t,n);});}).then(function(){oe.trigger(l.Z.STREAMS_COMPOSED),Me();}).catch(function(e){throw e;});}catch(e){R.error(new S.Z(w.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+" nostreamscomposed",c.getValue())),U=!0,Qe();}}();}function ce(){te=!0;}function fe(e){var t=ze(e.id);return t?t.updateData(e):(t=Bt(ae).create({manifestModel:c,mediaPlayerModel:Y,dashMetrics:h,manifestUpdater:i,adapter:g,timelineConverter:N,capabilities:n,capabilitiesFilter:r,errHandler:R,baseURLController:E,segmentBaseController:v,textController:M,abrController:T,playbackController:G,eventController:A,mediaController:b,protectionController:O,videoModel:B,streamInfo:e,settings:J}),C.push(t),t.initialize(),Promise.resolve());}function de(e,n,r){try{Ae();var i=h.getCurrentDVRInfo().range;if(i.end<i.start){ne&&clearTimeout(ne);var a=Math.min(1e3*(-1*(i.end-i.start)+2),2147483647);return t.debug("Waiting for ".concat(a," ms before playback can start")),oe.trigger(l.Z.AST_IN_FUTURE,{delay:a}),void(ne=setTimeout(function(){de(e,n,r);},a));}J.get().streaming.applyProducerReferenceTime&&q.calculateProducerReferenceTimeOffsets(e);var o=e[0].manifestInfo;if(J.get().streaming.applyServiceDescription&&q.applyServiceDescription(o),g.getIsDynamic()){var s=Be(e,o);G.computeAndSetLiveDelay(s,o);}(J.get().streaming.applyContentSteering&&y.shouldQueryBeforeStart()?y.loadSteeringData():Promise.resolve()).then(function(){var e=c.getValue();e&&E.update(e),ge(),n();}).catch(function(e){t.error(e),ge(),n();});}catch(e){r(e);}}function ge(){var e=function(){var e;if(g.getIsDynamic()){var n=h.getCurrentDVRInfo();e=(n&&n.range?n.range.end:0)-G.getOriginalLiveDelay();var r=n?n.range:null;if(r){if(isNaN(re)&&-1===re.toString().indexOf("posix:")){var i=ke(!0);isNaN(i)||(t.info("Start time from URI parameters: ".concat(i)),e=Math.min(e,i));}else {t.info("Start time provided by the app: ".concat(re));var a=Ue(!0,re);isNaN(a)||(e=Math.min(e,a));}var o=J.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;e=Math.max(e,r.start+o);}}else if(e=$e()[0].getStreamInfo().start,isNaN(re)){var s=ke(!1);isNaN(s)||(t.info("Start time from URI parameters: ".concat(s)),e=Math.max(e,s));}else {t.info("Start time provided by the app: ".concat(re));var u=Ue(!1,re);isNaN(u)||(e=Math.max(e,u));}return e;}(),n=be(e),r=null!==n?n:C[0];oe.trigger(l.Z.INITIAL_STREAM_SWITCH,{startTime:e}),he(r,null,e),z||(z=setInterval(function(){!F&&G.getTimeToStreamEnd()<=0&&!G.isSeeking()&&oe.trigger(l.Z.PLAYBACK_ENDED,{isLast:Ke().isLast});},200));}function he(e,n,r){try{if(F||!e||n===e&&e.getIsActive())return;F=!0,oe.trigger(l.Z.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var i=!1;D=e,n&&(i=Te(e,n),n.deactivate(i)),r=isNaN(r)?!i&&n?e.getStreamInfo().start:NaN:r,t.info("Switch to stream ".concat(e.getId(),". Seektime is ").concat(r,", current playback time is ").concat(G.getTime(),". Seamless period switch is set to ").concat(i)),X=X.filter(function(e){return e.getId()!==D.getId();}),G.initialize(Ke(),!!n),B.getElement()?pe(r,i,!1):me(r,i);}catch(e){F=!1;}}function pe(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];function a(){if(Z&&"open"===Z.readyState){t.debug("MediaSource is open!"),window.URL.revokeObjectURL(r),Z.removeEventListener("sourceopen",a),Z.removeEventListener("webkitsourceopen",a),Fe();var o=h.getCurrentDVRInfo();p.setSeekable(o.range.start,o.range.end),i?(isNaN(e)||G.seek(e,!0,!0),D.setMediaSource(Z).then(function(){D.initializeForTextWithMediaSource(Z);})):me(e,n);}}function o(){Z.addEventListener("sourceopen",a,!1),Z.addEventListener("webkitsourceopen",a,!1),r=p.attachMediaSource(B),t.debug("MediaSource attached to element.  Waiting on open...");}Z?n?me(e,n):(p.detachMediaSource(B),o()):(Z=p.createMediaSource(),o());}function me(e,t){D.activate(Z,t?W:void 0,e).then(function(t){if(t){var n=Object.keys(t);n.length>0&&t[n[0]].getBuffer().changeType&&(Q=!0),W=t;}isNaN(e)||(oe.trigger(l.Z.SEEK_TARGET,{time:e},{streamId:D.getId()}),G.seek(e,!1,!0),D.startScheduleControllers()),F=!1,oe.trigger(l.Z.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Ke()});});}function ye(e){var t=be(e.seekTime);t&&t!==D?t&&t!==D&&(Ee(),function(e,t){var n=e&&!isNaN(e.seekTime)?e.seekTime:NaN,r=D.getProcessors().map(function(t){return t.prepareOuterPeriodPlaybackSeeking(e);});Promise.all(r).then(function(){he(t,D,n);}).catch(function(e){R.error(e);});}(e,t)):(Ee(),function(e){D.getProcessors().forEach(function(t){return t.prepareInnerPeriodPlaybackSeeking(e);}),je(ee.USER_REQUEST_STOP_REASON);}(e)),He($.SEEK_START_REASON);}function Ee(){ve();}function ve(){X&&X.length>0&&(X.forEach(function(e){e.deactivate(!0);}),X=[]);}function _e(e){e.newMediaInfo.streamInfo.id===D.getId()&&(ve(),D.prepareTrackChange(e));}function Te(e,t){try{return J.get().streaming.buffer.reuseExistingSourceBuffers&&(t.isProtectionCompatible(e)||te)&&(Q&&J.get().streaming.buffer.useChangeTypeForTrackSwitch||t.isMediaCodecCompatible(e,t));}catch(e){return !1;}}function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Z&&!e.getPreloaded()){var n=Te(e,t);n&&e.startPreloading(Z,W).then(function(){X.push(e);});}}function be(e){if(isNaN(e))return null;for(var t=C.length,n=0;n<t;n++){var r=C[n];if(e<parseFloat((r.getStartTime()+r.getDuration()).toFixed(5)))return r;}return null;}function Ae(){try{var e=g.getIsDynamic(),t=g.getStreamsInfo()[0].manifestInfo,n=G.getTime(),r=N.calcTimeShiftBufferWindow(C,e),i=Le();if(void 0===r.start||void 0===r.end)return;i&&0!==i.length?i.forEach(function(e){h.addDVRInfo(e.getType(),n,t,r);}):h.addDVRInfo(a.Z.VIDEO,n,t,r);}catch(e){}}function Ie(e){if(V&&L){var t=Y.getInitialBufferLevel(),n=[a.Z.TEXT];(isNaN(t)||t<=G.getBufferLevel(n)||g.getIsDynamic()&&t>G.getLiveDelay())&&(V=!1,He($.INITIAL_PLAYOUT_START_REASON),G.play());}e&&e.mediaType&&h.addBufferLevel(e.mediaType,new Date(),1e3*e.bufferLevel);}function Re(e){e.streamInfo.id===D.getId()&&e.reason&&e.reason.forceReplace&&ve(),ze(e.streamInfo.id).prepareQualityChange(e);}function we(){if(g.getIsDynamic()&&0!==G.getOriginalLiveDelay()&&D){var e=g.getStreamsInfo();if(e.length>0){var t=e[0].manifestInfo,n=Be(e,t);G.computeAndSetLiveDelay(n,t);}}}function Ne(){if(qe()){var e=B.getPlaybackQuality();e&&h.addDroppedFrames(e);}}function Ce(){t.debug("[onPlaybackStarted]"),!V&&H&&He($.RESUME_FROM_PAUSE_START_REASON),V&&(V=!1),K&&(K=!1,J.get().streaming.applyContentSteering&&!y.shouldQueryBeforeStart()&&y.loadSteeringData()),H=!1;}function De(e){t.debug("[onPlaybackPaused]"),e.ended||(H=!0,je(ee.USER_REQUEST_STOP_REASON));}function Oe(e){t.debug("Stream with id ".concat(e.streamInfo.id," finished buffering"));var n=e.streamInfo.isLast;Z&&n?(t.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),p.signalEndOfStream(Z)):Me();}function Me(){if(D&&D.getHasFinishedBuffering())for(var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=e||D||null;if(t){var n=t.getStreamInfo();return C.filter(function(e){var t=e.getStreamInfo();return t.start>n.start&&n.id!==t.id;});}}catch(e){return [];}}(D),t=0;t<e.length;){var n=e[t],r=0===t?D:e[t-1];!n.getPreloaded()&&r.getHasFinishedBuffering()&&Z&&Se(n,r),t+=1;}}function Pe(){z&&(clearInterval(z),z=null);}function Le(){return D?D.getProcessors():[];}function xe(e){if(D&&!D.getIsEndedEventSignaled()){D.setIsEndedEventSignaled(!0);var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||D||null;if(!t)return null;for(var n=t.getStreamInfo(),r=n.start,i=0,a=-1,o=NaN;i<C.length;){var s=C[i].getStreamInfo(),u=s.start-r;u>0&&(isNaN(o)||u<o)&&n.id!==s.id&&(o=u,a=i),i+=1;}return a>=0?C[a]:null;}();n?(t.debug("StreamController onEnded, found next stream with id ".concat(n.getStreamInfo().id,". Switching from ").concat(D.getStreamInfo().id," to ").concat(n.getStreamInfo().id)),he(n,D,NaN)):(t.debug("StreamController no next stream found"),D.setIsEndedEventSignaled(!1)),je(n?ee.END_OF_PERIOD_STOP_REASON:ee.END_OF_CONTENT_STOP_REASON);}e&&e.isLast&&(Pe(),y.stopSteeringRequestTimer());}function Fe(e){var t=e||Ke().manifestInfo.duration;p.setDuration(t);}function ke(e){var t=_.getURIFragmentData();if(!t||!t.t)return NaN;var n=$e()[0].getStreamInfo().start;return t.t=t.t.split(",")[0],Ze(e,t.t,n);}function Ue(e,t){var n=0;return e||(n=$e()[0].getStreamInfo().start),Ze(e,t,n);}function Ze(e,t,n){var r=g.getRegularPeriods()[0],i=t.toString(),a=-1!==i.indexOf("posix:")?"now"===i.substring(6)?Date.now()/1e3:parseFloat(i.substring(6)):NaN;return e&&!isNaN(a)?N.calcPresentationTimeFromWallTime(new Date(1e3*a),r):parseFloat(i)+n;}function Be(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var r=e[0],i=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT].reduce(function(e,t){var n=g.getMediaInfoForType(r,t);return n&&!1!==n.isFragmented&&e.push(n),e;},[]).reduce(function(e,t){var n=g.getVoRepresentations(t);return n&&n.length>0&&n.forEach(function(t){t&&e.push(t);}),e;},[]).reduce(function(e,t){var n=g.convertRepresentationToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e;},[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e))return rn(e);}(o=i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e);}(o)||function(e,t){if(e){if("string"==typeof e)return rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rn(e,t):void 0;}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}());}return isFinite(n)?n:NaN;}catch(e){return NaN;}var o;}function Ge(e){if(e.error)U=!0,Qe();else {t.info("Manifest updated... updating data system wide.");var n=e.manifest;g.updatePeriods(n);var i=g.getUTCTimingSources();!g.getIsDynamic()||i&&0!==i.length||oe.trigger(d.Z.CONFORMANCE_VIOLATION,{level:nn.LEVELS.WARNING,event:nn.EVENTS.NO_UTC_TIMING_ELEMENT});var a=g.getIsDynamic()?i.concat(j.getUTCTimingSources()):i;r.filterUnsupportedFeatures(n).then(function(){E.initialize(n),m.attemptSync(a,g.getIsDynamic());});}}function qe(){return !!D&&D.getHasVideoTrack();}function Ye(){return !!D&&D.getHasAudioTrack();}function je(e,t){t=t||new Date(),Le().forEach(function(n){n.finalisePlayList(t,e);}),h.addPlayList();}function He(e){h.createPlaylistMetrics(1e3*G.getTime(),e);}function Ve(e){if(e.error){var n="";switch(e.error.code){case 1:n="MEDIA_ERR_ABORTED";break;case 2:n="MEDIA_ERR_NETWORK";break;case 3:n="MEDIA_ERR_DECODE",ie.counts.mediaErrorDecode+=1;break;case 4:n="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:n="MEDIA_ERR_ENCRYPTED";break;default:n="UNKNOWN";}"MEDIA_ERR_DECODE"===n&&J.get().errors.recoverAttempts.mediaErrorDecode>=ie.counts.mediaErrorDecode?function(){t.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var e=G.getTime();D.deactivate(!1),t.warn("MediaSource has been resetted. Resuming playback from time ".concat(e)),pe(e,!1,!1);}():(k=!0,e.error.message&&(n+=" ("+e.error.message+")"),e.error.msExtendedCode&&(n+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),t.fatal("Video Element Error: "+n),e.error&&t.fatal(e.error),R.error(new S.Z(e.error.code,n)),Qe());}}function Ke(){return D?D.getStreamInfo():null;}function ze(e){for(var t=0,n=C.length;t<n;t++)if(C[t].getId()===e)return C[t];return null;}function We(e){isNaN(e.newDuration)||Fe(e.newDuration);}function Xe(){C=[],re=NaN,O=null,F=!1,D=null,k=!1,U=!1,V=!0,K=!0,H=!1,L=!0,z=null,te=!1,Q=!1,X=[],ne=null,ie={counts:{mediaErrorDecode:0}};}function Qe(){se(),m.reset(),je(k||U?ee.FAILURE_STOP_REASON:ee.USER_REQUEST_STOP_REASON);for(var t=0,n=C?C.length:0;t<n;t++)C[t].reset(k);oe.off(d.Z.PLAYBACK_TIME_UPDATED,Ne,e),oe.off(d.Z.PLAYBACK_SEEKING,ye,e),oe.off(d.Z.PLAYBACK_ERROR,Ve,e),oe.off(d.Z.PLAYBACK_STARTED,Ce,e),oe.off(d.Z.PLAYBACK_PAUSED,De,e),oe.off(d.Z.PLAYBACK_ENDED,xe,e),oe.off(d.Z.METRIC_ADDED,Je,e),oe.off(d.Z.MANIFEST_VALIDITY_CHANGED,We,e),oe.off(d.Z.BUFFER_LEVEL_UPDATED,Ie,e),oe.off(d.Z.QUALITY_CHANGE_REQUESTED,Re,e),l.Z.KEY_SESSION_UPDATED&&oe.off(l.Z.KEY_SESSION_UPDATED,ce,e),oe.off(l.Z.MANIFEST_UPDATED,Ge,e),oe.off(l.Z.STREAM_BUFFERING_COMPLETED,Oe,e),oe.off(l.Z.TIME_SYNCHRONIZATION_COMPLETED,le,e),oe.off(l.Z.CURRENT_TRACK_CHANGED,_e,e),oe.off(l.Z.SETTING_UPDATED_LIVE_DELAY,we,e),oe.off(l.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,we,e),E.reset(),i.reset(),A.reset(),h.clearAllCurrentMetrics(),c.setValue(null),o.reset(),N.reset(),I.reset(),Z&&(p.detachMediaSource(B),Z=null),B=null,O&&(O=null,P=null,c.getValue()&&oe.trigger(l.Z.PROTECTION_DESTROYED,{data:c.getValue().url})),Pe(),oe.trigger(l.Z.STREAM_TEARDOWN_COMPLETE),Xe();}function Je(e){if(e.metric===s.Z.DVR_INFO){var t=Ye()?a.Z.AUDIO:a.Z.VIDEO;e.mediaType===t&&p.setSeekable(e.value.range.start,e.value.range.end);}}function $e(){return C;}return e={initialize:function(t,n){se(),L=t,P=n,N.initialize(),(i=zt(ae).create()).setConfig({manifestModel:c,adapter:g,manifestLoader:o,errHandler:R,settings:J,contentSteeringController:y}),i.initialize(),(A=tn(ae).getInstance()).setConfig({manifestUpdater:i,playbackController:G,settings:J}),A.start(),m.setConfig({dashMetrics:h,baseURLController:E,errHandler:R,settings:J}),m.initialize(),O&&(oe.trigger(l.Z.PROTECTION_CREATED,{controller:O}),O.setMediaElement(B.getElement()),P&&O.setProtectionData(P)),oe.on(d.Z.PLAYBACK_TIME_UPDATED,Ne,e),oe.on(d.Z.PLAYBACK_SEEKING,ye,e),oe.on(d.Z.PLAYBACK_ERROR,Ve,e),oe.on(d.Z.PLAYBACK_STARTED,Ce,e),oe.on(d.Z.PLAYBACK_PAUSED,De,e),oe.on(d.Z.PLAYBACK_ENDED,xe,e),oe.on(d.Z.METRIC_ADDED,Je,e),oe.on(d.Z.MANIFEST_VALIDITY_CHANGED,We,e),oe.on(d.Z.BUFFER_LEVEL_UPDATED,Ie,e),oe.on(d.Z.QUALITY_CHANGE_REQUESTED,Re,e),l.Z.KEY_SESSION_UPDATED&&oe.on(l.Z.KEY_SESSION_UPDATED,ce,e),oe.on(l.Z.MANIFEST_UPDATED,Ge,e),oe.on(l.Z.STREAM_BUFFERING_COMPLETED,Oe,e),oe.on(l.Z.TIME_SYNCHRONIZATION_COMPLETED,le,e),oe.on(l.Z.CURRENT_TRACK_CHANGED,_e,e),oe.on(l.Z.SETTING_UPDATED_LIVE_DELAY,we,e),oe.on(l.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,we,e);},getActiveStreamInfo:Ke,addDVRMetric:Ae,hasVideoTrack:qe,hasAudioTrack:Ye,getStreamById:ze,getStreamForTime:be,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=0;o<C.length;o++){if(i=(n=C[o]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a);}return null;},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;se(),re=t,o.load(e);},loadWithManifest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;ue(),re=t,i.setManifest(e);},getActiveStreamProcessors:Le,setConfig:function(e){e&&(e.capabilities&&(n=e.capabilities),e.capabilitiesFilter&&(r=e.capabilitiesFilter),e.manifestLoader&&(o=e.manifestLoader),e.manifestModel&&(c=e.manifestModel),e.mediaPlayerModel&&(Y=e.mediaPlayerModel),e.customParametersModel&&(j=e.customParametersModel),e.protectionController&&(O=e.protectionController),e.adapter&&(g=e.adapter),e.dashMetrics&&(h=e.dashMetrics),e.errHandler&&(R=e.errHandler),e.timelineConverter&&(N=e.timelineConverter),e.videoModel&&(B=e.videoModel),e.playbackController&&(G=e.playbackController),e.serviceDescriptionController&&(q=e.serviceDescriptionController),e.contentSteeringController&&(y=e.contentSteeringController),e.textController&&(M=e.textController),e.abrController&&(T=e.abrController),e.mediaController&&(b=e.mediaController),e.settings&&(J=e.settings),e.baseURLController&&(E=e.baseURLController),e.uriFragmentModel&&(_=e.uriFragmentModel),e.segmentBaseController&&(v=e.segmentBaseController));},setProtectionData:function(e){P=e,O&&O.setProtectionData(P);},getIsStreamSwitchInProgress:function(){return F;},switchToVideoElement:function(e){D&&(G.initialize(Ke()),pe(e,!1,!0));},getHasMediaOrInitialisationError:function(){return k||U;},getStreams:$e,getActiveStream:function(){return D;},getInitialPlayback:function(){return V;},getAutoPlay:function(){return L;},reset:Qe},t=(0, f.Z)(ae).getInstance().getLogger(e),m=Qt(ae).getInstance(),p=$t(ae).getInstance(),I=x(ae).getInstance(),Xe(),e;}an.__dashjs_factory_name="StreamController";const on=c.Z.getSingletonFactory(an);function sn(){var e,t,n,r,i,o,s,c,d,g,h,p,m=this.context,y=(0, u.Z)(m).getInstance();function E(){p.debug("Stopping the gap controller"),i&&(clearInterval(i),i=null),function(){y.off(l.Z.WALLCLOCK_TIME_UPDATED,b,this),y.off(l.Z.INITIAL_STREAM_SWITCH,S,this),y.off(l.Z.PLAYBACK_SEEKING,v,this),y.off(l.Z.BUFFER_REPLACEMENT_STARTED,_,e),y.off(l.Z.TRACK_CHANGE_RENDERED,T,e);}(),i=null,o=NaN,r=0,g=null,h={};}function v(){g&&(clearTimeout(g),g=null);}function _(e){try{if(e.streamId!==c.getActiveStreamInfo().id||e.mediaType!==a.Z.VIDEO&&e.mediaType!==a.Z.AUDIO)return;e.streamId===c.getActiveStreamInfo().id&&(h[e.mediaType]=!0);}catch(e){p.error(e);}}function T(e){e&&e.mediaType&&(h[e.mediaType]=!1);}function S(){i||function(){try{i||(p.debug("Starting the gap controller"),i=setInterval(function(){A()&&N(s.getTime());},100));}catch(e){}}();}function b(){if(A(n.get().streaming.gaps.enableSeekFix)&&++r>=10){var e=s.getTime();t===e?N(e,!0):(t=e,o=NaN),r=0;}}function A(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!c.getActiveStream())return !1;var t=Object.keys(h).some(function(e){return h[e];}),r=!!e&&I();return !t&&n.get().streaming.gaps.jumpGaps&&c.getActiveStreamProcessors().length>0&&(!s.isSeeking()||r)&&!s.isPaused()&&!c.getIsStreamSwitchInProgress()&&!c.getHasMediaOrInitialisationError();}function I(){var e=c.getActiveStream(),t=parseFloat((e.getStartTime()+e.getDuration()).toFixed(5));return s.getTime()+n.get().streaming.gaps.threshold>=t;}function R(e,t){try{if(!e||e.length<=1&&t>0)return NaN;for(var r=NaN,i=0;isNaN(r)&&i<e.length;){var a=i>0?e.end(i-1):0;t<e.start(i)&&a-t<n.get().streaming.gaps.threshold&&(r=i),i+=1;}return r;}catch(e){return null;}}function w(e,t){for(var n=0,r=e.length;n<r;n++)if(t>=e.start(n)&&t<=e.end(n))return !0;return !1;}function N(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n.get().streaming.gaps.enableStallFix,a=n.get().streaming.gaps.stallSeek,u=n.get().streaming.gaps.smallGapLimit,l=n.get().streaming.gaps.jumpLargeGaps,f=d.getBufferRange(),h=NaN,m=!1;if(t=R(f,e),!isNaN(t)){var y=f.start(t),E=y-e;E>0&&(E<=u||l)&&(h=y);}var v=s.getTimeToStreamEnd();if(isNaN(h)&&r&&isFinite(v)&&!isNaN(v)&&v<u&&(h=parseFloat(s.getStreamEndTime().toFixed(5)),m=!0),i&&isNaN(h)&&r&&isNaN(t)&&w(f,e)&&(0===a?(p.warn("Toggle play pause to break stall"),d.pause(),d.play()):(p.warn("Jumping ".concat(a,"s to break stall")),h=e+a)),h>0&&o!==h&&h>e&&!g){var _=h-e;if(m){var T=c.getStreamForTime(h),S=T&&!!T.getPreloaded();p.warn("Jumping to end of stream because of gap from ".concat(e," to ").concat(h,". Gap duration: ").concat(_)),s.seek(h,!0,S);}else {var b=s.getIsDynamic(),A=t>0?f.end(t-1):e,I=b?1e3*Math.max(0,_-.1):0;g=window.setTimeout(function(){s.seek(h,!0,!0),p.warn("Jumping gap occuring in period ".concat(c.getActiveStream().getStreamId()," starting at ").concat(A," and ending at ").concat(h,". Jumping by: ").concat(h-A)),g=null;},I);}o=h;}}return e={reset:E,setConfig:function(e){e&&(e.settings&&(n=e.settings),e.playbackController&&(s=e.playbackController),e.streamController&&(c=e.streamController),e.videoModel&&(d=e.videoModel));},initialize:function(){!function(){y.on(l.Z.WALLCLOCK_TIME_UPDATED,b,this),y.on(l.Z.INITIAL_STREAM_SWITCH,S,this),y.on(l.Z.PLAYBACK_SEEKING,v,this),y.on(l.Z.BUFFER_REPLACEMENT_STARTED,_,e),y.on(l.Z.TRACK_CHANGE_RENDERED,T,e);}();}},p=(0, f.Z)(m).getInstance().getLogger(e),E(),e;}sn.__dashjs_factory_name="GapController";const un=c.Z.getSingletonFactory(sn);function ln(){var e,t,n,r,i,o,c,g,h,p,m=this.context,y=(0, u.Z)(m).getInstance();function E(){t=!1;var e=Be.Z.parseUserAgent();n=e&&e.browser&&e.browser.name&&"safari"===e.browser.name.toLowerCase();}function v(){t=!1;}function _(e){if(e.streamId===o.getActiveStreamInfo().id&&h){var t=c.getLiveDelay();c.getBufferLevel()>t/2&&(h=!1);}}function T(e){e.streamId===o.getActiveStreamInfo().id&&(h=e.state===s.Z.BUFFER_EMPTY);}function S(){g.getCatchupModeEnabled()||r.setPlaybackRate(1);}function b(){c.getIsDynamic()&&g.getCatchupModeEnabled()&&(g.getCatchupPlaybackRates().max>0||g.getCatchupPlaybackRates().min<0)&&!c.isPaused()&&!c.isSeeking()&&function(){try{return !(!c.getTime()>0||t)&&(I()===a.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t){try{return Math.abs(A())>0||e<t;}catch(e){return !1;}}(c.getBufferLevel(),i.get().streaming.liveCatchup.playbackBufferMin):function(){try{return Math.abs(A())>0;}catch(e){return !1;}}());}catch(e){return !1;}}()&&function(){if(!t&&r){var e,o=r.getPlaybackRate(),s=g.getCatchupPlaybackRates(),u=c.getBufferLevel(),l=A(),f=g.getCatchupMaxDrift();if(!isNaN(f)&&f>0&&l>f)p.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),t=!0,c.seekToCurrentLive(!0,!1);else {var d=c.getCurrentLiveLatency(),m=c.getLiveDelay();e=I()===a.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t,n,r,i){var a;if(i<r){var o=Math.abs(e.min),s=5*(i-r);a=1-o+2*o/(1+Math.pow(Math.E,-s)),p.debug("[LoL+ playback control_buffer-based] bufferLevel: "+i+", newRate: "+a);}else {var u=e.max;if(Math.abs(t-n)<=.02*n)a=1;else {var l=5*(t-n);a=1-u+2*u/(1+Math.pow(Math.E,-l));}p.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+a);}return a;}(s,d,m,i.get().streaming.liveCatchup.playbackBufferMin,u):function(e,t,n,r){if(h)return 1;var i=t-n,a=i<0?Math.abs(e.min):e.max,o=5*i,s=1-a+2*a/(1+Math.pow(Math.E,-o));return c.getPlaybackStalled()&&r<=n/2&&i>0&&(s=1),s;}(s,d,m,u);var y=n?.25:.02/(.5/s.max);e&&Math.abs(o-e)>=y&&(p.debug("[CatchupController]: Setting playback rate to ".concat(e)),r.setPlaybackRate(e));}}}();}function A(){return c.getCurrentLiveLatency()-c.getLiveDelay();}function I(){var e=i.get().streaming.liveCatchup.playbackBufferMin;return i.get().streaming.liveCatchup.mode!==a.Z.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?a.Z.LIVE_CATCHUP_MODE_DEFAULT:a.Z.LIVE_CATCHUP_MODE_LOLP;}function R(){g.getCatchupPlaybackRates(!0);}return e={reset:function(){y.off(d.Z.BUFFER_LEVEL_UPDATED,_,e),y.off(d.Z.BUFFER_LEVEL_STATE_CHANGED,T,e),y.off(d.Z.PLAYBACK_PROGRESS,b,e),y.off(d.Z.PLAYBACK_TIME_UPDATED,b,e),y.off(d.Z.PLAYBACK_SEEKED,b,e),y.off(l.Z.SETTING_UPDATED_CATCHUP_ENABLED,S,e),y.off(l.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,R,e),y.off(l.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,R,e),y.off(d.Z.STREAM_INITIALIZED,R,e),E(),r.setPlaybackRate(1,!0);},setConfig:function(e){e&&(e.settings&&(i=e.settings),e.videoModel&&(r=e.videoModel),e.streamController&&(o=e.streamController),e.playbackController&&(c=e.playbackController),e.mediaPlayerModel&&(g=e.mediaPlayerModel));},initialize:function(){y.on(d.Z.BUFFER_LEVEL_UPDATED,_,e),y.on(d.Z.BUFFER_LEVEL_STATE_CHANGED,T,e),y.on(d.Z.PLAYBACK_PROGRESS,b,e),y.on(d.Z.PLAYBACK_TIME_UPDATED,b,e),y.on(d.Z.PLAYBACK_SEEKED,v,e),y.on(l.Z.SETTING_UPDATED_CATCHUP_ENABLED,S,e),y.on(l.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,R,e),y.on(l.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,R,e),y.on(d.Z.STREAM_INITIALIZED,R,e),R();}},p=(0, f.Z)(m).getInstance().getLogger(e),E(),e;}ln.__dashjs_factory_name="CatchupController";const cn=c.Z.getSingletonFactory(ln);var fn=[a.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME],dn="video",gn="audio";function hn(){var e,t,n,r,i,s=this.context;function u(){t={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{},contentSteering:null},n=[];}function l(e,n,i){try{t[e][n]=i/1e3;}catch(e){r.error(e);}}return e={getServiceDescriptionSettings:function(){return t;},getProducerReferenceTimeOffsets:function(){return n;},calculateProducerReferenceTimeOffsets:function(e){try{var t=[];if(e&&e.length>0){var s=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT],u=i.getAvailabilityStartTime()/1e3;e.forEach(function(e){var n=s.reduce(function(t,n){return t.concat(i.getAllMediaInfoForType(e,n));},[]).reduce(function(t,n){return i.getProducerReferenceTimes(e,n).forEach(function(r){var a=i.getVoRepresentations(n);if(a&&a.length>0&&a[0].adaptation&&a[0].segmentInfoType===o.Z.SEGMENT_TEMPLATE){var s=a[0],l=new Date(r[o.Z.WALL_CLOCK_TIME]).getTime()/1e3-(r[o.Z.PRESENTATION_TIME]/s[o.Z.TIMESCALE]-s[o.Z.PRESENTATION_TIME_OFFSET]+e.start),c=u-l;t.push({id:r[o.Z.ID],to:c});}}),t;},[]);t=t.concat(n);});}n=t;}catch(e){r.error(e),n=[];}},applyServiceDescription:function(e){if(e&&e.serviceDescriptions){var i=e.serviceDescriptions.filter(function(e){return fn.includes(e.schemeIdUri);}),o=e.serviceDescriptions.filter(function(e){return null==e.schemeIdUri;}),s=i.length>0?i[i.length-1]:o[o.length-1];s&&(s.latency&&s.latency.target>0&&function(e){var i;if(e.schemeIdUri,a.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME,i=function(e){return {liveDelay:e.latency.target/1e3,maxDrift:!isNaN(e.latency.max)&&e.latency.max>e.latency.target?(e.latency.max-e.latency.target+500)/1e3:NaN,referenceId:e.latency.referenceId||NaN};}(e),n.length>0){var o=function(e){var t,r=0,i=n.filter(function(t){return t.id===e.referenceId;});return 0===i.length?(r=n.length>0?n[0].to:0,t=n[0].id||NaN):(r=i[0].to||0,t=i[0].id||NaN),{to:r,id:t};}(i),s=o.to,u=o.id;t.liveDelay=i.liveDelay-s,t.liveCatchup.maxDrift=i.maxDrift,r.debug("\n                Found latency properties coming from service description. Applied time offset of ".concat(s," from ProducerReferenceTime element with id ").concat(u,".\n                Live Delay: ").concat(i.liveDelay-s,", Live catchup max drift: ").concat(i.maxDrift,"\n            "));}else t.liveDelay=i.liveDelay,t.liveCatchup.maxDrift=i.maxDrift,r.debug("Found latency properties coming from service description: Live Delay: ".concat(i.liveDelay,", Live catchup max drift: ").concat(i.maxDrift));}(s),s.playbackRate&&function(e){var n=e.playbackRate.min?Math.round(1e3*(e.playbackRate.min-1))/1e3:NaN,i=e.playbackRate.max?Math.round(1e3*(e.playbackRate.max-1))/1e3:NaN;t.liveCatchup.playbackRate.min=n,t.liveCatchup.playbackRate.max=i,r.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(n)),r.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(i));}(s),s.operatingQuality,s.operatingBandwidth&&function(e){if(e&&e.operatingBandwidth&&e.operatingBandwidth.mediaType&&"all"!==e.operatingBandwidth.mediaType){var t={};t.minBandwidth=e.operatingBandwidth.min,t.maxBandwidth=e.operatingBandwidth.max,t.targetBandwidth=e.operatingBandwidth.target;var n=[];e.operatingBandwidth.mediaType===dn||e.operatingBandwidth.mediaType===gn?n.push(e.operatingBandwidth.mediaType):"any"===e.operatingBandwidth.mediaType&&(n.push(gn),n.push(dn)),n.forEach(function(e){isNaN(t.minBandwidth)||l("minBitrate",e,t.minBandwidth),isNaN(t.maxBandwidth)||l("maxBitrate",e,t.maxBandwidth),isNaN(t.targetBandwidth)||l("initialBitrate",e,t.targetBandwidth);});}}(s),s.contentSteering&&function(e){t.contentSteering=e.contentSteering;}(s));}},reset:function(){u();},setConfig:function(e){e&&e.adapter&&(i=e.adapter);}},r=(0, f.Z)(s).getInstance().getLogger(e),u(),e;}hn.__dashjs_factory_name="ServiceDescriptionController";const pn=c.Z.getSingletonFactory(hn);var mn=n(3973),yn=n.n(mn),En=n(3039);function vn(){var e,t,n,r,i,o,s,c,d=this.context,g=(0, u.Z)(d).getInstance();function h(e,t){return e&&n[t]&&n[t][e]?n[t][e].list:[];}function p(e,t){return e&&n[t]&&n[t][e]?n[t][e].current:null;}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.streamInfo){var i=e.type,s=e.streamInfo,u=s.id,f=p(i,u);if(n[u]&&n[u][i]&&(n[u][i].current=e,n[u][i].current&&(i!==a.Z.TEXT&&!v(e,f)||i===a.Z.TEXT&&e.isFragmented)&&g.trigger(l.Z.CURRENT_TRACK_CHANGED,{oldMediaInfo:f,newMediaInfo:e,switchMode:r.get().streaming.trackSwitchMode[i]},{streamId:u}),!t)){var d=T(e);if(!d||!n[u][i].storeLastSettings)return;d.roles&&(d.role=d.roles[0],delete d.roles),d.accessibility&&(d.accessibility=d.accessibility[0]),d.audioChannelConfiguration&&(d.audioChannelConfiguration=d.audioChannelConfiguration[0]),o[i]=d,c.setSavedMediaSettings(i,d);}}}function y(e,t){e&&t&&(i[e]=t);}function E(e){return e?i[e]:null;}function v(e,t){if(!e&&!t)return !0;if(!e||!t)return !1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),a=e.lang===t.lang,o=e.codec===t.codec,s=e.roles.toString()===t.roles.toString(),u=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),l=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),f=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),d=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return n&&o&&r&&i&&a&&s&&u&&l&&c&&f&&d;}function _(){n={},o={},i={audio:null,video:null,text:null};}function T(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null;}function S(e,t,n){var r=[];return e.forEach(function(e){t(n,e)&&r.push(e);}),0!==r.length?r:e;}function b(e,t){return !e.lang||e.lang instanceof RegExp?t.lang.match(e.lang):""!==t.lang&&(0, En.extendedFilter)(t.lang,yn()(e.lang)).length>0;}function A(e,t){return void 0===e.index||null===e.index||t.index===e.index;}function I(e,t){return !e.viewpoint||e.viewpoint===t.viewpoint;}function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!e.role||!!t.roles.filter(function(t){return t===e.role;})[0];return r||t.type===a.Z.AUDIO&&n;}function w(e,t){return e.accessibility?!!t.accessibility.filter(function(t){return t===e.accessibility;})[0]:!t.accessibility.length;}function N(e,t){return !e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration;})[0];}function C(e){var t,n=0,r=[];return e.forEach(function(e){(t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth;})))>n?(n=t,r=[e]):t===n&&r.push(e);}),r;}function D(e){var t,n=1/0,r=[];return e.forEach(function(e){var i=e.bitrateList.reduce(function(e,t){var n=Math.max(1,t.width*t.height);return e+t.bandwidth/n;},0);(t=i/e.bitrateList.length)<n?(n=t,r=[e]):t===n&&r.push(e);}),r;}function O(e){var t,n=0,r=[];return e.forEach(function(e){(t=e.representationCount)>n?(n=t,r=[e]):t===n&&r.push(e);}),r;}function M(e,n){if(e===a.Z.TEXT)return n[0];var i,o=r.get().streaming.selectionModeForInitialTrack,u=s.getCustomInitialTrackSelectionFunction();if(u&&"function"==typeof u)i=u(n);else switch(o){case a.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:i=function(e){var t,n,r=(t=0,n=[],e.forEach(function(e){isNaN(e.selectionPriority)||(e.selectionPriority>t?(t=e.selectionPriority,n=[e]):e.selectionPriority===t&&n.push(e));}),n);return r.length>1&&(r=C(r)),r.length>1&&(r=O(r)),r;}(n);break;case a.Z.TRACK_SELECTION_MODE_HIGHEST_BITRATE:i=function(e){var t=C(e);return t.length>1&&(t=O(t)),t;}(n);break;case a.Z.TRACK_SELECTION_MODE_FIRST_TRACK:i=P(n);break;case a.Z.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:i=function(e){var t=D(e);return t.length>1&&(t=C(t)),t;}(n);break;case a.Z.TRACK_SELECTION_MODE_WIDEST_RANGE:i=function(e){var t=O(e);return t.length>1&&(t=C(e)),t;}(n);break;default:t.warn("Track selection mode ".concat(o," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),i=P(n);}return i.length>0?i[0]:n[0];}function P(e){return e[0];}return e={setInitialMediaSettingsForType:function(e,t){var n=o[e]||E(e),r=h(e,t.id),i=[];n||y(e,n=c.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&(i=S(i=Array.from(r),b,n),i=S(i,A,n),i=S(i,I,n),e===a.Z.AUDIO&&o[e]||(i=S(i,R,n)),i=S(i,w,n),i=S(i,N,n)),0===i.length?m(M(e,r),!0):i.length>1?m(M(e,i,o[e])):m(i[0]));},addTrack:function(e){if(e){var t=e.type;if((r=t)===a.Z.AUDIO||r===a.Z.VIDEO||r===a.Z.TEXT||r===a.Z.IMAGE){var r,i=e.streamInfo.id;n[i]||(n[i]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var o=n[i][t].list,s=0,u=o.length;s<u;++s)if(v(o[s],e))return;o.push(e);}}},getTracksFor:h,getCurrentTrackFor:p,isCurrentTrack:function(e){if(!e)return !1;var t=e.type,r=e.streamInfo.id;return n[r]&&n[r][t]&&v(n[r][t].current,e);},setTrack:m,selectInitialTrack:M,setInitialSettings:y,getInitialSettings:E,getTracksWithHighestBitrate:C,getTracksWithHighestEfficiency:D,getTracksWithWidestRange:O,isTracksEqual:v,matchSettings:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var r=!1;if(e.lang){if(e.lang instanceof RegExp)r=t.lang.match(e.lang);else if(""!==t.lang){var i=yn()(e.lang);i&&(r=(0,En.extendedFilter)(t.lang,i).length>0);}}else r=!0;var o=void 0===e.index||null===e.index||t.index===e.index,s=!e.viewpoint||e.viewpoint===t.viewpoint,u=!e.role||!!t.roles.filter(function(t){return t===e.role;})[0],l=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility;})[0],c=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration;})[0];return r&&o&&s&&(u||t.type===a.Z.AUDIO&&n)&&l&&c;}catch(e){return !1;}},matchSettingsLang:b,matchSettingsIndex:A,matchSettingsViewPoint:I,matchSettingsRole:R,matchSettingsAccessibility:w,matchSettingsAudioChannelConfig:N,saveTextSettingsDisabled:function(){c.setSavedMediaSettings(a.Z.TEXT,null);},setConfig:function(e){e&&(e.domStorage&&(c=e.domStorage),e.settings&&(r=e.settings),e.customParametersModel&&(s=e.customParametersModel));},reset:_},t=(0, f.Z)(d).getInstance().getLogger(e),_(),e;}vn.__dashjs_factory_name="MediaController";var _n=c.Z.getSingletonFactory(vn);c.Z.updateSingletonFactory(vn.__dashjs_factory_name,_n);const Tn=_n;var Sn=NaN,bn=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.data={baseUrls:t||null,selectedIdx:n||Sn},this.children=[];};function An(){var e,t,n,r,i=this.context,a=Oe(i).getInstance();function o(e,t,n){var r=s(n);e[t]?a.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=Sn):e[t]=new bn(r);}function s(e){var t=n.getBaseURLsFromElement(e),i=r.getSynthesizedBaseUrlElements(t);return i&&i.length>0&&(t=t.concat(i)),t;}function u(e,n){var r=n||t;e(r.data),r.children&&r.children.forEach(function(t){return u(e,t);});}function l(){t=new bn();}return e={reset:l,update:function(e){!function(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously");}();var r=s(e);a.areEqual(r,t.data.baseUrls)||(t.data.baseUrls=r,t.data.selectedIdx=Sn),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,r){o(t.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,i){o(t.children[r].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach(function(e,n){o(t.children[r].children[i].children,n,e);});});});}(e);},getForPath:function(e){var n=t,r=[n.data];return e&&e.forEach(function(e){(n=n.children[e])&&r.push(n.data);}),r.filter(function(e){return e.baseUrls.length;});},invalidateSelectedIndexes:function(e){u(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=Sn);});},setConfig:function(e){e.adapter&&(n=e.adapter),e.contentSteeringController&&(r=e.contentSteeringController);},getBaseUrls:function(e){return s(e);}},l(),e;}An.__dashjs_factory_name="BaseURLTreeModel";const In=c.Z.getClassFactory(An);function Rn(e){var t=(e=e||{}).blacklistController;return {select:function(e){return e&&function(e){var t,n,r=0,i=[],a=0;if((n=e.sort(function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n;}).filter(function(e,t,n){return !t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority;})).length)return n.length>1&&(n.forEach(function(e){r+=e.dvb_weight,i.push(r);}),t=Math.floor(Math.random()*(r-1)),i.every(function(e,n){return a=n,!(t<e);})),n[a];}((n=[],e.filter(function(e){return !t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1);}).filter(function(e){return !n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority);})));var n;}};}Rn.__dashjs_factory_name="DVBSelector";const wn=c.Z.getClassFactory(Rn);function Nn(e){var t=(e=e||{}).blacklistController;return {select:function(e){var n,r=0;return e&&e.some(function(e,n){return r=n,!t.contains(e.serviceLocation);})&&(n=e[r]),n;}};}Nn.__dashjs_factory_name="BasicSelector";const Cn=c.Z.getClassFactory(Nn);function Dn(){var e,t,n,r=this.context;function i(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0,i=NaN,a=function(){var a=e[r],o=t.findIndex(function(e){return e.serviceLocation&&e.serviceLocation===a;});if(-1!==o&&!n.contains(t[o].serviceLocation))return i=o,"break";r+=1;};r<e.length;){var o=a();if("break"===o)break;}return i;}return e={selectBaseUrlIndex:function(e){var n=NaN;if(isNaN(e.selectedIdx)){var r=t.getSteeringDataFromManifest();r&&r.defaultServiceLocationArray.length>0&&(n=i(r.defaultServiceLocationArray,e.baseUrls));}var a=t.getCurrentSteeringResponseData();return e.baseUrls&&e.baseUrls.length&&a&&a.pathwayPriority&&a.pathwayPriority.length&&(n=i(a.pathwayPriority,e.baseUrls)),n;},setConfig:function(e){e.blacklistController&&(n=e.blacklistController),e.contentSteeringController&&(t=e.contentSteeringController);}},t=jt(r).getInstance(),e;}Dn.__dashjs_factory_name="ContentSteeringSelector";const On=c.Z.getClassFactory(Dn);function Mn(){var e,t,n,r,i,a,o=this.context,s=(0, u.Z)(o).getInstance(),c=(0, N.Z)(o).getInstance();function f(){t.reset();}return e={chooseSelector:function(e){(0, z.PS)(e,"boolean"),a=e?r:n;},select:function(e){if(e){if(c.get().streaming.applyContentSteering){var t=i.selectBaseUrlIndex(e);isNaN(t)||-1===t||(e.selectedIdx=t);}if(!isNaN(e.selectedIdx))return e.baseUrls[e.selectedIdx];var r=a.select(e.baseUrls);return r?(e.selectedIdx=e.baseUrls.indexOf(r),r):(s.trigger(l.Z.URL_RESOLUTION_FAILED,{error:new S.Z(w.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,w.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(a===n&&f()));}},reset:f,setConfig:function(e){e.selector&&(a=e.selector),e.contentSteeringSelector&&(i=e.contentSteeringSelector);}},t=kt(o).create({updateEventName:l.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,addBlacklistEventName:l.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD}),n=Cn(o).create({blacklistController:t}),r=wn(o).create({blacklistController:t}),(i=On(o).create()).setConfig({blacklistController:t}),a=n,e;}Mn.__dashjs_factory_name="BaseURLSelector";const Pn=c.Z.getClassFactory(Mn);function Ln(){var e,t,n,r,i,a=this.context,o=(0, u.Z)(a).getInstance(),s=(0, Q.Z)(a).getInstance();function c(e){n.update(e),r.chooseSelector(t.getIsDVB(e)),o.trigger(d.Z.BASE_URLS_UPDATED,{baseUrls:f(e)});}function f(e){return n.getBaseUrls(e);}return e={reset:function(){n.reset(),r.reset();},initialize:function(e){n.setConfig({adapter:t,contentSteeringController:i}),c(e);},resolve:function(e){var t=n.getForPath(e).reduce(function(e,t){var n=r.select(t);return n?(s.isRelative(n.url)?e.url=s.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e.queryParams=n.queryParams,e):new Se();},new Se());if(!s.isRelative(t.url))return t;},setConfig:function(e){e.baseURLTreeModel&&(n=e.baseURLTreeModel),e.baseURLSelector&&(r=e.baseURLSelector),e.adapter&&(t=e.adapter),e.contentSteeringController&&(i=e.contentSteeringController);},getBaseUrls:f,update:c},n=In(a).create(),r=Pn(a).create(),o.on(l.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,function(e){n.invalidateSelectedIndexes(e.entry);},e),e;}Ln.__dashjs_factory_name="BaseURLController";const xn=c.Z.getClassFactory(Ln);function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},Fn(e);}function kn(e,t){return kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},kn(e,t);}function Un(e,t){return !t||"object"!==Fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function Zn(e){return Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},Zn(e);}const Bn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kn(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=Zn(t);if(n){var i=Zn(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Un(this,e);});function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),(n=r.call(this)).url=e||null,n.type=t||null,n.mediaType=a.Z.STREAM,n.responseType="",n;}return i;}(p.Z);function Gn(e){e=e||{};var t=this.context,n=(0, u.Z)(t).getInstance(),r=vt(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,errors:w});return {load:function(e,t,i){var a=function(r,a){t.resolved=!0,t.resolvedContent=r||null,n.trigger(l.Z.XLINK_ELEMENT_LOADED,{element:t,resolveObject:i,error:r||a?null:new S.Z(w.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,w.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)});};if("urn:mpeg:dash:resolve-to-zero:2013"===e)a(null,!0);else {var o=new Bn(e,C.w.XLINK_EXPANSION_TYPE);r.load({request:o,success:function(e){a(e);},error:function(){a(null);}});}},reset:function(){r&&(r.abort(),r=null);}};}Gn.__dashjs_factory_name="XlinkLoader";const qn=c.Z.getClassFactory(Gn),Yn=function(e){void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1);function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t;}function n(e){return "string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e;}function r(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break;}else if(a instanceof RegExp){if(a.test(r))break;}else if("function"==typeof a&&a(t,n,r))break;}return i!=e.length;}function i(t,n,i){"property"===e.arrayAccessForm&&(t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]),!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&r(e.arrayAccessFormPaths,t,n,i)&&(t[n]=[t[n]]);}function a(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset());}else -1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n;}function o(t,n,i,a){return !(1==n&&e.xmlElementsFilter.length>0)||r(e.xmlElementsFilter,t,i,a);}function s(n,u){if(9==n.nodeType){for(var l=new Object(),c=n.childNodes,f=0;f<c.length;f++)1==(g=c[f]).nodeType&&(e.ignoreRoot?l=s(g):(l={})[h=t(g)]=s(g));return l;}if(1==n.nodeType){(l=new Object()).__cnt=0;var d=[];for(c=n.childNodes,f=0;f<c.length;f++){var g,h=t(g=c[f]);if(8!=g.nodeType){var p=u+"."+h;if(o(l,g.nodeType,h,p))if(l.__cnt++,null==l[h]){var m=s(g,p);("#text"!=h||/[^\s]/.test(m))&&((y={})[h]=m,d.push(y)),l[h]=m,i(l,h,p);}else {var y;null!=l[h]&&(l[h]instanceof Array||(l[h]=[l[h]],i(l,h,p))),m=s(g,p),("#text"!=h||/[^\s]/.test(m))&&((y={})[h]=m,d.push(y)),l[h][l[h].length]=m;}}}l.__children=d;for(var E=t(n),v=0;v<n.attributes.length;v++){var _=n.attributes[v];l.__cnt++;for(var T=_.value,S=0,b=e.matchers.length;S<b;S++){var A=e.matchers[S];A.test(_,E)&&(T=A.converter(_.value));}l[e.attributePrefix+_.name]=T;}var I=function(e){return e.prefix;}(n);return null!=I&&""!=I&&(l.__cnt++,l.__prefix=I),null!=l["#text"]&&(l.__text=l["#text"],l.__text instanceof Array&&(l.__text=l.__text.join("\n")),e.stripWhitespaces&&(l.__text=l.__text.trim()),delete l["#text"],"property"==e.arrayAccessForm&&delete l["#text_asArray"],l.__text=function(t,n,i){if(e.datetimeAccessFormPaths.length>0){var o=i.split(".#")[0];return r(e.datetimeAccessFormPaths,t,n,o)?a(t):t;}return t;}(l.__text,h,u+"."+h)),null!=l["#cdata-section"]&&(l.__cdata=l["#cdata-section"],delete l["#cdata-section"],"property"==e.arrayAccessForm&&delete l["#cdata-section_asArray"]),0==l.__cnt&&"text"==e.emptyNodeForm?l="":1==l.__cnt&&null!=l.__text?l=l.__text:1!=l.__cnt||null==l.__cdata||e.keepCData?l.__cnt>1&&null!=l.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==l.__text||""==l.__text.trim())&&delete l.__text:l=l.__cdata,delete l.__cnt,!e.enableToStringFunc||null==l.__text&&null==l.__cdata||(l.toString=function(){return (null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"");}),l;}if(3==n.nodeType||4==n.nodeType)return n.nodeValue;}function u(t,r,i,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+r;if(null!=i)for(var s=0;s<i.length;s++){var u=i[s],l=t[u];e.escapeMode&&(l=n(l)),o+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+l+'"':o+="'"+l+"'";}return o+(a?"/>":">");}function l(e,t){return "</"+(null!=e.__prefix?e.__prefix+":":"")+t+">";}function c(t,n){return "property"==e.arrayAccessForm&&(i="_asArray",-1!==(r=n.toString()).indexOf(i,r.length-i.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r,i;}function f(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t;}function d(t,n,i){return 0==e.jsonPropertiesFilter.length||""==i||r(e.jsonPropertiesFilter,t,n,i);}function g(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n;}function h(t){var r="";return t instanceof Object?r+=function(t){var r="";return null!=t.__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?r+=n(t.__text):r+=t.__text),r;}(t):null!=t&&(e.escapeMode?r+=n(t):r+=t),r;}function p(e,t){return ""===e?t:e+"."+t;}function m(e,t,n,r){var i="";if(0==e.length)i+=u(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=u(e[a],t,g(e[a]),!1),i+=y(e[a],p(r,t)),i+=l(e[a],t);return i;}function y(e,t){var n="";if(f(e)>0)for(var r in e)if(!c(e,r)&&(""==t||d(e,r,p(t,r)))){var i=e[r],a=g(i);null==i||null==i?n+=u(i,r,a,!0):i instanceof Object?i instanceof Array?n+=m(i,r,a,t):i instanceof Date?(n+=u(i,r,a,!1),n+=i.toISOString(),n+=l(i,r)):f(i)>0||null!=i.__text||null!=i.__cdata?(n+=u(i,r,a,!1),n+=y(i,p(t,r)),n+=l(i,r)):n+=u(i,r,a,!0):(n+=u(i,r,a,!1),n+=h(i),n+=l(i,r));}return n+h(e);}this.parseXmlString=function(e){var t;if(void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser();try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null);}catch(e){t=null;}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t;},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e];},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null;},this.asDateTime=function(e){return "string"==typeof e?a(e):e;},this.xml2json=function(e){return s(e);},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null;},this.json2xml_str=function(e){return y(e,"");},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t);},this.getVersion=function(){return "1.2.0";};};var jn="onLoad";function Hn(e){e=e||{};var t,n,r,i,a,s,c=this.context,f=(0, u.Z)(c).getInstance(),d=(0, Q.Z)(c).getInstance();function g(e,t,n){var r,i,a={};a.elements=e,a.type=t,a.resolveType=n,0===a.elements.length&&p(a);for(var o=0;o<a.elements.length;o++)r=a.elements[o],i=d.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,s.load(i,r,a);}function h(e){var t,n,r="";if(t=e.element,n=e.resolveObject,t.resolvedContent){var i=0;0===t.resolvedContent.indexOf("<?xml")&&(i=t.resolvedContent.indexOf("?>")+2),r=t.resolvedContent.substr(0,i)+"<response>"+t.resolvedContent.substr(i)+"</response>",t.resolvedContent=a.xml_str2json(r);}(function(e){var t;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return !1;return !0;})(n)&&p(n);}function p(e){var t,n,a=[];if(function(e){var t,n,a,o,s,u,l=[];for(o=e.elements.length-1;o>=0;o--){if(n=(t=e.elements[o]).type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(s=0;s<t.resolvedContent[n].length;s++)a=t.resolvedContent[n][s],l.push(a);}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],l.push(t.originalContent);for(t.parentElement[n].splice(t.index,1),u=0;u<l.length;u++)t.parentElement[n].splice(t.index+u,0,l[u]);l=[];}e.elements.length>0&&r.run(i);}(e),"onActuate"===e.resolveType&&f.trigger(l.Z.XLINK_READY,{manifest:i}),e.resolveType===jn)switch(e.type){case o.Z.PERIOD:for(t=0;t<i[o.Z.PERIOD+"_asArray"].length;t++)(n=i[o.Z.PERIOD+"_asArray"][t]).hasOwnProperty(o.Z.ADAPTATION_SET+"_asArray")&&(a=a.concat(m(n[o.Z.ADAPTATION_SET+"_asArray"],n,o.Z.ADAPTATION_SET,jn))),n.hasOwnProperty(o.Z.EVENT_STREAM+"_asArray")&&(a=a.concat(m(n[o.Z.EVENT_STREAM+"_asArray"],n,o.Z.EVENT_STREAM,jn)));g(a,o.Z.ADAPTATION_SET,jn);break;case o.Z.ADAPTATION_SET:f.trigger(l.Z.XLINK_READY,{manifest:i});}}function m(e,t,n,r){var i,a,o,s=[];for(a=e.length-1;a>=0;a--)(i=e[a]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===i["xlink:href"]&&e.splice(a,1);for(a=0;a<e.length;a++)(i=e[a]).hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===r&&(o=y(i["xlink:href"],t,n,a,r,i),s.push(o));return s;}function y(e,t,n,r,i,a){return {url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1};}return t={resolveManifestOnLoad:function(e){a=new Yn({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:n}),(i=e).Period_asArray?g(m(i.Period_asArray,i,o.Z.PERIOD,jn),o.Z.PERIOD,jn):f.trigger(l.Z.XLINK_READY,{manifest:i});},setMatchers:function(e){e&&(n=e);},setIron:function(e){e&&(r=e);},reset:function(){f.off(l.Z.XLINK_ELEMENT_LOADED,h,t),s&&(s.reset(),s=null);}},f.on(l.Z.XLINK_ELEMENT_LOADED,h,t),s=qn(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),t;}Hn.__dashjs_factory_name="XlinkController";const Vn=c.Z.getClassFactory(Hn);function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},Kn(e);}function zn(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n]);}function n(e,n,r){for(var i=0,a=e.length;i<a;++i){var o=e[i];if(n[o.name])if(r[o.name]){if(o.merge){var s=n[o.name],u=r[o.name];"object"===Kn(s)&&"object"===Kn(u)?t(s,u):r[o.name]=s+u;}}else r[o.name]=n[o.name];}}function r(e,t){for(var i=0,a=e.children.length;i<a;++i){var o=e.children[i],s=t[o.name+"_asArray"];if(s)for(var u=0,l=s.length;u<l;++u){var c=s[u];n(e.properties,t,c),r(o,c);}}}return {run:function(t){if(null===t||"object"!==Kn(t))return t;if(t.Period_asArray&&"period"in e)for(var n=e.period,i=t.Period_asArray,a=0,o=i.length;a<o;++a){var s=i[a];if(r(n,s),"adaptationset"in e){var u=s.AdaptationSet_asArray;if(u)for(var l=e.adaptationset,c=0,f=u.length;c<f;++c)r(l,u[c]);}}return t;}};}zn.__dashjs_factory_name="ObjectIron";const Wn=c.Z.getClassFactory(zn);function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const Qn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this._test=t,this._converter=n;}var t,n;return t=e,(n=[{key:"test",get:function(){return this._test;}},{key:"converter",get:function(){return this._converter;}}])&&Xn(t.prototype,n),e;}();function Jn(e){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},Jn(e);}function $n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function er(e,t){return er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},er(e,t);}function tr(e,t){return !t||"object"!==Jn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function nr(e){return nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},nr(e);}const rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&er(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=nr(t);if(n){var i=nr(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return tr(this,e);});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),r.call(this,function(e,t){var n,r=($n(n={},o.Z.MPD,[o.Z.ID,o.Z.PROFILES]),$n(n,o.Z.PERIOD,[o.Z.ID]),$n(n,o.Z.BASE_URL,[o.Z.SERVICE_LOCATION,o.Z.BYTE_RANGE]),$n(n,o.Z.SEGMENT_BASE,[o.Z.INDEX_RANGE]),$n(n,o.Z.INITIALIZATION,[o.Z.RANGE]),$n(n,o.Z.REPRESENTATION_INDEX,[o.Z.RANGE]),$n(n,o.Z.SEGMENT_LIST,[o.Z.INDEX_RANGE]),$n(n,o.Z.BITSTREAM_SWITCHING,[o.Z.RANGE]),$n(n,o.Z.SEGMENT_URL,[o.Z.MEDIA_RANGE,o.Z.INDEX_RANGE]),$n(n,o.Z.SEGMENT_TEMPLATE,[o.Z.INDEX_RANGE,o.Z.MEDIA,o.Z.INDEX,o.Z.INITIALIZATION_MINUS,o.Z.BITSTREAM_SWITCHING_MINUS]),$n(n,o.Z.ASSET_IDENTIFIER,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.EVENT_STREAM,[o.Z.VALUE]),$n(n,o.Z.ADAPTATION_SET,[o.Z.PROFILES,o.Z.MIME_TYPE,o.Z.SEGMENT_PROFILES,o.Z.CODECS,o.Z.CONTENT_TYPE]),$n(n,o.Z.FRAME_PACKING,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.AUDIO_CHANNEL_CONFIGURATION,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.CONTENT_PROTECTION,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.ESSENTIAL_PROPERTY,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.SUPPLEMENTAL_PROPERTY,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.INBAND_EVENT_STREAM,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.ACCESSIBILITY,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.ROLE,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.RATING,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.VIEWPOINT,[o.Z.VALUE,o.Z.ID]),$n(n,o.Z.CONTENT_COMPONENT,[o.Z.CONTENT_TYPE]),$n(n,o.Z.REPRESENTATION,[o.Z.ID,o.Z.DEPENDENCY_ID,o.Z.MEDIA_STREAM_STRUCTURE_ID]),$n(n,o.Z.SUBSET,[o.Z.ID]),$n(n,o.Z.METRICS,[o.Z.METRICS_MINUS]),$n(n,o.Z.REPORTING,[o.Z.VALUE,o.Z.ID]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&i.indexOf(e.name)>=0;}return !1;},function(e){return String(e);});}return i;}(Qn);function ir(e){return ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},ir(e);}function ar(e,t){return ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},ar(e,t);}function or(e,t){return !t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function sr(e){return sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},sr(e);}var ur=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/;const lr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ar(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=sr(t);if(n){var i=sr(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return or(this,e);});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),r.call(this,function(e){for(var t=[o.Z.MIN_BUFFER_TIME,o.Z.MEDIA_PRESENTATION_DURATION,o.Z.MINIMUM_UPDATE_PERIOD,o.Z.TIMESHIFT_BUFFER_DEPTH,o.Z.MAX_SEGMENT_DURATION,o.Z.MAX_SUBSEGMENT_DURATION,o.Z.SUGGESTED_PRESENTATION_DELAY,o.Z.START,a.Z.START_TIME,o.Z.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return ur.test(e.value);return !1;},function(e){var t=ur.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n;});}return i;}(Qn);function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},cr(e);}function fr(e,t){return fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},fr(e,t);}function dr(e,t){return !t||"object"!==cr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function gr(e){return gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},gr(e);}var hr=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/;const pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fr(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=gr(t);if(n){var i=gr(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return dr(this,e);});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),r.call(this,function(e){return hr.test(e.value);},function(e){var t,n=hr.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var r=60*parseInt(n[9],10)+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*r*60*1e3;}return new Date(t);});}return i;}(Qn);function mr(e){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},mr(e);}function yr(e,t){return yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},yr(e,t);}function Er(e,t){return !t||"object"!==mr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function vr(e){return vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},vr(e);}var _r=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/;const Tr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yr(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=vr(t);if(n){var i=vr(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Er(this,e);});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),r.call(this,function(e){return _r.test(e.value);},function(e){return parseFloat(e);});}return i;}(Qn);function Sr(e){return Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},Sr(e);}function br(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function Ar(e,t){return Ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},Ar(e,t);}function Ir(e,t){return !t||"object"!==Sr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function Rr(e){return Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},Rr(e);}const wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ar(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=Rr(t);if(n){var i=Rr(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Ir(this,e);});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),r.call(this,function(e,t){var n,r=(br(n={},o.Z.ADAPTATION_SET,[o.Z.LANG]),br(n,o.Z.REPRESENTATION,[o.Z.LANG]),br(n,o.Z.CONTENT_COMPONENT,[o.Z.LANG]),br(n,o.Z.LABEL,[o.Z.LANG]),br(n,o.Z.GROUP_LABEL,[o.Z.LANG]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&i.indexOf(e.name)>=0;}return !1;},function(e){var t=yn()(e);return void 0!==t?t:String(e);});}return i;}(Qn);function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const Cr=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase();}var t,n;return t=e,(n=[{key:"name",get:function(){return this._name;}},{key:"merge",get:function(){return this._merge;}}])&&Nr(t.prototype,n),e;}();function Dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const Or=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach(function(e){i._properties.push(new Cr(e));});}var t,n;return t=e,(n=[{key:"name",get:function(){return this._name;}},{key:"children",get:function(){return this._children;}},{key:"properties",get:function(){return this._properties;}}])&&Dr(t.prototype,n),e;}();function Mr(e){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},Mr(e);}function Pr(e,t){return Pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},Pr(e,t);}function Lr(e,t){return !t||"object"!==Mr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function xr(e){return xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},xr(e);}const Fr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pr(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=xr(t);if(n){var i=xr(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Lr(this,e);});function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i);var e=[o.Z.PROFILES,o.Z.WIDTH,o.Z.HEIGHT,o.Z.SAR,o.Z.FRAMERATE,o.Z.AUDIO_SAMPLING_RATE,o.Z.MIME_TYPE,o.Z.SEGMENT_PROFILES,o.Z.CODECS,o.Z.MAXIMUM_SAP_PERIOD,o.Z.START_WITH_SAP,o.Z.MAX_PLAYOUT_RATE,o.Z.CODING_DEPENDENCY,o.Z.SCAN_TYPE,o.Z.FRAME_PACKING,o.Z.AUDIO_CHANNEL_CONFIGURATION,o.Z.CONTENT_PROTECTION,o.Z.ESSENTIAL_PROPERTY,o.Z.ESSENTIAL_PROPERTY+"_asArray",o.Z.SUPPLEMENTAL_PROPERTY,o.Z.INBAND_EVENT_STREAM];return r.call(this,o.Z.ADAPTATION_SET,e,[new Or(o.Z.REPRESENTATION,e,[new Or(o.Z.SUB_REPRESENTATION,e)])]);}return i;}(Or);function kr(e){return kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},kr(e);}function Ur(e,t){return Ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},Ur(e,t);}function Zr(e,t){return !t||"object"!==kr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function Br(e){return Br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},Br(e);}const Gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ur(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=Br(t);if(n){var i=Br(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Zr(this,e);});function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i);var e=[o.Z.SEGMENT_BASE,o.Z.SEGMENT_TEMPLATE,o.Z.SEGMENT_LIST];return r.call(this,o.Z.PERIOD,e,[new Or(o.Z.ADAPTATION_SET,e,[new Or(o.Z.REPRESENTATION,e)])]);}return i;}(Or);function qr(e){e=e||{};var t,n,r,i,a,o=this.context,s=e.debug;return t={parse:function(e){var t,r=window.performance.now();if(!(t=i.xml_str2json(e)))throw new Error("parsing the manifest failed");var o=window.performance.now();t.Patch?((t=t.Patch).add_asArray&&t.add_asArray.forEach(function(e){return a.run(e);}),t.replace_asArray&&t.replace_asArray.forEach(function(e){return a.run(e);})):(t=t.MPD,a.run(t));var s=window.performance.now();return n.info("Parsing complete: ( xml2json: "+(o-r).toPrecision(3)+"ms, objectiron: "+(s-o).toPrecision(3)+"ms, total: "+((s-r)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t;},getMatchers:function(){return r;},getIron:function(){return a;}},n=s.getLogger(t),r=[new lr(),new pr(),new Tr(),new wr(),new rr()],i=new Yn({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:r}),a=Wn(o).create({adaptationset:new Fr(),period:new Gr()}),t;}qr.__dashjs_factory_name="DashParser";const Yr=c.Z.getClassFactory(qr);function jr(e){e=e||{};var t,n,r,i,s,c=this.context,f=e.debug,d=e.settings,g=(0, u.Z)(c).getInstance(),h=(0, Q.Z)(c).getInstance(),p=e.mssHandler,m=e.errHandler;function y(e){g.trigger(l.Z.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest});}function E(e){var t=null;return e.indexOf("SmoothStreamingMedia")>-1?(p&&(t=p.createMssParser(),p.createMssFragmentProcessor(),p.registerEvents()),t):e.indexOf("MPD")>-1||e.indexOf("Patch")>-1?Yr(c).create({debug:f}):t;}return t={load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new Date(),u=new Bn(e,C.w.MPD_TYPE);t&&(u.serviceLocation=t),a&&(u.queryParams=a),u.requestStartDate||(u.requestStartDate=o),g.trigger(l.Z.MANIFEST_LOADING_STARTED,{request:u}),r.load({request:u,success:function(t,r,a){var o,u,c;if(i)if(a&&a!==e?(u=h.parseBaseUrl(a),o=a):(h.isRelative(e)&&(e=h.resolve(e,window.location.href)),u=h.parseBaseUrl(e)),"No Content"!=r){if(null===s&&(s=E(t)),null!==s){i.setMatchers(s.getMatchers()),i.setIron(s.getIron());try{c=s.parse(t);}catch(t){return void g.trigger(l.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});}if(c){if(c.url=o||e,c.originalUrl||(c.originalUrl=c.url),d&&d.get().streaming.enableManifestDurationMismatchFix&&c.mediaPresentationDuration&&c.Period_asArray.length>1){var f=c.Period_asArray.reduce(function(e,t){return e+t.duration;},0);!isNaN(f)&&c.mediaPresentationDuration>f&&(n.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),c.mediaPresentationDuration=f);}c.baseUri=u,c.loadedTime=new Date(),i.resolveManifestOnLoad(c),g.trigger(l.Z.ORIGINAL_MANIFEST_LOADED,{originalManifest:t});}else g.trigger(l.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});}else g.trigger(l.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,w.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});}else g.trigger(l.Z.INTERNAL_MANIFEST_LOADED,{manifest:null});},error:function(t,n,r){g.trigger(l.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(w.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,w.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(e,", ").concat(r))});}});},reset:function(){g.off(l.Z.XLINK_READY,y,t),p&&p.reset(),i&&(i.reset(),i=null),r&&(r.abort(),r=null);}},n=f.getLogger(t),g.on(l.Z.XLINK_READY,y,t),r=vt(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:h,constants:a.Z,dashConstants:o.Z,errors:w,requestTimeout:e.settings.get().streaming.manifestRequestTimeout}),i=Vn(c).create({errHandler:m,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),s=null,t;}jr.__dashjs_factory_name="ManifestLoader";const Hr=c.Z.getClassFactory(jr);function Vr(){var e=this.context,t=(0, u.Z)(e).getInstance();return {error:function(e){t.trigger(l.Z.ERROR,{error:e});}};}Vr.__dashjs_factory_name="ErrorHandler";const Kr=c.Z.getSingletonFactory(Vr);var zr=n(1715);function Wr(){var e,t,n,r,i,o,s=this.context,c=(0, u.Z)(s).getInstance();function d(e,r){if(!r||!r.Period_asArray||0===r.Period_asArray.length)return Promise.resolve();var i=[];return r.Period_asArray.forEach(function(r){i.push(function(e,r){return new Promise(function(i){if(e&&e.AdaptationSet_asArray&&0!==e.AdaptationSet_asArray.length){var s=[];e.AdaptationSet_asArray.forEach(function(e){t.getIsTypeOf(e,r)&&s.push(function(e,r){return new Promise(function(i){if(e.Representation_asArray&&0!==e.Representation_asArray.length){var s=[],u=[];e.Representation_asArray.forEach(function(i,o){var l=t.getCodec(e,o,!1),c=function(e,t,n){switch(e){case a.Z.VIDEO:return function(e,t){return {codec:t,width:e.width||null,height:e.height||null,framerate:e.frameRate||null,bitrate:e.bandwidth||null};}(t,n);case a.Z.AUDIO:return function(e,t){var n=e.audioSamplingRate||null;return {codec:t,bitrate:e.bandwidth||null,samplerate:n};}(t,n);default:return null;}}(r,i,l);u.push(c),s.push(n.supportsCodec(c,r));}),Promise.all(s).then(function(t){e.Representation_asArray=e.Representation_asArray.filter(function(e,n){return t[n]||o.debug("[Stream] Codec ".concat(u[n].codec," not supported ")),t[n];}),i();}).catch(function(){i();});}else i();});}(e,r));}),Promise.all(s).then(function(){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){var t=e.Representation_asArray&&e.Representation_asArray.length>0;return t||(c.trigger(l.Z.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:e}),o.warn("AdaptationSet has been removed because of no supported Representation")),t;}),i();}).catch(function(){i();});}else i();});}(r,e));}),Promise.all(i);}return e={setConfig:function(e){e&&(e.adapter&&(t=e.adapter),e.capabilities&&(n=e.capabilities),e.settings&&(r=e.settings),e.customParametersModel&&(i=e.customParametersModel));},filterUnsupportedFeatures:function(e){return new Promise(function(s){var u=[];u.push(d(a.Z.VIDEO,e)),u.push(d(a.Z.AUDIO,e)),Promise.all(u).then(function(){r.get().streaming.capabilities.filterUnsupportedEssentialProperties&&function(e){e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return !e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(e){var r=t.getEssentialPropertiesForRepresentation(e);if(r&&r.length>0)for(var i=0;i<r.length;){if(!n.supportsEssentialProperty(r[i]))return o.debug("[Stream] EssentialProperty not supported: "+r[i].schemeIdUri),!1;i+=1;}return !0;}),e.Representation_asArray&&e.Representation_asArray.length>0);});});}(e),function(e){var t=i.getCustomCapabilitiesFilters();t&&0!==t.length&&e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return !e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(e){return !t.some(function(t){return !t(e);});}),e.Representation_asArray&&e.Representation_asArray.length>0);});});}(e),s();}).catch(function(){s();});});}},o=(0, f.Z)(s).getInstance().getLogger(e),e;}Wr.__dashjs_factory_name="CapabilitiesFilter";const Xr=c.Z.getSingletonFactory(Wr),Qr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null;};function Jr(){var e;return {initialize:function(t){if(e=new Qr(),!t)return null;var n=t.indexOf("#");if(-1!==n)for(var r=t.substr(n+1).split("&"),i=0,a=r.length;i<a;++i){var o=r[i],s=o.indexOf("=");if(-1!==s){var u=o.substring(0,s);e.hasOwnProperty(u)&&(e[u]=o.substr(s+1));}}},getURIFragmentData:function(){return e;}};}Jr.__dashjs_factory_name="URIFragmentModel";const $r=c.Z.getSingletonFactory(Jr);function ei(){var e,t=this.context,n=(0, u.Z)(t).getInstance();return {getValue:function(){return e;},setValue:function(t){e=t,t&&n.trigger(l.Z.MANIFEST_LOADED,{data:t});}};}ei.__dashjs_factory_name="ManifestModel";const ti=c.Z.getSingletonFactory(ei);var ni=-.5;function ri(){var e,t,n,r,i=this.context,a=(0, N.Z)(i).getInstance();function o(e,n){return isNaN(e)?0:e>0?(n&&t.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e<ni?(n&&t.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(ni,": ").concat(-50,"% playback speed.")),ni):e;}function s(e,n){return isNaN(e)?0:e<0?(n&&t.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e>1?(n&&t.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(1,": ").concat(200,"% playback speed.")),1):e;}function u(){var e=a.get().streaming.buffer.stableBufferTime>0?a.get().streaming.buffer.stableBufferTime:a.get().streaming.buffer.fastSwitchEnabled?20:12,t=n.getLiveDelay();return !isNaN(t)&&t>0?Math.min(e,t):e;}return e={getCatchupMaxDrift:function(){if(!isNaN(a.get().streaming.liveCatchup.maxDrift)&&a.get().streaming.liveCatchup.maxDrift>0)return a.get().streaming.liveCatchup.maxDrift;var e=r.getServiceDescriptionSettings();return e&&e.liveCatchup&&!isNaN(e.liveCatchup.maxDrift)&&e.liveCatchup.maxDrift>0?e.liveCatchup.maxDrift:12;},getCatchupModeEnabled:function(){return null!==a.get().streaming.liveCatchup.enabled?a.get().streaming.liveCatchup.enabled:n.getInitialCatchupModeActivated();},getStableBufferTime:u,getInitialBufferLevel:function(){var e=a.get().streaming.buffer.initialBufferLevel;return isNaN(e)||e<0?0:Math.min(u(),e);},getRetryAttemptsForType:function(e){var t=isNaN(a.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:a.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return n.getLowLatencyModeEnabled()?a.get().streaming.retryAttempts[e]*t:a.get().streaming.retryAttempts[e];},getRetryIntervalsForType:function(e){var t=isNaN(a.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:a.get().streaming.retryIntervals.lowLatencyReductionFactor;return n.getLowLatencyModeEnabled()?a.get().streaming.retryIntervals[e]/t:a.get().streaming.retryIntervals[e];},getCatchupPlaybackRates:function(e){var t=a.get().streaming.liveCatchup.playbackRate;if(!isNaN(t.min)||!isNaN(t.max))return {min:o(t.min,e),max:s(t.max,e)};var n=r.getServiceDescriptionSettings();if(n&&n.liveCatchup&&(!isNaN(n.liveCatchup.playbackRate.min)||!isNaN(n.liveCatchup.playbackRate.max))){var i=n.liveCatchup.playbackRate;return {min:o(i.min,e),max:s(i.max,e)};}return {min:-.5,max:.5};},getAbrBitrateParameter:function(e,t){try{var n=a.get().streaming.abr[e][t];if(!isNaN(n)&&-1!==n)return n;var i=r.getServiceDescriptionSettings();return i&&i[e]&&!isNaN(i[e][t])?i[e][t]:-1;}catch(e){return -1;}},setConfig:function(e){e.playbackController&&(n=e.playbackController),e.serviceDescriptionController&&(r=e.serviceDescriptionController);},reset:function(){}},t=(0, f.Z)(i).getInstance().getLogger(e),e;}ri.__dashjs_factory_name="MediaPlayerModel";const ii=c.Z.getSingletonFactory(ri);var ai=n(1767);function oi(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,u=e.streamProcessor?e.streamProcessor.getScheduleController():null,l=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel?e.videoModel:null;function f(){return l?l.mediaInfo:null;}return {getMediaType:function(){var e=f();return e?e.type:null;},getMediaInfo:f,getDroppedFramesHistory:function(){return r;},getCurrentRequest:function(){return i;},getSwitchHistory:function(){return n;},getStreamInfo:function(){var e=f();return e?e.streamInfo:null;},getScheduleController:function(){return u;},getAbrController:function(){return t;},getRepresentationInfo:function(){return l;},useBufferOccupancyABR:function(){return a;},useL2AABR:function(){return o;},useLoLPABR:function(){return s;},getVideoModel:function(){return c;}};}oi.__dashjs_factory_name="RulesContext";const si=c.Z.getClassFactory(oi);var ui=n(2068);function li(){var e=[],t=[];return {push:function(n){n.newValue===ui.Z.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var r=n.newValue-n.oldValue,i=r<0?1:0,a=i?-r:0,o=i?0:1;if(e[n.oldValue].drops+=i,e[n.oldValue].dropSize+=a,e[n.oldValue].noDrops+=o,t.push({idx:n.oldValue,noDrop:o,drop:i,dropSize:a}),t.length>8){var s=t.shift();e[s.idx].drops-=s.drop,e[s.idx].dropSize-=s.dropSize,e[s.idx].noDrops-=s.noDrop;}},getSwitchRequests:function(){return e;},reset:function(){e=[],t=[];}};}li.__dashjs_factory_name="SwitchRequestHistory";const ci=c.Z.getClassFactory(li);function fi(){var e={},t={},n={};return {push:function(r,i,a){if(i){e[r]||(e[r]=[],t[r]=0,n[r]=0);var o=a&&a.droppedVideoFrames?a.droppedVideoFrames:0,s=a&&a.totalVideoFrames?a.totalVideoFrames:0,u=o-t[r];t[r]=o;var l=s-n[r];n[r]=s;var c=e[r];isNaN(i)||(c[i]?(c[i].droppedVideoFrames+=u,c[i].totalVideoFrames+=l):c[i]={droppedVideoFrames:u,totalVideoFrames:l});}},getFrameHistory:function(t){return e[t];},clearForStream:function(r){try{delete e[r],delete t[r],delete n[r];}catch(e){}},reset:function(){e={},t={},n={};}};}fi.__dashjs_factory_name="DroppedFramesHistory";const di=c.Z.getClassFactory(fi);function gi(e){var t,n,r,i,o,s=this.context,l=(e=e||{}).settings,c=(0, u.Z)(s).getInstance();function f(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n;}function g(e,s,u){return l.get().streaming.abr.movingAverageMethod!==a.Z.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?o.throughputHalfLife:o.latencyHalfLife,a=e?r[t]:i[t];if(!a||a.totalWeight<=0)return NaN;var s=a.fastEstimate/(1-Math.pow(.5,a.totalWeight/n.fast)),u=a.slowEstimate/(1-Math.pow(.5,a.totalWeight/n.slow));return e?Math.min(s,u):Math.max(s,u);}(e,s):function(e,r,i){var a=function(e,r,i){var a,o;if(e?(a=t[r],o=i?3:4):(a=n[r],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var u=a[a.length-s]/a[a.length-s-1];if((u>=1.3||u<=1/1.3)&&(o+=1)===a.length)break;}}else o=0;return o;}(e,r,i),o=(e?t:n)[r];return 0!==a&&o&&0!==o.length?(o=o.slice(-a)).reduce(function(e,t){return e+t;})/o.length:NaN;}(e,s,u);}function h(e,t){return g(!0,e,t);}function p(e){t[e]=t[e]||[],n[e]=n[e]||[],r[e]=r[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},i[e]=i[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0};}function m(){t={},n={},r={},i={};}var y={push:function(e,s,u){if(s.trace&&s.trace.length){var g,h=s.tresponse.getTime()-s.trequest.getTime()||1,m=s._tfinish.getTime()-s.tresponse.getTime()||1,y=s.trace.reduce(function(e,t){return e+t.b[0];},0),E=0;if(0!==(g=s._fileLoaderType&&s._fileLoaderType===a.Z.FILE_LOADER_TYPES.FETCH?s.trace.reduce(function(e,t){return e+t.d;},0):u?m:h+m)&&(E=Math.round(8*y/g)),s.cmsd){var v=s.cmsd.dynamic&&s.cmsd.dynamic.etp?s.cmsd.dynamic.etp:null;if(v){var _=l.get().streaming.cmsd.abr.etpWeightRatio;_>0&&_<=1&&(E=E*(1-_)+v*_);}}if(p(e),function(e,t,n){return e===a.Z.VIDEO?n<l.get().streaming.cacheLoadThresholds[a.Z.VIDEO]:e===a.Z.AUDIO?n<l.get().streaming.cacheLoadThresholds[a.Z.AUDIO]:void 0;}(e,0,m)){if(t[e].length>0&&!t[e].hasCachedEntries)return;t[e].hasCachedEntries=!0;}else t[e]&&t[e].hasCachedEntries&&function(e){delete t[e],delete n[e],delete r[e],delete i[e],p(e);}(e);t[e].push(E),c.trigger(d.Z.THROUGHPUT_MEASUREMENT_STORED,{throughput:E,mediaType:e,httpRequest:s}),t[e].length>20&&t[e].shift(),n[e].push(h),n[e].length>20&&n[e].shift(),f(r[e],E,.001*m,o.throughputHalfLife),f(i[e],h,1,o.latencyHalfLife);}},getAverageThroughput:h,getSafeAverageThroughput:function(e,t){var n=h(e,t);return isNaN(n)||(n*=l.get().streaming.abr.bandwidthSafetyFactor),n;},getAverageLatency:function(e){return g(!1,e);},reset:m};return o={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},m(),y;}gi.__dashjs_factory_name="ThroughputHistory";const hi=c.Z.getClassFactory(gi);function pi(){var e,t,n,r,i,o,c,g,h,p,m,y,E,v,_,S,b,A,I,R,w,N,D,O,M,P,L,x=this.context,F=(0, f.Z)(x).getInstance(),k=(0, u.Z)(x).getInstance();function U(){i={},o={},g={},c={},R={},D={},O={},M={},void 0===p&&(p=!1),w&&w.reset(),I=void 0,w=void 0,N=void 0,clearTimeout(h),h=null;}function Z(t){var i=t.request.mediaType,a=t.streamId;if(i&&a&&c[a]&&L.get().streaming.abr.autoSwitchBitrate[i]){var o=c[a][i];if(o){var u=si(x).create({abrController:e,streamProcessor:o,currentRequest:t.request,useBufferOccupancyABR:D[i],useL2AABR:O[i],useLoLPABR:M[i],videoModel:v}),l=n.shouldAbandonFragment(u,a);l.quality>ui.Z.NO_CHANGE&&o.getFragmentModel().getRequests({state:T.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(g[a][i].state=s.Z.ABANDON_LOAD,R[a][i].reset(),R[a][i].push({oldValue:j(i,a),newValue:l.quality,confidence:1,reason:l.reason}),H(i,r.getActiveStreamInfo(),l.quality,l.reason),clearTimeout(h),h=setTimeout(function(){g[a][i].state=s.Z.ALLOW_LOAD,h=null;},L.get().streaming.abandonLoadTimeout));}}}function B(e){e.mediaType===a.Z.VIDEO&&(void 0!==I&&w.push(e.streamId,I,v.getPlaybackQuality()),I=e.newQuality);}function G(e){var n,r;e.metric!==s.Z.HTTP_REQUEST||!e.value||e.value.type!==C.w.MEDIA_SEGMENT_TYPE||e.mediaType!==a.Z.AUDIO&&e.mediaType!==a.Z.VIDEO||N.push(e.mediaType,e.value,L.get().streaming.abr.useDeadTimeLatency),e.metric!==s.Z.BUFFER_LEVEL||e.mediaType!==a.Z.AUDIO&&e.mediaType!==a.Z.VIDEO||(n=e.mediaType,r=.001*e.value.level,L.get().streaming.abr.ABRStrategy===a.Z.ABR_STRATEGY_DYNAMIC&&function(e,n){try{var r=_.getStableBufferTime(),i=r,a=.5*r,o=D[e],s=n>(o?a:i);D[e]=s,s!==o&&(s?t.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+n.toFixed(3)+")."):t.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+n.toFixed(3)+")."));}catch(e){t.error(e);}}(n,r));}function q(e,n){try{var r;return i[n]=i[n]||{},i[n].hasOwnProperty(e)||(i[n][e]=0),r=function(e,t){var n=i[t][e],r=n;if(!c[t]||!c[t][e])return r;var a=Y(e,t);void 0!==a&&(r=Math.max(n,a));var o=function(e,t){try{var n=_.getAbrBitrateParameter("maxBitrate",e);return n>-1?W(c[t][e].getMediaInfo(),n,t):void 0;}catch(e){return;}}(e,t);return void 0!==o&&(r=Math.min(r,o)),r;}(e,n),r=function(e,t,n){var r=i[n][t],a=L.get().streaming.abr.maxRepresentationRatio[t];return isNaN(a)||a>=1||a<0?e:Math.min(e,Math.round(r*a));}(r,e,n),r=function(e,t,n){if(t!==a.Z.VIDEO||!L.get().streaming.abr.limitBitrateByPortal||!c[n]||!c[n][t])return e;p||Q();var r=c[n][t].getStreamInfo(),i=E.getAdaptationForType(r.index,t,r).Representation_asArray,o=e;if(m>0&&y>0){for(;o>0&&i[o]&&m<i[o].width&&m-i[o-1].width<i[o].width-m;)o-=1;for(;o<i.length-1&&i[o].width===i[o+1].width;)o+=1;}return o;}(r,e,n),L.get().streaming.cmsd.enabled&&L.get().streaming.cmsd.abr.applyMb&&(r=function(e,n,r){if("video"!==n)return e;var i=b.getMaxBitrate(n);if(i<0)return e;var a=K(r,"audio",j("audio",r));i-=a?a.bitrate/1e3:0;var o=W(c[r][n].getMediaInfo(),i,r);return t.debug("Stream ID: "+r+" ["+n+"] Apply max bit rate from CMSD: "+i),Math.min(e,o);}(r,e,n)),r;}catch(e){return;}}function Y(e,t){try{return function(e,t){try{var n=_.getAbrBitrateParameter("minBitrate",e);if(n>-1){var r=c[t][e].getMediaInfo(),i=X(r),a=W(r,n,t);return i[a]&&a<i.length-1&&i[a].bitrate<1e3*n&&a++,a;}return;}catch(e){return;}}(e,t);}catch(e){return;}}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return t||(t=r.getActiveStreamInfo().id),e&&c[t]&&c[t][e]&&t?(o[t]=o[t]||{},o[t].hasOwnProperty(e)||(o[t][e]=0),o[t][e]):0;}catch(e){return 0;}}function H(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t&&t.id&&e){var i=t.id,a=j(e,i);(0, z.SE)(n);var o=q(e,i);n!==a&&n>=0&&n<=o&&V(e,a,n,o,r,i);}}function V(e,n,r,i,a,s){if(e&&c[s]&&c[s][e]){var u=c[s][e].getStreamInfo(),f=u&&u.manifestInfo&&u.manifestInfo.isDynamic,d=P.getCurrentBufferLevel(e);t.info("Stream ID: "+s+" ["+e+"] switch from "+n+" to "+r+"/"+i+" (buffer: "+d+") "+(a?JSON.stringify(a):".")),o[s]=o[s]||{},o[s][e]=r;var g=K(s,e,r);k.trigger(l.Z.QUALITY_CHANGE_REQUESTED,{oldQuality:n,newQuality:r,reason:a,streamInfo:u,bitrateInfo:g,maxIdx:i,mediaType:e},{streamId:u.id,mediaType:e});var h=N.getAverageThroughput(e,f);isNaN(h)||A.setSavedBitrateSettings(e,h);}}function K(e,t,n){if(t&&c&&c[e]&&c[e][t]){var r=X(c[e][t].getMediaInfo());return r[n]?r[n]:null;}return null;}function W(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e&&e.type?c[n][e.type].getRepresentationInfo():null;if(L.get().streaming.abr.useDeadTimeLatency&&r&&i&&i.fragmentDuration){r/=1e3;var a=i.fragmentDuration;if(r>a)return 0;var o=r/a;t*=1-o;}for(var s=X(e),u=s.length-1;u>=0;u--){var l=s[u];if(1e3*t>=l.bitrate)return u;}return 0;}function X(e){var t=[];if(!e||!e.bitrateList)return t;for(var n,r=e.bitrateList,i=e.type,a=0,o=r.length;a<o;a++)(n=new Mt()).mediaType=i,n.qualityIndex=a,n.bitrate=r[a].bandwidth,n.width=r[a].width,n.height=r[a].height,n.scanType=r[a].scanType,t.push(n);return t;}function Q(){if(v){var e=L.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;m=v.getClientWidth()*e,y=v.getClientHeight()*e;}}return e={initialize:function(){w=di(x).create(),N=hi(x).create({settings:L}),(n=(0, ai.Z)(x).create({dashMetrics:P,customParametersModel:S,mediaPlayerModel:_,settings:L})).initialize(),k.on(d.Z.QUALITY_CHANGE_RENDERED,B,e),k.on(d.Z.METRIC_ADDED,G,e),k.on(l.Z.LOADING_PROGRESS,Z,e);},isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=j(a.Z.AUDIO,t),r=j(a.Z.VIDEO,t);return n===q(a.Z.AUDIO,t)&&r===q(a.Z.VIDEO,t);},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return i[n]=i[n]||{},i[n][t]=r,r;},clearDataForStream:function(e){w&&w.clearForStream(e),c[e]&&delete c[e],R[e]&&delete R[e],g[e]&&delete g[e];},getThroughputHistory:function(){return N;},getBitrateList:X,getQualityForBitrate:W,getTopBitrateInfoFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||(t=r.getActiveStreamInfo().id),e&&c&&c[t]&&c[t][e]){var n=q(e,t),i=X(c[t][e].getMediaInfo());return i[n]?i[n]:null;}return null;},getMinAllowedIndexFor:Y,getMaxAllowedIndexFor:q,getInitialBitrateFor:function(e,t){if(function(){if(!A||!A.hasOwnProperty("getSavedBitrateSettings"))throw new Error(a.Z.MISSING_CONFIG_ERROR);}(),e===a.Z.TEXT)return NaN;var n=A.getSavedBitrateSettings(e),r=_.getAbrBitrateParameter("initialBitrate",e),i=L.get().streaming.abr.initialRepresentationRatio[e];if(-1===r)if(i>-1){var o=c[t][e].getStreamInfo(),s=E.getAdaptationForType(o.index,e,o).Representation_asArray;r=Array.isArray(s)?s[Math.max(Math.round(s.length*i)-1,0)].bandwidth/1e3:0;}else r=isNaN(n)?e===a.Z.VIDEO?1e3:100:n;return r;},getQualityFor:j,getAbandonmentStateFor:function(e,t){return g[e]&&g[e][t]?g[e][t].state:null;},setPlaybackQuality:H,checkPlaybackQuality:function(t,r){try{if(!(t&&c&&c[r]&&c[r][t]))return !1;if(w){var i=v.getPlaybackQuality();i&&w.push(r,I,i);}if(!L.get().streaming.abr.autoSwitchBitrate[t])return !1;var a=j(t,r),o=si(x).create({abrController:e,switchHistory:R[r][t],droppedFramesHistory:w,streamProcessor:c[r][t],currentValue:a,useBufferOccupancyABR:D[t],useL2AABR:O[t],useLoLPABR:M[t],videoModel:v}),u=Y(t,r),l=q(t,r),f=n.getMaxQuality(o),d=f.quality;return void 0!==u&&(d>ui.Z.NO_CHANGE?d:a)<u&&(d=u),d>l&&(d=l),R[r][t].push({oldValue:a,newValue:d}),d>ui.Z.NO_CHANGE&&d!==a&&(g[r][t].state===s.Z.ALLOW_LOAD||d<a)&&(V(t,a,d,l,f.reason,r),!0);}catch(e){return !1;}},setElementSize:Q,setWindowResizeEventCalled:function(e){p=e;},registerStreamType:function(e,t){var n=t.getStreamInfo().id;c[n]||(c[n]={}),R[n]||(R[n]={}),g[n]||(g[n]={}),R[n][e]=ci(x).create(),c[n][e]=t,g[n][e]={},g[n][e].state=s.Z.ALLOW_LOAD,function(e){var t=L.get().streaming.abr.ABRStrategy;t===a.Z.ABR_STRATEGY_L2A?(D[e]=!1,M[e]=!1,O[e]=!0):t===a.Z.ABR_STRATEGY_LoLP?(D[e]=!1,M[e]=!0,O[e]=!1):t===a.Z.ABR_STRATEGY_BOLA?(D[e]=!0,M[e]=!1,O[e]=!1):t===a.Z.ABR_STRATEGY_THROUGHPUT?(D[e]=!1,M[e]=!1,O[e]=!1):t===a.Z.ABR_STRATEGY_DYNAMIC&&(D[e]=!(!D||!D[e])&&D[e],M[e]=!1,O[e]=!1);}(e),e===a.Z.VIDEO&&Q();},unRegisterStreamType:function(e,t){try{c[e]&&c[e][t]&&delete c[e][t],R[e]&&R[e][t]&&delete R[e][t],g[e]&&g[e][t]&&delete g[e][t];}catch(e){}},setConfig:function(e){e&&(e.streamController&&(r=e.streamController),e.domStorage&&(A=e.domStorage),e.mediaPlayerModel&&(_=e.mediaPlayerModel),e.customParametersModel&&(S=e.customParametersModel),e.cmsdModel&&(b=e.cmsdModel),e.dashMetrics&&(P=e.dashMetrics),e.adapter&&(E=e.adapter),e.videoModel&&(v=e.videoModel),e.settings&&(L=e.settings));},reset:function(){U(),k.off(l.Z.LOADING_PROGRESS,Z,e),k.off(d.Z.QUALITY_CHANGE_RENDERED,B,e),k.off(d.Z.METRIC_ADDED,G,e),n&&n.reset();}},t=F.getLogger(e),U(),e;}pi.__dashjs_factory_name="AbrController";var mi=c.Z.getSingletonFactory(pi);mi.QUALITY_DEFAULT=0,c.Z.updateSingletonFactory(pi.__dashjs_factory_name,mi);const yi=mi;var Ei=new Map([[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function vi(){var e,t,n,r,i,o,s=this.context,c=(0, u.Z)(s).getInstance(),d=[];function g(){n&&(n.playbackRate=1,n.removeEventListener("canplay",g));}function h(){return d.length>0;}function p(){if(n&&h()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e);}}function m(e,t){n&&n.addEventListener(e,t);}function y(e,t){n&&n.removeEventListener(e,t);}function E(){return n?n.readyState:NaN;}function v(){return n?n.buffered:null;}function _(e,t,r,i,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===r&&n.textTracks[o].isTTML===i&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null;}function T(e,t){e===a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||E()>=e?t():function(e,t){m(e,function n(){y(e,n),t(e);});}(Ei.get(e),t);}return e={initialize:function(){c.on(l.Z.PLAYBACK_PLAYING,p,this);},setCurrentTime:function(e,t){n&&(r=e,T(a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(n.currentTime!==r)try{r=t?function(e){var t=v(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(e>=a&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o);}return n;}(r):r,n.currentTime=r,r=NaN;}catch(e){0===n.readyState&&e.code===e.INVALID_STATE_ERR&&setTimeout(function(){n.currentTime=r,r=NaN;},400);}else r=NaN;}));},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&c.trigger(l.Z.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing (".concat(e,")"));});}},isPaused:function(){return n?n.paused:null;},pause:function(){n&&(n.pause(),n.autoplay=!1);},isStalled:h,isSeeking:function(){return n?n.seeking||!isNaN(r):null;},getTime:function(){return n?isNaN(r)?n.currentTime:r:null;},getPlaybackRate:function(){return n?n.playbackRate:null;},setPlaybackRate:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n&&(!t&&n.readyState<=2&&e>0?n.addEventListener("canplay",g):n.playbackRate=e);},getPlayedRanges:function(){return n?n.played:null;},getEnded:function(){return n?n.ended:null;},setStallState:function(e,t){!function(e,t){t?function(e){null!==e&&n&&!n.seeking&&-1===d.indexOf(e)&&d.push(e);}(e):function(e){var t=d.indexOf(e);null!==e&&-1!==t&&d.splice(t,1);}(e);}(e,t);},getElement:function(){return n;},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw "element is not video or audio DOM type!";(n=e)&&(n.preload="auto");},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()));},getSource:function(){return n?n.src:null;},getTTMLRenderingDiv:function(){return i;},setTTMLRenderingDiv:function(e){(i=e).style.position="absolute",i.style.display="flex",i.style.overflow="hidden",i.style.pointerEvents="none",i.style.top=0,i.style.left=0;},getVttRenderingDiv:function(){return o;},setVttRenderingDiv:function(e){o=e;},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return "getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date()}),t;},addEventListener:m,removeEventListener:y,getReadyState:E,getBufferRange:v,getClientWidth:function(){return n?n.clientWidth:NaN;},getClientHeight:function(){return n?n.clientHeight:NaN;},getTextTracks:function(){return n?n.textTracks:[];},getTextTrack:_,addTextTrack:function(e,t,r,i,a){if(!n)return null;var o=_(e,t,r,i,a);return o||((o=n.addTextTrack(e,t,r)).isEmbedded=a,o.isTTML=i),o;},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded));},removeChild:function(e){n&&n.removeChild(e);},getVideoWidth:function(){return n?n.videoWidth:NaN;},getVideoHeight:function(){return n?n.videoHeight:NaN;},getVideoRelativeOffsetTop:function(){if(n){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN;}return NaN;},getVideoRelativeOffsetLeft:function(){if(n){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN;}return NaN;},waitForReadyState:T,reset:function(){c.off(l.Z.PLAYBACK_PLAYING,p,this);}},t=(0, f.Z)(s).getInstance().getLogger(e),r=NaN,e;}vi.__dashjs_factory_name="VideoModel";const _i=c.Z.getSingletonFactory(vi);var Ti=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],Si="dashjs_?_bitrate",bi="dashjs_?_settings",Ai="localStorage",Ii="lastBitrate",Ri="lastMediaSettings";function wi(e){e=e||{};var t,n,r,i=this.context,o=e.settings;function s(e){if(void 0!==r)return r;var t;r=!1;try{"undefined"!=typeof window&&(t=window[e]);}catch(e){return n.warn("DOMStorage access denied: "+e.message),r;}if(!t||e!==Ai&&"sessionStorage"!==e)return r;try{t.setItem("1","1"),t.removeItem("1"),r=!0;}catch(e){n.warn("DOMStorage is supported, but cannot be used: "+e.message);}return r;}function u(){var e=6e5;return Math.round(new Date().getTime()/e)*e;}function l(e,t){return s(e)&&o.get().streaming[t+"CachingInfo"].enabled;}function c(){if(!o)throw new Error(a.Z.MISSING_CONFIG_ERROR);}return t={getSavedBitrateSettings:function(e){if(c(),!o.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var t=NaN;if(l(Ai,Ii)){var r=Si.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},a=new Date().getTime()-parseInt(i.timestamp,10)>=o.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(i.bitrate);isNaN(s)||a?a&&localStorage.removeItem(r):(t=s,n.debug("Last saved bitrate for "+e+" was "+s));}catch(e){return null;}}return t;},setSavedBitrateSettings:function(e,t){if(l(Ai,Ii)&&t){var r=Si.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({bitrate:t.toFixed(3),timestamp:u()}));}catch(e){n.error(e.message);}}},getSavedMediaSettings:function(e){if(c(),!o.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var t=null;if(l(Ai,Ri)){var n=bi.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},i=new Date().getTime()-parseInt(r.timestamp,10)>=o.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=r.settings,i&&(localStorage.removeItem(n),t=null);}catch(e){return null;}}return t;},setSavedMediaSettings:function(e,t){if(l(Ai,Ri)){var r=bi.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({settings:t,timestamp:u()}));}catch(e){n.error(e.message);}}}},n=(0, f.Z)(i).getInstance().getLogger(t),s(Ai)&&Ti.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t);}catch(e){n.error(e.message);}}}),t;}wi.__dashjs_factory_name="DOMStorage";const Ni=c.Z.getSingletonFactory(wi);var Ci=n(2032),Di=n(2011);function Oi(){var e,t,n,r,i,a,o,s,u,l,c,f,d,g=this.context;function h(e,n,i,a){var o=null,u=e?d.resolve(e.path):null,l=a||{init:!0,url:u?u.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n};t.debug("Start searching for initialization.");var c=E(l);s.load({request:c,success:function(t){if(l.bytesLoaded=l.range.end,!(o=r.findInitRange(t)))return l.range.end=l.bytesLoaded+l.bytesToLoad,h(e,n,i,l);e.range=o,i(e);},error:function(){i(e);}}),t.debug("Perform init search: "+l.url);}function m(e,n,i,a,o,u){if(i&&(void 0===i.start||void 0===i.end)){var l=i?i.toString().split("-"):null;i=l?{start:parseFloat(l[0]),end:parseFloat(l[1])}:null;}o=o||y;var c=null,f=null,g=!!i,h=e?d.resolve(e.path):null,p={init:!1,url:h?h.url:void 0,range:g?i:{start:0,end:1500},searching:!g,bytesLoaded:u?u.bytesLoaded:0,bytesToLoad:1500,mediaType:n},v=E(p);s.load({request:v,success:function(i){var s=p.bytesToLoad,u=i.byteLength;if(p.bytesLoaded=p.range.end-p.range.start,c=r.parse(i),(f=c.getBox("sidx"))&&f.isComplete){var l,d,g=f.references;if(null!=g&&g.length>0&&(l=1===g[0].reference_type),l){var h,y,E,v;t.debug("Initiate multiple SIDX load."),p.range.end=p.range.start+f.size;var _=[],T=0,S=(f.offset||p.range.start)+f.size,b=function(t){t?(_=_.concat(t),++T>=y&&(_.sort(function(e,t){return e.startTime-t.startTime<0?-1:0;}),o(_,e,a))):o(null,e,a);};for(h=0,y=g.length;h<y;h++)E=S,v=S+g[h].referenced_size-1,S+=g[h].referenced_size,m(e,n,{start:E,end:v},a,b,p);}else t.debug("Parsing segments from SIDX. representation "+n+" - id: "+e.id+" for range : "+p.range.start+" - "+p.range.end),d=function(e,t){for(var n,r,i,a,o=e.references,s=o.length,u=e.timescale,l=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,f=[],d=0;d<s;d++)i=o[d].subsegment_duration,a=o[d].referenced_size,(n=new Di.Z()).duration=i,n.startTime=l,n.timescale=u,r=c+a-1,n.mediaRange=c+"-"+r,f.push(n),l+=i,c+=a;return f;}(f,p),o(d,e,a);}else {if(f)p.range.start=f.offset||p.range.start,p.range.end=p.range.start+(f.size||s);else {if(u<p.bytesLoaded)return void o(null,e,a);var A=c.getLastBox();A&&A.size?(p.range.start=A.offset+A.size,p.range.end=p.range.start+s):p.range.end+=s;}m(e,n,p.range,a,null,p);}},error:function(){o(null,e,a);}}),t.debug("Perform SIDX load for type ".concat(n," : ").concat(p.url," with range ").concat(p.range.start," - ").concat(p.range.end));}function y(e,t,n){n({segments:e,representation:t,error:e?void 0:new S.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)});}function E(e){if(e.url){var t=new p.Z();return t.setInfo(e),t;}}return e={setConfig:function(s){s.baseURLController&&(d=s.baseURLController),s.dashMetrics&&(a=s.dashMetrics),s.mediaPlayerModel&&(o=s.mediaPlayerModel),s.errHandler&&(n=s.errHandler),s.boxParser&&(r=s.boxParser),s.debug&&(t=s.debug.getLogger(e)),s.requestModifier&&(i=s.requestModifier),s.errors&&(u=s.errors),s.urlUtils&&(f=s.urlUtils),s.constants&&(l=s.constants),s.dashConstants&&(c=s.dashConstants);},initialize:function(){s=vt(g).create({errHandler:n,dashMetrics:a,mediaPlayerModel:o,requestModifier:i,boxParser:r,errors:u,urlUtils:f,constants:l,dashConstants:c});},loadInitialization:function(e,t){return new Promise(function(n){h(e,t,n);});},loadSegments:function(e,t,n){return new Promise(function(r){m(e,t,n,r);});},reset:function(){s&&(s.abort(),s=null);}};}Oi.__dashjs_factory_name="SegmentBaseLoader";const Mi=c.Z.getSingletonFactory(Oi);function Pi(e){var t;e=e||{};var n=new DataView(e.data),r=0;function i(e,t){var i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(r)!==e.tag&&(i=!1),a=4):e.tag>65535?(256*n.getUint16(r)+n.getUint8(r+2)!==e.tag&&(i=!1),a=3):e.tag>255?(n.getUint16(r)!==e.tag&&(i=!1),a=2):(n.getUint8(r)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(r+=a),i;}function a(e){var t=1,i=128,a=-1,o=0,s=n.getUint8(r),u=0;for(u=0;u<8;u+=1){if((s&i)===i){o=void 0===e?s&~i:s,a=u;break;}i>>=1;}for(u=0;u<a;u+=1,t+=1)o=o<<8|255&n.getUint8(r+t);return r+=t,o;}return t={getPos:function(){return r;},setPos:function(e){r=e;},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n;},parseTag:function(e){var n;return i(e),n=a(),t[e.parse](n);},skipOverElement:function(e,t){var n,o=i(e,t);return o&&(n=a(),r+=n),o;},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t;switch(e){case 4:t=n.getFloat32(r),r+=4;break;case 8:t=n.getFloat64(r),r+=8;}return t;},getMatroskaUint:function(e){if(e>4)return function(e){for(var t=Math.floor(Number.MAX_SAFE_INTEGER/256),i=0,a=0;a<e;a+=1){if(i>t)throw new Error("Value exceeds safe integer limit");i*=256;var o=n.getUint8(r+a);if(i>Number.MAX_SAFE_INTEGER-o)throw new Error("Value exceeds safe integer limit");i+=o;}return r+=e,i;}(e);for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&n.getUint8(r+i);return r+=e,t>>>0;},moreData:function(){return r<n.byteLength;}};}Pi.__dashjs_factory_name="EBMLParser";const Li=c.Z.getClassFactory(Pi);function xi(){var e,t,n,r,i,o,s,u,l,c,f=this.context;function d(e){var t=new p.Z();return t.setInfo(e),t;}return e={setConfig:function(n){if(!(n.baseURLController&&n.dashMetrics&&n.mediaPlayerModel&&n.errHandler))throw new Error(a.Z.MISSING_CONFIG_ERROR);c=n.baseURLController,o=n.dashMetrics,s=n.mediaPlayerModel,r=n.errHandler,l=n.errors,t=n.debug.getLogger(e),i=n.requestModifier;},initialize:function(){u=vt(f).create({errHandler:r,dashMetrics:o,mediaPlayerModel:s,requestModifier:i,errors:l});},loadInitialization:function(e,n){return new Promise(function(r){var i=null,a=e?c.resolve(e.path):null,o=e?e.range.split("-"):null,s={range:{start:o?parseFloat(o[0]):null,end:o?parseFloat(o[1]):null},request:i,url:a?a.url:void 0,init:!0,mediaType:n};t.info("Start loading initialization."),i=d(s),u.load({request:i,success:function(){r(e);},error:function(){r(e);}}),t.debug("Perform init load: "+s.url);});},loadSegments:function(e,r,i){return new Promise(function(a){var o=null,s=e?c.resolve(e.path):null,g=s?s.url:void 0;o=d({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:o,url:g,init:!1,mediaType:r}),t.debug("Parsing ebml header"),u.load({request:o,success:function(r){!function(e,r,i,a){if(e&&0!==e.byteLength){var o,s,l,c,g=Li(f).create({data:e}),h=i?i.split("-"):null,p=null,m={url:r,range:{start:h?parseFloat(h[0]):null,end:h?parseFloat(h[1]):null},request:p};for(t.debug("Parse EBML header: "+m.url),g.skipOverElement(n.EBML),g.consumeTag(n.Segment),l=g.getMatroskaCodedNum(),l+=g.getPos(),c=g.getPos();g.moreData()&&!g.consumeTagAndSize(n.Segment.Info,!0);)if(!(g.skipOverElement(n.Segment.SeekHead,!0)||g.skipOverElement(n.Segment.Tracks,!0)||g.skipOverElement(n.Segment.Cues,!0)||g.skipOverElement(n.Void,!0)))throw new Error("no valid top level element found");for(;void 0===o;){var y=g.getMatroskaCodedNum(!0),E=g.getMatroskaCodedNum();y===n.Segment.Info.Duration.tag?o=g[n.Segment.Info.Duration.parse](E):g.setPos(g.getPos()+E);}p=d(m),u.load({request:p,success:function(e){s=function(e,r,i,a){var o,s,u,l,c,d,g,h;for(u=[],c=0,d=(s=function(e){var t,r,i=[],a=Li(f).create({data:e});for(a.consumeTagAndSize(n.Segment.Cues);a.moreData()&&a.consumeTagAndSize(n.Segment.Cues.CuePoint,!0);){for((t={}).CueTime=a.parseTag(n.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];a.moreData()&&a.consumeTag(n.Segment.Cues.CuePoint.CueTrackPositions,!0);){var o=a.getMatroskaCodedNum(),s=a.getPos();if((r={}).Track=a.parseTag(n.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===r.Track)throw new Error("Cue track cannot be 0");r.ClusterPosition=a.parseTag(n.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(r),a.setPos(s+o);}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");i.push(t);}if(0===i.length)throw new Error("mandatory cuepoint not found");return i;}(e)).length;c<d;c+=1)l=new Di.Z(),o=c<s.length-1?s[c+1].CueTime-s[c].CueTime:a-s[c].CueTime,l.duration=o,l.startTime=s[c].CueTime,l.timescale=1e3,g=s[c].CueTracks[0].ClusterPosition+r,h=c<s.length-1?s[c+1].CueTracks[0].ClusterPosition+r-1:i-1,l.mediaRange=g+"-"+h,u.push(l);return t.debug("Parsed cues: "+u.length+" cues."),u;}(e,c,l,o),a(s);},error:function(){t.error("Download Error: Cues "+m.url),a(null);}}),t.debug("Perform cues load: "+m.url+" bytes="+m.range.start+"-"+m.range.end);}else a(null);}(r,g,i,function(t){a({segments:t,representation:e,error:t?void 0:new S.Z(l.SEGMENT_BASE_LOADER_ERROR_CODE,l.SEGMENT_BASE_LOADER_ERROR_MESSAGE)});});},error:function(){a({representation:e,error:new S.Z(l.SEGMENT_BASE_LOADER_ERROR_CODE,l.SEGMENT_BASE_LOADER_ERROR_MESSAGE)});}});});},reset:function(){u&&(u.abort(),u=null);}},n={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},e;}xi.__dashjs_factory_name="WebmSegmentBaseLoader";const Fi=c.Z.getSingletonFactory(xi);function ki(e){e=e||{};var t,n,r,i=this.context,a=e.eventBus,o=e.events,s=e.dashMetrics,u=e.mediaPlayerModel,l=e.errHandler,c=e.baseURLController,f=e.debug,d=e.boxParser,g=e.requestModifier,h=e.errors;function p(e){return "webm"===(e?e.split("/")[1]:"").toLowerCase();}return t={initialize:function(){n.initialize(),r.initialize();},getSegmentBaseInitSegment:function(e){return p(e.representation.mimeType)?r.loadInitialization(e.representation,e.mediaType):n.loadInitialization(e.representation,e.mediaType);},getSegmentList:function(e){return p(e.mimeType)?r.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null):n.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null);},reset:function(){n.reset(),r.reset();}},n=Mi(i).getInstance(),r=Fi(i).getInstance(),n.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:u,errHandler:l,eventBus:a,events:o,errors:h,debug:f,boxParser:d,requestModifier:g}),r.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:u,errHandler:l,eventBus:a,events:o,errors:h,debug:f,requestModifier:g}),t;}ki.__dashjs_factory_name="SegmentBaseController";const Ui=c.Z.getSingletonFactory(ki),Zi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null;},Bi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.viewpointsWithSchemeIdUri=null,this.accessibility=null,this.accessibilitiesWithSchemeIdUri=null,this.audioChannelConfiguration=null,this.audioChannelConfigurationsWithSchemeIdUri=null,this.roles=null,this.rolesWithSchemeIdUri=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={},this.supplementalPropertiesAsArray=[],this.segmentAlignment=!1,this.subSegmentAlignment=!1;},Gi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0;},qi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null,this.serviceDescriptions=[],this.protocol=null;};function Yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const ji=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.valid="/"==t[0],this.path=t.split("/").filter(function(e){return 0!==e.length;}).map(function(e){var t={name:e},r=e.indexOf("[");if(-1!=r){t.name=e.substring(0,r);var i=e.substring(r+1,e.length-1);n.valid=n.valid&&-1==i.indexOf("[");var a=i.indexOf("=");-1!=a?(t.attribute={name:i.substring(1,a),value:i.substring(a+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(i,10)-1;}return t;});}var t,n;return t=e,(n=[{key:"isValid",value:function(){return this.valid;}},{key:"findsElement",value:function(){return !this.findsAttribute();}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@");}},{key:"getMpdTarget",value:function(e,t){for(var n=null,r=e,i=1,a="MPD";i<this.path.length&&null!==r;){n=r;var o=this.path[i];if(a=o.name,i!==this.path.length-1||!a.startsWith("@")){var s=n[a+"_asArray"]||[];0===s.length&&n[a]&&s.push(n[a]),o.position?r=s[o.position]||null:o.attribute?function(){var e=o.attribute;r=s.filter(function(t){return t[e.name]==e.value;})[0]||null;}():r=s[0]||null;}i++;}return null===r?null:a.startsWith("@")?{name:a.substring(1),leaf:r,target:r}:{name:a,leaf:r,target:t?n:r};}}])&&Yi(t.prototype,n),e;}();function Hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const Vi=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.action=t,this.xpath=n,this.value=r,this.position=null;}var t,n;return t=e,(n=[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t);}}])&&Hi(t.prototype,n),e;}();function Ki(){var e,t,n=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(o.Z.ORIGINAL_MPD_ID)||!1;},getPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.PUBLISH_TIME)?new Date(e[o.Z.PUBLISH_TIME]):null;},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.ORIGINAL_PUBLISH_TIME)?new Date(e[o.Z.ORIGINAL_PUBLISH_TIME]):null;},getMpdId:function(e){return e&&e[o.Z.ORIGINAL_MPD_ID]||null;},getPatchOperations:function(e){return e?(e.__children||[]).map(function(e){var n=Object.keys(e)[0];if("add"!==n&&"remove"!==n&&"replace"!==n)return t.warn("Ignoring node of invalid action: ".concat(n)),null;var r=e[n],i=r.sel;if("add"===n&&r.type){if(!r.type.startsWith("@"))return t.warn("Ignoring add action for prefixed namespace declaration: ".concat(r.type,"=").concat(r.__text)),null;i="".concat(i,"/").concat(r.type);}var a=new ji(i);if(!a.isValid())return t.warn("Ignoring action with invalid selector: ".concat(n," - ").concat(i)),null;var o=null;a.findsAttribute()?o=r.__text||"":"remove"!==n&&(o=r.__children.reduce(function(e,t){var n=Object.keys(t)[0];return "#text"!==n&&(e[n]=e[n]||[],e[n].push(t[n])),e;},{}));var s=new Vi(n,a,o);return "add"===n&&(s.position=r.pos),s;}).filter(function(e){return !!e;}):[];}},t=(0, f.Z)(n).getInstance().getLogger(e),e;}Ki.__dashjs_factory_name="PatchManifestModel";const zi=c.Z.getSingletonFactory(Ki);function Wi(){var e,t,n,r,i,a,s,u=this.context;function l(e,n,a){var s,u=t.getAdaptationsForType(r[0].mpd.manifest,e,n);if(!u||0===u.length)return null;if(u.length>1&&a){var l=d(a,n);if(i[a.id]&&i[a.id][n])for(var f=0,g=u.length;f<g;f++)if(c(i[a.id][n],l[f]))return u[f];for(var h=0,p=u.length;h<p;h++)if(s=u[h],t.getRolesForAdaptation(s).filter(function(e){return e.value===o.Z.MAIN;})[0])return u[h];}return u[0];}function c(e,t){if(!e||!t)return !1;var n=e.id===t.id,r=e.codec===t.codec,i=e.viewpoint===t.viewpoint,a=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),o=e.lang===t.lang,s=e.roles.toString()===t.roles.toString(),u=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),l=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),f=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),d=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return n&&r&&i&&a&&o&&s&&u&&l&&c&&f&&d;}function f(e,n,r,i,o,s){var u,l,c,f,d,g,h=[];if(!i||0===i.length)return [];var p=t.getAdaptationsForPeriod(n);for(f=0,g=i.length;f<g;f++)if(u=i[f],l=v(p[c=t.getIndexForAdaptation(u,e,r.index)]),s){var m=l.accessibility.length;for(d=0;d<m;d++)if(l){var y=l.accessibility[d];if(0===y.indexOf("cea-608:")){var E=y.substring(8).split(";");if("CC"===E[0].substring(0,2))for(d=0;d<E.length;d++)l||(l=v.call(this,p[c])),_(l,E[d].substring(0,3),E[d].substring(4)),h.push(l),l=null;else for(d=0;d<E.length;d++)l||(l=v.call(this,p[c])),_(l,"CC"+(d+1),E[d]),h.push(l),l=null;}else 0===y.indexOf("cea-608")&&(_(l,a.CC1,"eng"),h.push(l),l=null);}}else o===a.IMAGE?(l.type=a.IMAGE,h.push(l),l=null):l&&h.push(l);return h;}function d(e,n,i){var o=r,s=i,u=[];if(s)S(),o=g(s);else {if(!(r.length>0))return u;s=r[0].mpd.manifest;}var l=E(e,o),c=t.getAdaptationsForType(s,e?e.index:null,n);return u=f(s,l,e,c,n),n===a.TEXT&&(c=t.getAdaptationsForType(s,e?e.index:null,a.VIDEO),u=u.concat(f(s,l,e,c,n,!0))),u;}function g(e){var n=h(e);return t.getRegularPeriods(n);}function h(e){var n=m(e);return t.getMpd(n);}function p(){r=[],i={};}function m(e){return e||(r.length>0?r[0].mpd.manifest:null);}function y(e){try{var n=E(e.streamInfo,r),i=t.getAdaptationsForPeriod(n);return e&&e.streamInfo&&void 0!==e.streamInfo.id&&i?i[e.index]:null;}catch(e){return null;}}function E(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i;}return null;}function v(e){if(!e)return null;var n,r,i,a,o,u=new Bi(),l=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];if(u.id=e.id,u.index=e.index,u.type=e.type,u.streamInfo=T(e.period),u.representationCount=t.getRepresentationCount(l),u.labels=t.getLabelsForAdaptation(l),u.lang=t.getLanguageForAdaptation(l),u.segmentAlignment=t.getSegmentAlignment(l),u.subSegmentAlignment=t.getSubSegmentAlignment(l),n=t.getViewpointForAdaptation(l),u.viewpoint=n.length?n[0].value:void 0,u.viewpointsWithSchemeIdUri=n,o=t.getAccessibilityForAdaptation(l),u.accessibility=o.map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==s&&(n=t?"cea-608:"+t:"cea-608",u.embeddedCaptions=!0),n;}),u.accessibilitiesWithSchemeIdUri=o,r=t.getAudioChannelConfigurationForAdaptation(l),u.audioChannelConfiguration=r.map(function(e){return e.value;}),u.audioChannelConfigurationsWithSchemeIdUri=r,0===u.audioChannelConfiguration.length&&Array.isArray(l.Representation_asArray)&&l.Representation_asArray.length>0&&(i=t.getAudioChannelConfigurationForRepresentation(l.Representation_asArray[0]),u.audioChannelConfiguration=i.map(function(e){return e.value;}),u.audioChannelConfigurationsWithSchemeIdUri=i),a=t.getRolesForAdaptation(l),u.roles=a.map(function(e){return e.value;}),u.rolesWithSchemeIdUri=a,u.codec=t.getCodec(l),u.mimeType=t.getMimeType(l),u.contentProtection=t.getContentProtectionData(l),u.bitrateList=t.getBitrateListForAdaptation(l),u.selectionPriority=t.getSelectionPriority(l),u.contentProtection){var c=u.contentProtection.map(function(e){return t.getKID(e);}).filter(function(e){return null!==e;});if(c.length){var f=c[0];u.contentProtection.forEach(function(e){e.keyId=f;});}}if(u.isText=t.getIsText(l),u.supplementalProperties=t.getSupplementalPropertiesForAdaptation(l),(!u.supplementalProperties||0===Object.keys(u.supplementalProperties).length)&&Array.isArray(l.Representation_asArray)&&l.Representation_asArray.length>0){var d=l.Representation_asArray.map(function(e){return t.getSupplementalPropertiesForRepresentation(e);});d.every(function(e){return JSON.stringify(e)===JSON.stringify(d[0]);})&&(u.supplementalProperties=d[0]);}if(u.supplementalPropertiesAsArray=t.getSupplementalPropertiesAsArrayForAdaptation(l),(!u.supplementalPropertiesAsArray||0===u.supplementalPropertiesAsArray.length)&&Array.isArray(l.Representation_asArray)&&l.Representation_asArray.length>0){var g=l.Representation_asArray.map(function(e){return t.getSupplementalPropertiesAsArrayForRepresentation(e);});g.every(function(e){return JSON.stringify(e)===JSON.stringify(g[0]);})&&(u.supplementalPropertiesAsArray=g[0]);}return u.isFragmented=t.getIsFragmented(l),u.isEmbedded=!1,u;}function _(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=a.TEXT,e.codec="cea-608-in-SEI",e.isEmbedded=!0,e.isFragmented=!1,e.lang=yn()(n),e.roles=["caption"],e.rolesWithSchemeIdUri=[{schemeIdUri:"urn:mpeg:dash:role:2011",value:"caption"}];}function T(e){var n,r,i=new Gi();return i.id=e.id,i.index=e.index,i.start=e.start,i.duration=e.duration,i.manifestInfo=(n=e.mpd,(r=new qi()).dvrWindowSize=n.timeShiftBufferDepth,r.loadedTime=n.manifest.loadedTime,r.availableFrom=n.availabilityStartTime,r.minBufferTime=n.manifest.minBufferTime,r.maxFragmentDuration=n.maxSegmentDuration,r.duration=t.getDuration(n.manifest),r.isDynamic=t.getIsDynamic(n.manifest),r.serviceDescriptions=t.getServiceDescriptions(n.manifest),r.protocol=n.manifest.protocol,r),i.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(i.start+i.duration-i.manifestInfo.duration)<1,i;}function S(){if(!a)throw new Error("setConfig function has to be called previously");}function b(e){return r.length>0?r[0].mpd.manifest.Period_asArray[e]:null;}function A(e,t,n){var r,i,a,o,s;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null;}return e={getBandwidthForRepresentation:function(e,t){var n;return (n=A(b(t),e))?n.bandwidth:null;},getIndexForRepresentation:function(e,t){return function(e,t){var n=A(e,t,!0);return null!==n?n:-1;}(b(t),e);},getMaxIndexForBufferType:function(e,n){return function(e,n){var r,i,a,o;if(!e||!n)return -1;for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)if(a=(r=i[o]).Representation_asArray,t.getIsTypeOf(r,n))return a.length;return -1;}(b(n),e);},convertRepresentationToRepresentationInfo:function(e){if(e){var n=new Zi(),r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],i=t.getRepresentationFor(e.index,r);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(i),n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.mediaInfo=v(e.adaptation),n;}return null;},getStreamsInfo:function(e,t){var n=[],i=r;if(e&&(S(),i=g(e)),i.length>0){(!t||t>i.length)&&(t=i.length);for(var a=0;a<t;a++)n.push(T(i[a]));}return n;},getMediaInfoForType:function(e,n){if(0===r.length||!e)return null;var i=E(e,r);if(!i)return null;var a=t.getAdaptationsForPeriod(i),o=l(e.index,n,e);return o?v(a[t.getIndexForAdaptation(o,r[0].mpd.manifest,e.index)]):null;},getAllMediaInfoForType:d,getAdaptationForType:l,getRealAdaptation:function(e,n){var i,a,o=E(e,r);return i=n?n.id:null,r.length>0&&o&&(a=i?t.getAdaptationForId(i,r[0].mpd.manifest,o.index):t.getAdaptationForIndex(n?n.index:null,r[0].mpd.manifest,o.index)),a;},getProducerReferenceTimes:function(e,n){var i,a,o=E(e,r);return i=n?n.id:null,r.length>0&&o&&(a=i?t.getAdaptationForId(i,r[0].mpd.manifest,o.index):t.getAdaptationForIndex(n?n.index:null,r[0].mpd.manifest,o.index)),a?t.getProducerReferenceTimesForAdaptation(a):[];},getRealPeriodByIndex:function(e){return t.getRealPeriodForIndex(e,r[0].mpd.manifest);},getEssentialPropertiesForRepresentation:function(e){try{return t.getEssentialPropertiesForRepresentation(e);}catch(e){return [];}},getVoRepresentations:function(e){var n=y(e);return t.getRepresentationsForAdaptation(n);},getEventsFor:function(e,n,i){var a=[];if(r.length>0){var o=r[0].mpd.manifest;if(e instanceof Gi){var s=E(e,r);a=t.getEventsForPeriod(s);}else if(e instanceof Bi){var u=E(i,r);a=t.getEventStreamForAdaptationSet(o,y(e),u);}else if(e instanceof Zi){var l=E(i,r);a=t.getEventStreamForRepresentation(o,n,l);}}return a;},getEvent:function(e,t,n,r){try{if(!e||!t||isNaN(n)||!r)return null;var i=e.scheme_id_uri,a=e.value;if(!t[i+"/"+a])return null;var o,s=new _e(),u=e.timescale||1,l=r.adaptation.period.start,c=t[i+"/"+a],f=isNaN(r.presentationTimeOffset)?isNaN(c.presentationTimeOffset)?0:c.presentationTimeOffset:r.presentationTimeOffset,d=e.presentation_time_delta/u;o=0===e.version?l+n-f+d:l-f+d;var g=e.event_duration/u,h=e.id,p=e.message_data;return s.eventStream=c,s.eventStream.value=a,s.eventStream.timescale=u,s.duration=g,s.id=h,s.calculatedPresentationTime=o,s.messageData=p,s.presentationTimeDelta=d,s;}catch(e){return null;}},getMpd:h,setConfig:function(e){e&&(e.constants&&(a=e.constants),e.cea608parser&&(s=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}));},updatePeriods:function(e){if(!e)return null;S(),r=g(e);},getIsTextTrack:function(e){return t.getIsText(e);},getUTCTimingSources:function(){var e=m();return t.getUTCTimingSources(e);},getSuggestedPresentationDelay:function(){var e=r.length>0?r[0].mpd:null;return t.getSuggestedPresentationDelay(e);},getAvailabilityStartTime:function(e){var n=h(e);return t.getAvailabilityStartTime(n);},getIsTypeOf:function(e,n){return t.getIsTypeOf(e,n);},getIsDynamic:function(e){var n=m(e);return t.getIsDynamic(n);},getDuration:function(e){var n=m(e);return t.getDuration(n);},getRegularPeriods:g,getContentSteering:function(e){return t.getContentSteering(e);},getLocation:function(e){return t.getLocation(e);},getPatchLocation:function(e){var n=t.getPatchLocation(e),r=t.getPublishTime(e);return n&&0!==n.length&&r?n.filter(function(e){return isNaN(e.ttl)||r.getTime()+e.ttl>new Date().getTime();}):[];},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n);},getPublishTime:function(e){return t.getPublishTime(e);},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014");},getIsPatch:function(e){return n.getIsPatch(e);},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e);},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction();},getCodec:function(e,n,r){return t.getCodec(e,n,r);},getPeriodById:function(e){if(!e||0===r.length)return null;var t=r.filter(function(t){return t.id===e;});return t&&t.length>0?t[0]:null;},setCurrentMediaInfo:function(e,t,n){i[e]=i[e]||{},i[e][t]=i[e][t]||{},i[e][t]=n;},isPatchValid:function(e,r){var i=t.getId(e),a=n.getMpdId(r),o=t.getPublishTime(e),s=n.getPublishTime(r),u=n.getOriginalPublishTime(r);return !!(i&&a&&i==a&&o&&u&&o.getTime()==u.getTime()&&s&&o.getTime()<s.getTime());},applyPatchToManifest:function(e,t){n.getPatchOperations(t).forEach(function(t){var n=t.getMpdTarget(e);if(null!==n){var r=n.name,i=n.target,a=n.leaf;if(t.xpath.findsAttribute())switch(t.action){case"add":case"replace":i[r]=t.value;break;case"remove":delete i[r];}else {var o=(i[r+"_asArray"]||[]).indexOf(a),s="prepend"===t.position||"before"===t.position;if(("remove"===t.action||"replace"===t.action)&&(delete i[r],-1!=o)){var u=i[r+"_asArray"];u.splice(o,1),u.length>1?i[r]=u:1==u.length?i[r]=u[0]:delete i[r+"_asArray"];}"add"!==t.action&&"replace"!==t.action||Object.keys(t.value).forEach(function(e){var n=t.value[e],a=i[e+"_asArray"]||[];if(0===a.length&&i[e]&&a.push(i[e]),0===a.length)a=n;else {var u=a.length;u=e==r&&-1!=o?o+(s?0:1)+("replace"==t.action?-1:0):s?0:a.length,a.splice.apply(a,[u,0].concat(n));}i[e+"_asArray"]=a,i[e]=1==a.length?a[0]:a;});}}});},areMediaInfosEqual:c,reset:p},t=Ze(u).getInstance(),n=zi(u).getInstance(),p(),e;}Wi.__dashjs_factory_name="DashAdapter";const Xi=c.Z.getSingletonFactory(Wi);function Qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var Ji=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}var t,n;return t=e,n=[{key:"round10",value:function(e,t){return function(e,t,n){return void 0===n||0==+n?Math[e](t):(n=+n,null===(t=+t)||isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))));}("round",e,t);}}],n&&Qi(t,n),e;}();const $i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[];},ea=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null;},ta=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.t=null,this.level=null;},na=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.target=null,this.state=s.Z.BUFFER_EMPTY;},ra=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.time=null,this.range=null,this.manifestInfo=null;},ia=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.time=null,this.droppedFrames=null;};function aa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}var oa=function e(){aa(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[];},sa=function e(){aa(this,e),this.id=null,this.index=null,this.start=null,this.duration=null;},ua=function e(){aa(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null;};const la=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null;},ca=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.loadingRequests=[],this.executedRequests=[];};function fa(e){var t,n,r=(e=e||{}).settings,i=this.context,o=(0, u.Z)(i).getInstance();function c(){o.trigger(l.Z.METRICS_CHANGED);}function f(e){o.trigger(l.Z.METRIC_CHANGED,{mediaType:e}),c();}function d(e,t,n){o.trigger(l.Z.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),f(e);}function g(e,t,n){o.trigger(l.Z.METRIC_ADDED,{mediaType:e,metric:t,value:n}),f(e);}function h(e,t){var r=null;return e?(n.hasOwnProperty(e)?r=n[e]:t||(r=new $i(),n[e]=r),r):r;}function p(e,t,n){var i=h(e);null!==i&&(i[t].push(n),i[t].length>r.get().streaming.metrics.maxListDepth&&i[t].shift());}function m(e,t,n){p(e,t,n),g(e,t,n);}return t={clearCurrentMetricsForType:function(e){delete n[e],f(e);},clearAllCurrentMetrics:function(){n={},c();},getMetricsFor:h,addHttpRequest:function e(t,n,r,i,a,o,u,l,c,f,d,g,h,p,y,E,v){var _=new C.w();o&&o!==i&&(e(t,null,r,i,a,null,null,l,c,null,null,null,h,null,null,E,v),_.actualurl=o),_.tcpid=n,_.type=r,_.url=i,_.range=l,_.trequest=c,_.tresponse=f,_.responsecode=g,_.cmsd=v,_._tfinish=d,_._stream=t,_._mediaduration=h,_._quality=a,_._responseHeaders=p,_._serviceLocation=u,_._fileLoaderType=E,y?y.forEach(function(e){!function(e,t,n,r){var i=new C.O();i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n;}(_,e.s,e.d,e.b);}):(delete _.interval,delete _.trace),m(t,s.Z.HTTP_REQUEST,_);},addRepresentationSwitch:function(e,t,n,r,i){var a=new ea();a.t=t,a.mt=n,a.to=r,i?a.lto=i:delete a.lto,m(e,s.Z.TRACK_SWITCH,a);},addBufferLevel:function(e,t,n){var r=new ta();r.t=t,r.level=n,m(e,s.Z.BUFFER_LEVEL,r);},addBufferState:function(e,t,n){var r=new na();r.target=n,r.state=t,m(e,s.Z.BUFFER_STATE,r);},addDVRInfo:function(e,t,n,r){var i=new ra();i.time=t,i.range=r,i.manifestInfo=n,m(e,s.Z.DVR_INFO,i);},addDroppedFrames:function(e,t){var n=new ia(),r=h(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n||m(e,s.Z.DROPPED_FRAMES,n));},addSchedulingInfo:function(e,t,n,r,i,a,o,u,l){var c=new la();c.mediaType=e,c.t=t,c.type=n,c.startTime=r,c.availabilityStartTime=i,c.duration=a,c.quality=o,c.range=u,c.state=l,m(e,s.Z.SCHEDULING_INFO,c);},addRequestsQueue:function(e,t,n){var r=new ca();r.loadingRequests=t,r.executedRequests=n,h(e).RequestsQueue=r,g(e,s.Z.REQUESTS_QUEUE,r);},addManifestUpdate:function(e,t,n,r,i,o,u,l,c,f){var d=new oa();d.mediaType=e,d.type=t,d.requestTime=n,d.fetchTime=r,d.availabilityStartTime=i,d.presentationStartTime=o,d.clientTimeOffset=u,d.currentTime=l,d.buffered=c,d.latency=f,p(a.Z.STREAM,s.Z.MANIFEST_UPDATE,d),g(e,s.Z.MANIFEST_UPDATE,d);},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];d(e.mediaType,s.Z.MANIFEST_UPDATE,e);}},addManifestUpdateStreamInfo:function(e,t,n,r,i){if(e){var a=new sa();a.id=t,a.index=n,a.start=r,a.duration=i,e.streamInfo.push(a),d(e.mediaType,s.Z.MANIFEST_UPDATE_STREAM_INFO,e);}},addManifestUpdateRepresentationInfo:function(e,t,n,r,i,a,o,u){if(e&&e.representationInfo){var l=new ua();l.id=t,l.index=n,l.streamIndex=r,l.mediaType=i,l.startNumber=o,l.fragmentInfoType=u,l.presentationTimeOffset=a,e.representationInfo.push(l),d(e.mediaType,s.Z.MANIFEST_UPDATE_TRACK_INFO,e);}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel;}):delete e.trace,m(a.Z.STREAM,s.Z.PLAY_LIST,e);},addDVBErrors:function(e){m(a.Z.STREAM,s.Z.DVB_ERRORS,e);}},n={},t;}fa.__dashjs_factory_name="MetricsModel";const da=c.Z.getSingletonFactory(fa);function ga(e){e=e||{};var t,n,r,i,o=this.context,u=e.metricsModel;function l(e){var t=u.getMetricsFor(e,!0);if(!t)return null;var n,r=t.HttpList,i=null;if(!r||r.length<=0)return null;for(n=r.length-1;n>=0;){if(r[n].responsecode){i=r[n];break;}n--;}return i;}function c(e){var t=u.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[];}function f(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null;}return t={getCurrentRepresentationSwitch:function(e){return f(u.getMetricsFor(e,!0),s.Z.TRACK_SWITCH);},getCurrentBufferState:function(e){return f(u.getMetricsFor(e,!0),s.Z.BUFFER_STATE);},getCurrentBufferLevel:function(e){var t=f(u.getMetricsFor(e,!0),s.Z.BUFFER_LEVEL);return t?Ji.round10(t.level/1e3,-3):0;},getCurrentHttpRequest:l,getHttpRequests:c,getCurrentDroppedFrames:function(){return f(u.getMetricsFor(a.Z.VIDEO,!0),s.Z.DROPPED_FRAMES);},getCurrentSchedulingInfo:function(e){return f(u.getMetricsFor(e,!0),s.Z.SCHEDULING_INFO);},getCurrentDVRInfo:function(e){return f(e?u.getMetricsFor(e,!0):u.getMetricsFor(a.Z.VIDEO,!0)||u.getMetricsFor(a.Z.AUDIO,!0),s.Z.DVR_INFO);},getCurrentManifestUpdate:function(){return f(u.getMetricsFor(a.Z.STREAM),s.Z.MANIFEST_UPDATE);},getLatestFragmentRequestHeaderValueByID:function(e,t){if(!t)return null;var n={},r=l(e);r&&(n=Be.Z.parseHttpHeaders(r._responseHeaders));var i=n[t.toLowerCase()];return void 0===i?null:i;},getLatestMPDRequestHeaderValueByID:function(e){if(!e)return null;var t,n,r,i={};for(r=(t=c(a.Z.STREAM)).length-1;r>=0;r--)if((n=t[r]).type===C.w.MPD_TYPE){i=Be.Z.parseHttpHeaders(n._responseHeaders);break;}var o=i[e.toLowerCase()];return void 0===o?null:o;},addRepresentationSwitch:function(e,t,n,r,i){u.addRepresentationSwitch(e,t,n,r,i);},addDVRInfo:function(e,t,n,r){u.addDVRInfo(e,t,n,r);},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();u.updateManifestUpdateInfo(t,e);},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();u.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration);}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();u.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType);}},addManifestUpdate:function(e){u.addManifestUpdate(a.Z.STREAM,e.type,e.requestStartDate,e.requestEndDate);},addHttpRequest:function(e,t,n,r,i,a){u.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i,e.fileLoaderType,a);},addSchedulingInfo:function(e,t){u.addSchedulingInfo(e.mediaType,new Date(),e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t);},addRequestsQueue:function(e,t,n){u.addRequestsQueue(e,t,n);},addBufferLevel:function(e,t,n){u.addBufferLevel(e,t,n);},addBufferState:function(e,t,n){u.addBufferState(e,t,n);},addDroppedFrames:function(e){u.addDroppedFrames(a.Z.VIDEO,e);},addPlayList:function(){i&&(u.addPlayList(i),i=null);},addDVBErrors:function(e){u.addDVBErrors(e);},createPlaylistMetrics:function(e,t){(i=new $()).start=new Date(),i.mstart=e,i.starttype=t;},createPlaylistTraceMetrics:function(e,t,i){!0===n&&(n=!1,(r=new ee()).representationid=e,r.start=new Date(),r.mstart=t,r.playbackspeed=null!==i?i.toString():null);},updatePlayListTraceMetrics:function(e){if(r)for(var t in r)r[t]=e[t];},pushPlayListTraceMetrics:function(e,t){if(!1===n&&i&&r&&r.start){var a=r.start,o=e.getTime()-a.getTime();r.duration=o,r.stopreason=t,i.trace.push(r),n=!0;}},clearAllCurrentMetrics:function(){u.clearAllCurrentMetrics();}},u=u||da(o).getInstance({settings:e.settings}),n=!0,r=null,i=null,t;}ga.__dashjs_factory_name="DashMetrics";const ha=c.Z.getSingletonFactory(ga);function pa(){var e,t,n,r,i=this.context,s=(0, u.Z)(i).getInstance(),c=(0, N.Z)(i).getInstance();function f(e){r=e;}function g(e,t,n,r){var i,a=t.adaptation.period.mpd,o=a.availabilityStartTime;if(r)i=n&&a.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(o.getTime()+1e3*(e+a.timeShiftBufferDepth)):a.availabilityEndTime;else if(n){var s=t.availabilityTimeOffset;i=new Date(o.getTime()+1e3*(e-s));}else i=o;return i;}function h(e,t){return (e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*r)/1e3;}function p(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset);}function m(e){var n={start:NaN,end:NaN},r=e[0].getAdapter().getRegularPeriods()[0],i=h(new Date(),r);if(!e||0===e.length)return {range:n,now:i};e.forEach(function(e){var r=e.getAdapter(),s=r.getMediaInfoForType(e.getStreamInfo(),a.Z.VIDEO)||r.getMediaInfoForType(e.getStreamInfo(),a.Z.AUDIO),u=r.getVoRepresentations(s)[0],l={start:NaN,end:NaN};if(u)if(u.segmentInfoType===o.Z.SEGMENT_TIMELINE)l=function(e){var n,r,i,a,o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],s=t.getRepresentationFor(e.index,o),u=s.SegmentTemplate.SegmentTimeline,l=s.SegmentTemplate.timescale,c=u.S_asArray,f={start:0,end:0},d=c[0].t,g=!isNaN(d),h=g?d:0,m=0;for(g&&(f.start=p(h/l,e)),i=0,a=c.length;i<a;i++)r=0,(n=c[i]).hasOwnProperty("r")&&(r=n.r),m+=n.d*(1+r);return f.end=p((h+m)/l,e),f;}(u);else {var c=u.adaptation.period;l.start=c.start,l.end=Math.max(i,c.start+c.duration);}!isNaN(l.start)&&(isNaN(n.start)||n.start>l.start)&&(n.start=l.start),!isNaN(l.end)&&(isNaN(n.end)||n.end<l.end)&&(n.end=l.end);}),n.end=Math.min(i,n.end);var s=E(e,n.end,!0);return n.end=isNaN(s)?n.end:s,n.start=r&&r.mpd&&r.mpd.timeShiftBufferDepth&&!isNaN(r.mpd.timeShiftBufferDepth)&&!isNaN(n.end)?Math.max(n.end-r.mpd.timeShiftBufferDepth,n.start):n.start,n.start=E(e,n.start),{range:n,now:i};}function y(e,t){n=e-t.end;}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{for(var r=0,i=!1,a=NaN;!i&&r<e.length;){var o=e[r].getStreamInfo();o.start<=t&&(!isFinite(o.duration)||o.start+o.duration>=t)?(a=t,i=!0):!n&&o.start>t&&(isNaN(a)||o.start<a)?a=o.start:n&&o.start+o.duration<t&&(isNaN(a)||o.start+o.duration>a)&&(a=o.start+o.duration),r+=1;}return a;}catch(e){return t;}}function v(e){void 0===e.offset||isNaN(e.offset)||f(e.offset/1e3);}function _(){r=0,n=0;}function T(){s.off(l.Z.UPDATE_TIME_SYNC_OFFSET,v,this),_();}return e={initialize:function(){_(),s.on(l.Z.UPDATE_TIME_SYNC_OFFSET,v,this);},getClientTimeOffset:function(){return r;},setClientTimeOffset:f,getClientReferenceTime:function(){return Date.now()-1e3*n+1e3*r;},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return g(e,t,n);},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return g(e,t,n,!0);},calcPresentationTimeFromWallTime:h,calcPresentationTimeFromMediaTime:p,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start;},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset;},calcWallTimeForSegment:function(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i;},calcTimeShiftBufferWindow:function(e,t){if(!t)return function(e){var t={start:NaN,end:NaN},n=0,r=NaN;return e.forEach(function(e){var t=e.getStreamInfo();n+=t.duration,(isNaN(r)||t.start<r)&&(r=t.start);}),t.start=r,t.end=r+n,t;}(e);if(c.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var n=m(e);return y(n.now,n.range),n.range;}return function(e){var t={start:NaN,end:NaN};if(!e||0===e.length)return t;var n=e[0].getAdapter().getRegularPeriods()[0],r=h(new Date(),n),i=n.mpd.timeShiftBufferDepth,a=isNaN(i)?0:r-i;if(t.start=E(e,a),t.end=!isNaN(t.start)&&r<t.start?r:E(e,r,!0),!isNaN(i)&&t.end<r-i&&(t.end=NaN),c.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var o=m(e);if(o.range.end<t.start)return s.trigger(d.Z.CONFORMANCE_VIOLATION,{level:nn.LEVELS.WARNING,event:nn.EVENTS.INVALID_DVR_WINDOW}),y(o.now,o.range),o.range;}return t;}(e);},reset:T},t=Ze(i).getInstance(),T(),e;}pa.__dashjs_factory_name="TimelineConverter";const ma=c.Z.getSingletonFactory(pa);var ya=n(4593),Ea=n(6934);function va(e){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},va(e);}function _a(e,t){return _a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},_a(e,t);}function Ta(e,t){return !t||"object"!==va(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function Sa(e){return Sa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},Sa(e);}const ba=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_a(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=Sa(t);if(n){var i=Sa(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Ta(this,e);});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),(e=r.call(this)).captionData=null,e.label=null,e.defaultTrack=!1,e.kind=null,e.isFragmented=!1,e.isEmbedded=!1,e.isTTML=null,e;}return i;}(Bi);var Aa=n(2295);function Ia(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n)t+=e[n].uchar;return t.length-t.replace(/^\s+/,"").length;}function n(e){return "left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;";}function r(e){return "red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e;}function i(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;";}function a(e){return e.replace(/^\s+/g,"");}function o(e){return e.replace(/\s+$/g,"");}return {createHTMLCaptionsFromScreen:function(r,s,u,l){var c,f,d=null,g=!1,h=-1,p={start:s,end:u,spans:[]},m="style_cea608_white_black",y={},E={},v=[];for(c=0;c<15;++c){var _=l.rows[c],T="",S=null;if(!1===_.isEmpty()){var b=t(_.chars);null===d&&(d={x:b,y1:c,y2:c+1,p:[]}),b!==h&&g&&(d.p.push(p),p={start:s,end:u,spans:[]},d.y2=c,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===y.hasOwnProperty(d.name)?(v.push(d),y[d.name]=d):y[d.name].p.contat(d.p),d={x:b,y1:c,y2:c+1,p:[]});for(var A=0;A<_.chars.length;++A){var I=_.chars[A],R=I.penState;if(null===S||!R.equals(S)){T.trim().length>0&&(p.spans.push({name:m,line:T,row:c}),T="");var w="style_cea608_"+R.foreground+"_"+R.background;R.underline&&(w+="_underline"),R.italics&&(w+="_italics"),E.hasOwnProperty(w)||(E[w]=JSON.parse(JSON.stringify(R))),S=R,m=w;}T+=I.uchar;}T.trim().length>0&&p.spans.push({name:m,line:T,row:c}),g=!0,h=b;}else g=!1,h=-1,d&&(d.p.push(p),p={start:s,end:u,spans:[]},d.y2=c,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===y.hasOwnProperty(d.name)?(v.push(d),y[d.name]=d):y[d.name].p.contat(d.p),d=null);}d&&(d.p.push(p),d.y2=c+1,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===y.hasOwnProperty(d.name)?(v.push(d),y[d.name]=d):y[d.name].p.contat(d.p),d=null);var N=[];for(c=0;c<v.length;++c){var C=v[c],D="sub_cea608_"+e++,O=document.createElement("div");O.id=D;var M=n(C);O.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+M;var P=document.createElement("div");P.className="paragraph bodyStyle",P.style.cssText=i(r);var L=document.createElement("div");L.className="cueUniWrapper",L.style.cssText="unicode-bidi: normal; direction: ltr;";for(var x=0;x<C.p.length;++x){var F=C.p[x],k=0;for(f=0;f<F.spans.length;++f){var U=F.spans[f];if(U.line.length>0){if(0!==f&&k!=U.row){var Z=document.createElement("br");Z.className="lineBreak",L.appendChild(Z);}var B=!1;k===U.row&&(B=!0),k=U.row;var G=E[U.name],q=document.createElement("span");q.className="spanPadding "+U.name+" customSpanColor",q.style.cssText=i(r,G),0!==f&&B?f===F.spans.length-1?q.textContent=o(U.line):q.textContent=U.line:F.spans.length>1&&f<F.spans.length-1&&U.row===F.spans[f+1].row?q.textContent=a(U.line):q.textContent=U.line.trim(),L.appendChild(q);}}}P.appendChild(L),O.appendChild(P);var Y={bodyStyle:["%",90]};for(var j in E)E.hasOwnProperty(j)&&(Y[j]=["%",90]);N.push({type:"html",start:s,end:u,cueHTMLElement:O,cueID:D,cellResolution:[32,15],isFromCEA608:!0,fontSize:Y,lineHeight:{},linePadding:{}});}return N;}};}Ia.__dashjs_factory_name="EmbeddedTextHtmlRender";const Ra=c.Z.getSingletonFactory(Ia);function wa(e){var t,n,r,o,s,c,d,g,h,p,m,y,E,v,_,T,b=e.errHandler,A=e.manifestModel,I=e.mediaController,R=e.videoModel,N=e.textTracks,D=e.vttParser,O=e.vttCustomRenderingParser,M=e.ttmlParser,P=e.streamInfo,L=e.settings,x=this.context,F=(0, u.Z)(x).getInstance(),k=!1;function U(){c=null,g=NaN,h=[],p=null,d=!1,s=[],o=null;}function Z(e){var t=new ba();for(var n in e)t[n]=e[n];t.labels=e.labels,t.defaultTrack=function(e){var t=!1;return y.length>1&&e.isEmbedded?t=e.id&&e.id===a.Z.CC1:1===y.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===y.length&&(t=e.index===s[0].index),t;}(e),t.isFragmented=e.isFragmented,t.isEmbedded=!!e.isEmbedded,t.isTTML=function(e){return e.codec&&e.codec.search(a.Z.STPP)>=0||e.mimeType&&e.mimeType.search(a.Z.TTML)>=0;}(e),t.kind=function(e,t){var n=e.roles&&e.roles.length>0?t[e.roles[0]]:t.caption;return n=n===t.caption||n===t.subtitle?n:t.caption;}(e,{subtitle:"subtitles",caption:"captions"}),N.addTextTrack(t);}function B(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&q(t.bytes,t);}function G(e){m=e;}function q(e,s){var u=s.mediaInfo,l=u.type,f=u.mimeType,h=u.codec||f;h?-1!==u.codec.indexOf("application/mp4")?function(e,i,s){var u;if("InitializationSegment"===i.segmentType)d=!0,g=r.getMediaTimescaleFromMoov(e);else {if(!d)return;(u=r.getSamplesInfo(e).sampleList).length>0&&(p=u[0].cts-i.start*g),s.search(a.Z.STPP)>=0?function(e,r,i){var s,u;for(o=null!==o?o:H(i),s=0;s<r.length;s++){var l=r[s],f=l.cts,d=j(),h=d+f/g,p=h+l.duration/g;t.buffered.add(h,p);var y=new DataView(e,l.offset,l.subSizes[0]),E=Ea.Utils.dataViewToString(y,a.Z.UTF8),v=[],_=l.offset+l.subSizes[0];for(u=1;u<l.subSizes.length;u++){var T=new Uint8Array(e,_,l.subSizes[u]),S=String.fromCharCode.apply(null,T);v.push(S),_+=l.subSizes[u];}try{var b=A.getValue().ttmlTimeIsRelative?f/g:0,I=o.parse(E,b,f/g,(f+l.duration)/g,v);N.addCaptions(m,d,I);}catch(e){c.removeExecutedRequestsBeforeTime(),this.remove(),n.error("TTML parser error: "+e.message);}}}(e,u,s):function(e,r){var i,a,o,s=[];for(i=0;i<r.length;i++){var u=r[i];u.cts-=p;var l=j()+u.cts/g,c=l+u.duration/g;t.buffered.add(l,c);var f=e.slice(u.offset,u.offset+u.size),d=Ea.parseBuffer(f);for(a=0;a<d.boxes.length;a++){var h=d.boxes[a];if(n.debug("VTT box1: "+h.type),"vtte"!==h.type&&"vttc"===h.type){n.debug("VTT vttc boxes.length = "+h.boxes.length);var y={styles:{}};for(o=0;o<h.boxes.length;o++){var E=h.boxes[o];if(n.debug("VTT box2: "+E.type),"payl"===E.type)y.start=u.cts/g,y.end=(u.cts+u.duration)/g,y.data=E.cue_text;else if("sttg"===E.type&&E.settings&&""!==E.settings)try{var v=E.settings.split(" ");y.styles=D.getCaptionStyles(v);}catch(e){}}y&&y.data&&(s.push(y),n.debug("VTT  ".concat(y.start," - ").concat(y.end," :  ").concat(y.data)));}}}s.length>0&&N.addCaptions(m,0,s);}(e,u);}}(e,s,h):l===a.Z.VIDEO?function(e,t){var a,o;if(t.segmentType===C.w.INIT_SEGMENT_TYPE)0===E&&(E=r.getMediaTimescaleFromMoov(e));else if(t.segmentType===C.w.MEDIA_SEGMENT_TYPE){if(0===E)return void n.warn("CEA-608: No timescale for embeddedTextTrack yet");var s=(o=r.getSamplesInfo(e)).lastSequenceNumber;if(_[0]||_[1]||function(){for(var e,t=0;t<y.length;t++){if(-1===(e=N.getTrackIdxForId(y[t].id)))return void n.warn("CEA-608: data before track is ready.");var r=Y(e);_[t]=new(i().Cea608Parser)(t+1,{newCue:r},null);}}(),E){if(null!==v&&s!==v+o.numSequences)for(a=0;a<_.length;a++)_[a]&&_[a].reset();for(var u=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),a=0;a<t.length;a++)for(var o=t[a],s=i().findCea608Nalus(r,o.offset,o.size),u=null,l=0,c=0;c<s.length;c++)for(var f=i().extractCea608DataFromRange(r,s[c]),d=0;d<2;d++)if(f[d].length>0){o.cts!==u?l=0:l+=1;var g=j();n.fields[d].push([o.cts+g*E,f[d],l]),u=o.cts;}return n.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0];});}),n;}(e,o.sampleList),l=0;l<_.length;l++){var c=u.fields[l],f=_[l];if(f)for(a=0;a<c.length;a++)f.addData(c[a][0]/E,c[a][1]);}v=s;}}}(e,s):function(e,n,r){var i,o,s=new DataView(e,0,e.byteLength);o=Ea.Utils.dataViewToString(s,a.Z.UTF8);try{i=H(r).parse(o,0),N.addCaptions(N.getCurrentTrackIdx(),0,i),t.buffered&&t.buffered.add(n.start,n.end);}catch(e){b.error(new S.Z(w.TIMED_TEXT_ERROR_ID_PARSE_CODE,w.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,o));}}(e,s,h):n.error("No text type defined");}function Y(e){return function(t,n,r){var i;(i=R.getTTMLRenderingDiv()?T.createHTMLCaptionsFromScreen(R.getElement(),t,n,r):[{start:t,end:n,data:r.getDisplayText(),styles:{}}])&&N.addCaptions(e,0,i);};}function j(){return isNaN(t.timestampOffset)?0:t.timestampOffset;}function H(e){var t;return e.search(a.Z.VTT)>=0?t=L.get().streaming.text.webvtt.customRenderingEnabled&&O?O:D:(e.search(a.Z.TTML)>=0||e.search(a.Z.STPP)>=0)&&(t=M),t;}function V(e){y.forEach(function(t){var n=N.getTrackIdxForId(t.id);n>=0&&N.deleteCuesFromTrackIdx(n,e.from,e.to);});}return t={initialize:function(){k||(y=[],m=null,E=0,_=[],v=null,k=!0,T=Ra(x).getInstance(),F.on(l.Z.VIDEO_CHUNK_RECEIVED,B,t),F.on(l.Z.BUFFER_CLEARED,V,t));},addMediaInfos:function(e,n,r){if(s=s.concat(n),e===a.Z.TEXT&&n[0].isFragmented&&!n[0].isEmbedded){c=r,t.buffered=(0, Aa.Z)(x).create(),h=I.getTracksFor(a.Z.TEXT,P.id).filter(function(e){return e.isFragmented;});for(var i=I.getCurrentTrackFor(a.Z.TEXT,P.id),o=0;o<h.length;o++)if(h[o]===i){G(o);break;}}for(var u=0;u<n.length;u++)Z(n[u]);},resetMediaInfos:function(){s=[];},getStreamId:function(){return P.id;},append:q,abort:function(){},addEmbeddedTrack:function(e){if(k&&e)if(e.id===a.Z.CC1||e.id===a.Z.CC3){for(var t=0;t<y.length;t++)if(y[t].id===e.id)return;y.push(e);}else n.warn("Embedded track "+e.id+" not supported!");},resetEmbedded:function(){F.off(l.Z.VIDEO_CHUNK_RECEIVED,B,t),F.off(l.Z.BUFFER_CLEARED,V,t),N&&N.deleteAllTextTracks(),k=!1,y=[],_=[null,null],v=null;},getConfig:function(){return {fragmentModel:c,fragmentedTracks:h,videoModel:R};},setCurrentFragmentedTrackIdx:G,remove:function(e,n){void 0===e&&e===n&&(e=t.buffered.start(0),n=t.buffered.end(t.buffered.length-1)),t.buffered.remove(e,n),N.deleteCuesFromTrackIdx(m,e,n);},reset:function(){U(),s=[],r=null;}},n=(0, f.Z)(x).getInstance().getLogger(t),r=(0, xt.Z)(x).getInstance(),U(),t;}wa.__dashjs_factory_name="TextSourceBuffer";const Na=c.Z.getClassFactory(wa);var Ca=n(4403);function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r;}var Oa=["text","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function Ma(e){var t,n,r,i,o,s,c,g,h,p,m,y,E,v,_,T,S,b,A=this.context,I=(0, u.Z)(A).getInstance(),R=e.videoModel,w=e.streamInfo,N=e.settings;function C(e,t,n,r,i,a){var o=0,s=0;e/t>n/r?o=(s=t)/r*n:s=(o=e)/n*r;var u,l,c=0,f=0;return o/s>i?(f=s,c=s*i):(c=o,f=o/i),u=(e-c)/2,l=(t-f)/2,a?{x:u+.1*c,y:l+.1*f,w:.8*c,h:.8*f}:{x:u,y:l,w:c,h:f};}function D(e,t){var n=R.getClientWidth(),r=R.getClientHeight(),i=R.getVideoWidth(),a=R.getVideoHeight(),o=R.getVideoRelativeOffsetTop(),s=R.getVideoRelativeOffsetLeft();if(0!==i&&0!==a){var u=i/a,l=!1;e.isFromCEA608&&(u=3.5/3,l=!0);var f=C.call(this,n,r,i,a,u,l),y=f.w,E=f.h,T=f.x,b=f.y;if(y!=h||E!=p||T!=c||b!=g||t){if(c=T+s,g=b+o,h=y,p=E,m){var A=m.style;A&&(A.left=c+"px",A.top=g+"px",A.width=h+"px",A.height=p+"px",A.zIndex=v&&document[v]||_?S:null,I.trigger(d.Z.CAPTION_CONTAINER_RESIZE));}var w=e.activeCues;if(w)for(var N=w.length,D=0;D<N;++D){var O=w[D];O.scaleCue(O);}}}}function O(e){var t,n,r,i,a,o=h,s=p;if(e.cellResolution){var u=[o/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){n=(e.linePadding[t]*u[0]).toString();for(var l=document.getElementsByClassName("spanPadding"),c=0;c<l.length;c++)l[c].style.cssText=l[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),l[c].style.cssText=l[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n);}if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),n=(r*u[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var f=0;f<a.length;f++)a[f].style.cssText=a[f].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n);}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),n=(i*u[1]).toString(),a=document.getElementsByClassName(t);for(var d=0;d<a.length;d++)a[d].style.cssText=a[d].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n);}}}if(e.isd){var g=document.getElementById(e.cueID);g&&m.removeChild(g),P(e);}}function M(e,t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),a=parseInt(i[4],10)-1;return "data:image/png;base64,"+btoa(e.images[a]);}if(r.test(t)){var o=r.exec(t)[1];return "data:image/png;base64,"+e.embeddedImages[o];}return t;}function P(e){if(m){var t=document.createElement("div");m.appendChild(t),T=(0, Ca.renderHTML)(e.isd,t,function(t){return M(e,t);},m.clientHeight,m.clientWidth,!1,function(e){n.info("renderCaption :",e);},T,!0),t.id=e.cueID,I.trigger(d.Z.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:s});}}function L(e,t){if(!N.get().streaming.text.extendSegmentedCues)return !1;if(!t.cues||0===t.cues.length)return !1;var n=t.cues[t.cues.length-1];return !(n.endTime<e.startTime||!function(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if(JSON.stringify(e[i])!==JSON.stringify(t[i]))return !1;}return !0;}(n,e,Oa)||(n.endTime=Math.max(n.endTime,e.endTime),0));}function x(e,t){t&&t.forEach(function(t){t.kind&&"image"===t.kind&&(t.src=M(e,t.src)),x(e,t.contents);});}function F(e,t,r){var i=B(e);if(i&&Array.isArray(r)&&0!==r.length)for(var a=0;a<r.length;a++){var o=void 0,s=r[a];i.cellResolution=s.cellResolution,i.isFromCEA608=s.isFromCEA608,isNaN(s.start)||isNaN(s.end)||(o="html"===s.type&&m?k(s,t,i):s.data?U(s,t,i):null);try{o?Y(i,o)||(N.get().streaming.text.webvtt.customRenderingEnabled?(i.manualCueList||(i.manualCueList=[]),i.manualCueList.push(o)):L(o,i)||i.addCue(o)):n.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)");}catch(e){throw H(i),i.addCue(o),e;}}}function k(e,t,i){var o=this,u=new r(e.start+t,e.end+t,"");return u.cueHTMLElement=e.cueHTMLElement,u.isd=e.isd,u.images=e.images,u.embeddedImages=e.embeddedImages,u.cueID=e.cueID,u.scaleCue=O.bind(o),u.cellResolution=e.cellResolution,u.lineHeight=e.lineHeight,u.linePadding=e.linePadding,u.fontSize=e.fontSize,m.style.left=c+"px",m.style.top=g+"px",m.style.width=h+"px",m.style.height=p+"px",u.isd&&x(u,u.isd.contents),u.onenter=function(){i.mode===a.Z.TEXT_SHOWING&&(this.isd?(P(this),n.debug("Cue enter id:"+this.cueID)):(m.appendChild(this.cueHTMLElement),O.call(o,this),I.trigger(d.Z.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:s})));},u.onexit=function(){if(m)for(var e=m.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(n.debug("Cue exit id:"+e[t].id),m.removeChild(e[t]),--t);},u;}function U(e,t,i){var o=new r(e.start-t,e.end-t,e.data);if(o.cueID="".concat(o.startTime,"_").concat(o.endTime),o.isActive=!1,e.styles)try{void 0!==e.styles.align&&"align"in o&&(o.align=e.styles.align),void 0!==e.styles.line&&"line"in o&&(o.line=e.styles.line),void 0!==e.styles.snapToLines&&"snapToLines"in o&&(o.snapToLines=e.styles.snapToLines),void 0!==e.styles.position&&"position"in o&&(o.position=e.styles.position),void 0!==e.styles.size&&"size"in o&&(o.size=e.styles.size);}catch(e){n.error(e);}return o.onenter=function(){i.mode===a.Z.TEXT_SHOWING&&I.trigger(d.Z.CAPTION_RENDERED,{currentTrackIdx:s});},o;}function Z(){var e,t=[],n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Da(e,t):void 0;}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return {s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function(e){throw e;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var a,o=!0,s=!1;return {s:function(){n=e[Symbol.iterator]();},n:function(){var e=n.next();return o=e.done,e;},e:function(e){s=!0,a=e;},f:function(){try{o||null==n.return||n.return();}finally{if(s)throw a;}}};}(R.getTextTracks());try{for(n.s();!(e=n.n()).done;){var r=e.value;r.manualMode===a.Z.TEXT_SHOWING&&t.push(r);}}catch(e){n.e(e);}finally{n.f();}return t;}function B(e){return e>=0&&i[e]?R.getTextTrack(i[e].kind,i[e].id,i[e].lang,i[e].isTTML,i[e].isEmbedded):null;}function G(e){var t=this;if(e!==s){var n=B(s=e);q.call(this,n),E&&(clearInterval(E),E=null),n&&"html"===n.renderingType&&(D.call(this,n,!0),window.ResizeObserver?(b=new window.ResizeObserver(function(){D.call(t,n,!0);})).observe(R.getElement()):E=setInterval(D.bind(this,n),500));}}function q(e){z.call(this),e&&"html"===e.renderingType?V.call(this):K.call(this);}function Y(e,t){if(!e.cues)return !1;for(var n=0;n<e.cues.length;n++)if(e.cues[n].startTime===t.startTime&&e.cues[n].endTime===t.endTime)return !0;return !1;}function j(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return (isNaN(t)||(r?e.startTime:e.endTime)>=t)&&(isNaN(n)||(r?e.endTime:e.startTime)<=n);}function H(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.cues)for(var i=e.cues,a=i.length-1,o=a;o>=0;o--)j(i[o],t,n,r)&&(i[o].onexit&&i[o].onexit(),e.removeCue(i[o]));}function V(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,r=R.getElement();try{r&&(r.id?t.insertRule("#"+r.id+"::cue {background: transparent}",0):0!==r.classList.length?t.insertRule("."+r.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0));}catch(e){n.info(""+e.message);}}}function K(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e);}function z(){if(m)for(;m.firstChild;)m.removeChild(m.firstChild);}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(r=window.VTTCue||window.TextTrackCue,i=[],o=[],s=-1,c=0,g=0,h=0,p=0,m=null,y=null,E=null,_=!1,S=2147483647,T=null,void 0!==document.fullscreenElement?v="fullscreenElement":void 0!==document.webkitIsFullScreen?v="webkitIsFullScreen":document.msFullscreenElement?v="msFullscreenElement":document.mozFullScreen&&(v="mozFullScreen"));},getStreamId:function(){return w.id;},addTextTrack:function(e){i.push(e);},addCaptions:F,createTracks:function(){i.sort(function(e,t){return e.index-t.index;}),m=R.getTTMLRenderingDiv(),y=R.getVttRenderingDiv();for(var e,t,n,r,u,c,f=-1,g=0;g<i.length;g++){var h=(t=(e=i[g]).kind,n=void 0!==e.id?e.id:e.lang,r=e.lang,u=e.isTTML,c=e.isEmbedded,R.addTextTrack(t,n,r,u,c));o.push(h),i[g].defaultTrack&&(h.default=!0,f=g);var p=B(g);p&&(p.mode=a.Z.TEXT_SHOWING,m&&(i[g].isTTML||i[g].isEmbedded)?p.renderingType="html":p.renderingType="default"),F(g,0,i[g].captionData),I.trigger(d.Z.TEXT_TRACK_ADDED);}if(G.call(this,f),f>=0){I.on(d.Z.PLAYBACK_METADATA_LOADED,function e(){var t=B(f);t&&"html"===t.renderingType&&D.call(this,t,!0),I.off(d.Z.PLAYBACK_METADATA_LOADED,e,this);},this);for(var E=0;E<i.length;E++){var v=B(E);v&&(v.mode=E===f?a.Z.TEXT_SHOWING:a.Z.TEXT_HIDDEN,v.manualMode=E===f?a.Z.TEXT_SHOWING:a.Z.TEXT_HIDDEN);}}I.trigger(l.Z.TEXT_TRACKS_QUEUE_INITIALIZED,{index:s,tracks:i,streamId:w.id});},getCurrentTrackIdx:function(){return s;},setCurrentTrackIdx:G,getTrackIdxForId:function(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].id===e){t=n;break;}return t;},getCurrentTrackInfo:function(){return i[s];},setModeForTrackIdx:function(e,t){var n=B(e);n&&n.mode!==t&&(n.mode=t),n&&n.manualMode!==t&&(n.manualMode=t);},deleteCuesFromTrackIdx:function(e,t,n){var r=B(e);r&&H(r,t,n);},deleteAllTextTracks:function(){for(var e=o?o.length:0,t=0;t<e;t++){var n=B(t);n&&H.call(this,n,w.start,w.start+w.duration,!1);}o=[],i=[],E&&(clearInterval(E),E=null),b&&R&&(b.unobserve(R.getElement()),b=null),s=-1,z.call(this);},deleteTextTrack:function(e){R.removeChild(o[e]),o.splice(e,1);},manualCueProcessing:function(e){var t=Z();if(t&&t.length>0){var n=t[0].manualCueList;n&&n.length>0&&n.forEach(function(t){if(t.startTime<=e&&t.endTime>=e&&!t.isActive)t.isActive=!0,WebVTT.processCues(window,[t],y,t.cueID);else if(t.isActive&&(t.startTime>e||t.endTime<e)&&(t.isActive=!1,y))for(var n=y.childNodes,r=0;r<n.length;++r)n[r].id===t.cueID&&(y.removeChild(n[r]),--r);});}},disableManualTracks:function(){var e=Z();if(e&&e.length>0){var t=e[0].manualCueList;t&&t.length>0&&t.forEach(function(e){if(e.isActive&&(e.isActive=!1,y))for(var t=y.childNodes,n=0;n<t.length;++n)t[n].id===e.cueID&&(y.removeChild(t[n]),--n);});}}},n=(0, f.Z)(A).getInstance().getLogger(t),t;}Ma.__dashjs_factory_name="TextTracks";const Pa=c.Z.getClassFactory(Ma);function La(){var e,t,n,r,i,a,o=this.context;function s(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e;}function u(e){var t=e.split(r),n=t[1].split(a);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:l(n)};}function l(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1],r=!1;n&&-1!=n.search(/%/)&&(r=!0,n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line="auto"===n?n:parseInt(n,10),r&&(t.snapToLines=!1)),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n);}}),t;}function c(e,t){for(var n,i=t,a="",o="";""!==e[i]&&i<e.length;)i++;if((n=i-t)>1)for(var s=0;s<n;s++){if((o=e[t+s]).match(r)){a="";break;}a+=o,s!==n-1&&(a+="\n");}else (o=e[t]).match(r)||(a=o);return a;}return e={parse:function(e){var a,o,l=[];if(!e)return l;a=(e=e.split(n)).length,o=-1;for(var f=0;f<a;f++){var d=e[f];if(d.length>0&&"WEBVTT"!==d&&d.match(r)){var g=u(d),h=g.cuePoints,p=g.styles,m=c(e,f+1),y=s(h[0].replace(i,"")),E=s(h[1].replace(i,""));!isNaN(y)&&!isNaN(E)&&y>=o&&E>y?""!==m?(o=y,l.push({start:y,end:E,data:m,styles:p})):t.error("Skipping cue due to empty/malformed cue text"):t.error("Skipping cue due to incorrect cue timing");}}return l;},getCaptionStyles:l},t=(0, f.Z)(o).getInstance().getLogger(e),n=/(?:\r\n|\r|\n)/gm,r=/-->/,i=/(^[\s]+|[\s]+$)/g,a=/\s\b/g,e;}La.__dashjs_factory_name="VTTParser";const xa=c.Z.getSingletonFactory(La);function Fa(){var e,t;return e={parse:function(e){var n=[];return t.oncue=function(e){e.start=e.startTime,e.end=e.endTime,e.data=e.text,e.styles={align:e.align,line:e.line,position:e.position,size:e.size},n.push(e);},t.parse(e),n;}},function(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(t=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()));}catch(e){}}(),e;}Fa.__dashjs_factory_name="VttCustomRenderingParser";const ka=c.Z.getSingletonFactory(Fa);function Ua(){var e,t,n=this.context,r=(0, u.Z)(n).getInstance(),i=0;return e={parse:function(e,n,a,o,s){var u,c,f,g="",h=[],p={},m={},y="",E="",v={onOpenTag:function(e,n,i){if(i[" imagetype"]&&!i[" imageType"]&&(r.trigger(d.Z.CONFORMANCE_VIOLATION,{level:nn.LEVELS.ERROR,event:nn.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),i[" imageType"]=i[" imagetype"]),"image"===n&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!i[" imageType"]||"PNG"!==i[" imageType"].value)return void t.warn("smpte-tt imageType != PNG. Discarded");y=i["http://www.w3.org/XML/1998/namespace id"].value;}},onCloseTag:function(){y&&(m[y]=E.trim()),E="",y="";},onText:function(e){y&&(E+=e);}};if(!e)throw g="no ttml data to parse",new Error(g);p.data=e,r.trigger(l.Z.TTML_TO_PARSE,p);var _=(0, Ca.fromXML)(p.data,function(e){g=e;},v);r.trigger(l.Z.TTML_PARSED,{ttmlString:p.data,ttmlDoc:_});var T,S=_.getMediaTimeEvents();for(f=0;f<S.length;f++){var b=(0, Ca.generateISD)(_,S[f],function(e){g=e;});b.contents.some(function(e){return e.contents.length;})&&(u=S[f]+n)<(c=S[f+1]+n)&&h.push({start:u,end:c,type:"html",cueID:(T="cue_TTML_"+i,i++,T),isd:b,images:s,embeddedImages:m});}if(""!==g)throw t.error(g),new Error(g);return h;}},t=(0, f.Z)(n).getInstance().getLogger(e),e;}Ua.__dashjs_factory_name="TTMLParser";const Za=c.Z.getSingletonFactory(Ua);function Ba(e){var t,n,r,i,o,s,c,f,g,h,p,m,y=this.context,E=e.adapter,v=e.errHandler,_=e.manifestModel,T=e.mediaController,S=e.videoModel,b=e.settings;function A(e){var t=e.tracks,r=e.index,i=e.streamId;if(!1===b.get().streaming.text.defaultEnabled&&!w()||m)N(i,-1);else {var o=T.getCurrentTrackFor(a.Z.TEXT,i);if(o){var s={lang:o.lang,role:o.roles[0],index:o.index,codec:o.codec,accessibility:o.accessibility[0]};t.some(function(e,t){if(T.matchSettings(s,e))return N(i,t),r=t,!0;});}g=!1;}n[i].lastEnabledIndex=r,f.trigger(d.Z.TEXT_TRACKS_ADDED,{enabled:w(),index:r,tracks:t,streamId:i}),p=!0;}function I(e){try{var t=e.streamId;if(!i[t]||isNaN(e.time))return;i[t].manualCueProcessing(e.time);}catch(e){}}function R(e){try{var t=e.streamId;if(!i[t])return;i[t].disableManualTracks();}catch(e){}}function w(){var e=!0;return g&&!h&&(e=!1),e;}function N(e,t){(g=-1===t)&&T&&T.saveTextSettingsDisabled();var n=C(e);if(n!==t&&i[e]){i[e].disableManualTracks(),i[e].setModeForTrackIdx(n,a.Z.TEXT_HIDDEN),i[e].setCurrentTrackIdx(t),i[e].setModeForTrackIdx(t,a.Z.TEXT_SHOWING);var o=i[e].getCurrentTrackInfo();o&&o.isFragmented&&!o.isEmbedded?function(e,t,n){if(r[e])for(var o=r[e].getConfig().fragmentedTracks,s=0;s<o.length;s++){var u=o[s];if(t.lang===u.lang&&(u.id?t.id===u.id:t.index===u.index)){var c=T.getCurrentTrackFor(a.Z.TEXT,e);(u.id?c.id!==u.id:c.index!==u.index)?(i[e].deleteCuesFromTrackIdx(n),r[e].setCurrentFragmentedTrackIdx(s)):-1===n&&f.trigger(l.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:e,mediaType:a.Z.TEXT});}}}(e,o,n):o&&!o.isFragmented&&function(e,t){f.trigger(l.Z.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:t},{streamId:e,mediaType:a.Z.TEXT});}(e,o),T.setTrack(o);}}function C(e){return i[e].getCurrentTrackIdx();}function D(){r={},i={},n={},g=!0,p=!1,m=!1;}return t={deactivateStream:function(e){if(e){var t=e.id;r[t]&&r[t].resetMediaInfos(),i[t]&&i[t].deleteAllTextTracks();}},initialize:function(){f.on(l.Z.TEXT_TRACKS_QUEUE_INITIALIZED,A,t),b.get().streaming.text.webvtt.customRenderingEnabled&&(f.on(l.Z.PLAYBACK_TIME_UPDATED,I,t),f.on(l.Z.PLAYBACK_SEEKING,R,t));},initializeForStream:function(e){var t=e.id,a=Pa(y).create({videoModel:S,settings:b,streamInfo:e});a.initialize(),i[t]=a;var u=Na(y).create({errHandler:v,adapter:E,manifestModel:_,mediaController:T,videoModel:S,textTracks:a,vttParser:o,vttCustomRenderingParser:s,ttmlParser:c,streamInfo:e,settings:b});u.initialize(),r[t]=u,n[t]={},n[t].lastEnabledIndex=-1;},createTracks:function(e){var t=e.id;i[t]&&i[t].createTracks();},getTextSourceBuffer:function(e){var t=e.id;if(r&&r[t])return r[t];},getAllTracksAreDisabled:function(){return g;},addEmbeddedTrack:function(e,t){var n=e.id;r[n]&&r[n].addEmbeddedTrack(t);},enableText:function(e,t){return (0, z.PS)(t,"boolean"),w()!==t&&(t&&N(e,n[e].lastEnabledIndex),t||(n[e].lastEnabledIndex=C(e),p?N(e,-1):m=!0)),!0;},isTextEnabled:w,setTextTrack:N,getCurrentTrackIdx:C,enableForcedTextStreaming:function(e){return (0, z.PS)(e,"boolean"),h=e,!0;},addMediaInfosToBuffer:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.id;r[a]&&r[a].addMediaInfos(t,n,i);},reset:function(){D(),f.off(l.Z.TEXT_TRACKS_QUEUE_INITIALIZED,A,t),b.get().streaming.text.webvtt.customRenderingEnabled&&(f.off(l.Z.PLAYBACK_TIME_UPDATED,I,t),f.off(l.Z.PLAYBACK_SEEKING,R,t)),Object.keys(r).forEach(function(e){r[e].resetEmbedded(),r[e].reset();});}},h=!1,p=!1,m=!1,o=xa(y).getInstance(),s=ka(y).getInstance(),c=Za(y).getInstance(),f=(0, u.Z)(y).getInstance(),D(),t;}Ba.__dashjs_factory_name="TextController";const Ga=c.Z.getClassFactory(Ba);function qa(){var e,t,n,r,g,p,m,y,E,v,_,T,b,A,I,R,D,O,M,P,L,x,F,k,U,Z,B,G,q,Y,j,H,V,K,W,J,$,ee,te,ne="You must first call initialize() and set a source before calling this method",re="You must first call initialize() and set a valid source and view before calling this method",ie="You must first call attachView() to set the video element before calling this method",ae="You must first call attachSource() with a valid source before calling this method",oe="MediaPlayer not initialized!",se=this.context,ue=(0, u.Z)(se).getInstance(),le=(0, N.Z)(se).getInstance(),ce=(0, f.Z)(se).getInstance({settings:le});function fe(){Ie(null),be(null),r=null,A&&(A.reset(),A=null),I&&(I.reset(),I=null),P&&P.reset(),le.reset(),D&&(D.reset(),D=null);}function de(){return !!n&&!!J.getElement();}function ge(){return (0, Ci.e)();}function he(){if(!m)throw re;return G.isPaused();}function pe(){if(!m)throw re;return G.getIsDynamic();}function me(e){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=H.getCurrentDVRInfo(t);if(!n)return 0;var r=G.getOriginalLiveDelay(),i=n.range.start+e;return i>n.range.end-r&&(i=n.range.end-r),i;}function ye(e){if(!m)throw re;var t=Se().currentTime;if(void 0!==e)t=U.getTimeRelativeToStreamId(t,e);else if(G.getIsDynamic()){var n=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,r=H.getCurrentDVRInfo(n);t=null===r||0===t?0:Math.max(0,t-r.range.start);}return t;}function Ee(){if(!m)throw re;var e=Se().duration;if(G.getIsDynamic()){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=H.getCurrentDVRInfo(t);e=n?n.range.end-n.range.start:0;}return e;}function ve(e){(0, z.PS)(e,"boolean"),y=e;}function _e(){P.restoreDefaultUTCTimingSources();}function Te(){return H;}function Se(){if(!J.getElement())throw ie;return J.getElement();}function be(e){if(!g)throw oe;J.setElement(e),e&&(De(),function(){if(!I){var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(se).create();I=t.createMetricsReporting({debug:ce,eventBus:ue,mediaElement:Se(),adapter:O,dashMetrics:H,mediaPlayerModel:M,events:l.Z,constants:a.Z,metricsConstants:s.Z});}}}(),function(){if(!R){var e=dashjs.MssHandler;"function"==typeof e&&(w.extend(e.errors),R=e(se).create({eventBus:ue,mediaPlayerModel:M,dashMetrics:H,manifestModel:V,playbackController:G,streamController:U,protectionController:A,baseURLController:x,errHandler:L,events:l.Z,constants:a.Z,debug:ce,initSegmentType:C.w.INIT_SEGMENT_TYPE,BASE64:ya,ISOBoxer:Ea,settings:le}));}}(),U&&U.switchToVideoElement(E)),m&&we(),Pe(E);}function Ae(e){if(!p)throw ne;var t=U.getActiveStreamInfo();return t?b.getTracksFor(e,t.id):[];}function Ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;if(!g)throw oe;"string"==typeof e&&$.initialize(e),null==t&&(t=NaN),isNaN(t)||(t=Math.max(0,t)),E=t,n=e,(p||m)&&we(),de()&&Pe(E);}function Re(){if(!p)throw ne;var e=U.getActiveStreamInfo();return e?U.getStreamById(e.id):null;}function we(){m=!1,p=!1,O.reset(),U.reset(),B.reset(),j.reset(),G.reset(),q.reset(),Y.reset(),v.reset(),b.reset(),te.reset(),A&&(le.get().streaming.protection.keepProtectionMediaKeys?A.stop():(A.reset(),A=null,De())),Z.reset(),K.reset(),W.reset();}function Ne(){var e=Ce();U||(U=on(se).getInstance()),Z||(Z=Ga(se).create({errHandler:L,manifestModel:V,adapter:O,mediaController:b,videoModel:J,settings:le})),k.setConfig({capabilities:F,customParametersModel:P,adapter:O,settings:le,manifestModel:V,errHandler:L}),U.setConfig({capabilities:F,capabilitiesFilter:k,manifestLoader:e,manifestModel:V,mediaPlayerModel:M,customParametersModel:P,protectionController:A,textController:Z,adapter:O,dashMetrics:H,errHandler:L,timelineConverter:T,videoModel:J,playbackController:G,serviceDescriptionController:q,contentSteeringController:Y,abrController:v,mediaController:b,settings:le,baseURLController:x,uriFragmentModel:$,segmentBaseController:te}),B.setConfig({settings:le,playbackController:G,streamController:U,videoModel:J,timelineConverter:T,adapter:O}),G.setConfig({streamController:U,serviceDescriptionController:q,dashMetrics:H,adapter:O,videoModel:J,timelineConverter:T,settings:le}),j.setConfig({streamController:U,playbackController:G,mediaPlayerModel:M,videoModel:J,settings:le}),v.setConfig({streamController:U,domStorage:ee,mediaPlayerModel:M,customParametersModel:P,cmsdModel:W,dashMetrics:H,adapter:O,videoModel:J,settings:le}),K.setConfig({abrController:v,dashMetrics:H,playbackController:G}),W.setConfig({}),v.initialize(),U.initialize(y,r),Z.initialize(),B.initialize(),j.initialize(),K.initialize(),W.initialize(),Y.initialize(),te.initialize();}function Ce(){return Hr(se).create({debug:ce,errHandler:L,dashMetrics:H,mediaPlayerModel:M,requestModifier:(0, X.Z)(se).getInstance(),mssHandler:R,settings:le});}function De(){if(A)return A;var e=dashjs.Protection;if("function"==typeof e){var t=e(se).create();return l.Z.extend(e.events),d.Z.extend(e.events,{publicOnly:!0}),w.extend(e.errors),F||(F=(0, zr.Z)(se).getInstance()),A=t.createProtectionSystem({debug:ce,errHandler:L,videoModel:J,customParametersModel:P,capabilities:F,eventBus:ue,events:l.Z,BASE64:ya,constants:a.Z,cmcdModel:K,settings:le});}return null;}function Oe(){if(!g)throw oe;if(D)return D;var e=dashjs.OfflineController;if("function"==typeof e){l.Z.extend(e.events),d.Z.extend(e.events,{publicOnly:!0}),w.extend(e.errors);var t=Ce(),n=zt(se).create();return n.setConfig({manifestModel:V,adapter:O,manifestLoader:t,errHandler:L,contentSteeringController:Y}),D=e(se).create({debug:ce,manifestUpdater:n,baseURLController:x,manifestLoader:t,manifestModel:V,mediaPlayerModel:M,abrController:v,playbackController:G,adapter:O,errHandler:L,dashMetrics:H,timelineConverter:T,segmentBaseController:te,schemeLoaderFactory:_,eventBus:ue,events:l.Z,errors:w,constants:a.Z,settings:le,dashConstants:o.Z,urlUtils:(0, Q.Z)(se).getInstance()});}return null;}function Me(e){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=H.getCurrentDVRInfo(t);return n?e+(n.manifestInfo.availableFrom.getTime()/1e3+n.range.start):0;}function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN;D&&D.resetRecords(),!p&&n&&(p=!0,t.info("Streaming Initialized"),Ne(),"string"==typeof n?U.load(n,e):U.loadWithManifest(n,e)),!m&&de()&&(m=!0,t.info("Playback Initialized"));}return e={initialize:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NaN;F||(F=(0, zr.Z)(se).getInstance()).setConfig({settings:le}),L||(L=Kr(se).getInstance()),F.supportsMediaSource()?(g||(g=!0,T=ma(se).getInstance(),v||(v=yi(se).getInstance()).setConfig({settings:le}),_||(_=yt(se).getInstance()),G||(G=h(se).getInstance()),b||(b=Tn(se).getInstance()),U||(U=on(se).getInstance()),B||(B=un(se).getInstance()),j||(j=cn(se).getInstance()),q||(q=pn(se).getInstance()),Y||(Y=jt(se).getInstance()),k||(k=Xr(se).getInstance()),O=Xi(se).getInstance(),V=ti(se).getInstance(),K=je(se).getInstance(),W=lt(se).getInstance(),H=ha(se).getInstance({settings:le}),ee=Ni(se).getInstance({settings:le}),O.setConfig({constants:a.Z,cea608parser:i(),errHandler:L,BASE64:ya}),x||(x=xn(se).create()),x.setConfig({adapter:O,contentSteeringController:Y}),q.setConfig({adapter:O}),te||(te=Ui(se).getInstance({dashMetrics:H,mediaPlayerModel:M,errHandler:L,baseURLController:x,events:l.Z,eventBus:ue,debug:ce,boxParser:(0, xt.Z)(se).getInstance(),requestModifier:(0, X.Z)(se).getInstance(),errors:w})),b.setConfig({domStorage:ee,settings:le,customParametersModel:P}),M.setConfig({playbackController:G,serviceDescriptionController:q}),Y.setConfig({adapter:O,errHandler:L,dashMetrics:H,mediaPlayerModel:M,manifestModel:V,serviceDescriptionController:q,eventBus:ue,requestModifier:(0, X.Z)(se).getInstance()}),_e(),ve(void 0===r||r),Oe()),e&&be(e),n&&Ie(n,o),t.info("[dash.js "+ge()+"] MediaPlayer has been initialized")):L.error(new S.Z(w.CAPABILITY_MEDIASOURCE_ERROR_CODE,w.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));},setConfig:function(e){e&&(e.capabilities&&(F=e.capabilities),e.capabilitiesFilter&&(k=e.capabilitiesFilter),e.streamController&&(U=e.streamController),e.textController&&(Z=e.textController),e.gapController&&(B=e.gapController),e.playbackController&&(G=e.playbackController),e.serviceDescriptionController&&(q=e.serviceDescriptionController),e.contentSteeringController&&(Y=e.contentSteeringController),e.catchupController&&(j=e.catchupController),e.mediaPlayerModel&&(M=e.mediaPlayerModel),e.customParametersModel&&(P=e.customParametersModel),e.abrController&&(v=e.abrController),e.schemeLoaderFactory&&(_=e.schemeLoaderFactory),e.mediaController&&(b=e.mediaController),e.settings&&(le=e.settings));},on:function(e,t,n,r){ue.on(e,t,n,r);},off:function(e,t,n){ue.off(e,t,n);},extend:function(e,t,n){c.Z.extend(e,t,n,se);},attachView:be,attachSource:Ie,isReady:de,preload:function(){if(!J.getElement()&&!p){if(!n)throw ae;Pe(E);}},play:function(){if(!m)throw re;(!y||he()&&m)&&G.play(!0);},isPaused:he,pause:function(){if(!m)throw re;G.pause();},isSeeking:function(){if(!m)throw re;return G.isSeeking();},isDynamic:pe,getLowLatencyModeEnabled:function(){if(!m)throw re;return G.getLowLatencyModeEnabled();},seek:function(e){if(!m)throw re;if((0, z.PS)(e,"number"),isNaN(e))throw a.Z.BAD_ARGUMENT_ERROR;e<0&&(e=0);var t=G.getIsDynamic()?me(e):e,n=Se();!G.getIsDynamic()&&n.duration&&(t=Math.min(n.duration,t)),G.seek(t,!1,!1,!0);},seekToOriginalLive:function(){m&&pe()&&G.seekToOriginalLive();},setPlaybackRate:function(e){Se().playbackRate=e;},getPlaybackRate:function(){return Se().playbackRate;},setMute:function(e){(0, z.PS)(e,"boolean"),Se().muted=e;},isMuted:function(){return Se().muted;},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw a.Z.BAD_ARGUMENT_ERROR;Se().volume=e;},getVolume:function(){return Se().volume;},time:ye,duration:Ee,timeAsUTC:function(){if(!m)throw re;return ye()<0?NaN:Me(ye());},durationAsUTC:function(){if(!m)throw re;return Me(Ee());},getActiveStream:Re,getDVRWindowSize:function(){var e=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,t=H.getCurrentDVRInfo(e);return t?t.manifestInfo.dvrWindowSize:0;},getDVRSeekOffset:me,getAvailableBaseUrls:function(){var e=V.getValue();return e?x.getBaseUrls(e):[];},getAvailableLocations:function(){var e=V.getValue();if(!e)return [];var t=O.getLocation(e),n=Y.getSynthesizedLocationElements(t);return t.concat(n);},getTargetLiveDelay:function(){if(!m)throw re;return G.getOriginalLiveDelay();},convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return (0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString());},formatUTC:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o;},getVersion:ge,getDebug:function(){return ce;},getBufferLength:function(e){var n=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT];if(e)return -1!==n.indexOf(e)?Te().getCurrentBufferLevel(e)||NaN:(t.warn("getBufferLength requested for invalid type"),NaN);var r=n.map(function(e){return Ae(e).length>0?Te().getCurrentBufferLevel(e):Number.MAX_VALUE;}).reduce(function(e,t){return Math.min(e,t);});return r===Number.MAX_VALUE?NaN:r;},getTTMLRenderingDiv:function(){return J?J.getTTMLRenderingDiv():null;},getVideoElement:Se,getSource:function(){if(!n)throw ae;return n;},updateSource:function(e){n=e,U.load(n);},getCurrentLiveLatency:function(){if(!g)throw oe;return m?G.getCurrentLiveLatency():NaN;},getTopBitrateInfoFor:function(e){if(!p)throw ne;return v.getTopBitrateInfoFor(e);},setAutoPlay:ve,getAutoPlay:function(){return y;},getDashMetrics:Te,getQualityFor:function(e){if(!p)throw ne;if(e===a.Z.IMAGE){var t=Re();if(!t)return -1;var n=t.getThumbnailController();return n?n.getCurrentTrackIndex():-1;}return v.getQualityFor(e);},setQualityFor:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!p)throw ne;if(e===a.Z.IMAGE){var r=Re();if(!r)return;var i=r.getThumbnailController();i&&i.setTrackByIndex(t);}v.setPlaybackQuality(e,U.getActiveStreamInfo(),t,{forceReplace:n});},updatePortalSize:function(){v.setElementSize(),v.setWindowResizeEventCalled(!0);},enableText:function(e){var t=U.getActiveStreamInfo();return !(!t||!Z)&&Z.enableText(t.id,e);},enableForcedTextStreaming:function(e){return !(!U.getActiveStreamInfo()||!Z)&&Z.enableForcedTextStreaming(e);},isTextEnabled:function(){var e=U.getActiveStreamInfo();return !(!e||!Z)&&Z.isTextEnabled(e);},setTextTrack:function(e){if(!m)throw re;var t=U.getActiveStreamInfo();t&&Z&&Z.setTextTrack(t.id,e);},getBitrateInfoListFor:function(e){if(!p)throw ne;var t=Re();return t?t.getBitrateListFor(e):[];},getStreamsFromManifest:function(e){if(!p)throw ne;return O.getStreamsInfo(e);},getTracksFor:Ae,getTracksForTypeFromManifest:function(e,t,n){if(!p)throw ne;return (n=n||O.getStreamsInfo(t,1)[0])?O.getAllMediaInfoForType(n,e,t):[];},getCurrentTrackFor:function(e){if(!p)throw ne;var t=U.getActiveStreamInfo();return b.getCurrentTrackFor(e,t.id);},setInitialMediaSettingsFor:function(e,t){if(!g)throw oe;b.setInitialSettings(e,t);},getInitialMediaSettingsFor:function(e){if(!g)throw oe;return b.getInitialSettings(e);},setCurrentTrack:function(e){if(!p)throw ne;b.setTrack(e);},addABRCustomRule:function(e,t,n){P.addAbrCustomRule(e,t,n);},removeABRCustomRule:function(e){P.removeAbrCustomRule(e);},removeAllABRCustomRule:function(){P.removeAllAbrCustomRule();},getABRCustomRules:function(){return P.getAbrCustomRules();},getAverageThroughput:function(e){var t=v.getThroughputHistory(),n=G.getIsDynamic();return t?t.getAverageThroughput(e,n):0;},retrieveManifest:function(e,t){var n=Ce(),r=this;ue.on(l.Z.INTERNAL_MANIFEST_LOADED,function e(i){i.error?t(null,i.error):t(i.manifest),ue.off(l.Z.INTERNAL_MANIFEST_LOADED,e,r),n.reset();},r),$.initialize(e),n.load(e);},addUTCTimingSource:function(e,t){P.addUTCTimingSource(e,t);},removeUTCTimingSource:function(e,t){P.removeUTCTimingSource(e,t);},clearDefaultUTCTimingSources:function(){P.clearDefaultUTCTimingSources();},restoreDefaultUTCTimingSources:_e,setXHRWithCredentialsForType:function(e,t){P.setXHRWithCredentialsForType(e,t);},getXHRWithCredentialsForType:function(e){return P.getXHRWithCredentialsForType(e);},getProtectionController:function(){return De();},attachProtectionController:function(e){A=e;},setProtectionData:function(e){r=e,U&&U.setProtectionData(r);},registerLicenseRequestFilter:function(e){P.registerLicenseRequestFilter(e);},registerLicenseResponseFilter:function(e){P.registerLicenseResponseFilter(e);},unregisterLicenseRequestFilter:function(e){P.unregisterLicenseRequestFilter(e);},unregisterLicenseResponseFilter:function(e){P.unregisterLicenseResponseFilter(e);},registerCustomCapabilitiesFilter:function(e){P.registerCustomCapabilitiesFilter(e);},unregisterCustomCapabilitiesFilter:function(e){P.unregisterCustomCapabilitiesFilter(e);},setCustomInitialTrackSelectionFunction:function(e){P.setCustomInitialTrackSelectionFunction(e);},resetCustomInitialTrackSelectionFunction:function(){P.resetCustomInitialTrackSelectionFunction(null);},attachTTMLRenderingDiv:function(e){if(!J.getElement())throw ie;J.setTTMLRenderingDiv(e);},attachVttRenderingDiv:function(e){if(!J.getElement())throw ie;J.setVttRenderingDiv(e);},getCurrentTextTrackIndex:function(){var e=U.getActiveStreamInfo();if(e&&Z)return Z.getCurrentTrackIdx(e.id);},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else {var n=G.getIsDynamic()?me(e):e,r=U.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i)return i.provide(n,t);t(null);}else t(null);}},getDashAdapter:function(){return O;},getOfflineController:function(){return Oe();},triggerSteeringRequest:function(){if(Y)return Y.loadSteeringData();},getCurrentSteeringResponseData:function(){if(Y)return Y.getCurrentSteeringResponseData();},getSettings:function(){return le.get();},updateSettings:function(e){le.update(e);},resetSettings:function(){le.reset();},reset:fe,destroy:function(){fe(),c.Z.deleteSingletonInstances(se);}},t=ce.getLogger(e),g=!1,m=!1,p=!1,y=!0,E=NaN,A=null,D=null,r=null,O=null,te=null,l.Z.extend(d.Z),M=ii(se).getInstance(),P=(0, dt.Z)(se).getInstance(),J=_i(se).getInstance(),$=$r(se).getInstance(),e;}qa.__dashjs_factory_name="MediaPlayer";var Ya=c.Z.getClassFactory(qa);Ya.events=d.Z,Ya.errors=w,c.Z.updateClassFactory(qa.__dashjs_factory_name,Ya);const ja=Ya;},8825:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},r(e);}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},i(e,t);}function a(e,t){return !t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},o(e);}n.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=o(t);if(n){var i=o(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return a(this,e);});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,s),(e=r.call(this)).AST_IN_FUTURE="astInFuture",e.BASE_URLS_UPDATED="baseUrlsUpdated",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADING_STARTED="manifestLoadingStarted",e.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_ACTIVATED="streamActivated",e.STREAM_DEACTIVATED="streamDeactivated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.CAN_PLAY_THROUGH="canPlayThrough",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_LOADED_DATA="playbackLoadedData",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e.REPRESENTATION_SWITCH="representationSwitch",e.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",e.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",e.INBAND_PRFT="inbandPrft",e;}return s;}(n(8342).Z))();},3393:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{Z:()=>i});const i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.init();}var t,n;return t=e,(n=[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"};}}])&&r(t.prototype,n),e;}())();},3860:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{Z:()=>i});const i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.init();}var t,n;return t=e,(n=[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting";}}])&&r(t.prototype,n),e;}())();},8080:(e,t,n)=>{n.d(t,{default:()=>V});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null;};r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00";const i=r;var a=n(1180);function o(e){var t,n,r=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,u=e.events;function l(e){var t=new i();if(n){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date()),o.addDVBErrors(t);}}function c(e){e.error||(n=e.manifest);}function f(e){l({errorcode:i.BASE_URL_CHANGED,servicelocation:e.entry});}function d(){l({errorcode:i.BECAME_REPORTER});}function g(e){var t;e.metric===s.HTTP_REQUEST&&(0===(t=e.value).responsecode||null==t.responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&l({errorcode:t.responsecode||i.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation});}function h(e){var t;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=i.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=i.CORRUPT_MEDIA_OTHER;break;default:return;}l({errorcode:t});}return t={initialize:function(){r.on(u.MANIFEST_UPDATED,c,t),r.on(u.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,f,t),r.on(u.METRIC_ADDED,g,t),r.on(u.METRIC_UPDATED,g,t),r.on(u.PLAYBACK_ERROR,h,t),r.on(a.Z.BECAME_REPORTING_PLAYER,d,t);},reset:function(){r.off(u.MANIFEST_UPDATED,c,t),r.off(u.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,f,t),r.off(u.METRIC_ADDED,g,t),r.off(u.METRIC_UPDATED,g,t),r.off(u.PLAYBACK_ERROR,h,t),r.off(a.Z.BECAME_REPORTING_PLAYER,d,t);}};}o.__dashjs_factory_name="DVBErrorsTranslator";const s=dashjs.FactoryMaker.getSingletonFactory(o);var u=n(2295);function l(e){e=e||{};var t,n,r=!1,i=this.context,a=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,r=t+e.duration;n.add(t,r);}),r=!!e[0]._useWallClockTime);},reset:function(){n.clear();},isEnabled:function(){var e,t=n.length;if(!t)return !0;e=r?new Date().getTime()/1e3:a.currentTime;for(var i=0;i<t;i+=1){var o=n.start(i),s=n.end(i);if(o<=e&&e<s)return !0;}return !1;}},n=(0, u.Z)(i).create(),t;}l.__dashjs_factory_name="RangeController";const c=dashjs.FactoryMaker.getClassFactory(l);function f(){return {serialise:function e(t){var n,r,i=[],a=[];for(n in t)if(t.hasOwnProperty(n)&&0!==n.indexOf("_")){if(null==(r=t[n])&&(r=""),Array.isArray(r)){if(!r.length)continue;a=[],r.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);a.push(n?t:e(t));}),r=a.map(encodeURIComponent).join(",");}else "string"==typeof r?r=encodeURIComponent(r):r instanceof Date?r=r.toISOString():"number"==typeof r&&(r=Math.round(r));i.push(n+"="+r);}return i.join("&");}};}f.__dashjs_factory_name="MetricSerialiser";const d=dashjs.FactoryMaker.getSingletonFactory(f);function g(){var e,t,n,r=window.crypto||window.msCrypto,i=Uint32Array,a=Math.pow(2,8*i.BYTES_PER_ELEMENT)-1;function o(){r&&(e||(e=new i(10)),r.getRandomValues(e),t=0);}return n={random:function(n,i){var s;return n||(n=0),i||(i=1),r?(t===e.length&&o(),s=e[t]/a,t+=1):s=Math.random(),s*(i-n)+n;}},o(),n;}g.__dashjs_factory_name="RNG";const h=dashjs.FactoryMaker.getSingletonFactory(g);var p=n(5717);function m(e){var t;e=e||{};var n,r,i,a,o,s,u,l=this.context,c=[],f=e.metricsConstants;function g(){a=!1,o=!1,s=null,u=null;}return t={report:function(e,t){Array.isArray(t)||(t=[t]),o&&u.isEnabled()&&t.forEach(function(t){var i=n.serialise(t);e!==f.DVB_ERRORS&&(i="metricname=".concat(e,"&").concat(i)),function(e,t,n){var i=new XMLHttpRequest();i.withCredentials=r.getXHRWithCredentialsForType(f.HTTP_REQUEST_DVB_REPORTING_TYPE);var a=function(){var e=c.indexOf(i);-1!==e&&(c.splice(e,1),!(i.status>=200&&i.status<300)&&n&&n());};c.push(i);try{i.open("GET",e),i.onloadend=a,i.onerror=a,i.send();}catch(e){i.onerror();}}(i="".concat(s,"?").concat(i),0,function(){o=!1;});});},initialize:function(e,t){var n;if(u=t,!(s=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");a||((n=e.dvb_probability)&&(1e3===n||n/1e3>=i.random())&&(o=!0),a=!0);},reset:function(){g();}},n=d(l).getInstance(),i=h(l).getInstance(),r=(0, p.Z)(l).getInstance(),g(),t;}m.__dashjs_factory_name="DVBReporting";const y=dashjs.FactoryMaker.getClassFactory(m);function E(e){e=e||{};var t,n={"urn:dvb:dash:reporting:2014":y},r=this.context,i=e.debug?e.debug.getLogger(t):{},a=e.metricsConstants,o=e.mediaPlayerModel||{};return {create:function(e,t){var s;try{(s=n[e.schemeIdUri](r).create({metricsConstants:a,mediaPlayerModel:o})).initialize(e,t);}catch(t){s=null,i.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(e.schemeIdUri," (").concat(t.message,")"));}return s;},register:function(e,t){n[e]=t;},unregister:function(e){delete n[e];}};}E.__dashjs_factory_name="ReportingFactory";const v=dashjs.FactoryMaker.getSingletonFactory(E);function _(e){var t=[],n=v(this.context).getInstance(e);return {initialize:function(e,r){e.some(function(e){var i=n.create(e,r);if(i)return t.push(i),!0;});},reset:function(){t.forEach(function(e){return e.reset();}),t=[];},report:function(e,n){t.forEach(function(t){return t.report(e,n);});}};}_.__dashjs_factory_name="ReportingController";const T=dashjs.FactoryMaker.getClassFactory(_);function S(){return {reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r;},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e;}};}S.__dashjs_factory_name="HandlerHelpers";const b=dashjs.FactoryMaker.getSingletonFactory(S);function A(e){var t,n,r,i,a;e=e||{};var o=this.context,s=b(o).getInstance(),u=[],l=e.metricsConstants;function c(){var e=function(){try{return Object.keys(u).map(function(e){return u[e];}).reduce(function(e,t){return e.level<t.level?e:t;});}catch(e){return;}}();e&&a!==e.t&&(a=e.t,t.report(r,e));}return {initialize:function(e,a,o){a&&(n=s.validateN(o),t=a,r=s.reconstructFullMetricName(e,o),i=setInterval(c,n));},reset:function(){clearInterval(i),i=null,n=0,t=null,a=null;},handleNewMetric:function(e,t,n){e===l.BUFFER_LEVEL&&(u[n]=t);}};}A.__dashjs_factory_name="BufferLevelHandler";const I=dashjs.FactoryMaker.getClassFactory(A),R=dashjs.FactoryMaker.getClassFactory(function(e){var t,n=(e=e||{}).eventBus,r=e.metricsConstants;function i(){n.off(a.Z.METRICS_INITIALISATION_COMPLETE,i,this),n.trigger(a.Z.BECAME_REPORTING_PLAYER);}return {initialize:function(e,r){r&&(t=r,n.on(a.Z.METRICS_INITIALISATION_COMPLETE,i,this));},reset:function(){t=null;},handleNewMetric:function(e,n){e===r.DVB_ERRORS&&t&&t.report(e,n);}};});function w(e){var t,n,r,i,a;e=e||{};var o=[],s=b(this.context).getInstance(),u=e.metricsConstants;function l(){var e=o;e.length&&t&&t.report(i,e),o=[];}return {initialize:function(e,o,u,c){o&&(n=s.validateN(u),t=o,c&&c.length&&(r=c),i=s.reconstructFullMetricName(e,u,c),a=setInterval(l,n));},reset:function(){clearInterval(a),a=null,n=null,r=null,o=[],t=null;},handleNewMetric:function(e,t){e===u.HTTP_REQUEST&&(r&&r!==t.type||o.push(t));}};}w.__dashjs_factory_name="HttpListHandler";const N=dashjs.FactoryMaker.getClassFactory(w);function C(){var e,t;return {initialize:function(n,r){e=n,t=r;},reset:function(){t=null,e=void 0;},handleNewMetric:function(n,r){n===e&&t&&t.report(e,r);}};}C.__dashjs_factory_name="GenericMetricHandler";const D=dashjs.FactoryMaker.getClassFactory(C);function O(e){var t,n=(e=e||{}).debug?e.debug.getLogger(t):{},r=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,i=this.context,a={BufferLevel:I,DVBErrors:R,HttpList:N,PlayList:D,RepSwitchList:D,TcpList:D};return {create:function(t,o){var s,u=t.match(r);if(u){try{(s=a[u[1]](i).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(u[1],o,u[3],u[5]);}catch(e){s=null,n.error("MetricsHandlerFactory: Could not create handler for type ".concat(u[1]," with args ").concat(u[3],", ").concat(u[5]," (").concat(e.message,")"));}return s;}},register:function(e,t){a[e]=t;},unregister:function(e){delete a[e];}};}O.__dashjs_factory_name="MetricsHandlerFactory";const M=dashjs.FactoryMaker.getSingletonFactory(O);function P(e){e=e||{};var t,n=[],r=this.context,i=e.eventBus,a=e.events,o=M(r).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function s(e){n.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType);});}return t={initialize:function(e,r){e.split(",").forEach(function(e,t,i){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var s=i[t+1];s&&-1===s.indexOf("(")&&-1!==s.indexOf(")")&&(e+=","+s,delete i[t+1]);}(a=o.create(e,r))&&n.push(a);}),i.on(a.METRIC_ADDED,s,t),i.on(a.METRIC_UPDATED,s,t);},reset:function(){i.off(a.METRIC_ADDED,s,t),i.off(a.METRIC_UPDATED,s,t),n.forEach(function(e){return e.reset();}),n=[];}};}P.__dashjs_factory_name="MetricsHandlersController";const L=dashjs.FactoryMaker.getClassFactory(P);function x(e){var t,n,r;e=e||{};var i=this.context;function a(){t&&t.reset(),n&&n.reset(),r&&r.reset();}return {initialize:function(o){try{(r=c(i).create({mediaElement:e.mediaElement})).initialize(o.Range),(n=T(i).create({debug:e.debug,metricsConstants:e.metricsConstants,mediaPlayerModel:e.mediaPlayerModel})).initialize(o.Reporting,r),(t=L(i).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(o.metrics,n);}catch(e){throw a(),e;}},reset:a};}x.__dashjs_factory_name="MetricsController";const F=dashjs.FactoryMaker.getClassFactory(x),k=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.metrics="",this.Range=[],this.Reporting=[];},U=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1;},Z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3;};function B(e){var t=(e=e||{}).adapter,n=e.constants;return {getMetrics:function(e){var r=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach(function(i){var a=new k(),o=t.getIsDynamic(e);i.hasOwnProperty("metrics")&&(a.metrics=i.metrics,i.Range_asArray&&i.Range_asArray.forEach(function(r){var i=new U();i.starttime=function(e,r,i){var a,o,s=0;return r?s=t.getAvailabilityStartTime(e)/1e3:(a=t.getRegularPeriods(e)).length&&(s=a[0].start),o=s,i&&i.hasOwnProperty(n.START_TIME)&&(o+=i.starttime),o;}(e,o,r),r.hasOwnProperty("duration")?i.duration=r.duration:i.duration=t.getDuration(e),i._useWallClockTime=o,a.Range.push(i);}),i.Reporting_asArray&&(i.Reporting_asArray.forEach(function(e){var t=new Z();e.hasOwnProperty(n.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(n.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[n.DVB_REPORTING_URL]),e.hasOwnProperty(n.DVB_PROBABILITY)&&(t.dvb_probability=e[n.DVB_PROBABILITY]),a.Reporting.push(t));}),r.push(a)));}),r;}};}B.__dashjs_factory_name="ManifestParsing";const G=dashjs.FactoryMaker.getSingletonFactory(B);function q(e){var t;e=e||{};var n={},r=this.context,i=e.eventBus,o=e.events;function s(t){if(!t.error){var o=Object.keys(n);G(r).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(t.manifest).forEach(function(t){var i=JSON.stringify(t);if(n.hasOwnProperty(i))o.splice(i,1);else try{var a=F(r).create(e);a.initialize(t),n[i]=a;}catch(e){}}),o.forEach(function(e){n[e].reset(),delete n[e];}),i.trigger(a.Z.METRICS_INITIALISATION_COMPLETE);}}function u(){Object.keys(n).forEach(function(e){n[e].reset();}),n={};}return t={reset:function(){i.off(o.MANIFEST_UPDATED,s,t),i.off(o.STREAM_TEARDOWN_COMPLETE,u,t);}},i.on(o.MANIFEST_UPDATED,s,t),i.on(o.STREAM_TEARDOWN_COMPLETE,u,t),t;}q.__dashjs_factory_name="MetricsCollectionController";const Y=dashjs.FactoryMaker.getClassFactory(q);function j(){var e=this.context;return {createMetricsReporting:function(t){return s(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}).initialize(),Y(e).create(t);},getReportingFactory:function(){return v(e).getInstance();},getMetricsHandlerFactory:function(){return M(e).getInstance();}};}j.__dashjs_factory_name="MetricsReporting";var H=dashjs.FactoryMaker.getClassFactory(j);H.events=a.Z,dashjs.FactoryMaker.updateClassFactory(j.__dashjs_factory_name,H);const V=H;},1180:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},r(e);}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},i(e,t);}function a(e,t){return !t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},o(e);}n.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=o(t);if(n){var i=o(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return a(this,e);});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,s),(e=r.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e;}return s;}(n(8342).Z))();},5717:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(2610),i=n(5448),a=n(1264),o=n(3106),s=n(1767),u=n(3393);function l(){var e,t,n,i,l,c,f,d,g=this.context,h=(0, a.Z)(g).getInstance();function p(){i=[],l=[],c=[],d=[],f=null,t=[];}function m(e,t){var n=-1;e.some(function(e,r){if(e===t)return n=r,!0;}),n<0||e.splice(n,1);}function y(e){var t;for(t=0;t<d.length;t++)if(d[t].rulename===e)return t;return -1;}function E(e,n){v(e,n);var i=new r.Z();i.schemeIdUri=e,i.value=n,t.push(i);}function v(e,n){(0, o.PS)(e,"string"),(0, o.PS)(n,"string"),t.forEach(function(r,i){r.schemeIdUri===e&&r.value===n&&t.splice(i,1);});}return e={getCustomInitialTrackSelectionFunction:function(){return f;},setCustomInitialTrackSelectionFunction:function(e){f=e;},resetCustomInitialTrackSelectionFunction:function(){f=null;},getLicenseResponseFilters:function(){return l;},getLicenseRequestFilters:function(){return i;},getCustomCapabilitiesFilters:function(){return c;},registerCustomCapabilitiesFilter:function(e){c.push(e);},registerLicenseResponseFilter:function(e){l.push(e);},registerLicenseRequestFilter:function(e){i.push(e);},unregisterCustomCapabilitiesFilter:function(e){m(c,e);},unregisterLicenseResponseFilter:function(e){m(l,e);},unregisterLicenseRequestFilter:function(e){m(i,e);},addAbrCustomRule:function(e,t,n){if("string"!=typeof e||e!==s.Z.ABANDON_FRAGMENT_RULES&&e!==s.Z.QUALITY_SWITCH_RULES||"string"!=typeof t)throw u.Z.BAD_ARGUMENT_ERROR;var r=y(t);-1===r?d.push({type:e,rulename:t,rule:n}):(d[r].type=e,d[r].rule=n);},removeAllAbrCustomRule:function(){d=[];},removeAbrCustomRule:function(e){if(e){var t=y(e);-1!==t&&d.splice(t,1);}else d=[];},getAbrCustomRules:function(){return d;},addUTCTimingSource:E,removeUTCTimingSource:v,getUTCTimingSources:function(){return t;},clearDefaultUTCTimingSources:function(){t=[];},restoreDefaultUTCTimingSources:function(){var e=h.get().streaming.utcSynchronization.defaultTimingSource;E(e.scheme,e.value);},setXHRWithCredentialsForType:function e(t,r){t?n[t]=!!r:Object.keys(n).forEach(function(t){e(t,r);});},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t;},setConfig:function(){},reset:function(){p();}},n={default:!1},p(),e;}l.__dashjs_factory_name="CustomParametersModel";const c=i.Z.getSingletonFactory(l);},9032:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5448),i=n(7473);function a(e){var t=(e=e||{}).requestModifier;function n(e){var n=new Date(),r=e.request,i=new XMLHttpRequest();if(i.open(e.method,e.url,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=n),t&&t.modifyRequestHeader&&(i=t.modifyRequestHeader(i,{url:e.url})),e.headers)for(var a in e.headers){var o=e.headers[a];o&&i.setRequestHeader(a,o);}i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.ontimeout=e.ontimeout,i.timeout=e.timeout,i.send(),e.response=i;}return {load:function(e){t&&t.modifyRequest?(0, i.k)(e,t).then(function(){return n(e);}):n(e);},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort();}};}a.__dashjs_factory_name="XHRLoader";const o=r.Z.getClassFactory(a);},1737:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{default:()=>be});var i={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};const a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}var t,n;return t=e,n=[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"!==r.schemeIdUri.toLowerCase()||"cenc"!==r.value.toLowerCase()&&"cbcs"!==r.value.toLowerCase()||(t=r);}return t;}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t);}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return t&&r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null;}},{key:"parseInitDataFromContentProtection",value:function(e,t){return "pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null;}},{key:"parsePSSHList",value:function(e){if(null==e)return [];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r)){if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";var u=void 0,l=void 0;for(u=0;u<4;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=4,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<6;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;r+=6,r+=4,n[o=o.toLowerCase()]=t.buffer.slice(s,i),r=i;}else r=i;}else r=i;}return n;}},{key:"getLicenseServerUrlFromMediaInfo",value:function(e,t){try{if(!e||0===e.length)return null;for(var n=0,r=null;n<e.length&&!r;){var a=e[n];if(a&&a.contentProtection&&a.contentProtection.length>0){var o=a.contentProtection.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===t;});if(o&&o.length>0)for(var s=0;s<o.length&&!r;){for(var u=o[s],l=0;l<i.attributes.length&&!r;){for(var c=0,f=i.attributes[l];c<i.prefixes.length&&!r;){var d=i.prefixes[c];u[f]&&u[f].__prefix&&u[f].__prefix===d&&u[f].__text&&(r=u[f].__text),c+=1;}l+=1;}s+=1;}}n+=1;}return r;}catch(e){return null;}}}],n&&r(t,n),e;}(),o=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.contentType=t,this.robustness=n;},s=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a;};function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},u(e);}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},l(e,t);}function c(e,t){return !t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},f(e);}const d=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=f(t);if(n){var i=f(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return c(this,e);});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),(e=r.call(this)).MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e;}return i;}(n(2230).Z))();var g=n(5459);const h=function e(t,n,r,i,a,o,s,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=t,this.method=n,this.responseType=r,this.headers=i,this.withCredentials=a,this.messageType=o,this.sessionId=s,this.data=u;},p=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.url=t,this.headers=n,this.data=r;};var m=n(7855),y=n(703),E=n(3393),v=n(5448);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_(e);}function T(e){var t,n,r,i,u,l,c,f,v,T,S,b=(e=e||{}).protectionKeyController,A=e.protectionModel,I=e.eventBus,R=e.events,w=e.debug,N=e.BASE64,C=e.constants,D=[],O=e.cmcdModel,M=e.settings,P=e.customParametersModel;function L(){if(!(I&&I.hasOwnProperty("on")&&b&&b.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)");}function x(e,t){f||v?f&&F():function(e,t){if(!v){v=!0;var r,i=[];e=e.sort(function(t,n){return (u&&u[t.ks.systemString]&&u[t.ks.systemString].priority>=0?u[t.ks.systemString].priority:e.length)-(u&&u[n.ks.systemString]&&u[n.ks.systemString].priority>=0?u[n.ks.systemString].priority:e.length);});for(var a=0;a<e.length;a++){var o=Y(e[a]);i.push({ks:e[a].ks,configs:[o],protData:e[a].protData});}A.requestKeySystemAccess(i).then(function(e){var t=(r=e.data).mksa&&r.mksa.selectedSystemString?r.mksa.selectedSystemString:r.keySystem.systemString;return n.info("DRM: KeySystem Access Granted for system string ("+t+")!  Selecting key system..."),A.selectKeySystem(r);}).then(function(e){if(f=e,v=!1,A){I.trigger(R.KEY_SYSTEM_SELECTED,{data:r});var t=B(f);t&&t.serverCertificate&&t.serverCertificate.length>0&&A.setServerCertificate(N.decodeArray(t.serverCertificate).buffer),F();}}).catch(function(e){f=null,v=!1,t||I.trigger(R.KEY_SYSTEM_SELECTED,{data:null,error:new g.Z(d.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,d.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+e.error)});});}}(e,t);}function F(){for(var e,t=0;t<r.length;t++)for(e=0;e<r[t].length;e++)if(f===r[t][e].ks){k(r[t][e]);break;}r=[];}function k(e){if(b.isClearKey(f)&&e.protData&&e.protData.hasOwnProperty("clearkeys")&&0!==Object.keys(e.protData.clearkeys).length){var t={kids:Object.keys(e.protData.clearkeys)};e.initData=new TextEncoder().encode(JSON.stringify(t));}e.sessionId?U(e):null!==e.initData&&Z(e);}function U(e){L(),A.loadKeySession(e);}function Z(e){var t=a.getPSSHForKeySystem(f,e?e.initData:null);if(t){if(function(e){if(!e)return !1;try{for(var t=A.getSessions(),n=0;n<t.length;n++)if(t[n].getKeyId()===e)return !0;return !1;}catch(e){return !1;}}(e.keyId))return;if(G(t))return;try{e.initData=t,A.createKeySession(e);}catch(e){I.trigger(R.KEY_SESSION_CREATED,{data:null,error:new g.Z(d.KEY_SESSION_CREATED_ERROR_CODE,d.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)});}}else e&&e.initData?A.createKeySession(e):I.trigger(R.KEY_SESSION_CREATED,{data:null,error:new g.Z(d.KEY_SESSION_CREATED_ERROR_CODE,d.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(f?f.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")});}function B(e){if(e){var t=e.systemString;if(u)return t in u?u[t]:null;}return null;}function G(e){if(!e)return !1;try{for(var t=A.getAllInitData(),r=0;r<t.length;r++)if(b.initDataEquals(e,t[r]))return n.debug("DRM: Ignoring initData because we have already seen it!"),!0;return !1;}catch(e){return !1;}}function q(e){L(),e?(A.setMediaElement(e),I.on(R.NEED_KEY,J,t)):null===e&&(A.setMediaElement(e),I.off(R.NEED_KEY,J,t));}function Y(e){var t=e.protData,n=[],r=[],a=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:c,u=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:c,l=e.sessionType,f=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",d=t&&t.persistentState?t.persistentState:"temporary"===l?"optional":"required";return i.forEach(function(e){e.type===C.AUDIO?n.push(new o(e.codec,a)):e.type===C.VIDEO&&r.push(new o(e.codec,u));}),new s(n,r,f,d,[l]);}function j(e){e.error?I.trigger(R.KEY_STATUSES_CHANGED,{data:null,error:e.error}):n.debug("DRM: key status = "+e.status);}function H(e){n.debug("DRM: onKeyMessage");var t=e.data;I.trigger(R.KEY_MESSAGE,{data:t});var r=t.messageType?t.messageType:"license-request",o=t.message,s=t.sessionToken,u=B(f),l=b.getLicenseServerModelInstance(f,u,r),c={sessionToken:s,messageType:r};if(o&&0!==o.byteLength){if(!l)return n.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+s.getSessionId()),void V(c);if(b.isClearKey(f)){var E=b.processClearKeyLicenseRequest(f,u,o);if(E&&E.keyPairs&&E.keyPairs.length>0)return n.debug("DRM: ClearKey license request handled by application!"),V(c),void A.updateKeySession(s,E);}!function(e,t,n){var r=e.sessionToken,o=e.messageType?e.messageType:"license-request",s={sessionToken:r,messageType:o},u=f?f.systemString:null,l=function(e,t,n,r,o){var s=null,u=r.message;if(e&&e.serverURL){var l=e.serverURL;"string"==typeof l&&""!==l?s=l:"object"===_(l)&&l.hasOwnProperty(t)&&(s=l[t]);}else if(e&&e.laURL&&""!==e.laURL)s=e.laURL;else if(!(s=a.getLicenseServerUrlFromMediaInfo(i,f.schemeIdURI))&&!b.isClearKey(f)){var c=a.getPSSHData(n.initData);(s=f.getLicenseServerURLFromInitData(c))||(s=r.laURL);}return s=o.getServerURLFromMessage(s,u,t);}(n,o,r,e,t);if(l){var c={},E=!1;n&&W(c,n.httpRequestHeaders);var v=e.message;W(c,f.getRequestHeadersFromMessage(v)),Object.keys(c).forEach(function(e){"authorization"===e.toLowerCase()&&(E=!0);}),n&&"boolean"==typeof n.withCredentials&&(E=n.withCredentials);var T=function(e){if(A)if(e.status>=200&&e.status<=299){var n=y.Z.parseHttpHeaders(e.getAllResponseHeaders?e.getAllResponseHeaders():null),i=new p(e.responseURL,n,e.response);Q(P.getLicenseResponseFilters(),i).then(function(){var n=t.getLicenseMessage(i.data,u,o);null!==n?(V(s),A.updateKeySession(r,n)):X(e,s,u,o,t);});}else X(e,s,u,o,t);},S=function(e){V(s,new g.Z(d.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,d.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+u+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState));},I=function(e){V(s,new g.Z(d.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,d.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+u+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState));},R=f.getLicenseRequestFromMessage(v),w=t.getHTTPMethod(o),N=t.getResponseType(u,o),C=n&&!isNaN(n.httpTimeout)?n.httpTimeout:8e3,D=r.getSessionId()||null,O=new h(l,w,N,c,E,o,D,R),L=isNaN(M.get().streaming.retryAttempts[m.w.LICENSE])?3:M.get().streaming.retryAttempts[m.w.LICENSE];Q(P.getLicenseRequestFilters(),O).then(function(){K(O,L,C,T,S,I);});}else V(s,new g.Z(d.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,d.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));}(t,l,u);}else V(c,new g.Z(d.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,d.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));}function V(e,t){I.trigger(R.LICENSE_REQUEST_COMPLETE,{data:e,error:t});}function K(e,t,r,i,a,o){var s=new XMLHttpRequest();if(M.get().streaming.cmcd&&M.get().streaming.cmcd.enabled&&M.get().streaming.cmcd.mode===E.Z.CMCD_MODE_QUERY){var u=O.getQueryParameter({url:e.url,type:m.w.LICENSE});u&&(e.url=y.Z.addAditionalQueryParameterToUrl(e.url,[u]));}for(var l in s.open(e.method,e.url,!0),s.responseType=e.responseType,s.withCredentials=e.withCredentials,r>0&&(s.timeout=r),e.headers)s.setRequestHeader(l,e.headers[l]);if(M.get().streaming.cmcd&&M.get().streaming.cmcd.enabled&&M.get().streaming.cmcd.mode===E.Z.CMCD_MODE_HEADER){var c=O.getHeaderParameters({url:e.url,type:m.w.LICENSE});if(c)for(var f in c){var d=c[f];d&&s.setRequestHeader(f,d);}}var g=function(){t--;var n=isNaN(M.get().streaming.retryIntervals[m.w.LICENSE])?1e3:M.get().streaming.retryIntervals[m.w.LICENSE];S=setTimeout(function(){K(e,t,r,i,a,o);},n);};s.onload=function(){T=null,this.status>=200&&this.status<=299||t<=0?i(this):(n.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+t),g());},s.ontimeout=s.onerror=function(){T=null,t<=0?o(this):(n.warn("License request network request failed . Retrying it... Pending retries: "+t),g());},s.onabort=function(){a(this);},I.trigger(R.LICENSE_REQUEST_SENDING,{url:e.url,headers:e.headers,payload:e.data,sessionId:e.sessionId}),T=s,s.send(e.data);}function z(){T&&(T.onloadend=T.onerror=T.onprogress=void 0,T.abort(),T=null),S&&(clearTimeout(S),S=null);}function W(e,t){if(t)for(var n in t)e[n]=t[n];}function X(e,t,n,r,i){var a="NONE",o=null;e.response&&(a=i.getErrorResponse(e.response,n,r),o={serverResponse:e.response||null,responseCode:e.status||null,responseText:e.statusText||null}),V(t,new g.Z(d.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,d.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+a,o));}function Q(e,t){return e?e.reduce(function(e,n){return e.then(function(){return n(t);});},Promise.resolve()):Promise.resolve();}function J(e,t){if(!M.get().streaming.protection.ignoreEmeEncryptedEvent){if(n.debug("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void n.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);if(0===i.length&&(n.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))return void D.push(setTimeout(function(){J(e,t);},500));var o=e.key.initData;if(ArrayBuffer.isView(o)&&(o=o.buffer),f){var s=a.getPSSHForKeySystem(f,o);if(s&&G(s))return;}n.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(o)));var c=b.getSupportedKeySystemsFromSegmentPssh(o,u,l);if(0===c.length)return void n.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");!function(e){r.push(e),x(e,!1);}(c);}}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");L(),i.push(e);},clearMediaInfoArray:function(){i=[];},handleKeySystemFromManifest:function(){if(i&&0!==i.length){var e=[];i.forEach(function(t){var n=b.getSupportedKeySystemsFromContentProtection(t.contentProtection,u,l);n.length>0&&(0===e.length&&(e=n),r.push(n));}),e&&e.length>0&&x(e,!0);}},createKeySession:Z,loadKeySession:U,removeKeySession:function(e){L(),A.removeKeySession(e);},closeKeySession:function(e){L(),A.closeKeySession(e);},setServerCertificate:function(e){L(),A.setServerCertificate(e);},setMediaElement:q,setSessionType:function(e){l=e;},setRobustnessLevel:function(e){c=e;},setProtectionData:function(e){u=e,b.setProtectionData(e);},getSupportedKeySystemsFromContentProtection:function(e){return L(),b.getSupportedKeySystemsFromContentProtection(e,u,l);},getKeySystems:function(){return b?b.getKeySystems():[];},setKeySystems:function(e){b&&b.setKeySystems(e);},stop:function(){z(),A&&A.stop();},reset:function(){I.off(R.INTERNAL_KEY_MESSAGE,H,t),I.off(R.INTERNAL_KEY_STATUS_CHANGED,j,t),L(),z(),q(null),f=null,v=!1,A&&(A.reset(),A=null),D.forEach(function(e){return clearTimeout(e);}),D=[],i=[],r=[];}},n=w.getLogger(t),r=[],i=[],l="temporary",c="",T=null,S=null,I.on(R.INTERNAL_KEY_MESSAGE,H,t),I.on(R.INTERNAL_KEY_STATUS_CHANGED,j,t),t;}T.__dashjs_factory_name="ProtectionController";const S=v.Z.getClassFactory(T),b=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.keyID=t,this.key=n;};function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const I=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n;}var t,n;return t=e,(n=[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r);}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o;}}])&&A(t.prototype,n),e;}();function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}const w=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.init();}var t,n;return t=e,(n=[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm";}}])&&R(t.prototype,n),e;}())();var N="e2719d58-a985-b3c9-781a-b030af78d30e",C=w.CLEARKEY_KEYSTEM_STRING,D="urn:uuid:"+N;function O(e){var t=(e=e||{}).BASE64;return {uuid:N,schemeIdURI:D,systemString:C,getInitData:function(e,n){try{var r=a.parseInitDataFromContentProtection(e,t);if(!r&&n){var i={kids:[function(e){try{var t=e.replace(/-/g,"");return (t=btoa(t.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16));}).join(""))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");}catch(e){return null;}}(n["cenc:default_KID"])]};r=new TextEncoder().encode(JSON.stringify(i));}return r;}catch(e){return null;}},getRequestHeadersFromMessage:function(){return {"Content-Type":"application/json"};},getLicenseRequestFromMessage:function(e){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e))));},getLicenseServerURLFromInitData:function(){return null;},getCDMData:function(){return null;},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new b(o,s));}n=new I(i);}return n;}};}O.__dashjs_factory_name="KeySystemClearKey";const M=dashjs.FactoryMaker.getSingletonFactory(O);var P="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",L=w.CLEARKEY_KEYSTEM_STRING,x="urn:uuid:"+P;function F(e){var t,n=e.BASE64,r=e.debug.getLogger(t);return {uuid:P,schemeIdURI:x,systemString:L,getInitData:function(e){return a.parseInitDataFromContentProtection(e,n);},getRequestHeadersFromMessage:function(){return null;},getLicenseRequestFromMessage:function(e){return new Uint8Array(e);},getLicenseServerURLFromInitData:function(){return null;},getCDMData:function(){return null;},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var i=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),a=[],o=0;o<i.kids.length;o++){var s=i.kids[o],u=e.clearkeys&&e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!u)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");a.push(new b(s,u));}n=new I(a),r.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4");}return n;}};}F.__dashjs_factory_name="KeySystemW3CClearKey";const k=dashjs.FactoryMaker.getSingletonFactory(F);var U="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",Z=w.WIDEVINE_KEYSTEM_STRING,B="urn:uuid:"+U;function G(e){var t=(e=e||{}).BASE64;return {uuid:U,schemeIdURI:B,systemString:Z,getInitData:function(e){return a.parseInitDataFromContentProtection(e,t);},getRequestHeadersFromMessage:function(){return null;},getLicenseRequestFromMessage:function(e){return new Uint8Array(e);},getLicenseServerURLFromInitData:function(){return null;},getCDMData:function(){return null;}};}G.__dashjs_factory_name="KeySystemWidevine";const q=dashjs.FactoryMaker.getSingletonFactory(G);var Y="9a04f079-9840-4286-ab92-e65be0885f95",j=w.PLAYREADY_KEYSTEM_STRING,H="urn:uuid:"+Y;function V(e){var t="utf-16",n=(e=e||{}).BASE64,r=e.settings;function i(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)");}return {uuid:Y,schemeIdURI:H,systemString:j,getInitData:function(e){var t,r,o,s,u,l=new Uint8Array([112,115,115,104,0,0,0,0]),c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),f=0,d=null;if(i(),!e)return null;if("pssh"in e)return a.parseInitDataFromContentProtection(e,n);if("pro"in e)d=n.decodeArray(e.pro.__text);else {if(!("prheader"in e))return null;d=n.decodeArray(e.prheader.__text);}return t=d.length,r=4+l.length+c.length+4+t,o=new ArrayBuffer(r),s=new Uint8Array(o),(u=new DataView(o)).setUint32(f,r),f+=4,s.set(l,f),f+=l.length,s.set(c,f),f+=c.length,u.setUint32(f,t),f+=4,s.set(d,f),f+=t,s.buffer;},getRequestHeadersFromMessage:function(e){var n,i,a={},o=new DOMParser();if(r&&r.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return a["Content-Type"]="text/xml; charset=utf-8",a;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,s);for(var u=(i=o.parseFromString(n,"application/xml")).getElementsByTagName("name"),l=i.getElementsByTagName("value"),c=0;c<u.length;c++)a[u[c].childNodes[0].nodeValue]=l[c].childNodes[0].nodeValue;return a.hasOwnProperty("Content")&&(a["Content-Type"]=a.Content,delete a.Content),a.hasOwnProperty("Content-Type")||(a["Content-Type"]="text/xml; charset=utf-8"),a;},getLicenseRequestFromMessage:function(e){var a=null,o=new DOMParser();if(r&&r.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return e;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);i();var u=String.fromCharCode.apply(null,s),l=o.parseFromString(u,"application/xml");if(!l.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var c=l.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return c&&(a=n.decode(c)),a;},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser(),a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),c=i.parseFromString(l,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var f=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(f)return f;}if(c.getElementsByTagName("LUI_URL")[0]){var d=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(d)return d;}}else r+=s;}return null;},getCDMData:function(e){var t,r,a,o;if(i(),!e)return null;for(t=[],o=0;o<e.length;++o)t.push(e.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=n.encode(t),r='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),a=[],o=0;o<r.length;++o)a.push(r.charCodeAt(o)),a.push(0);return new Uint8Array(a).buffer;},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e;}};}V.__dashjs_factory_name="KeySystemPlayReady";const K=dashjs.FactoryMaker.getSingletonFactory(V);function z(e){var t=(e=e||{}).BASE64,n={};return n[w.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license);},getErrorResponse:function(e){return e;}},n[w.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e;},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e));}},{getServerURLFromMessage:function(e){return e;},getHTTPMethod:function(){return "POST";},getResponseType:function(e){return n[e].responseType;},getLicenseMessage:function(e,r){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)");}(),n[r].getLicenseMessage(e);},getErrorResponse:function(e,t){return n[t].getErrorResponse(e);}};}z.__dashjs_factory_name="DRMToday";const W=dashjs.FactoryMaker.getSingletonFactory(z);function X(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t));}function n(n){if(window.DOMParser){var r=t(n),i=new window.DOMParser().parseFromString(r,"text/xml"),a=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o&&o.getElementsByTagNameNS(e,"Fault")[0])return null;}return n;}function r(n){var r="",i="",a="",o=-1,s=-1;if(window.DOMParser){var u=t(n),l=new window.DOMParser().parseFromString(u,"text/xml"),c=l?l.getElementsByTagNameNS(e,"Envelope")[0]:null,f=c?c.getElementsByTagNameNS(e,"Body")[0]:null,d=f?f.getElementsByTagNameNS(e,"Fault")[0]:null,g=d?d.getElementsByTagName("detail")[0]:null,h=g?g.getElementsByTagName("Exception")[0]:null,p=null;if(null===d)return u;r=(p=d.getElementsByTagName("faultstring")[0].firstChild)?p.nodeValue:null,null!==h&&(i=(p=h.getElementsByTagName("StatusCode")[0])?p.firstChild.nodeValue:null,o=(a=(p=h.getElementsByTagName("Message")[0])?p.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"");}var m="code: ".concat(i,", name: ").concat(r);return a&&(m+=", message: ".concat(a)),m;}return {getServerURLFromMessage:function(e){return e;},getHTTPMethod:function(){return "POST";},getResponseType:function(){return "arraybuffer";},getLicenseMessage:function(e){return n.call(this,e);},getErrorResponse:function(e){return r.call(this,e);}};}X.__dashjs_factory_name="PlayReady";const Q=v.Z.getSingletonFactory(X);function J(){return {getServerURLFromMessage:function(e){return e;},getHTTPMethod:function(){return "POST";},getResponseType:function(){return "arraybuffer";},getLicenseMessage:function(e){return e;},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e));}};}J.__dashjs_factory_name="Widevine";const $=dashjs.FactoryMaker.getSingletonFactory(J);function ee(){return {getServerURLFromMessage:function(e){return e;},getHTTPMethod:function(){return "POST";},getResponseType:function(){return "json";},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],i=r.kid.replace(/=/g,""),a=r.k.replace(/=/g,"");t.push(new b(i,a));}return new I(t);},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e));}};}ee.__dashjs_factory_name="ClearKey";const te=dashjs.FactoryMaker.getSingletonFactory(ee);function ne(){var e,t,n,r,i,o,s,u,l=this.context;function c(e,t){return t&&e in t?t[e]:null;}function f(e,t){return e&&e.sessionId?e.sessionId:t&&t.sessionId?t.sessionId:null;}function d(e,t){return e&&e.sessionType?e.sessionType:t;}return e={initialize:function(){var e;r=[],e=K(l).getInstance({BASE64:i,settings:o}),r.push(e),e=q(l).getInstance({BASE64:i}),r.push(e),e=M(l).getInstance({BASE64:i}),r.push(e),s=e,e=k(l).getInstance({BASE64:i,debug:t}),r.push(e),u=e;},setProtectionData:function(e){for(var t,n,i=0;i<r.length;i++){var a=r[i];a.hasOwnProperty("init")&&a.init((t=a.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n));}},isClearKey:function(e){return e===s||e===u;},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return !1;return !0;}return !1;},getKeySystems:function(){return r;},setKeySystems:function(e){r=e;},getKeySystemBySystemString:function(e){for(var t=0;t<r.length;t++)if(r[t].systemString===e)return r[t];return null;},getSupportedKeySystemsFromContentProtection:function(e,t,n){var i,o,s,u,l=[];if(e){var g=a.findCencContentProtection(e);for(s=0;s<r.length;++s){var h=c((o=r[s]).systemString,t);for(u=0;u<e.length;++u)if((i=e[u]).schemeIdUri.toLowerCase()===o.schemeIdURI){var p=o.getInitData(i,g);l.push({ks:r[s],keyId:i.keyId,initData:p,protData:h,cdmData:o.getCDMData(h?h.cdmData:null),sessionId:f(h,i),sessionType:d(h,n)});}}}return l;},getSupportedKeySystemsFromSegmentPssh:function(e,t,n){for(var i,o=[],s=a.parsePSSHList(e),u=0;u<r.length;++u){var l=c((i=r[u]).systemString,t);i.uuid in s&&o.push({ks:i,initData:s[i.uuid],protData:l,cdmData:i.getCDMData(l?l.cdmData:null),sessionId:f(l),sessionType:d(l,n)});}return o;},getLicenseServerModelInstance:function(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=W(l).getInstance({BASE64:i}):e.systemString===w.WIDEVINE_KEYSTEM_STRING?r=$(l).getInstance():e.systemString===w.PLAYREADY_KEYSTEM_STRING?r=Q(l).getInstance():e.systemString===w.CLEARKEY_KEYSTEM_STRING&&(r=te(l).getInstance()),r;},processClearKeyLicenseRequest:function(e,t,r){try{return e.getClearKeysFromProtectionData(t,r);}catch(e){return n.error("Failed to retrieve clearkeys from ProtectionData"),null;}},setConfig:function(r){r&&(r.debug&&(t=r.debug,n=t.getLogger(e)),r.BASE64&&(i=r.BASE64),r.settings&&(o=r.settings));}},e;}ne.__dashjs_factory_name="ProtectionKeyController";const re=dashjs.FactoryMaker.getSingletonFactory(ne);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},ie(e);}function ae(e,t){return ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;},ae(e,t);}function oe(e,t){return !t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);},se(e);}const ue=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t);}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}(),function(){var e,r=se(t);if(n){var i=se(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return oe(this,e);});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,i),(e=r.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e.KEY_SESSION_UPDATED="public_keySessionUpdated",e;}return i;}(n(8342).Z))(),le=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.initData=t,this.initDataType=n;},ce=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request";},fe=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.keySystem=t,this.ksConfiguration=n;};var de={};function ge(e){e=e||{};var t,n,r,i,a,o,s,u,l=this.context,c=e.eventBus,f=e.events,h=e.debug;function p(e,t,n,r){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess){var i="Insecure origins are not allowed";return c.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{error:i}),void r({error:i});}var a=e[t].protData&&e[t].protData.systemStringPriority?e[t].protData.systemStringPriority:null,o=e[t].configs,s=e[t].ks,u=s.systemString;(function(e,t){return new Promise(function(n,r){m(e,t,0,n,r);});})(a||(de[u]?de[u]:[u]),o).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new fe(s,t);r.mksa=e,c.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{data:r}),n({data:r});}).catch(function(i){if(t+1<e.length)p(e,t+1,n,r);else {var a="Key system access denied! ";c.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{error:a+i.message}),r({error:a+i.message});}});}function m(e,t,r,i,a){var o=e[r];n.debug("Requesting key system access for system string ".concat(o)),navigator.requestMediaKeySystemAccess(o,t).then(function(e){e.selectedSystemString=o,i(e);}).catch(function(n){r+1<e.length?m(e,t,r+1,i,a):a(n);});}function y(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close();}function E(e){for(var t=0;t<o.length;t++)if(o[t]===e){o.splice(t,1);break;}}function v(e){var t,n;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n};}function _(e,t){var r={session:e,keyId:t.keyId,initData:t.initData,sessionId:t.sessionId,sessionType:t.sessionType,handleEvent:function(e){switch(e.type){case"keystatuseschange":c.trigger(f.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=v(arguments);"expired"===e.status?c.trigger(f.INTERNAL_KEY_STATUS_CHANGED,{error:new g.Z(d.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,d.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)}):c.trigger(f.INTERNAL_KEY_STATUS_CHANGED,e);});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;c.trigger(f.INTERNAL_KEY_MESSAGE,{data:new ce(this,t,void 0,e.messageType)});}},getKeyId:function(){return this.keyId;},getSessionId:function(){return e.sessionId;},getSessionType:function(){return this.sessionType;},getExpirationTime:function(){return e.expiration;},getKeyStatuses:function(){return e.keyStatuses;},getUsable:function(){var t=!1;return e.keyStatuses.forEach(function(){var e=v(arguments);"usable"===e.status&&(t=!0);}),t;}};return e.addEventListener("keystatuseschange",r),e.addEventListener("message",r),e.closed.then(function(){E(r),n.debug("DRM: Session closed.  SessionID = "+r.getSessionId()),c.trigger(f.KEY_SESSION_CLOSED,{data:r.getSessionId()});}),o.push(r),r;}return t={getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)o[t].initData&&e.push(o[t].initData);return e;},getSessions:function(){return o;},requestKeySystemAccess:function(e){return new Promise(function(t,n){p(e,0,t,n);});},selectKeySystem:function(e){return new Promise(function(t,n){e.mksa.createMediaKeys().then(function(t){return r=e.keySystem,a=t,i?i.setMediaKeys(a):Promise.resolve();}).then(function(){t(r);}).catch(function(){n({error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"});});});},setMediaElement:function(e){i!==e&&(i&&(i.removeEventListener("encrypted",s),i.setMediaKeys&&i.setMediaKeys(null)),(i=e)&&(i.addEventListener("encrypted",s),i.setMediaKeys&&a&&i.setMediaKeys(a)));},setServerCertificate:function(e){if(!r||!a)throw new Error("Can not set server certificate until you have selected a key system");a.setServerCertificate(e).then(function(){n.info("DRM: License server certificate successfully updated."),c.trigger(f.SERVER_CERTIFICATE_UPDATED);}).catch(function(e){c.trigger(f.SERVER_CERTIFICATE_UPDATED,{error:new g.Z(d.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,d.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)});});},createKeySession:function(e){if(!r||!a)throw new Error("Can not create sessions until you have selected a key system");var t=a.createSession(e.sessionType),i=_(t,e),o=r.systemString===w.CLEARKEY_KEYSTEM_STRING&&(e.initData||e.protData&&e.protData.clearkeys)?w.INITIALIZATION_DATA_TYPE_KEYIDS:w.INITIALIZATION_DATA_TYPE_CENC;t.generateRequest(o,e.initData).then(function(){n.debug("DRM: Session created.  SessionID = "+i.getSessionId()),c.trigger(f.KEY_SESSION_CREATED,{data:i});}).catch(function(e){E(i),c.trigger(f.KEY_SESSION_CREATED,{data:null,error:new g.Z(d.KEY_SESSION_CREATED_ERROR_CODE,d.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)});});},updateKeySession:function(e,t){var n=e.session;u.isClearKey(r)&&(t=t.toJWK()),n.update(t).then(function(){c.trigger(f.KEY_SESSION_UPDATED);}).catch(function(t){c.trigger(f.KEY_ERROR,{error:new g.Z(d.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)});});},loadKeySession:function(e){if(!r||!a)throw new Error("Can not load sessions until you have selected a key system");for(var t=e.sessionId,i=0;i<o.length;i++)if(t===o[i].sessionId)return void n.warn("DRM: Ignoring session ID because we have already seen it!");var s=a.createSession(e.sessionType),u=_(s,e);s.load(t).then(function(e){e?(n.debug("DRM: Session loaded.  SessionID = "+u.getSessionId()),c.trigger(f.KEY_SESSION_CREATED,{data:u})):(E(u),c.trigger(f.KEY_SESSION_CREATED,{data:null,error:new g.Z(d.KEY_SESSION_CREATED_ERROR_CODE,d.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}));}).catch(function(e){E(u),c.trigger(f.KEY_SESSION_CREATED,{data:null,error:new g.Z(d.KEY_SESSION_CREATED_ERROR_CODE,d.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)});});},removeKeySession:function(e){e.session.remove().then(function(){n.debug("DRM: Session removed.  SessionID = "+e.getSessionId()),c.trigger(f.KEY_SESSION_REMOVED,{data:e.getSessionId()});},function(t){c.trigger(f.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionId()+"). "+t.name});});},closeKeySession:function(e){y(e).catch(function(t){E(e),c.trigger(f.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionId()+") "+t.name});});},stop:function(){for(var e,t=0;t<o.length;t++)(e=o[t]).getUsable()||y(e).catch(function(){E(e);});},reset:function(){var e,t=o.length;0!==t?function(){for(var n=function(e){E(e),0===o.length&&(i?(i.removeEventListener("encrypted",s),i.setMediaKeys(null).then(function(){c.trigger(f.TEARDOWN_COMPLETE);})):c.trigger(f.TEARDOWN_COMPLETE));},r=0;r<t;r++)!function(t){e.session.closed.then(function(){n(t);}),y(e).catch(function(){n(t);});}(e=o[r]);}():c.trigger(f.TEARDOWN_COMPLETE);}},n=h.getLogger(t),r=null,i=null,a=null,o=[],u=re(l).getInstance(),s={handleEvent:function(e){if("encrypted"===e.type&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;c.trigger(f.NEED_KEY,{key:new le(t,e.initDataType)});}}},t;}de[w.PLAYREADY_KEYSTEM_STRING]=[w.PLAYREADY_KEYSTEM_STRING,w.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],de[w.WIDEVINE_KEYSTEM_STRING]=[w.WIDEVINE_KEYSTEM_STRING],de[w.CLEARKEY_KEYSTEM_STRING]=[w.CLEARKEY_KEYSTEM_STRING],ge.__dashjs_factory_name="ProtectionModel_21Jan2015";const he=dashjs.FactoryMaker.getClassFactory(ge);function pe(e){e=e||{};var t,n,r,i,a,o,u,l,c,f=this.context,h=e.eventBus,p=e.events,m=e.debug,y=e.api;function E(){try{for(var e=0;e<u.length;e++)v(u[e]);r&&r.removeEventListener(y.needkey,l),h.trigger(p.TEARDOWN_COMPLETE);}catch(e){h.trigger(p.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message});}}function v(e){var t=e.session;t.removeEventListener(y.error,e),t.removeEventListener(y.message,e),t.removeEventListener(y.ready,e),t.removeEventListener(y.close,e);for(var n=0;n<u.length;n++)if(u[n]===e){u.splice(n,1);break;}t[y.release]();}function _(){var e=null,t=function(){r.removeEventListener("loadedmetadata",e),r[y.setMediaKeys](a),h.trigger(p.VIDEO_ELEMENT_SELECTED);};r.readyState>=1?t():(e=t.bind(this),r.addEventListener("loadedmetadata",e));}return t={getAllInitData:function(){for(var e=[],t=0;t<u.length;t++)e.push(u[t].initData);return e;},getSessions:function(){return u;},requestKeySystemAccess:function(e){return new Promise(function(t,n){for(var r=!1,i=0;i<e.length;i++)for(var a=e[i].ks.systemString,o=e[i].configs,u=null,l=null,f=0;f<o.length;f++){var d=o[f].audioCapabilities,g=o[f].videoCapabilities;if(d&&0!==d.length){u=[];for(var m=0;m<d.length;m++)window[y.MediaKeys].isTypeSupported(a,d[m].contentType)&&u.push(d[m]);}if(g&&0!==g.length){l=[];for(var E=0;E<g.length;E++)window[y.MediaKeys].isTypeSupported(a,g[E].contentType)&&l.push(g[E]);}if(!(!u&&!l||u&&0===u.length||l&&0===l.length)){r=!0;var v=new s(u,l),_=c.getKeySystemBySystemString(a),T=new fe(_,v);h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{data:T}),t({data:T});break;}}if(!r){var S="Key system access denied! -- No valid audio/video content globalConstants detected!";h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:S}),n({error:S});}});},selectKeySystem:function(e){return new Promise(function(t,n){try{a=e.mediaKeys=new window[y.MediaKeys](e.keySystem.systemString),i=e.keySystem,o=e,r&&_(),t(i);}catch(e){n({error:"Error selecting keys system ("+i.systemString+")! Could not create MediaKeys -- TODO"});}});},setMediaElement:function(e){r!==e&&(r&&r.removeEventListener(y.needkey,l),(r=e)&&(r.addEventListener(y.needkey,l),a&&_()));},createKeySession:function(e){if(!i||!a||!o)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(o.ksConfiguration.videoCapabilities&&o.ksConfiguration.videoCapabilities.length>0&&(t=o.ksConfiguration.videoCapabilities[0]),null===t&&o.ksConfiguration.audioCapabilities&&o.ksConfiguration.audioCapabilities.length>0&&(t=o.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var r=t.contentType,s=a.createSession(r,new Uint8Array(e.initData),e.cdmData?new Uint8Array(e.cdmData):null),l=function(e,t){return {session:e,keyId:t.keyId,initData:t.initData,getKeyId:function(){return this.keyId;},getSessionId:function(){return this.session.sessionId;},getExpirationTime:function(){return NaN;},getSessionType:function(){return "temporary";},handleEvent:function(e){switch(e.type){case y.error:h.trigger(p.KEY_ERROR,{error:new g.Z(d.MEDIA_KEYERR_CODE,"KeyError",this)});break;case y.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;h.trigger(p.INTERNAL_KEY_MESSAGE,{data:new ce(this,t,e.destinationURL)});break;case y.ready:n.debug("DRM: Key added."),h.trigger(p.KEY_ADDED);break;case y.close:n.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),h.trigger(p.KEY_SESSION_CLOSED,{data:this.getSessionId()});}}};}(s,e);s.addEventListener(y.error,l),s.addEventListener(y.message,l),s.addEventListener(y.ready,l),s.addEventListener(y.close,l),u.push(l),n.debug("DRM: Session created.  SessionID = "+l.getSessionId()),h.trigger(p.KEY_SESSION_CREATED,{data:l});},updateKeySession:function(e,t){var n=e.session;c.isClearKey(i)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t)),h.trigger(p.KEY_SESSION_UPDATED);},closeKeySession:v,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:E,reset:E},n=m.getLogger(t),r=null,i=null,a=null,o=null,u=[],c=re(f).getInstance(),l={handleEvent:function(e){if(e.type===y.needkey&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;h.trigger(p.NEED_KEY,{key:new le(t,"cenc")});}}},t;}pe.__dashjs_factory_name="ProtectionModel_3Feb2014";const me=dashjs.FactoryMaker.getClassFactory(pe);function ye(e){e=e||{};var t,n,r,i,a,o,u,l,c,f=this.context,h=e.eventBus,p=e.events,m=e.debug,y=e.api,E=e.errHandler;function v(){r&&S();for(var e=0;e<u.length;e++)_(u[e]);h.trigger(p.TEARDOWN_COMPLETE);}function _(e){try{r[y.cancelKeyRequest](i.systemString,e.sessionId);}catch(t){h.trigger(p.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionId+") "+t.message});}}function T(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionId==t)return e[r];return null;}return null;}function S(){r.removeEventListener(y.keyerror,c),r.removeEventListener(y.needkey,c),r.removeEventListener(y.keymessage,c),r.removeEventListener(y.keyadded,c);}return t={getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)e.push(o[t].initData);for(var n=0;n<u.length;n++)e.push(u[n].initData);return e;},getSessions:function(){return u.concat(o);},requestKeySystemAccess:function(e){return new Promise(function(t,n){var i=r;i||(i=document.createElement("video"));for(var o=!1,u=0;u<e.length;u++)for(var l=e[u].ks.systemString,c=e[u].configs,f=null,d=0;d<c.length;d++){var g=c[d].videoCapabilities;if(g&&0!==g.length){f=[];for(var m=0;m<g.length;m++)""!==i.canPlayType(g[m].contentType,l)&&f.push(g[m]);}if(f&&(!f||0!==f.length)){o=!0;var y=new s(null,f),E=a.getKeySystemBySystemString(l),v=new fe(E,y);h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{data:v}),t({data:v});break;}}if(!o){var _="Key system access denied! -- No valid audio/video content globalConstants detected!";h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:_}),n({error:_});}});},selectKeySystem:function(e){return i=e.keySystem,Promise.resolve(i);},setMediaElement:function(e){if(r!==e){if(r){S();for(var t=0;t<u.length;t++)_(u[t]);u=[];}(r=e)&&(r.addEventListener(y.keyerror,c),r.addEventListener(y.needkey,c),r.addEventListener(y.keymessage,c),r.addEventListener(y.keyadded,c),h.trigger(p.VIDEO_ELEMENT_SELECTED));}},createKeySession:function(e){if(!i)throw new Error("Can not create sessions until you have selected a key system");if(l||0===u.length){var t={sessionId:null,keyId:e.keyId,initData:e.initData,getKeyId:function(){return this.keyId;},getSessionId:function(){return this.sessionId;},getExpirationTime:function(){return NaN;},getSessionType:function(){return "temporary";}};return o.push(t),r[y.generateKeyRequest](i.systemString,new Uint8Array(e.initData)),t;}throw new Error("Multiple sessions not allowed!");},updateKeySession:function(e,t){var n=e.sessionId;if(a.isClearKey(i))for(var o=0;o<t.keyPairs.length;o++)r[y.addKey](i.systemString,t.keyPairs[o].key,t.keyPairs[o].keyID,n);else r[y.addKey](i.systemString,new Uint8Array(t),new Uint8Array(e.initData),n);h.trigger(p.KEY_SESSION_UPDATED);},closeKeySession:_,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:v,reset:v},n=m.getLogger(t),r=null,i=null,o=[],u=[],a=re(f).getInstance(),c={handleEvent:function(e){var t=null;switch(e.type){case y.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;h.trigger(p.NEED_KEY,{key:new le(r,"cenc")});break;case y.keyerror:if((t=T(u,e.sessionId))||(t=T(o,e.sessionId)),t){var i=d.MEDIA_KEYERR_CODE,a="";switch(e.errorCode.code){case 1:i=d.MEDIA_KEYERR_UNKNOWN_CODE,a+="MEDIA_KEYERR_UNKNOWN - "+d.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:i=d.MEDIA_KEYERR_CLIENT_CODE,a+="MEDIA_KEYERR_CLIENT - "+d.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:i=d.MEDIA_KEYERR_SERVICE_CODE,a+="MEDIA_KEYERR_SERVICE - "+d.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:i=d.MEDIA_KEYERR_OUTPUT_CODE,a+="MEDIA_KEYERR_OUTPUT - "+d.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:i=d.MEDIA_KEYERR_HARDWARECHANGE_CODE,a+="MEDIA_KEYERR_HARDWARECHANGE - "+d.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:i=d.MEDIA_KEYERR_DOMAIN_CODE,a+="MEDIA_KEYERR_DOMAIN - "+d.MEDIA_KEYERR_DOMAIN_MESSAGE;}a+="  System Code = "+e.systemCode,h.trigger(p.KEY_ERROR,{error:new g.Z(i,a,t)});}else n.error("No session token found for key error");break;case y.keyadded:(t=T(u,e.sessionId))||(t=T(o,e.sessionId)),t?(n.debug("DRM: Key added."),h.trigger(p.KEY_ADDED,{data:t})):n.debug("No session token found for key added");break;case y.keymessage:if((l=null!==e.sessionId&&void 0!==e.sessionId)?!(t=T(u,e.sessionId))&&o.length>0&&(t=o.shift(),u.push(t),t.sessionId=e.sessionId,h.trigger(p.KEY_SESSION_CREATED,{data:t})):o.length>0&&(t=o.shift(),u.push(t),0!==o.length&&E.error(new g.Z(d.MEDIA_KEY_MESSAGE_ERROR_CODE,d.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var s=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=s,h.trigger(p.INTERNAL_KEY_MESSAGE,{data:new ce(t,s,e.defaultURL)});}else n.warn("No session token found for key message");}}},t;}ye.__dashjs_factory_name="ProtectionModel_01b";const Ee=dashjs.FactoryMaker.getClassFactory(ye);var ve=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],_e=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function Te(){var e,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r;}return null;}return e={createProtectionSystem:function(r){var i=null,a=re(t).getInstance();a.setConfig({debug:r.debug,BASE64:r.BASE64,settings:r.settings}),a.initialize();var o=function(r){var i=r.debug,a=i.getLogger(e),o=r.eventBus,s=r.errHandler,u=r.videoModel?r.videoModel.getElement():null;return u&&void 0===u.onencrypted||u&&void 0===u.mediaKeys?n(u,_e)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),me(t).create({debug:i,eventBus:o,events:r.events,api:n(u,_e)})):n(u,ve)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),Ee(t).create({debug:i,eventBus:o,errHandler:s,events:r.events,api:n(u,ve)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),he(t).create({debug:i,eventBus:o,events:r.events}));}(r);return !i&&o&&(i=S(t).create({protectionModel:o,protectionKeyController:a,eventBus:r.eventBus,debug:r.debug,events:r.events,BASE64:r.BASE64,constants:r.constants,cmcdModel:r.cmcdModel,customParametersModel:r.customParametersModel,settings:r.settings}),r.capabilities.setEncryptedMediaSupported(!0)),i;}};}Te.__dashjs_factory_name="Protection";var Se=dashjs.FactoryMaker.getClassFactory(Te);Se.events=ue,Se.errors=d,dashjs.FactoryMaker.updateClassFactory(Te.__dashjs_factory_name,Se);const be=Se;},2068:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i={DEFAULT:.5,STRONG:1,WEAK:0};function a(e,t,n){var r,a;return r=void 0===e?-1:e,a=function(e){var t=i.DEFAULT;return e!==i.DEFAULT&&e!==i.STRONG&&e!==i.WEAK||(t=e),t;}(n),{quality:r,reason:void 0===t?null:t,priority:a};}a.__dashjs_factory_name="SwitchRequest";var o=r.Z.getClassFactory(a);o.NO_CHANGE=-1,o.PRIORITY=i,r.Z.updateClassFactory(a.__dashjs_factory_name,o);const s=o;},1767:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(5628),i=n(6535),a=n(7423),o=n(895),s=n(6070),u=n(3112),l=n(1914),c=n(5435),f=n(5448),d=n(2068),g=n(3393),h="qualitySwitchRules",p="abandonFragmentRules";function m(e){e=e||{};var t,n,f=this.context,m=e.mediaPlayerModel,y=e.customParametersModel,E=e.dashMetrics,v=e.settings;function _(e){return e.filter(function(e){return e.quality>d.Z.NO_CHANGE;});}function T(e){var t,n,r,i,a,o={},s=null;if(0!==e.length){for(o[d.Z.PRIORITY.STRONG]={quality:d.Z.NO_CHANGE,reason:null},o[d.Z.PRIORITY.WEAK]={quality:d.Z.NO_CHANGE,reason:null},o[d.Z.PRIORITY.DEFAULT]={quality:d.Z.NO_CHANGE,reason:null},t=0,n=e.length;t<n;t+=1)(r=e[t]).quality!==d.Z.NO_CHANGE&&(o[r.priority].quality===d.Z.NO_CHANGE||o[r.priority].quality>r.quality)&&(o[r.priority].quality=r.quality,o[r.priority].reason=r.reason||null);return o[d.Z.PRIORITY.WEAK].quality!==d.Z.NO_CHANGE&&(s=o[d.Z.PRIORITY.WEAK]),o[d.Z.PRIORITY.DEFAULT].quality!==d.Z.NO_CHANGE&&(s=o[d.Z.PRIORITY.DEFAULT]),o[d.Z.PRIORITY.STRONG].quality!==d.Z.NO_CHANGE&&(s=o[d.Z.PRIORITY.STRONG]),s&&(i=s.quality,a=s.reason),(0, d.Z)(f).create(i,a);}}return {initialize:function(){t=[],n=[],v.get().streaming.abr.useDefaultABRRules&&(v.get().streaming.abr.ABRStrategy===g.Z.ABR_STRATEGY_L2A?t.push((0, l.Z)(f).create({dashMetrics:E,settings:v})):v.get().streaming.abr.ABRStrategy===g.Z.ABR_STRATEGY_LoLP?t.push((0, c.Z)(f).create({dashMetrics:E})):(t.push((0, u.Z)(f).create({dashMetrics:E,mediaPlayerModel:m,settings:v})),t.push((0, r.Z)(f).create({dashMetrics:E})),v.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&t.push((0, i.Z)(f).create({dashMetrics:E,settings:v})),v.get().streaming.abr.additionalAbrRules.switchHistoryRule&&t.push((0, s.Z)(f).create()),v.get().streaming.abr.additionalAbrRules.droppedFramesRule&&t.push((0, o.Z)(f).create()),v.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&n.push((0, a.Z)(f).create({dashMetrics:E,mediaPlayerModel:m,settings:v})))),y.getAbrCustomRules().forEach(function(e){e.type===h&&t.push(e.rule(f).create()),e.type===p&&n.push(e.rule(f).create());});},reset:function(){[t,n].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset();});}),t=[],n=[];},getMaxQuality:function(e){return T(_(t.map(function(t){return t.getMaxIndex(e);})))||(0, d.Z)(f).create();},getMinSwitchRequest:T,shouldAbandonFragment:function(e,t){return T(_(n.map(function(n){return n.shouldAbandon(e,t);})))||(0, d.Z)(f).create();},getQualitySwitchRules:function(){return t;}};}m.__dashjs_factory_name="ABRRulesCollection";var y=f.Z.getClassFactory(m);y.QUALITY_SWITCH_RULES=h,y.ABANDON_FRAGMENT_RULES=p,f.Z.updateSingletonFactory(m.__dashjs_factory_name,y);const E=y;},7423:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(2068),i=n(5448),a=n(6398);function o(e){e=e||{};var t,n,i,s,u,l=this.context,c=e.mediaPlayerModel,f=e.dashMetrics,d=e.settings;function g(){i={},s={},u=[];}return t={shouldAbandon:function(e){var t=(0, r.Z)(l).create(r.Z.NO_CHANGE,{name:o.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var a,g,h=e.getMediaInfo(),p=e.getMediaType(),m=e.getStreamInfo(),y=m?m.id:null,E=e.getCurrentRequest();if(!isNaN(E.index)){a=p,g=E.index,i[a]=i[a]||{},i[a][g]=i[a][g]||{};var v=c.getStableBufferTime();if(f.getCurrentBufferLevel(p)>v)return t;var _=i[p][E.index];if(null===_||null===E.firstByteDate||s.hasOwnProperty(_.id))return t;if(void 0===_.firstByteTime&&(u[p]=[],_.firstByteTime=E.firstByteDate.getTime(),_.segmentDuration=E.duration,_.bytesTotal=E.bytesTotal,_.id=E.index),_.bytesLoaded=E.bytesLoaded,_.elapsedTime=new Date().getTime()-_.firstByteTime,_.bytesLoaded>0&&_.elapsedTime>0&&function(e,t){u[e]=u[e]||[],u[e].push(t);}(p,Math.round(8*_.bytesLoaded/_.elapsedTime)),u[p].length>=5&&_.elapsedTime>500&&_.bytesLoaded<_.bytesTotal){var T=u[p].reduce(function(e,t){return e+t;},0);if(_.measuredBandwidthInKbps=Math.round(T/u[p].length),_.estimatedTimeOfDownload=+(8*_.bytesTotal/_.measuredBandwidthInKbps/1e3).toFixed(2),_.estimatedTimeOfDownload<1.8*_.segmentDuration||0===e.getRepresentationInfo().quality)return t;if(!s.hasOwnProperty(_.id)){var S=e.getAbrController(),b=_.bytesTotal-_.bytesLoaded,A=S.getBitrateList(h),I=S.getQualityForBitrate(h,_.measuredBandwidthInKbps*d.get().streaming.abr.bandwidthSafetyFactor,y),R=S.getMinAllowedIndexFor(p,y),w=void 0!==R?Math.max(R,I):I;b>_.bytesTotal*A[w].bitrate/A[S.getQualityFor(p,y)].bitrate&&(t.quality=w,t.reason.throughput=_.measuredBandwidthInKbps,t.reason.fragmentID=_.id,t.reason.rule=this.getClassName(),s[_.id]=_,n.debug("["+p+"] frag id",_.id," is asking to abandon and switch to quality to ",w," measured bandwidth was",_.measuredBandwidthInKbps),delete i[p][_.id]);}}else _.bytesLoaded===_.bytesTotal&&delete i[p][_.id];}return t;},reset:g},n=(0, a.Z)(l).getInstance().getLogger(t),g(),t;}o.__dashjs_factory_name="AbandonRequestsRule";const s=i.Z.getClassFactory(o);},3112:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(3860),i=n(2068),a=n(5448),o=n(7855),s=n(5595),u=n(8512),l=n(6398),c=n(8825),f=n(3393),d=10;function g(e){e=e||{};var t,n,a,g=this.context,h=e.dashMetrics,p=e.mediaPlayerModel,m=(0, s.Z)(g).getInstance();function y(e,t,n){var r=n.reduce(function(e,t,r){return t>n[e]?r:e;},0);if(0===r)return null;var i=Math.max(e,d+2*t.length),a=(n[r]-1)/(i/d-1);return {gp:a,Vp:d/a};}function E(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN;}function v(e,t){var n=p.getStableBufferTime();if(e.stableBufferTime!==n){var r=y(n,e.bitrates,e.utilities);if(r.Vp!==e.Vp||r.gp!==e.gp){var i=h.getCurrentBufferLevel(t),a=i+e.placeholderBuffer;a-=d,a*=r.Vp/e.Vp,a+=d,e.stableBufferTime=n,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,a-i);}}}function _(e,t){return e.Vp*(e.utilities[t]+e.gp);}function T(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,u);}return i;}function S(e){var t=e.mediaType===f.Z.AUDIO?[f.Z.AUDIO]:a;for(var n in t)a.hasOwnProperty(n)&&2===a[n].state&&(a[n].placeholderBuffer=0);}function b(){for(var e in a)if(a.hasOwnProperty(e)){var t=a[e];0!==t.state&&(t.state=1,E(t));}}function A(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=a[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,R(t,e.chunk.mediaInfo.type);}}}function I(e){if(e&&e.metric===r.Z.HTTP_REQUEST&&e.value&&e.value.type===o.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=a[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),R(t,e.mediaType));}}function R(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var n=h.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=_(e,e.lastQuality),i=Math.max(0,r-n);e.placeholderBuffer=Math.min(i,e.placeholderBuffer);}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN;}}function w(e){if(e){var t=a[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality);}}function N(e){if(e){var t=a[e.mediaType];if(t&&0!==t.state){var n,r=h.getCurrentBufferLevel(e.mediaType);n=t.abrQuality>0?T(t,t.abrQuality):d;var i=Math.max(0,n-r);t.placeholderBuffer=Math.min(t.placeholderBuffer,i);}}}function C(){a={};}return t={getMaxIndex:function(e){var t=(0, i.Z)(g).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var r=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),u=e.getStreamInfo(),l=e.getAbrController(),c=l.getThroughputHistory(),f=u?u.id:null,d=u&&u.manifestInfo&&u.manifestInfo.isDynamic,m=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!m)return t;s.setTimeToLoadDelay(0);var S=function(e){var t=e.getMediaType(),n=a[t];return n?0!==n.state&&v(n,t):(n=function(e){var t={},n=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth;}),r=function(e){return e.map(function(e){return Math.log(e);});}(n);r=r.map(function(e){return e-r[0]+1;});var i=p.getStableBufferTime(),a=y(i,n,r);return a?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,E(t)):t.state=0,t;}(e),a[t]=n),n;}(e);if(0===S.state)return t;var b,A=h.getCurrentBufferLevel(o),I=c.getAverageThroughput(o,d),R=c.getSafeAverageThroughput(o,d),w=c.getAverageLatency(o);if(t.reason.state=S.state,t.reason.throughput=I,t.reason.latency=w,isNaN(I))return t;switch(S.state){case 1:b=l.getQualityForBitrate(r,R,f,w),t.quality=b,t.reason.throughput=R,S.placeholderBuffer=Math.max(0,T(S,b)-A),S.lastQuality=b,!isNaN(S.lastSegmentDurationS)&&A>=S.lastSegmentDurationS&&(S.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r);}}else {var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i);}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,v(e,t);}(S,o),b=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a);}return r;}(S,A+S.placeholderBuffer);var N=l.getQualityForBitrate(r,R,f,w);b>S.lastQuality&&b>N&&(b=Math.max(N,S.lastQuality));var C=Math.max(0,A+S.placeholderBuffer-_(S,b));C<=S.placeholderBuffer?(S.placeholderBuffer-=C,C=0):(C-=S.placeholderBuffer,S.placeholderBuffer=0,b<l.getMaxAllowedIndexFor(o,f)?s.setTimeToLoadDelay(1e3*C):C=0),t.quality=b,t.reason.throughput=I,t.reason.latency=w,t.reason.bufferLevel=A,t.reason.placeholderBuffer=S.placeholderBuffer,t.reason.delay=C,S.lastQuality=b;break;default:n.debug("BOLA ABR rule invoked in bad state."),t.quality=l.getQualityForBitrate(r,R,f,w),t.reason.state=S.state,t.reason.throughput=R,t.reason.latency=w,S.state=1,E(S);}return t;},reset:function(){C(),m.off(c.Z.BUFFER_EMPTY,S,t),m.off(c.Z.PLAYBACK_SEEKING,b,t),m.off(c.Z.METRIC_ADDED,I,t),m.off(c.Z.QUALITY_CHANGE_REQUESTED,w,t),m.off(c.Z.FRAGMENT_LOADING_ABANDONED,N,t),m.off(u.Z.MEDIA_FRAGMENT_LOADED,A,t);}},n=(0, l.Z)(g).getInstance().getLogger(t),C(),m.on(c.Z.BUFFER_EMPTY,S,t),m.on(c.Z.PLAYBACK_SEEKING,b,t),m.on(c.Z.METRIC_ADDED,I,t),m.on(c.Z.QUALITY_CHANGE_REQUESTED,w,t),m.on(c.Z.FRAGMENT_LOADING_ABANDONED,N,t),m.on(u.Z.MEDIA_FRAGMENT_LOADED,A,t),t;}g.__dashjs_factory_name="BolaRule";const h=a.Z.getClassFactory(g);},895:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i=n(2068),a=n(6398);function o(){var e,t,n=this.context;return e={getMaxIndex:function(e){var r=(0, i.Z)(n).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return r;var a=e.getDroppedFramesHistory(),o=e.getStreamInfo().id;if(a){var s=a.getFrameHistory(o);if(!s||0===s.length)return r;for(var u=0,l=0,c=i.Z.NO_CHANGE,f=1;f<s.length;f++)if(s[f]&&(u=s[f].droppedVideoFrames,(l=s[f].totalVideoFrames)>375&&u/l>.15)){c=f-1,t.debug("index: "+c+" Dropped Frames: "+u+" Total Frames: "+l);break;}return (0, i.Z)(n).create(c,{droppedFrames:u});}return r;}},t=(0, a.Z)(n).getInstance().getLogger(e),e;}o.__dashjs_factory_name="DroppedFramesRule";const s=r.Z.getClassFactory(o);},6535:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(5595),i=n(8512),a=n(5448),o=n(6398),s=n(2068),u=n(3393),l=n(3860),c=n(8825);function f(e){e=e||{};var t,n,a,f=this.context,d=(0, r.Z)(f).getInstance(),g=e.dashMetrics;function h(){(a={})[u.Z.VIDEO]={ignoreCount:2},a[u.Z.AUDIO]={ignoreCount:2};}function p(){h();}function m(e){isNaN(e.startTime)||e.mediaType!==u.Z.AUDIO&&e.mediaType!==u.Z.VIDEO||a[e.mediaType].ignoreCount>0&&a[e.mediaType].ignoreCount--;}return t={getMaxIndex:function(e){var t=(0, s.Z)(f).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!g||!g.hasOwnProperty("getCurrentBufferLevel")||!g.hasOwnProperty("getCurrentBufferState"))throw new Error(u.Z.MISSING_CONFIG_ERROR);}();var r=e.getMediaType(),i=g.getCurrentBufferState(r),o=e.getRepresentationInfo().fragmentDuration,c=e.getStreamInfo(),d=c?c.id:null,h=e.getScheduleController(),p=c&&c.manifestInfo&&c.manifestInfo.isDynamic;if(function(e,t){return !e&&a[t].ignoreCount>0;}(h.getPlaybackController().getLowLatencyModeEnabled(),r)||!o)return t;if(i&&i.state===l.Z.BUFFER_EMPTY)n.debug("["+r+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty";else {var m=e.getMediaInfo(),y=e.getAbrController(),E=y.getThroughputHistory(),v=g.getCurrentBufferLevel(r),_=E.getAverageThroughput(r,p),T=E.getAverageLatency(r),S=_*(v/o)*.5;t.quality=y.getQualityForBitrate(m,S,d,T),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering";}return t;},reset:function(){h(),d.off(c.Z.PLAYBACK_SEEKING,p,t),d.off(i.Z.BYTES_APPENDED_END_FRAGMENT,m,t);}},n=(0, o.Z)(f).getInstance().getLogger(t),h(),d.on(c.Z.PLAYBACK_SEEKING,p,t),d.on(i.Z.BYTES_APPENDED_END_FRAGMENT,m,t),t;}f.__dashjs_factory_name="InsufficientBufferRule";const d=a.Z.getClassFactory(f);},1914:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(3860),i=n(2068),a=n(5448),o=n(7855),s=n(5595),u=n(8512),l=n(6398),c=n(3393);function f(e){e=e||{};var t,n,a,f,d=this.context,g=e.dashMetrics,h=(0, s.Z)(d).getInstance();function p(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN;}function m(){for(var e in n)if(n.hasOwnProperty(e)){var t=n[e];0!==t.state&&(t.state=1,p(t));}}function y(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=n[e.chunk.mediaInfo.type],r=a[e.chunk.mediaInfo.type];if(t&&0!==t.state){var i=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||i>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=i,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=i,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,v(t,r);}}}function E(e){if(e&&e.metric===r.Z.HTTP_REQUEST&&e.value&&e.value.type===o.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=n[e.mediaType],i=a[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),v(t,i));}}function v(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN);}function _(e){if(e&&e.mediaType){var t=n[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality);}}function T(e,t){if(e.length!==t.length)return -1;for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n;}function S(){n={},a={};}return t={getMaxIndex:function(e){var t,r=(0, i.Z)(d).create(),o=Math.pow(4,.99),s=Math.max(Math.pow(4,1),o*Math.sqrt(4)),u=e.getMediaInfo(),l=e.getMediaType(),h=u.bitrateList.map(function(e){return e.bandwidth;}),m=h.length,y=e.getScheduleController(),E=e.getStreamInfo(),v=e.getAbrController(),_=v.getThroughputHistory(),S=E&&E.manifestInfo&&E.manifestInfo.isDynamic,b=e.useL2AABR(),A=g.getCurrentBufferLevel(l,!0),I=_.getSafeAverageThroughput(l,S),R=_.getAverageThroughput(l,S),w=_.getAverageLatency(l),N=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return r;if(r.reason=r.reason||{},!b||l===c.Z.AUDIO)return r;y.setTimeToLoadDelay(0);var C=function(e){var t=e.getMediaType(),r=n[t];return r||(r=function(e){var t={},n=e.getMediaInfo(),r=n.bitrateList.map(function(e){return e.bandwidth/1e3;});return t.state=1,t.bitrates=r,t.lastQuality=0,function(e){e&&e.type&&(a[e.type]={},a[e.type].w=[],a[e.type].prev_w=[],a[e.type].Q=0,a[e.type].segment_request_start_s=0,a[e.type].segment_download_finish_s=0,a[e.type].B_target=1.5);}(n),p(t),t;}(e),n[t]=r),r;}(e);if(0===C.state)return r;var D=a[l];if(!D)return r;if(r.reason.state=C.state,r.reason.throughput=R,r.reason.latency=w,isNaN(R))return r;switch(C.state){case 1:if(t=v.getQualityForBitrate(u,I,E.id,w),r.quality=t,r.reason.throughput=I,C.lastQuality=t,!isNaN(C.lastSegmentDurationS)&&A>=D.B_target){C.state=2,D.Q=o;for(var O=0;O<m;++O)O===C.lastQuality?D.prev_w[O]=1:D.prev_w[O]=0;}break;case 2:var M=[],P=g.getCurrentHttpRequest(l).trace.reduce(function(e,t){return e+t.d;},0),L=g.getCurrentHttpRequest(l).trace.reduce(function(e,t){return e+t.b[0];},0),x=Math.round(8*L/P);x<1&&(x=1);for(var F=C.lastSegmentDurationS,k=1,U=0;U<m;++U)h[U]=h[U]/1e3,N*h[U]>x&&(k=-1),D.w[U]=D.prev_w[U]+k*(F/(2*s))*((D.Q+o)*(N*h[U]/x));D.w=function(e){for(var t=e.length,n=!1,r=[],i=0;i<t;++i)r[i]=e[i];for(var a=e.sort(function(e,t){return t-e;}),o=0,s=0,u=[],l=0;l<t-1;++l)if((s=((o+=a[l])-1)/(l+1))>=a[l+1]){n=!0;break;}n||(s=(o+a[t-1]-1)/t);for(var c=0;c<t;++c)u[c]=Math.max(r[c]-s,0);return u;}(D.w);for(var Z=0;Z<m;++Z)M[Z]=D.w[Z]-D.prev_w[Z],D.prev_w[Z]=D.w[Z];D.Q=Math.max(0,D.Q-F+F*N*((T(h,D.prev_w)+T(h,M))/x));for(var B=[],G=0;G<m;++G)B[G]=Math.abs(h[G]-T(D.w,h));(t=B.indexOf(Math.min.apply(Math,B)))>C.lastQuality&&h[C.lastQuality+1]<=x&&(t=C.lastQuality+1),h[t]>=x&&(D.Q=2*Math.max(o,D.Q)),r.quality=t,r.reason.throughput=R,r.reason.latency=w,r.reason.bufferLevel=A,C.lastQuality=r.quality;break;default:f.debug("L2A ABR rule invoked in bad state."),r.quality=v.getQualityForBitrate(u,I,E.id,w),r.reason.state=C.state,r.reason.throughput=I,r.reason.latency=w,C.state=1,p(C);}return r;},reset:function(){S(),h.off(u.Z.PLAYBACK_SEEKING,m,t),h.off(u.Z.MEDIA_FRAGMENT_LOADED,y,t),h.off(u.Z.METRIC_ADDED,E,t),h.off(u.Z.QUALITY_CHANGE_REQUESTED,_,t);}},f=(0, l.Z)(d).getInstance().getLogger(t),S(),h.on(u.Z.PLAYBACK_SEEKING,m,t),h.on(u.Z.MEDIA_FRAGMENT_LOADED,y,t),h.on(u.Z.METRIC_ADDED,E,t),h.on(u.Z.QUALITY_CHANGE_REQUESTED,_,t),t;}f.__dashjs_factory_name="L2ARule";const d=a.Z.getClassFactory(f);},6070:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(5448),i=n(6398),a=n(2068);function o(){var e,t,n=this.context;return e={getMaxIndex:function(e){for(var r=e?e.getSwitchHistory():null,i=r?r.getSwitchRequests():[],o=0,s=0,u=0,l=(0, a.Z)(n).create(),c=0;c<i.length;c++)if(void 0!==i[c]&&(o+=i[c].drops,s+=i[c].noDrops,u+=i[c].dropSize,o+s>=6&&o/s>.075)){l.quality=c>0&&i[c].drops>0?c-1:c,l.reason={index:l.quality,drops:o,noDrops:s,dropSize:u},t.debug("Switch history rule index: "+l.quality+" samples: "+(o+s)+" drops: "+o);break;}return l;}},t=(0, i.Z)(n).getInstance().getLogger(e),e;}o.__dashjs_factory_name="SwitchHistoryRule";const s=r.Z.getClassFactory(o);},5628:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(5448),i=n(2068),a=n(3393),o=n(3860);function s(e){e=e||{};var t=this.context,n=e.dashMetrics;return {getMaxIndex:function(e){var r=(0, i.Z)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return r;!function(){if(!n||!n.hasOwnProperty("getCurrentBufferState"))throw new Error(a.Z.MISSING_CONFIG_ERROR);}();var s=e.getMediaInfo(),u=e.getMediaType(),l=n.getCurrentBufferState(u),c=e.getScheduleController(),f=e.getAbrController(),d=e.getStreamInfo(),g=d?d.id:null,h=d&&d.manifestInfo?d.manifestInfo.isDynamic:null,p=f.getThroughputHistory(),m=p.getSafeAverageThroughput(u,h),y=p.getAverageLatency(u),E=e.useBufferOccupancyABR();return isNaN(m)||!l||E||f.getAbandonmentStateFor(g,u)!==o.Z.ABANDON_LOAD&&(l.state===o.Z.BUFFER_LOADED||h)&&(r.quality=f.getQualityForBitrate(s,m,g,y),c.setTimeToLoadDelay(0),r.reason={throughput:m,latency:y}),r;},reset:function(){}};}s.__dashjs_factory_name="ThroughputRule";const u=r.Z.getClassFactory(s);},4722:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5448),i=n(6398);function a(){var e,t,n,r,a,o,s,u,l,c=this.context;function f(){n=null,r=1,a=100,o=0,s=null,u=null,l="dynamic_weight_selection";}function d(){var e=0;if(n)for(var t=0;t<n.length;t++){var r=n[t];r.state.throughput>e&&(e=r.state.throughput);}return e;}function g(e,t,n){var r=e.map(function(e,r){return n[r]*Math.pow(e-t[r],2);}).reduce(function(e,t){return e+t;});return (r<0?-1:1)*Math.sqrt(Math.abs(r));}function h(e,t){return g([e.state.throughput,e.state.latency,e.state.rebuffer,e.state.switch],[t.state.throughput,t.state.latency,t.state.rebuffer,t.state.switch],[1,1,1,1]);}function p(e,t,n){for(var r=0;r<t.length;r++){var i=t[r],a=h(i,e);m(i,n,Math.exp(-1*Math.pow(a,2)/(2*Math.pow(.1,2))));}}function m(e,t,n){var r=e.state,i=[.01,.01,.01,.01];r.throughput=r.throughput+(t[0]-r.throughput)*i[0]*n,r.latency=r.latency+(t[1]-r.latency)*i[1]*n,r.rebuffer=r.rebuffer+(t[2]-r.rebuffer)*i[2]*n,r.switch=r.switch+(t[3]-r.switch)*i[3]*n;}return e={getNextQuality:function(e,i,c,f,h,m,y){var E=c,v=f,_=i,T=function(e){if(!n){n=[];var t=e.bitrateList,i=[];o=t[0].bandwidth,t.forEach(function(e){i.push(e.bandwidth),e.bandwidth<o&&(o=e.bandwidth);}),l=i.map(function(e){return Math.pow(e,2);}).reduce(function(e,t){return e+t;}),r=Math.sqrt(l);for(var a=0;a<t.length;a++){var s={qualityIndex:a,bitrate:t[a].bandwidth,state:{throughput:t[a].bandwidth/r,latency:0,rebuffer:0,switch:0}};n.push(s);}u=function(e){var t=[],n=function(e){for(var t=[],n=0;n<e;n++){var r=[Math.random()*d(),Math.random(),Math.random(),Math.random()];t.push(r);}return t;}(Math.pow(e.length,2));t.push(n[0]);for(var r=[1,1,1,1],i=1;i<e.length;i++){for(var a=null,o=null,s=0;s<n.length;s++){for(var u=n[s],l=null,c=0;c<t.length;c++){var f=g(u,t[c],r);(null===l||f<l)&&(l=f);}(null===o||l>o)&&(a=u,o=l);}t.push(a);}for(var h=null,p=null,m=0;m<t.length;m++){for(var y=0,E=0;E<t.length;E++)m!==E&&(y+=g(t[m],t[E],r));(null===h||y>h)&&(h=y,p=m);}var v=[];for(v.push(t[p]),t.splice(p,1);t.length>0;){for(var _=null,T=null,S=0;S<t.length;S++){var b=g(v[0],t[S],r);(null===_||b<_)&&(_=b,T=S);}v.push(t[T]),t.splice(T,1);}return v;}(n);}var l;return n;}(e),S=i/r;S>1&&(S=d()),c/=a,t.debug("getNextQuality called throughput:".concat(S," latency:").concat(c," bufferSize:").concat(f," currentQualityIndex:").concat(m," playbackRate:").concat(h));var b=T[m],A=b.bitrate*y.getSegmentDuration()/_,I=Math.max(0,A-v);if(v-A<y.getMinBuffer())return t.debug("Buffer is low for bitrate= ".concat(b.bitrate," downloadTime=").concat(A," currentBuffer=").concat(v," rebuffer=").concat(I)),function(e,t){var r=0,i=e;if(n)for(var a=0;a<n.length;a++){var o=n[a];o.bitrate<e.bitrate&&o.bitrate>r&&t>o.bitrate&&(r=o.bitrate,i=o);}return i;}(b,_).qualityIndex;switch(l){case"manual_weight_selection":s=[.4,.4,.4,.4];break;case"random_weight_selection":!function(e){s=function(e,t){for(var n=[],r=Math.sqrt(2/e),i=0;i<4;i++)n.push(Math.random()*r);return s=n;}(e.length);}(T);break;default:!function(e,t,n,r,i,a,o){s||(s=u[u.length-1]);var l=e.findWeightVector(t,n,r,i,a,o);null!==l&&-1!==l&&(s=l);}(y,T,E,v,I,_,h);}for(var R=null,w=null,N=null,C=0;C<T.length;C++){var D=T[C],O=D.state,M=[O.throughput,O.latency,O.rebuffer,O.switch],P=s.slice(),L=y.getNextBufferWithBitrate(D.bitrate,v,_),x=L<y.getMinBuffer();x&&t.debug("Buffer is low for bitrate=".concat(D.bitrate," downloadTime=").concat(A," currentBuffer=").concat(v," nextBuffer=").concat(L)),(D.bitrate>i-1e4||x)&&D.bitrate!==o&&(P[0]=100);var F=g(M,[S,0,0,0],P);(null===R||F<R)&&(R=F,w=D.qualityIndex,N=D);}var k=Math.abs(b.bitrate-N.bitrate)/r;return p(b,T,[S,c,I,k]),p(N,T,[S,0,0,k]),w;},reset:function(){f();}},t=(0, i.Z)(c).getInstance().getLogger(e),f(),e;}a.__dashjs_factory_name="LearningAbrController";const o=r.Z.getClassFactory(a);},5317:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5448),i=n(2298);function a(){var e,t,n,r,a;function o(){t=null,n=null,r=null,a=null;}function s(e,t,n,r){var a=new i.Z();return a.type=e,a.weights.bitrateReward=t||1,a.weights.bitrateSwitchPenalty=1,a.weights.rebufferPenalty=n||1e3,a.weights.latencyPenalty=[],a.weights.latencyPenalty.push({threshold:1.1,penalty:.05*r}),a.weights.latencyPenalty.push({threshold:1e8,penalty:.1*n}),a.weights.playbackSpeedPenalty=r||200,a;}function u(e,t,n,r,i){i.bitrateWSum+=i.weights.bitrateReward*e,i.lastBitrate&&(i.bitrateSwitchWSum+=i.weights.bitrateSwitchPenalty*Math.abs(e-i.lastBitrate)),i.lastBitrate=e,i.rebufferWSum+=i.weights.rebufferPenalty*t;for(var a=0;a<i.weights.latencyPenalty.length;a++){var o=i.weights.latencyPenalty[a];if(n<=o.threshold){i.latencyWSum+=o.penalty*n;break;}}i.playbackSpeedWSum+=i.weights.playbackSpeedPenalty*Math.abs(1-r),i.totalQoe=i.bitrateWSum-i.bitrateSwitchWSum-i.rebufferWSum-i.latencyWSum-i.playbackSpeedWSum;}return e={setupPerSegmentQoe:function(e,i,o){t=s("segment",e,i,o),n=e,r=i,a=o;},logSegmentMetrics:function(e,n,r,i){t&&u(e,n,r,i,t);},getPerSegmentQoe:function(){return t;},calculateSingleUseQoe:function(e,t,i,o){var l=null;return n&&r&&a&&(l=s("segment",n,r,a)),l?(u(e,t,i,o,l),l.totalQoe):0;},reset:function(){o();}},o(),e;}a.__dashjs_factory_name="LoLpQoeEvaluator";const o=r.Z.getClassFactory(a);},5435:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(6398),i=n(5448),a=n(4722),o=n(5317),s=n(2068),u=n(3860),l=n(6523),c=n(3393);function f(e){var t,n,i,f,d=(e=e||{}).dashMetrics,g=this.context;return n={getMaxIndex:function(e){try{var n=(0,s.Z)(g).create(),r=e.getMediaInfo().type,a=e.getAbrController(),o=e.getStreamInfo(),h=a.getQualityFor(r,o.id),p=e.getMediaInfo(),m=d.getCurrentBufferState(r),y=e.getScheduleController(),E=d.getCurrentBufferLevel(r,!0),v=o&&o.manifestInfo?o.manifestInfo.isDynamic:null,_=y.getPlaybackController(),T=_.getCurrentLiveLatency();if(!e.useLoLPABR()||r===c.Z.AUDIO)return n;T||(T=0);var S=_.getPlaybackRate(),b=a.getThroughputHistory().getSafeAverageThroughput(r,v);if(t.debug("Throughput ".concat(Math.round(b)," kbps")),isNaN(b)||!m)return n;if(a.getAbandonmentStateFor(o.id,r)===u.Z.ABANDON_LOAD)return n;for(var A=p.bitrateList,I=e.getRepresentationInfo().fragmentDuration,R=A[0].bandwidth/1e3,w=A[A.length-1].bandwidth/1e3,N=0;N<A.length;N++){var C=A[N].bandwidth/1e3;C>w?w=C:C<R&&(R=C);}var D=A[h].bandwidth/1e3,O=d.getCurrentHttpRequest(r,!0),M=(O.tresponse.getTime()-O.trequest.getTime())/1e3,P=M>I?M-I:0;f.setupPerSegmentQoe(I,w,R),f.logSegmentMetrics(D,P,T,S);var L=(0,l.Z)(g).create({targetLatency:1.5,bufferMin:.3,segmentDuration:I,qoeEvaluator:f});return n.quality=i.getNextQuality(p,1e3*b,T,E,S,h,L),n.reason={throughput:b,latency:T},n.priority=s.Z.PRIORITY.STRONG,y.setTimeToLoadDelay(0),n.quality!==h&&console.log("[TgcLearningRule]["+r+"] requesting switch to index: ",n.quality,"Average throughput",Math.round(b),"kbps"),n;}catch(e){throw e;}},reset:function(){i.reset(),f.reset();}},t=(0, r.Z)(g).getInstance().getLogger(n),i=(0, a.Z)(g).create(),f=(0, o.Z)(g).create(),n;}f.__dashjs_factory_name="LoLPRule";const d=i.Z.getClassFactory(f);},6523:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(5448);function i(e){var t,n,r,i,a=e.targetLatency,o=e.bufferMin,s=e.segmentDuration,u=e.qoeEvaluator;function l(){return s;}function c(e,t){var n=l();return t>n?e-n:e+n-t;}return t={getMinBuffer:function(){return o;},getSegmentDuration:l,getNextBufferWithBitrate:function(e,t,n){return c(t,e*s/n);},getNextBuffer:c,findWeightVector:function(e,t,i,l,f,d){var g=null,h=null,p=null,m=Math.abs(t-r);return e.forEach(function(e){n.forEach(function(n){n[0];var r=n[1],l=n[2],y=(n[3],e.bitrate*s/f),E=c(i,y),v=(0===l?10:1/l)*Math.max(1e-5,y-E),_=(0===r?10:1/r)*e.state.latency,T=u.calculateSingleUseQoe(e.bitrate,v,_,d);(null===g||T>g)&&function(e,t,n){return !(e>a+n)&&t>=o;}(t,E,m)&&(g=T,h=n,p=e.bitrate);});}),null===h&&null===p&&(h=-1),r=t,h;}},n=function e(t,n,r){if(r===n)return t;for(var a=t.length,o=0;o<a;o++)for(var s=t.shift(),u=0;u<i.length;u++)t.push(s.concat(i[u]));return e(t,n,r+1);}((i=[.2,.4,.6,.8,1]).map(function(e){return [e];}),4,1),r=0,t;}i.__dashjs_factory_name="LoLpWeightSelector";const a=r.Z.getClassFactory(i);},2298:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0;};},7803:(e,t,n)=>{n.d(t,{Y:()=>g,Z:()=>p});var r=n(3393),i=n(1553),a=n(5448),o=n(2128),s=n(2594),u=n(7387),l=n(7417),c=n(9032),f=n(9326),d=n(7802),g=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function h(e){var t,n,a,h,p,m,y,E,v=this.context,_=e.adapter,T=e.baseURLController,S=e.streamInfo,b=e.timelineConverter,A=e.debug,I=e.eventBus,R=e.events,w=e.dashConstants,N=(0, s.Z)(v).getInstance();function C(e,t){var r=new o.Z();r.id=e.id,r.bitrate=e.bandwidth,r.width=e.width,r.height=e.height,r.tilesHor=1,r.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach(function(e){if(g.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(r.tilesHor=parseInt(t[0],10),r.tilesVert=parseInt(t[1],10));}}),t?m.updateSegmentData(e).then(function(t){!function(e,t,n){var r=[],i=function(e,t){var n,r,i,a,o=[],s=0;for(n=0,r=e.segments.length;n<r;n++)i=e.segments[n],(a=(0, u.TJ)(b,_.getIsDynamic(),t,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,s))&&(o.push(a),a=null,s++);return o;}(n,t);t.segments=i,e.segmentDuration=t.segments[0].duration,e.readThumbnail=function(e,n){var i=null;r.some(function(t){if(t.start<=e&&t.end>e)return i=t.url,!0;}),i?n(i):t.segments.some(function(i){if(i.mediaStartTime<=e&&i.mediaStartTime+i.duration>e){var a=T.resolve(t.path);return y.load({method:"get",url:a.url,request:{range:i.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=E.getSamplesInfo(e.target.response),a=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);r.push({start:i.mediaStartTime,end:i.mediaStartTime+i.duration,url:o}),n&&n(o);}}),!0;}});};}(r,e,t);}):(r.startNumber=e.startNumber,r.segmentDuration=e.segmentDuration,r.timescale=e.timescale,r.templateUrl=function(e){var t=N.isRelative(e.media)?N.resolve(e.media,T.resolve(e.path).url):e.media;return t?(0, u.Aj)(t,e.id):"";}(e)),r.tilesHor>0&&r.tilesVert>0&&(r.widthPerTile=r.width/r.tilesHor,r.heightPerTile=r.height/r.tilesVert,n.push(r));}function D(){n=[],h=-1,p=null;}return t={getTracks:function(){return n;},addTracks:function(){if(S&&_&&(p=_.getMediaInfoForType(S,r.Z.IMAGE))){var e=_.getVoRepresentations(p);e&&e.length>0&&e.forEach(function(e){(e.segmentInfoType===i.Z.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===i.Z.SEGMENT_TIMELINE)&&C(e),e.segmentInfoType===i.Z.SEGMENT_BASE&&C(e,!0);}),n.length>0&&n.sort(function(e,t){return e.bitrate-t.bitrate;});}},reset:D,setTrackByIndex:function(e){n&&0!==n.length&&(e>=n.length&&(e=n.length-1),h=e);},getCurrentTrack:function(){return h<0?null:n[h];},getCurrentTrackIndex:function(){return h;},getThumbnailRequestForTime:function(e){for(var t,r=_.getVoRepresentations(p),i=0;i<r.length;i++)if(n[h].id===r[i].id){t=r[i];break;}return a.getSegmentRequestForTime(p,t,e);}},D(),y=(0, c.Z)(v).create({}),E=(0, l.Z)(v).getInstance(),m=(0, d.Z)(v).create({events:R,eventBus:I,streamInfo:S,timelineConverter:b,dashConstants:w,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController,type:r.Z.IMAGE}),(a=(0, f.Z)(v).create({streamInfo:S,type:r.Z.IMAGE,timelineConverter:b,segmentsController:m,baseURLController:T,debug:A,eventBus:I,events:R,dashConstants:w,urlUtils:N})).initialize(!!_&&_.getIsDynamic()),t;}h.__dashjs_factory_name="ThumbnailTracks";const p=a.Z.getClassFactory(h);},7417:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(6398),i=n(8260),a=n(5448),o=n(6934),s=n(9597);function u(){var e,t,n=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.parseBuffer(e),r=(0, i.Z)(n).create();return r.setData(t),r;}function u(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0;}function l(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t]);}return t={parse:a,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.Z(0,!1);for(var r,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;n<i.byteLength;){var o=u(i,n),c=l(i,n+4);if(0===o)break;n+o<=i.byteLength&&(e.indexOf(c)>=0?r=new s.Z(n,!0,o):a=n+o),n+=o;}return r||new s.Z(a,!1);},getMediaTimescaleFromMoov:function(e){var t=a(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN;},getSamplesInfo:function(e){if(!e||0===e.byteLength)return {sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,r,i,o,s,u,l,c,f,d,g,h,p,m,y,E=a(e),v=E.getBoxes("moof"),_=E.getBoxes("mfhd");m=E.getBoxes("moof").length,p=_[_.length-1].sequence_number,n=0,o=[];var T=-1,S=-1;for(f=0;f<v.length;f++){var b=v[f],A=b.getChildBoxes("traf");for(l=0;l<A.length;l++){var I=A[l],R=I.getChildBox("tfhd"),w=I.getChildBox("tfdt");i=w.baseMediaDecodeTime;var N=I.getChildBoxes("trun"),C=I.getChildBoxes("subs");for(c=0;c<N.length;c++){var D=N[c];for(n=D.sample_count,h=(R.base_data_offset||0)+(D.data_offset||0),u=0;u<n;u++){t=void 0!==(s=D.samples[u]).sample_duration?s.sample_duration:R.default_sample_duration,r=void 0!==s.sample_size?s.sample_size:R.default_sample_size;var O={dts:i,cts:i+(void 0!==s.sample_composition_time_offset?s.sample_composition_time_offset:0),duration:t,offset:b.offset+h,size:r,subSizes:[r]};if(C)for(d=0;d<C.length;d++){var M=C[d];if(T<M.entry_count-1&&u>S&&(T++,S+=M.entries[T].sample_delta),u==S){O.subSizes=[];var P=M.entries[T];for(g=0;g<P.subsample_count;g++)O.subSizes.push(P.subsamples[g].subsample_size);}}o.push(O),h+=r,i+=t;}}y=i-w.baseMediaDecodeTime;}}return {sampleList:o,lastSequenceNumber:p,totalDuration:y,numSequences:m};},findInitRange:function(t){var n=null,r=a(t);if(!r)return n;var i=r.getBox("ftyp"),o=r.getBox("moov");return e.debug("Searching for initialization."),o&&o.isComplete&&(n=(i?i.offset:o.offset)+"-"+(o.offset+o.size-1),e.debug("Found the initialization.  Range: "+n)),n;},parsePayload:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.Z(0,!1);for(var r,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;n<i.byteLength;){var o=u(i,n),c=l(i,n+4);if(0===o)break;n+o<=i.byteLength&&(e.indexOf(c)>=0?r=new s.Z(n,!0,o,c):a=n+o),n+=o;}return r||new s.Z(a,!1);}},e=(0, r.Z)(n).getInstance().getLogger(t),t;}u.__dashjs_factory_name="BoxParser";const l=a.Z.getSingletonFactory(u);},1715:(e,t,n)=>{n.d(t,{B:()=>s,Z:()=>l});var r=n(5448),i=n(7803),a=n(3393),o=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function s(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t;}function u(){var e,t,n;return e={setConfig:function(e){e&&e.settings&&(t=e.settings);},supportsMediaSource:s,supportsEncryptedMedia:function(){return n;},supportsCodec:function(e,n){return n!==a.Z.AUDIO&&n!==a.Z.VIDEO?Promise.resolve(!0):function(e,n){return t.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(e.codec&&n===a.Z.AUDIO||n===a.Z.VIDEO&&e.codec&&e.width&&e.height&&e.bitrate&&e.framerate);}(e,n)?function(e,t){return new Promise(function(n){if(e&&e.codec){var r={type:"media-source"};r[t]={},r[t].contentType=e.codec,r[t].width=e.width,r[t].height=e.height,r[t].bitrate=parseInt(e.bitrate),r[t].framerate=parseFloat(e.framerate),navigator.mediaCapabilities.decodingInfo(r).then(function(e){n(e.supported);}).catch(function(){n(!1);});}else n(!1);});}(e,n):function(e){return new Promise(function(t){if(e&&e.codec){var n=e.codec;e.width&&e.height&&(n+=';width="'+e.width+'";height="'+e.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(n)||"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(n)?t(!0):t(!1);}else t(!1);});}(e);},setEncryptedMediaSupported:function(e){n=e;},supportsEssentialProperty:function(e){try{return -1!==i.Y.indexOf(e.schemeIdUri);}catch(e){return !0;}},codecRootCompatibleWithCodec:function(e,t){for(var n,r=e.split(".")[0],i=0===t.indexOf(r),a=0;a<o.length;a++)if(o[a].codec===r){n=o[a];break;}return n?i||n.compatibleCodecs.some(function(e){return 0===t.indexOf(e);}):i;}},n=!1,e;}u.__dashjs_factory_name="Capabilities";const l=r.Z.getSingletonFactory(u);},2295:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5448),i=n(3106);function a(){return {customTimeRangeArray:[],length:0,add:function(e,t){var n;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length;},clear:function(){this.customTimeRangeArray=[],this.length=0;},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else {if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break;}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t);}this.length=this.customTimeRangeArray.length;},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0);},start:function(e){return (0, i.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start;},end:function(e){return (0, i.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end;}};}a.__dashjs_factory_name="CustomTimeRanges";const o=r.Z.getClassFactory(a);},5:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(5448);function i(){var e,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,r=/^https:\/\//i,i=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString();}catch(t){return e;}},o=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;f(e)&&(n=u),d(e)&&(n=l);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return [r,e].join(i);};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return -1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):"";}function u(e){var t=e.match(i);return t?t[1]:"";}function l(e){var n=e.match(t);return n?n[0]:"";}function c(e){return !t.test(e);}function f(e){return c(e)&&"/"===e.charAt(0);}function d(e){return 0===e.indexOf("//");}return function(){try{new window.URL("x","http://y"),e=a;}catch(e){}finally{e=e||o;}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:c,isPathAbsolute:f,isSchemeRelative:d,isHTTPURL:function(e){return n.test(e);},isHTTPS:function(e){return r.test(e);},removeHostname:function(e){return /^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1);},resolve:function(t,n){return e(t,n);}};}i.__dashjs_factory_name="DefaultURLUtils";const a=r.Z.getSingletonFactory(i);},8260:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(2839),i=n(5448);function a(){var e;function t(t){var r=[];if(!t||!e||"function"!=typeof e.fetchAll)return r;for(var i,a=e.fetchAll(t),o=0,s=a.length;o<s;o++)(i=n(a[o]))&&r.push(i);return r;}function n(e){if(!e)return null;var t=new r.Z(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t;}return {getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null;},getBoxes:t,setData:function(t){e=t;},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null;}};}a.__dashjs_factory_name="IsoFile";const o=i.Z.getClassFactory(a);},7473:(e,t,n)=>{n.d(t,{Z:()=>o,k:()=>i});var r=n(5448);function i(e,t){var n={url:e.url,method:e.method,headers:Object.assign({},e.headers),credentials:e.withCredentials?"include":void 0};return Promise.resolve(t.modifyRequest(n)).then(function(){return Object.assign(e,n,{withCredentials:"include"===n.credentials});});}function a(){return {modifyRequest:null,modifyRequestURL:function(e){return e;},modifyRequestHeader:function(e,t){return t.url,e;}};}a.__dashjs_factory_name="RequestModifier";const o=r.Z.getSingletonFactory(a);},3106:(e,t,n)=>{n.d(t,{PS:()=>a,SE:()=>o});var r=n(3393);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},i(e);}function a(e,t){if(i(e)!==t)throw r.Z.BAD_ARGUMENT_ERROR;}function o(e){if(null===e||isNaN(e)||e%1!=0)throw r.Z.BAD_ARGUMENT_ERROR+" : argument is not an integer";}},2594:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5448),i=n(5);function a(){var e,t=[],n=this.context;function r(n,r,i){var a=function(n){var r;for(r=0;r<t.length;r++)if(t[r].regex.test(n))return t[r].utils;return e;}(i||r);return a&&"function"==typeof a[n]?a[n](r,i):e[n](r,i);}return e=(0, i.Z)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n});},parseBaseUrl:function(e){return r("parseBaseUrl",e);},parseOrigin:function(e){return r("parseOrigin",e);},parseScheme:function(e){return r("parseScheme",e);},isRelative:function(e){return r("isRelative",e);},isPathAbsolute:function(e){return r("isPathAbsolute",e);},isSchemeRelative:function(e){return r("isSchemeRelative",e);},isHTTPURL:function(e){return r("isHTTPURL",e);},isHTTPS:function(e){return r("isHTTPS",e);},removeHostname:function(e){return r("removeHostname",e);},resolve:function(e,t){return r("resolve",e,t);}};}a.__dashjs_factory_name="URLUtils";const o=r.Z.getSingletonFactory(a);},5459:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.code=t||null,this.message=n||null,this.data=r||null;};},3186:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(7855);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null;}var t,n;return t=e,(n=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===r.w.INIT_SEGMENT_TYPE;}},{key:"setInfo",value:function(e){this.type=e&&e.init?r.w.INIT_SEGMENT_TYPE:r.w.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null;}}])&&i(t.prototype,n),e;}();a.ACTION_DOWNLOAD="download",a.ACTION_COMPLETE="complete";const o=a;},2839:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}n.d(t,{Z:()=>i});const i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var r=0;r<t.references.length;r++){var i={reference_type:t.references[r].reference_type,referenced_size:t.references[r].referenced_size,subsegment_duration:t.references[r].subsegment_duration};this.references.push(i);}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s);}}break;case"prft":this.version=t.version,this.reference_track_ID=t.reference_track_ID,this.ntp_timestamp_sec=t.ntp_timestamp_sec,this.ntp_timestamp_frac=t.ntp_timestamp_frac,this.media_time=t.media_time,this.flags=t.flags;}}var t,n;return t=e,(n=[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t];}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t;}}])&&r(t.prototype,n),e;}();},9597:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r;};},2128:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id="";};},7855:(e,t,n)=>{function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}n.d(t,{O:()=>a,w:()=>i});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null;},a=function e(){r(this,e),this.s=null,this.d=null,this.b=[];};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",i.DVB_REPORTING_TYPE="DVBReporting",i.LICENSE="license",i.CONTENT_STEERING_TYPE="ContentSteering",i.OTHER_TYPE="other";},3039:(e,t)=>{function n(e,t){return function(n,i){for(var a,o,s,u=r(n,"tag"),l=r(null==i?"*":i,"range"),c=[],f=-1;++f<l.length;)if(a=l[f].toLowerCase(),t||"*"!==a){for(o=-1,s=[];++o<u.length;)if(e(u[o].toLowerCase(),a)){if(!t)return u[o];c.push(u[o]);}else s.push(u[o]);u=s;}return t?c:void 0;};}function r(e,t){var n=e&&"string"==typeof e?[e]:e;if(!n||"object"!=typeof n||!("length"in n))throw new Error("Invalid "+t+" `"+n+"`, expected non-empty string");return n;}t.basicFilter=n(function(e,t){return "*"===t||e===t||e.indexOf(t+"-")>-1;},!0),t.extendedFilter=n(function(e,t){var n=e.split("-"),r=t.split("-"),i=0,a=0;if("*"!==r[a]&&n[i]!==r[a])return !1;for(i++,a++;a<r.length;)if("*"!==r[a]){if(!n[i])return !1;if(n[i]!==r[a]){if(1===n[i].length)return !1;i++;}else i++,a++;}else a++;return !0;},!0),t.lookup=n(function(e,t){for(var n,r=t;;){if("*"===r||e===r)return !0;if((n=r.lastIndexOf("-"))<0)return !1;"-"===r.charAt(n-2)&&(n-=2),r=r.slice(0,n);}});},3973:(e,t,n)=>{e.exports=n(3854);},3854:(e,t,n)=>{var r=n(2415),i=n(3039),a=n(7778),o=n(5813),s=n(3165),u=n(9460);e.exports=function(e,t){var n,c=t||{},m=r.parse(String(e||"").toLowerCase(),c),y=r.stringify(m),E=-1;if(!y)return y;for(;++E<a.length;)i.extendedFilter(y,a[E].from).length&&(d(m,a[E].from,a[E].to),y=r.stringify(m));for(E=-1;++E<o.length;)g(m,o[E].from.field,o[E].from.value)&&h(m,o[E].to.field,o[E].to.value);for(y=r.stringify(Object.assign({},m,f)),E=-1;++E<s.length;)y===s[E]&&(d(m,s[E],s[E].split("-").slice(0,-1).join("-")),y=r.stringify(Object.assign({},m,f)));if(m.extensions.sort(p),c.warning)for(n in u)l.call(u[n],m[n])&&c.warning("Deprecated "+n+" `"+m[n]+"`, expected one of `"+u[n][m[n]].join("`, `")+"`",null,7);return m.script&&(m.script=m.script.charAt(0).toUpperCase()+m.script.slice(1)),m.region&&(m.region=m.region.toUpperCase()),r.stringify(m);};var l={}.hasOwnProperty,c=new Intl.Collator(),f={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function d(e,t,n){var i,a=r.parse(t),o=r.parse(n),s=[];for(i in a)a[i]&&a[i].length&&g(e,i,a[i])&&s.push(i);for(i in o)o[i]&&o[i].length&&(s.indexOf(i)>-1||!e[i]||!e[i].length)&&h(e,i,o[i]);}function g(e,t,n){var r,i,a,o,s=!1;if(n){if(i=r=e[t],r&&"object"==typeof r)for(i=[],a=-1;++a<r.length;)o=r[a],n.indexOf(o)<0?i.push(o):s=!0;else r===n&&(i=null,s=!0);e[t]=i;}return s;}function h(e,t,n){var r,i,a,o=e[t];if(o&&"object"==typeof o)for(r=[].concat(n),i=-1;++i<r.length;)a=r[i],o.indexOf(a)<0&&o.push(a);else e[t]=n;}function p(e,t){return c.compare(e.singleton,t.singleton);}},2415:(e,t,n)=>{t.parse=n(6903),t.stringify=n(6713);},6903:(e,t,n)=>{var r=n(2219),i=n(3516),a=n(395),o=n(858),s=n(8589);e.exports=function e(t,n){var l,c,f,d=n||{},g={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},h=String(t),p=h.toLowerCase(),m=0;if(null==t)throw new Error("Expected string, got `"+t+"`");if(u.call(s,p))return (null==d.normalize||d.normalize)&&s[p]?e(s[p]):(g[-1===o.indexOf(p)?"irregular":"regular"]=h,g);for(;i(p.charCodeAt(m))&&m<9;)m++;if(m>1&&m<9){if(g.language=h.slice(0,m),m<4)for(c=0;45===p.charCodeAt(m)&&i(p.charCodeAt(m+1))&&i(p.charCodeAt(m+2))&&i(p.charCodeAt(m+3))&&!i(p.charCodeAt(m+4));){if(c>2)return y(m,3,"Too many extended language subtags, expected at most 3 subtags");g.extendedLanguageSubtags.push(h.slice(m+1,m+4)),m+=4,c++;}for(45===p.charCodeAt(m)&&i(p.charCodeAt(m+1))&&i(p.charCodeAt(m+2))&&i(p.charCodeAt(m+3))&&i(p.charCodeAt(m+4))&&!i(p.charCodeAt(m+5))&&(g.script=h.slice(m+1,m+5),m+=5),45===p.charCodeAt(m)&&(i(p.charCodeAt(m+1))&&i(p.charCodeAt(m+2))&&!i(p.charCodeAt(m+3))?(g.region=h.slice(m+1,m+3),m+=3):a(p.charCodeAt(m+1))&&a(p.charCodeAt(m+2))&&a(p.charCodeAt(m+3))&&!a(p.charCodeAt(m+4))&&(g.region=h.slice(m+1,m+4),m+=4));45===p.charCodeAt(m);){for(f=l=m+1;r(p.charCodeAt(f));){if(f-l>7)return y(f,1,"Too long variant, expected at most 8 characters");f++;}if(!(f-l>4||f-l>3&&a(p.charCodeAt(l))))break;g.variants.push(h.slice(l,f)),m=f;}for(;45===p.charCodeAt(m)&&120!==p.charCodeAt(m+1)&&r(p.charCodeAt(m+1))&&45===p.charCodeAt(m+2)&&r(p.charCodeAt(m+3));){for(f=m+2,c=0;45===p.charCodeAt(f)&&r(p.charCodeAt(f+1))&&r(p.charCodeAt(f+2));)for(f=(l=f+1)+2,c++;r(p.charCodeAt(f));){if(f-l>7)return y(f,2,"Too long extension, expected at most 8 characters");f++;}if(!c)return y(f,4,"Empty extension, extensions must have at least 2 characters of content");g.extensions.push({singleton:h.charAt(m+1),extensions:h.slice(m+3,f).split("-")}),m=f;}}else m=0;if(0===m&&120===p.charCodeAt(m)||45===p.charCodeAt(m)&&120===p.charCodeAt(m+1))for(f=m=m?m+2:1;45===p.charCodeAt(f)&&r(p.charCodeAt(f+1));){for(f=l=m+1;r(p.charCodeAt(f));){if(f-l>7)return y(f,5,"Too long private-use area, expected at most 8 characters");f++;}g.privateuse.push(h.slice(m+1,f)),m=f;}return m!==h.length?y(m,6,"Found superfluous content after tag"):g;function y(e,t,n){return d.warning&&d.warning(n,t,e),d.forgiving?g:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null};}};var u={}.hasOwnProperty;},6713:e=>{e.exports=function(e){var t,n,r,i=e||{},a=[];if(i.irregular||i.regular)return i.irregular||i.regular;if(i.language)for(a=a.concat(i.language,i.extendedLanguageSubtags||[],i.script||[],i.region||[],i.variants||[]),t=i.extensions||[],n=-1;++n<t.length;)(r=t[n]).singleton&&r.extensions&&r.extensions.length&&(a=a.concat(r.singleton,r.extensions));return i.privateuse&&i.privateuse.length&&(a=a.concat("x",i.privateuse)),a.join("-");};},1549:(e,t,n)=>{var r=n(6693),i=n(2165),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){return +e!=e&&(e=0),u.alloc(+e);},t.INSPECT_MAX_BYTES=50;var o=2147483647;function s(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t;}function u(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e);}return l(e,t,n);}function l(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|p(e,t),r=s(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r;}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){var t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength);}return d(e);}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return g(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return g(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return u.from(r,t,n);var i=function(e){if(u.isBuffer(e)){var t=0|h(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n;}return void 0!==e.length?"number"!=typeof e.length||q(e.length)?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0;}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"');}function f(e){return c(e),s(e<0?0:0|h(e));}function d(e){for(var t=e.length<0?0:0|h(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n;}function g(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,u.prototype),r;}function h(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e;}function p(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(e).length;default:if(i)return r?-1:U(e).length;t=(""+t).toLowerCase(),i=!0;}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return "";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return "";if((n>>>=0)<=(t>>>=0))return "";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,n);case"utf8":case"utf-8":return R(this,t,n);case"ascii":return N(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0;}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r;}function E(e,t,n,r,i){if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),q(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return -1;n=e.length-1;}else if(n<0){if(!i)return -1;n=0;}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer");}function v(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,s/=2,u/=2,n/=2;}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o);}if(i){var c=-1;for(a=n;a<s;a++)if(l(e,a)===l(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*o;}else -1!==c&&(a-=a-c),c=-1;}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var f=!0,d=0;d<u;d++)if(l(e,a+d)!==l(t,d)){f=!1;break;}if(f)return a;}return -1;}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(q(s))return o;e[n+o]=s;}return o;}function T(e,t,n,r){return B(U(t,e.length-n),e,n,r);}function S(e,t,n,r){return B(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t;}(t),e,n,r);}function b(e,t,n,r){return B(Z(t),e,n,r);}function A(e,t,n,r){return B(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a;}(t,e.length-n),e,n,r);}function I(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n));}function R(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,l=e[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(u=(15&l)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(c=u);}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f;}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=w));return n;}(r);}t.kMaxLength=o,u.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42;}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo();}catch(e){return !1;}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer;}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset;}}),u.poolSize=8192,u.from=function(e,t,n){return l(e,t,n);},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e);}(e,t,n);},u.allocUnsafe=function(e){return f(e);},u.allocUnsafeSlow=function(e){return f(e);},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype;},u.compare=function(e,t){if(G(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break;}return n<r?-1:r<n?1:0;},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return !0;default:return !1;}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(G(a,Uint8Array))i+a.length>r.length?u.from(a).copy(r,i):Uint8Array.prototype.set.call(r,a,i);else {if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i);}i+=a.length;}return r;},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this;},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this;},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this;},u.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?R(this,0,e):m.apply(this,arguments);},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e);},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">";},a&&(u.prototype[a]=u.prototype.inspect),u.prototype.compare=function(e,t,n,r,i){if(G(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return -1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),c=e.slice(t,n),f=0;f<s;++f)if(l[f]!==c[f]){a=l[f],o=c[f];break;}return a<o?-1:o<a?1:0;},u.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n);},u.prototype.indexOf=function(e,t,n){return E(this,e,t,n,!0);},u.prototype.lastIndexOf=function(e,t,n){return E(this,e,t,n,!1);},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else {if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":case"latin1":case"binary":return S(this,e,t,n);case"base64":return b(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0;}},u.prototype.toJSON=function(){return {type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)};};var w=4096;function N(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r;}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r;}function D(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=Y[e[a]];return i;}function O(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length-1;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i;}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length");}function P(e,t,n,r,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range");}function L(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range");}function x(e,t,n,r,a){return t=+t,n>>>=0,a||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4;}function F(e,t,n,r,a){return t=+t,n>>>=0,a||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8;}u.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,u.prototype),r;},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r;},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r;},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e];},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8;},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1];},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3];},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3]);},u.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r;},u.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a;},u.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e];},u.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n;},u.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n;},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24;},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3];},u.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!0,23,4);},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!1,23,4);},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!0,52,8);},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!1,52,8);},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n;},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n;},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,1,255,0),this[t]=255&e,t+1;},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2;},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2;},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4;},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4;},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i);}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n;},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i);}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n;},u.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1;},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2;},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2;},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4;},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4;},u.prototype.writeFloatLE=function(e,t,n){return x(this,e,t,!0,n);},u.prototype.writeFloatBE=function(e,t,n){return x(this,e,t,!1,n);},u.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n);},u.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n);},u.prototype.copy=function(e,t,n,r){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i;},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i);}}else "number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else {var o=u.isBuffer(e)?e:u.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-t;++a)this[a+t]=o[a%s];}return this;};var k=/[^+/0-9A-Za-z-_]/g;function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue;}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue;}i=n;continue;}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue;}n=65536+(i-55296<<10|n-56320);}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n);}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128);}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128);}else {if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128);}}return a;}function Z(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(k,"")).length<2)return "";for(;e.length%4!=0;)e+="=";return e;}(e));}function B(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i;}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name;}function q(e){return e!=e;}var Y=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t;}();},6693:(e,t)=>{t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r;},t.toByteArray=function(e){var t,n,a=u(e),o=a[0],s=a[1],l=new i(function(e,t,n){return 3*(t+n)/4-n;}(0,o,s)),c=0,f=s>0?o-4:o;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[c++]=255&t),1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l;},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,a=[],o=16383,s=0,u=r-i;s<u;s+=o)a.push(l(e,s,s+o>u?u:s+o));return 1===i?(t=e[r-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),a.join("");};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=a.length;o<s;++o)n[o]=a[o],r[a.charCodeAt(o)]=o;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return -1===n&&(n=t),[n,n===t?0:4-n%4];}function l(e,t,r){for(var i,a,o=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("");}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63;},2165:(e,t)=>{t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,d=n?-1:1,g=e[t+f];for(f+=d,a=g&(1<<-c)-1,g>>=-c,c+=s;c>0;a=256*a+e[t+f],f+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+f],f+=d,c-=8);if(0===a)a=1-l;else {if(a===u)return o?NaN:1/0*(g?-1:1);o+=Math.pow(2,r),a-=l;}return (g?-1:1)*o*Math.pow(2,a-r);},t.write=function(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:a-1,h=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*u-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[n+g]=255&s,g+=h,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+g]=255&o,g+=h,o/=256,l-=8);e[n+g-h]|=128*p;};},6934:(e,t)=>{var n={parseBuffer:function(e){return new r(e).parse();},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(i.prototype._boxProcessors[e]=t);},createFile:function(){return new r();},createBox:function(e,t,n){var r=i.create(e);return t&&t.append(r,n),r;},createFullBox:function(e,t,r){var i=n.createBox(e,t,r);return i.version=0,i.flags=0,i;},Utils:{}};n.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),r.push(String.fromCharCode(a));}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("");},n.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=new TextEncoder().encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r));}return t;},n.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var r,i=-1;if("number"==typeof n)i=n;else {if("string"==typeof n)r=n;else {if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type;}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break;}}e.boxes.splice(i,0,t);}else e.boxes.push(t);},t.parseBuffer=n.parseBuffer,t.addBoxProcessor=n.addBoxProcessor,t.createFile=n.createFile,t.createBox=n.createBox,t.createFullBox=n.createFullBox,t.Utils=n.Utils,n.Cursor=function(e){this.offset=void 0===e?0:e;};var r=function(e){this._cursor=new n.Cursor(),this.boxes=[],e&&(this._raw=new DataView(e));};r.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null;},r.prototype.fetchAll=function(e,t){var n=[];return r._sweep.call(this,e,n,t),n;},r.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=i.parse(this);if(void 0===e.type)break;this.boxes.push(e);}return this;},r._sweep=function(e,t,n){for(var i in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;r._sweep.call(this.boxes[i],e,t,n);}},r.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer;},r.prototype.append=function(e,t){n.Utils.appendBox(this,e,t);};var i=function(){this._cursor=new n.Cursor();};i.parse=function(e){var t=new i();return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t;},i.create=function(e){var t=new i();return t.type=e,t.boxes=[],t;},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e]);},i.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i]);},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24);},i.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r]);},i.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i]);},i.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t]);},i.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(i.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength();},i.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return -1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return -1;}},i.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(n+4);t=r*Math.pow(2,32)+i;}return this._cursor.offset+=e>>3,t;},i.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(i+2));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(i+4),r=t*Math.pow(2,32)+n;}return this._cursor.offset+=e>>3,r;},i.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r);}return t;},i.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2);},i.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t);}return e;},i.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n;}return null;},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?n.Utils.dataViewToString(t):t;},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else {switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size);}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData());}},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24);},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this));},i.prototype.append=function(e,t){n.Utils.appendBox(this,e,t);},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size;},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size);}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size;},i.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(n+4,i);}this._cursor.offset+=e>>3;}else this.size+=e>>3;},i.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(i+2,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(i+4,r);}this._cursor.offset+=e>>3;}else this.size+=e>>3;},i.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n));},i.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0);}},i.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r);},i.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length;}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length);}else this.size+=e.length;},i.prototype._writeUTF8String=function(e){var t=n.Utils.utf8ToByteArray(e);if(this._rawo)for(var r=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)r.setUint8(i,t[i]);else this.size+=t.length;},i.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n);}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.avc2=i.prototype._boxProcessors.avc3=i.prototype._boxProcessors.avc4=i.prototype._boxProcessors.hvc1=i.prototype._boxProcessors.hev1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1);},i.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_offset",1===this.version?"int":"uint",32);});},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count);},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16);});},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1);},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1);},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32);},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4);},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1);},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1);},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16);},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32);},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32);},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32);},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1);},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32);},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8");},i.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",1==this.version?64:32);},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8);},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1);},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8);},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap);});},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16);},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24);});});},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count);},i.prototype._boxProcessors.sttg=function(){this._procField("settings","utf8");},i.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_delta","uint",32);});},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32);});});},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8);},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32);},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32);},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1));});},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32);},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32);},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32);});},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1);},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8");},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16);},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8");},i.prototype._boxProcessors.vtte=function(){};},5530:(e,t,n)=>{e.exports=n(6146).polyfill();},6146:function(e,t,n){e.exports=function(){function e(e){return "function"==typeof e;}var t=Array.isArray?Array.isArray:function(e){return "[object Array]"===Object.prototype.toString.call(e);},r=0,i=void 0,a=void 0,o=function(e,t){g[r]=e,g[r+1]=t,2===(r+=2)&&(a?a(h):v());};var s="undefined"!=typeof window?window:void 0,u=s||{},l=u.MutationObserver||u.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(h,1);};}var g=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0, g[e])(g[e+1]),g[e]=void 0,g[e+1]=void 0;r=0;}var p,m,y,E,v=void 0;function _(e,t){var n=this,r=new this.constructor(b);void 0===r[S]&&L(r);var i=n._state;if(i){var a=arguments[i-1];o(function(){return M(i,r,a,n._result);});}else D(n,r,e,t);return r;}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(b);return R(t,e),t;}v=c?function(){return process.nextTick(h);}:l?(m=0,y=new l(h),E=document.createTextNode(""),y.observe(E,{characterData:!0}),function(){E.data=m=++m%2;}):f?((p=new MessageChannel()).port1.onmessage=h,function(){return p.port2.postMessage(0);}):void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(h);}:d();}catch(e){return d();}}():d();var S=Math.random().toString(36).substring(2);function b(){}var A=void 0;function I(t,n,r){n.constructor===t.constructor&&r===_&&n.constructor.resolve===T?function(e,t){1===t._state?N(e,t._result):2===t._state?C(e,t._result):D(t,void 0,function(t){return R(e,t);},function(t){return C(e,t);});}(t,n):void 0===r?N(t,n):e(r)?function(e,t,n){o(function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r);}catch(e){return e;}}(n,t,function(n){r||(r=!0,t!==n?R(e,n):N(e,n));},function(t){r||(r=!0,C(e,t));},e._label);!r&&i&&(r=!0,C(e,i));},e);}(t,n,r):N(t,n);}function R(e,t){if(e===t)C(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=t),null===r||"object"!==i&&"function"!==i)N(e,t);else {var n=void 0;try{n=t.then;}catch(t){return void C(e,t);}I(e,t,n);}var r,i;}function w(e){e._onerror&&e._onerror(e._result),O(e);}function N(e,t){e._state===A&&(e._result=t,e._state=1,0!==e._subscribers.length&&o(O,e));}function C(e,t){e._state===A&&(e._state=2,e._result=t,o(w,e));}function D(e,t,n,r){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+1]=n,i[a+2]=r,0===a&&e._state&&o(O,e);}function O(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,a=e._result,o=0;o<t.length;o+=3)r=t[o],i=t[o+n],r?M(n,r,i,a):i(a);e._subscribers.length=0;}}function M(t,n,r,i){var a=e(r),o=void 0,s=void 0,u=!0;if(a){try{o=r(i);}catch(e){u=!1,s=e;}if(n===o)return void C(n,new TypeError("A promises callback cannot return that same promise."));}else o=i;n._state!==A||(a&&u?R(n,o):!1===u?C(n,s):1===t?N(n,o):2===t&&C(n,o));}var P=0;function L(e){e[S]=P++,e._state=void 0,e._result=void 0,e._subscribers=[];}var x=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(b),this.promise[S]||L(this.promise),t(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&N(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"));}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t);},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===T){var i=void 0,a=void 0,o=!1;try{i=e.then;}catch(e){o=!0,a=e;}if(i===_&&e._state!==A)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===F){var s=new n(b);o?C(s,a):I(s,e,i),this._willSettleAt(s,t);}else this._willSettleAt(new n(function(t){return t(e);}),t);}else this._willSettleAt(r(e),t);},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===A&&(this._remaining--,2===e?C(r,n):this._result[t]=n),0===this._remaining&&N(r,this._result);},e.prototype._willSettleAt=function(e,t){var n=this;D(e,void 0,function(e){return n._settledAt(1,t,e);},function(e){return n._settledAt(2,t,e);});},e;}();var F=function(){function t(e){this[S]=P++,this._result=this._state=void 0,this._subscribers=[],b!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}(),this instanceof t?function(e,t){try{t(function(t){R(e,t);},function(t){C(e,t);});}catch(t){C(e,t);}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}());}return t.prototype.catch=function(e){return this.then(null,e);},t.prototype.finally=function(t){var n=this,r=n.constructor;return e(t)?n.then(function(e){return r.resolve(t()).then(function(){return e;});},function(e){return r.resolve(t()).then(function(){throw e;});}):n.then(t,t);},t;}();return F.prototype.then=_,F.all=function(e){return new x(this,e).promise;},F.race=function(e){var n=this;return t(e)?new n(function(t,r){for(var i=e.length,a=0;a<i;a++)n.resolve(e[a]).then(t,r);}):new n(function(e,t){return t(new TypeError("You must pass an array to race."));});},F.resolve=T,F.reject=function(e){var t=new this(b);return C(t,e),t;},F._setScheduler=function(e){a=e;},F._setAsap=function(e){o=e;},F._asap=o,F.polyfill=function(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")();}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment");}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve());}catch(e){}if("[object Promise]"===r&&!t.cast)return;}e.Promise=F;},F.Promise=F,F;}();},1159:e=>{var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n);};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e));}:function(e){return Object.getOwnPropertyNames(e);};var i=Number.isNaN||function(e){return e!=e;};function a(){a.init.call(this);}e.exports=a,e.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,a),r(n);}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments));}p(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&p(e,"error",t,{once:!0});}(e,i);});},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners;}function l(e,t,n,r){var i,a,o,l;if(s(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=u(e))>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,l=c,console&&console.warn&&console.warn(l);}return e;}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments);}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i;}function d(e,t,n){var r=e._events;if(void 0===r)return [];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t;}(i):h(i,i.length);}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length;}return 0;}function h(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n;}function p(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else {if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(a){r.once&&e.removeEventListener(t,i),n(a);});}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o;},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e;}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0;},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this;},a.prototype.getMaxListeners=function(){return u(this);},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return !1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s;}var u=a[e];if(void 0===u)return !1;if("function"==typeof u)r(u,this,t);else {var l=u.length,c=h(u,l);for(n=0;n<l;++n)r(c[n],this,t);}return !0;},a.prototype.addListener=function(e,t){return l(this,e,t,!1);},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0);},a.prototype.once=function(e,t){return s(t),this.on(e,f(this,e,t)),this;},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,f(this,e,t)),this;},a.prototype.removeListener=function(e,t){var n,r,i,a,o;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break;}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop();}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t);}return this;},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this;}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this;},a.prototype.listeners=function(e){return d(this,e,!0);},a.prototype.rawListeners=function(e){return d(this,e,!1);},a.listenerCount=function(e,t){return "function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t);},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[];};},3101:e=>{var t=Array.isArray,n=Object.keys,r=Object.prototype.hasOwnProperty;e.exports=function e(i,a){if(i===a)return !0;if(i&&a&&"object"==typeof i&&"object"==typeof a){var o,s,u,l=t(i),c=t(a);if(l&&c){if((s=i.length)!=a.length)return !1;for(o=s;0!=o--;)if(!e(i[o],a[o]))return !1;return !0;}if(l!=c)return !1;var f=i instanceof Date,d=a instanceof Date;if(f!=d)return !1;if(f&&d)return i.getTime()==a.getTime();var g=i instanceof RegExp,h=a instanceof RegExp;if(g!=h)return !1;if(g&&h)return i.toString()==a.toString();var p=n(i);if((s=p.length)!==n(a).length)return !1;for(o=s;0!=o--;)if(!r.call(a,p[o]))return !1;for(o=s;0!=o--;)if(!e(i[u=p[o]],a[u]))return !1;return !0;}return i!=i&&a!=a;};},3362:(e,t,n)=>{!function(e,t,n,r,i){function a(e){if("contents"in e)for(var t=("styleAttrs"in e)?e.styleAttrs[r.byName.ruby.qname]:null,n="span"===e.kind&&("container"===t||"textContainer"===t||"baseContainer"===t),i=e.contents.length-1;i>=0;i--)!n||"styleAttrs"in e.contents[i]&&r.byName.ruby.qname in e.contents[i].styleAttrs?a(e.contents[i]):delete e.contents[i];}function o(e,t,n,r){var i=r&&"seq"===r.timeContainer,a=0;r&&(a=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+a:a;var s=t.begin,u=null;if("sets"in t)for(var l=0;l<t.sets.length;l++)o(e,t.sets[l],u,t),s="seq"===t.timeContainer?t.sets[l].end:Math.max(s,t.sets[l].end),u=t.sets[l];if("contents"in t){if("contents"in t)for(var c=0;c<t.contents.length;c++)o(e,t.contents[c],u,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),u=t.contents[c];}else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,a+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=a+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t);}function s(e){this.node=e;}function u(){this.events=[],this.head=new l(),this.body=null;}function l(){this.styling=new c(),this.layout=new g();}function c(){this.styles={},this.initials={};}function f(){this.id=null,this.styleAttrs=null,this.styleRefs=null;}function d(){this.styleAttrs=null;}function g(){this.regions={};}function h(e,t){p.call(this,"image"),this.src=e,this.type=t;}function p(e){this.kind=e;}function m(e){this.id=e;}function y(e){this.regionID=e;}function E(e){this.styleAttrs=e;}function v(e){this.sets=e;}function _(e){this.contents=e;}function T(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n;}function S(){p.call(this,"body");}function b(){p.call(this,"div");}function A(){p.call(this,"p");}function I(){p.call(this,"span");}function R(){p.call(this,"span");}function w(){p.call(this,"br");}function N(){}function C(){}function D(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null;}function O(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[];}function M(e,t){var n={};if(null!==e)for(var i in e.attributes){var a=e.attributes[i].uri+" "+e.attributes[i].local,o=r.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[i].value);null!==s?(n[a]=s,o===r.byName.zIndex&&U(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):Z(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[i].value);}}return n;}function P(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null;}function L(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i;}function x(e,t,n){for(;t.styleRefs.length>0;){var r=t.styleRefs.pop();r in e.styles?(x(e,e.styles[r],n),k(e.styles[r].styleAttrs,t.styleAttrs)):Z(n,"Non-existant style id referenced");}}function F(e,t,n,r){for(var i=t.length-1;i>=0;i--){var a=t[i];a in e.styles?k(e.styles[a].styleAttrs,n):Z(r,"Non-existant style id referenced");}}function k(e,t){for(var n in e)e.hasOwnProperty(n)&&(n in t||(t[n]=e[n]));}function U(e,t){if(e&&e.warn&&e.warn(t))throw t;}function Z(e,t){if(e&&e.error&&e.error(t))throw t;}function B(e,t){throw e&&e.fatal&&e.fatal(t),t;}function G(e,t){for(var n,r=0,i=e.length-1;r<=i;){var a=e[n=Math.floor((r+i)/2)];if(a<t)r=n+1;else {if(!(a>t))return {found:!0,index:n};i=n-1;}}return {found:!1,index:r};}e.fromXML=function(e,i,p){var m=t.parser(!0,{xmlns:!0}),y=[],E=[],v=[],_=0,T=null;m.onclosetag=function(e){if(y[0]instanceof N)null!==T.head&&null!==T.head.styling&&F(T.head.styling,y[0].styleRefs,y[0].styleAttrs,i),delete y[0].styleRefs;else if(y[0]instanceof c)for(var t in y[0].styles)y[0].styles.hasOwnProperty(t)&&x(y[0],y[0].styles[t],i);else if(y[0]instanceof A||y[0]instanceof I){if(y[0].contents.length>1){var r,a=[y[0].contents[0]];for(r=1;r<y[0].contents.length;r++)y[0].contents[r]instanceof R&&a[a.length-1]instanceof R?a[a.length-1].text+=y[0].contents[r].text:a.push(y[0].contents[r]);y[0].contents=a;}y[0]instanceof I&&1===y[0].contents.length&&y[0].contents[0]instanceof R&&(y[0].text=y[0].contents[0].text,delete y[0].contents);}else y[0]instanceof s&&(y[0].node.uri===n.ns_tt&&"metadata"===y[0].node.local?_--:_>0&&p&&"onCloseTag"in p&&p.onCloseTag());v.shift(),E.shift(),y.shift();},m.ontext=function(e){if(void 0===y[0]);else if(y[0]instanceof I||y[0]instanceof A){if(y[0]instanceof I){var t=y[0].styleAttrs[r.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return;}var n=new R();n.initFromText(T,y[0],e,E[0],v[0],i),y[0].contents.push(n);}else y[0]instanceof s&&_>0&&p&&"onText"in p&&p.onText(e);},m.onopentag=function(e){var t=e.attributes["xml:space"];t?v.unshift(t.value):0===v.length?v.unshift("default"):v.unshift(v[0]);var a=e.attributes["xml:lang"];if(a?E.unshift(a.value):0===E.length?E.unshift(""):E.unshift(E[0]),e.uri===n.ns_tt){if("tt"===e.local)null!==T&&B(i,"Two <tt> elements at ("+this.line+","+this.column+")"),(T=new u()).initFromNode(e,E[0],i),y.unshift(T);else if("head"===e.local)y[0]instanceof u||B(i,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),y.unshift(T.head);else if("styling"===e.local)y[0]instanceof l||B(i,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),y.unshift(T.head.styling);else if("style"===e.local){var o;y[0]instanceof c?((o=new f()).initFromNode(e,i),o.id?T.head.styling.styles[o.id]=o:Z(i,"<style> element missing @id attribute"),y.unshift(o)):y[0]instanceof N?((o=new f()).initFromNode(e,i),k(o.styleAttrs,y[0].styleAttrs),y.unshift(o)):B(i,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");}else if("initial"===e.local){var m;if(y[0]instanceof c){for(var R in (m=new d()).initFromNode(e,i),m.styleAttrs)m.styleAttrs.hasOwnProperty(R)&&(T.head.styling.initials[R]=m.styleAttrs[R]);y.unshift(m);}else B(i,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");}else if("layout"===e.local)y[0]instanceof l||B(i,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),y.unshift(T.head.layout);else if("region"===e.local){y[0]instanceof g||B(i,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var D=new N();D.initFromNode(T,e,E[0],i),!D.id||D.id in T.head.layout.regions?Z(i,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):T.head.layout.regions[D.id]=D,y.unshift(D);}else if("body"===e.local){y[0]instanceof u||B(i,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==T.body&&B(i,"Second <body> element at "+this.line+","+this.column+")");var O=new S();O.initFromNode(T,e,E[0],i),T.body=O,y.unshift(O);}else if("div"===e.local){y[0]instanceof b||y[0]instanceof S||B(i,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var M=new b();M.initFromNode(T,y[0],e,E[0],i);var P=M.styleAttrs[r.byName.backgroundImage.qname];P&&(M.contents.push(new h(P)),delete M.styleAttrs[r.byName.backgroundImage.qname]),y[0].contents.push(M),y.unshift(M);}else if("image"===e.local){y[0]instanceof b||B(i,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var L=new h();L.initFromNode(T,y[0],e,E[0],i),y[0].contents.push(L),y.unshift(L);}else if("p"===e.local){y[0]instanceof b||B(i,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var x=new A();x.initFromNode(T,y[0],e,E[0],i),y[0].contents.push(x),y.unshift(x);}else if("span"===e.local){y[0]instanceof I||y[0]instanceof A||B(i,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var F=new I();F.initFromNode(T,y[0],e,E[0],v[0],i),y[0].contents.push(F),y.unshift(F);}else if("br"===e.local){y[0]instanceof I||y[0]instanceof A||B(i,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var U=new w();U.initFromNode(T,y[0],e,E[0],i),y[0].contents.push(U),y.unshift(U);}else if("set"===e.local){y[0]instanceof I||y[0]instanceof A||y[0]instanceof b||y[0]instanceof S||y[0]instanceof N||y[0]instanceof w||B(i,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var G=new C();G.initFromNode(T,y[0],e,i),y[0].sets.push(G),y.unshift(G);}else y.unshift(new s(e));}else y.unshift(new s(e));if(y[0]instanceof s)if(e.uri===n.ns_tt&&"metadata"===e.local)_++;else if(_>0&&p&&"onOpenTag"in p){var q=[];for(var Y in e.attributes)q[e.attributes[Y].uri+" "+e.attributes[Y].local]={uri:e.attributes[Y].uri,local:e.attributes[Y].local,value:e.attributes[Y].value};p.onOpenTag(e.uri,e.local,q);}},m.write(e).close(),delete T.head.styling.styles;var D=!1;for(var O in T.head.layout.regions)if(T.head.layout.regions.hasOwnProperty(O)){D=!0;break;}if(!D){var M=N.prototype.createDefaultRegion(T.lang);T.head.layout.regions[M.id]=M;}for(var P in T.head.layout.regions)T.head.layout.regions.hasOwnProperty(P)&&o(T,T.head.layout.regions[P],null,null);return T.body&&o(T,T.body,null,null),T.body&&a(T.body),T;},u.prototype.initFromNode=function(e,t,r){var a=function(e,t){var r=P(e,n.ns_ttp,"cellResolution"),i=15,a=32;if(null!==r){var o=/(\d+) (\d+)/.exec(r);null!==o?(a=parseInt(o[1]),i=parseInt(o[2])):U(t,"Malformed cellResolution value (using initial value instead)");}return {w:a,h:i};}(e,r);this.cellLength={h:new i.ComputedLength(0,1/a.h),w:new i.ComputedLength(1/a.w,0)};var o=function(e,t){var r,i=P(e,n.ns_ttp,"frameRate"),a=30;null!==i&&(null!==(r=/(\d+)/.exec(i))?a=parseInt(r[1]):U(t,"Malformed frame rate attribute (using initial value instead)"));var o=P(e,n.ns_ttp,"frameRateMultiplier"),s=1;null!==o&&(null!==(r=/(\d+) (\d+)/.exec(o))?s=parseInt(r[1])/parseInt(r[2]):U(t,"Malformed frame rate multiplier attribute (using initial value instead)"));var u=s*a,l=1,c=P(e,n.ns_ttp,"tickRate");return null===c?null!==i&&(l=u):null!==(r=/(\d+)/.exec(c))?l=parseInt(r[1]):U(t,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:u,tickRate:l};}(e,r);this.effectiveFrameRate=o.effectiveFrameRate,this.tickRate=o.tickRate,this.aspectRatio=function(e,t){var r=P(e,n.ns_ittp,"aspectRatio");null===r&&(r=P(e,n.ns_ttp,"displayAspectRatio"));var i=null;if(null!==r){var a=/(\d+)\s+(\d+)/.exec(r);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?i=o/s:Z(t,"Illegal aspectRatio values (ignoring)");}else Z(t,"Malformed aspectRatio attribute (ignoring)");}return i;}(e,r);var s=P(e,n.ns_ttp,"timeBase");null!==s&&"media"!==s&&B(r,"Unsupported time base");var u=function(e,t){var r=P(e,n.ns_tts,"extent");if(null===r)return null;var a=r.split(" ");if(2!==a.length)return U(t,"Malformed extent (ignoring)"),null;var o=i.parseLength(a[0]),s=i.parseLength(a[1]);return s&&o?{h:s,w:o}:(U(t,"Malformed extent values (ignoring)"),null);}(e,r);null===u?this.pxLength={h:null,w:null}:("px"===u.h.unit&&"px"===u.w.unit||B(r,"Extent on TT must be in px or absent"),this.pxLength={h:new i.ComputedLength(0,1/u.h.value),w:new i.ComputedLength(1/u.w.value,0)}),this.dimensions={h:new i.ComputedLength(0,1),w:new i.ComputedLength(1,0)},this.lang=t;},u.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=G(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=G(this.events,e.end);n.found||this.events.splice(n.index,0,e.end);}}},u.prototype.getMediaTimeRange=function(){return [this.events[0],this.events[this.events.length-1]];},u.prototype.getMediaTimeEvents=function(){return this.events;},f.prototype.initFromNode=function(e,t){this.id=D(e),this.styleAttrs=M(e,t),this.styleRefs=O(e);},d.prototype.initFromNode=function(e,t){for(var r in this.styleAttrs={},e.attributes)if(e.attributes[r].uri===n.ns_itts||e.attributes[r].uri===n.ns_ebutts||e.attributes[r].uri===n.ns_tts){var i=e.attributes[r].uri+" "+e.attributes[r].local;this.styleAttrs[i]=e.attributes[r].value;}},h.prototype.initFromNode=function(e,t,n,r,i){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||Z(i,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||Z(i,"Invalid image@type attribute"),E.prototype.initFromNode.call(this,e,t,n,i),T.prototype.initFromNode.call(this,e,t,n,i),v.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),this.lang=r;},m.prototype.initFromNode=function(e,t,n,r){this.id=D(n);},y.prototype.initFromNode=function(e,t,n,r){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:"";}(n);},E.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=M(n,r),null!==e.head&&null!==e.head.styling&&F(e.head.styling,O(n),this.styleAttrs,r);},v.prototype.initFromNode=function(e,t,n,r){this.sets=[];},_.prototype.initFromNode=function(e,t,n,r){this.contents=[];},T.prototype.initFromNode=function(e,t,n,r){var i=function(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=L(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&U(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=L(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&U(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;return n&&"end"in n.attributes&&null===(o=L(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&U(r,"Malformed end value (ignoring)"),{explicit_begin:i,explicit_end:o,explicit_dur:a};}(e,0,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(Z(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par";}(n,r);},S.prototype.initFromNode=function(e,t,n,r){E.prototype.initFromNode.call(this,e,null,t,r),T.prototype.initFromNode.call(this,e,null,t,r),v.prototype.initFromNode.call(this,e,null,t,r),y.prototype.initFromNode.call(this,e,null,t,r),_.prototype.initFromNode.call(this,e,null,t,r),this.lang=n;},b.prototype.initFromNode=function(e,t,n,r,i){E.prototype.initFromNode.call(this,e,t,n,i),T.prototype.initFromNode.call(this,e,t,n,i),v.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),this.lang=r;},A.prototype.initFromNode=function(e,t,n,r,i){E.prototype.initFromNode.call(this,e,t,n,i),T.prototype.initFromNode.call(this,e,t,n,i),v.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),this.lang=r;},I.prototype.initFromNode=function(e,t,n,r,i,a){E.prototype.initFromNode.call(this,e,t,n,a),T.prototype.initFromNode.call(this,e,t,n,a),v.prototype.initFromNode.call(this,e,t,n,a),y.prototype.initFromNode.call(this,e,t,n,a),_.prototype.initFromNode.call(this,e,t,n,a),this.space=i,this.lang=r;},R.prototype.initFromText=function(e,t,n,r,i,a){T.prototype.initFromNode.call(this,e,t,null,a),this.text=n,this.space=i,this.lang=r;},w.prototype.initFromNode=function(e,t,n,r,i){y.prototype.initFromNode.call(this,e,t,n,i),T.prototype.initFromNode.call(this,e,t,n,i),this.lang=r;},N.prototype.createDefaultRegion=function(e){var t=new N();return m.call(t,""),E.call(t,{}),v.call(t,[]),T.call(t,0,Number.POSITIVE_INFINITY,null),this.lang=e,t;},N.prototype.initFromNode=function(e,t,n,r){m.prototype.initFromNode.call(this,e,null,t,r),T.prototype.initFromNode.call(this,e,null,t,r),v.prototype.initFromNode.call(this,e,null,t,r),this.styleAttrs=M(t,r),this.styleRefs=O(t),this.lang=n;},C.prototype.initFromNode=function(e,t,n,r){T.prototype.initFromNode.call(this,e,t,n,r);var i=M(n,r);for(var a in this.qname=null,this.value=null,i)if(i.hasOwnProperty(a)){if(this.qname){Z(r,"More than one style specified on set");break;}this.qname=a,this.value=i[a];}};}(t,"undefined"==typeof sax?n(5378):sax,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils);},506:(e,t,n)=>{!function(e,t,n){function r(e,t,c,d){var g;if("region"===c.kind)(g=document.createElement("div")).style.position="absolute";else if("body"===c.kind)g=document.createElement("div");else if("div"===c.kind)g=document.createElement("div");else if("image"===c.kind){if(g=document.createElement("img"),null!==e.imgResolver&&null!==c.src){var m=e.imgResolver(c.src,g);m&&(g.src=m),g.height=e.regionH,g.width=e.regionW;}}else if("p"===c.kind)g=document.createElement("p");else if("span"===c.kind){if("container"===c.styleAttrs[n.byName.ruby.qname])g=document.createElement("ruby"),e.ruby=!0;else if("base"===c.styleAttrs[n.byName.ruby.qname])g=document.createElement("rb");else if("text"===c.styleAttrs[n.byName.ruby.qname])g=document.createElement("rt");else if("baseContainer"===c.styleAttrs[n.byName.ruby.qname])g=document.createElement("rbc");else if("textContainer"===c.styleAttrs[n.byName.ruby.qname])g=document.createElement("rtc");else {if("delimiter"===c.styleAttrs[n.byName.ruby.qname])return;g=document.createElement("span");}}else "br"===c.kind&&(g=document.createElement("br"));if(g){if(c.lang&&("region"!==c.kind&&c.lang===d.lang||(g.lang=c.lang)),t.appendChild(g),g.style.margin="0","region"===c.kind){var E=c.styleAttrs[n.byName.writingMode.qname];"lrtb"===E||"lr"===E?(e.ipd="lr",e.bpd="tb"):"rltb"===E||"rl"===E?(e.ipd="rl",e.bpd="tb"):"tblr"===E?(e.ipd="tb",e.bpd="lr"):"tbrl"!==E&&"tb"!==E||(e.ipd="tb",e.bpd="rl");}else if("p"===c.kind&&"tb"===e.bpd){var v=c.styleAttrs[n.byName.direction.qname];e.ipd="ltr"===v?"lr":"rl";}for(var _=0;_<f.length;_++){var T=f[_],S=c.styleAttrs[T.qname];void 0!==S&&null!==T.map&&T.map(e,g,c,S);}var b=g,A=c.styleAttrs[n.byName.linePadding.qname];if(A&&!A.isZero()){var I=A.toUsedLength(e.w,e.h);if(I>0){var R=Math.ceil(I)+"px";"tb"===e.bpd?(b.style.paddingLeft=R,b.style.paddingRight=R):(b.style.paddingTop=R,b.style.paddingBottom=R),e.lp=A;}}var w=c.styleAttrs[n.byName.multiRowAlign.qname];if(w&&"auto"!==w){var N=document.createElement("span");N.style.display="inline-block",N.style.textAlign=w,g.appendChild(N),b=N,e.mra=w;}var C=c.styleAttrs[n.byName.rubyReserve.qname];if(C&&"none"!==C[0]&&(e.rubyReserve=C),c.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===c.kind&&c.text){var D=c.styleAttrs[n.byName.textEmphasis.qname];if(D&&"none"!==D.style&&(e.textEmphasis=!0),n.byName.textCombine.qname in c.styleAttrs&&"all"===c.styleAttrs[n.byName.textCombine.qname])g.textContent=c.text,D&&l(e,g,0,D);else for(var O="",M=0;M<c.text.length;M++){O+=c.text.charAt(M);var P=c.text.charCodeAt(M);if(P<55296||P>56319||M===c.text.length-1){var L=document.createElement("span");L.textContent=O,D&&l(e,L,0,D),g.appendChild(L),O="",L._isd_element=c;}}}if("contents"in c)for(var x=0;x<c.contents.length;x++)r(e,b,c.contents[x],c);var F=[];if("p"===c.kind&&(u(e,b,F,null),e.rubyReserve&&(function(e,t){for(var n=0;n<e.length;n++){var r,i,a=document.createElement("ruby"),o=document.createElement("rb");o.textContent="​",a.appendChild(o);var s,u=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&1==e.length?((r=document.createElement("rtc")).style[p]=h?"after":"under",r.textContent="​",r.style.fontSize=u,(i=document.createElement("rtc")).style[p]=h?"before":"over",i.textContent="​",i.style.fontSize=u,a.appendChild(r),a.appendChild(i)):((r=document.createElement("rtc")).textContent="​",r.style.fontSize=u,s="after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?h?"after":"tb"===t.bpd||"rl"===t.bpd?"under":"over":h?"before":"tb"===t.bpd||"rl"===t.bpd?"over":"under",r.style[p]=s,a.appendChild(r));for(var l=null,c=0;c<e[n].rbc.length;c++)if("ruby"===e[n].rbc[c].localName){l=e[n].rbc[c];for(var f=0;f<l.style.length;f++)a.style.setProperty(l.style.item(f),l.style.getPropertyValue(l.style.item(f)));break;}(l=l||e[n].elements[0].node).parentElement.insertBefore(a,l);}}(F,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].rbc.length;r++){var i;e[n].rbc[r].style[p]||(i=h?0===n?"before":"after":"tb"===t.bpd||"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[r].style[p]=i);}}(F,e),e.ruby=null),e.textEmphasis&&(function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].te.length;r++){var i;e[n].te[r].style[y]&&"none"!==e[n].te[r].style[y]||(i="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[r].style[y]=i);}}(F,e),e.textEmphasis=null),e.mra&&(function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling);}}}(F),e.mra=null),e.lp&&(function(e,t,n){if(null!==e)for(var r=0;r<e.length;r++){var i=e[r].elements.length,a=Math.ceil(t)+"px",o="-"+Math.ceil(t)+"px";if(0!==i){var s=e[r].elements[e[r].start_elem],u=e[r].elements[e[r].end_elem];if(s===u&&(elementBoundingRect=s.node.getBoundingClientRect(),0==elementBoundingRect.width||0==elementBoundingRect.height))continue;"lr"===n.ipd?(s.node.style.marginLeft=o,s.node.style.paddingLeft=a):"rl"===n.ipd?(s.node.style.paddingRight=a,s.node.style.marginRight=o):"tb"===n.ipd&&(s.node.style.paddingTop=a,s.node.style.marginTop=o),"lr"===n.ipd?(u.node.style.marginRight=o,u.node.style.paddingRight=a):"rl"===n.ipd?(u.node.style.paddingLeft=a,u.node.style.marginLeft=o):"tb"===n.ipd&&(u.node.style.paddingBottom=a,u.node.style.marginBottom=o);}}}(F,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),function(e){for(var t=0;t<e.length;t++)for(var n=e[t],r=1;r<n.elements.length;){var o=n.elements[r-1],s=n.elements[r];a(o.node,s.node)?n.elements.splice(r,1):r++;}for(var u,l,c=[],f=0;f<e.length;f++)for(var d=0;d<e[f].elements.length;d++)(l=i(u=e[f].elements[d].node,c,!1))&&(u.style.backgroundColor=l);for(var g=0;g<c.length;g++)c[g].style.backgroundColor="";}(F),e.flg)){var k=s(b.getBoundingClientRect(),e);!function(e,t,n,r,i){for(var a=Math.sign(n-t),o=0;o<=e.length;o++){var s,u,l,c;if(s=0===o?Math.round(t):o===e.length?Math.round(n):Math.round((e[o-1].after+e[o].before)/2),o>0&&e[o-1])for(l=0;l<e[o-1].elements.length;l++)u=a*(s-(c=e[o-1].elements[l]).after)+"px","lr"===r.bpd?c.node.style.paddingRight=u:"rl"===r.bpd?c.node.style.paddingLeft=u:"tb"===r.bpd&&(c.node.style.paddingBottom=u);if(o<e.length)for(l=0;l<e[o].elements.length;l++)u=a*((c=e[o].elements[l]).before-s)+"px","lr"===r.bpd?c.node.style.paddingLeft=u:"rl"===r.bpd?c.node.style.paddingRight=u:"tb"===r.bpd&&(c.node.style.paddingTop=u);}}(F,k.before,k.after,e),e.flg=null;}if("region"===c.kind&&"tb"===e.bpd&&e.enableRollUp&&c.contents.length>0&&"after"===c.styleAttrs[n.byName.displayAlign.qname]){u(e,b,F,null);var U=new o(""===c.id?"_":c.id,F);if(e.currentISDState[U.id]=U,e.previousISDState&&U.id in e.previousISDState&&e.previousISDState[U.id].plist.length>0&&U.plist.length>1&&U.plist[U.plist.length-2].text===e.previousISDState[U.id].plist[e.previousISDState[U.id].plist.length-1].text){var Z=g.firstElementChild,B=U.plist[U.plist.length-1].after-U.plist[U.plist.length-1].before;Z.style.bottom="-"+B+"px",Z.style.transition="transform 0.4s",Z.style.position="relative",Z.style.transform="translateY(-"+B+"px)";}}}else !function(e,t){if(e&&e.error&&e.error(t))throw t;}(e.errorHandler,"Error processing ISD element kind: "+c.kind);}function i(e,t,n){return e.style.backgroundColor?(n&&!t.includes(e)&&t.push(e),e.style.backgroundColor):"SPAN"===e.parentElement.nodeName?i(e.parentElement,t,!0):void 0;}function a(e,t){if("SPAN"===e.tagName&&"SPAN"===t.tagName&&e._isd_element===t._isd_element){e.textContent+=t.textContent;for(var n=0;n<t.style.length;n++){var r=t.style[n];(r.indexOf("border")>=0||r.indexOf("padding")>=0||r.indexOf("margin")>=0)&&(e.style[r]=t.style[r]);}return t.parentElement.removeChild(t),!0;}return !1;}function o(e,t){this.id=e,this.plist=t;}function s(e,t){var n={before:null,after:null,start:null,end:null};return "tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n;}function u(e,t,n,r){if("rt"!==t.localName&&"rtc"!==t.localName){var i,a,o,l,c=t.style.backgroundColor||r;if(0===t.childElementCount){if("span"===t.localName||"rb"===t.localName){var f=s(t.getBoundingClientRect(),e);if(0!==n.length&&(i=f.before,a=f.after,o=n[n.length-1].before,a<(l=n[n.length-1].after)&&i>o||l<=a&&o>=i)){var d=Math.sign(f.after-f.before),g=Math.sign(f.end-f.start);d*(f.before-n[n.length-1].before)<0&&(n[n.length-1].before=f.before),d*(f.after-n[n.length-1].after)>0&&(n[n.length-1].after=f.after),g*(f.start-n[n.length-1].start)<0&&(n[n.length-1].start=f.start,n[n.length-1].start_elem=n[n.length-1].elements.length),g*(f.end-n[n.length-1].end)>0&&(n[n.length-1].end=f.end,n[n.length-1].end_elem=n[n.length-1].elements.length);}else n.push({before:f.before,after:f.after,start:f.start,end:f.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:c,before:f.before,after:f.after});}else "br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);}else for(var h=t.firstChild;h;)h.nodeType===Node.ELEMENT_NODE&&(u(e,h,n,c),"ruby"===h.localName||"rtc"===h.localName?n.length>0&&n[n.length-1].rbc.push(h):"span"===h.localName&&h.style[m]&&"none"!==h.style[m]&&n.length>0&&n[n.length-1].te.push(h)),h=h.nextSibling;}}function l(e,t,n,r){var i;"none"!==r.style&&("auto"===r.style?t.style[m]="filled":t.style[m]=r.style+" "+r.symbol,("before"===r.position||"after"===r.position)&&(i="tb"===e.bpd?"before"===r.position?"left over":"left under":"rl"===e.bpd?"before"===r.position?"right under":"left under":"before"===r.position?"left under":"right under",t.style[y]=i));}function c(e,t){this.qname=e,this.map=t;}e.render=function(e,t,n,i,a,o,s,u,l){var c=i||t.clientHeight,f=a||t.clientWidth;if(null!==e.aspectRatio){var d=c*e.aspectRatio;d>f?c=Math.round(f/e.aspectRatio):f=d;}var g=document.createElement("div");g.style.position="relative",g.style.width=f+"px",g.style.height=c+"px",g.style.margin="auto",g.style.top=0,g.style.bottom=0,g.style.left=0,g.style.right=0,g.style.zIndex=0;var h={h:c,w:f,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:u,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};if(t.appendChild(g),"contents"in e)for(var p=0;p<e.contents.length;p++)r(h,g,e.contents[p],e);return h.currentISDState;};for(var f=[new c("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")");}),new c("http://www.w3.org/ns/ttml#styling color",function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")";}),new c("http://www.w3.org/ns/ttml#styling direction",function(e,t,n,r){t.style.direction=r;}),new c("http://www.w3.org/ns/ttml#styling display",function(e,t,n,r){}),new c("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end");}),new c("http://www.w3.org/ns/ttml#styling extent",function(e,t,n,r){e.regionH=r.h.toUsedLength(e.w,e.h),e.regionW=r.w.toUsedLength(e.w,e.h);var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px";}),new c("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,n,r){for(var i=[],a=0;a<r.length;a++)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);if(i.length>0){for(var o=[i[0]],s=1;s<i.length;s++)-1==o.indexOf(i[s])&&o.push(i[s]);i=o;}t.style.fontFamily=i.join(",");}),new c("http://www.w3.org/ns/ttml#styling shear",function(e,t,n,r){if(0!==r){var i=-.9*r;"tb"===e.bpd?t.style.transform="skewX("+i+"deg)":t.style.transform="skewY("+i+"deg)";}}),new c("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,n,r){t.style.fontSize=r.toUsedLength(e.w,e.h)+"px";}),new c("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,n,r){t.style.fontStyle=r;}),new c("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,n,r){t.style.fontWeight=r;}),new c("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r.toUsedLength(e.w,e.h)+"px";}),new c("http://www.w3.org/ns/ttml#styling opacity",function(e,t,n,r){t.style.opacity=r;}),new c("http://www.w3.org/ns/ttml#styling origin",function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px";}),new c("http://www.w3.org/ns/ttml#styling overflow",function(e,t,n,r){t.style.overflow=r;}),new c("http://www.w3.org/ns/ttml#styling padding",function(e,t,n,r){var i=[];i[0]=r[0].toUsedLength(e.w,e.h)+"px",i[1]=r[3].toUsedLength(e.w,e.h)+"px",i[2]=r[2].toUsedLength(e.w,e.h)+"px",i[3]=r[1].toUsedLength(e.w,e.h)+"px",t.style.padding=i.join(" ");}),new c("http://www.w3.org/ns/ttml#styling position",function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px";}),new c("http://www.w3.org/ns/ttml#styling rubyAlign",function(e,t,n,r){t.style.rubyAlign="spaceAround"===r?"space-around":"center";}),new c("http://www.w3.org/ns/ttml#styling rubyPosition",function(e,t,n,r){var i;"before"!==r&&"after"!==r||(i=h?r:"tb"===e.bpd||"rl"===e.bpd?"before"===r?"over":"under":"before"===r?"under":"over",t.parentElement.style[p]=i);}),new c("http://www.w3.org/ns/ttml#styling showBackground",null),new c("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,n,r){var i;i="start"===r?"rl"===e.ipd?"right":"left":"end"===r?"rl"===e.ipd?"left":"right":r,t.style.textAlign=i;}),new c("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through");}),new c("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,n,r){}),new c("http://www.w3.org/ns/ttml#styling textShadow",function(e,t,r,i){var a=r.styleAttrs[n.byName.textOutline.qname];if("none"===i&&"none"===a)t.style.textShadow="";else {var o=[];if("none"!==a){var s="rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+")";o.push("1px 1px 1px "+s),o.push("-1px 1px 1px "+s),o.push("1px -1px 1px "+s),o.push("-1px -1px 1px "+s);}if("none"!==i)for(var u=0;u<i.length;u++)o.push(i[u].x_off.toUsedLength(e.w,e.h)+"px "+i[u].y_off.toUsedLength(e.w,e.h)+"px "+i[u].b_radius.toUsedLength(e.w,e.h)+"px rgba("+i[u].color[0].toString()+","+i[u].color[1].toString()+","+i[u].color[2].toString()+","+(i[u].color[3]/255).toString()+")");t.style.textShadow=o.join(",");}}),new c("http://www.w3.org/ns/ttml#styling textCombine",function(e,t,n,r){t.style.textCombineUpright=r;}),new c("http://www.w3.org/ns/ttml#styling textEmphasis",function(e,t,n,r){}),new c("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i;}),new c("http://www.w3.org/ns/ttml#styling visibility",function(e,t,n,r){t.style.visibility=r;}),new c("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap";}),new c("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,n,r){"lrtb"===r||"lr"===r||"rltb"===r||"rl"===r?t.style.writingMode="horizontal-tb":"tblr"===r?t.style.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(t.style.writingMode="vertical-rl");}),new c("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,n,r){t.style.zIndex=r;}),new c("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden");})],d={},g=0;g<f.length;g++)d[f[g].qname]=f[g];var h="webkitRubyPosition"in window.getComputedStyle(document.documentElement),p=h?"webkitRubyPosition":"rubyPosition",m="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",y="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition";}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils);},4080:(e,t,n)=>{!function(e,t,n,r){e.generateISD=function(e,t,r){var i,o=new u(e),s={},l={},c=e.head.styling.initials[n.byName.showBackground.qname],f=e.head.styling.initials[n.byName.backgroundColor.qname];for(var d in e.head.layout.regions)if(e.head.layout.regions.hasOwnProperty(d)){var g=e.head.layout.regions[d],h=g.styleAttrs[n.byName.showBackground.qname]||c,p=g.styleAttrs[n.byName.backgroundColor.qname]||f;l[g.id]=("always"===h||void 0===h)&&void 0!==p&&!(t<g.begin||t>=g.end);}for(var m in e.body&&e.body.regionID&&(l[e.body.regionID]=!0),i=null!==e.body?function e(t,n){if(n.contents){var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);return r.contents=[],n.contents.filter(function(e){return !(t<e.begin||t>=e.end);}).forEach(function(n){var i=e(t,n);i.regionID&&(l[i.regionID]=!0),null!==i&&r.contents.push(i);}),r;}return n;}(t,e.body):null,void 0!==l[""]&&(l[""]=!0),l)if(l[m]){var y=a(e,t,e.head.layout.regions[m],i,null,"",e.head.layout.regions[m],r,s);null!==y&&o.contents.push(y.element);}return o;};var i=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function a(e,t,u,f,d,g,h,p,m){if(t<h.begin||t>=h.end)return null;var y="regionID"in h&&""!==h.regionID?h.regionID:g;if(null!==d&&y!==u.id&&(!("contents"in h)||"contents"in h&&0===h.contents.length||""!==y))return null;var E=new l(h);if("sets"in h)for(var v=0;v<h.sets.length;v++)t<h.sets[v].begin||t>=h.sets[v].end||(E.styleAttrs[h.sets[v].qname]=h.sets[v].value);var _={};for(var T in E.styleAttrs)if(E.styleAttrs.hasOwnProperty(T)&&(_[T]=!0,"region"===E.kind&&T===n.byName.writingMode.qname&&!(n.byName.direction.qname in E.styleAttrs))){var S=E.styleAttrs[T];"lrtb"===S||"lr"===S?E.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==S&&"rl"!==S||(E.styleAttrs[n.byName.direction.qname]="rtl");}if(null!==d)for(var b=0;b<n.all.length;b++){var A=n.all[b];if(A.qname===n.byName.textDecoration.qname){var I=d.styleAttrs[A.qname],R=E.styleAttrs[A.qname],w=[];void 0===R?w=I:-1===R.indexOf("none")?((-1===R.indexOf("noUnderline")&&-1!==I.indexOf("underline")||-1!==R.indexOf("underline"))&&w.push("underline"),(-1===R.indexOf("noLineThrough")&&-1!==I.indexOf("lineThrough")||-1!==R.indexOf("lineThrough"))&&w.push("lineThrough"),(-1===R.indexOf("noOverline")&&-1!==I.indexOf("overline")||-1!==R.indexOf("overline"))&&w.push("overline")):w.push("none"),E.styleAttrs[A.qname]=w;}else if(A.qname!==n.byName.fontSize.qname||A.qname in E.styleAttrs||"span"!==E.kind||"textContainer"!==E.styleAttrs[n.byName.ruby.qname]){if(A.qname!==n.byName.fontSize.qname||A.qname in E.styleAttrs||"span"!==E.kind||"text"!==E.styleAttrs[n.byName.ruby.qname])A.inherit&&A.qname in d.styleAttrs&&!(A.qname in E.styleAttrs)&&(E.styleAttrs[A.qname]=d.styleAttrs[A.qname]);else {var N=d.styleAttrs[n.byName.fontSize.qname];"textContainer"===d.styleAttrs[n.byName.ruby.qname]?E.styleAttrs[A.qname]=N:E.styleAttrs[A.qname]=new r.ComputedLength(.5*N.rw,.5*N.rh);}}else {var C=d.styleAttrs[n.byName.fontSize.qname];E.styleAttrs[A.qname]=new r.ComputedLength(.5*C.rw,.5*C.rh);}}for(var D=0;D<n.all.length;D++){var O=n.all[D];if(!(O.qname in E.styleAttrs)&&!(O.qname===n.byName.position.qname&&n.byName.origin.qname in E.styleAttrs||O.qname===n.byName.origin.qname&&n.byName.position.qname in E.styleAttrs)){var M=e.head.styling.initials[O.qname]||O.initial;if(null!==M&&("region"===E.kind||!1===O.inherit&&null!==M)){var P=O.parse(M);null!==P?(E.styleAttrs[O.qname]=P,_[O.qname]=!0):c(p,"Invalid initial value for '"+O.qname+"' on element '"+E.kind);}}}for(var L=0;L<n.all.length;L++){var x=n.all[L];if(x.qname in _&&null!==x.compute){var F=x.compute(e,d,E,E.styleAttrs[x.qname],m);null!==F?E.styleAttrs[x.qname]=F:(E.styleAttrs[x.qname]=x.compute(e,d,E,x.parse(x.initial),m),c(p,"Style '"+x.qname+"' on element '"+E.kind+"' cannot be computed"));}}if("none"===E.styleAttrs[n.byName.display.qname])return null;var k=null;null===d?k=null===f?[]:[f]:"contents"in h&&(k=h.contents);for(var U=0;null!==k&&U<k.length;U++){var Z=a(e,t,u,f,E,y,k[U],p,m);null!==Z&&E.contents.push(Z.element);}for(var B in E.styleAttrs)if(E.styleAttrs.hasOwnProperty(B)){var G=!1;if("span"===E.kind){var q=E.styleAttrs[n.byName.ruby.qname];(G=("container"===q||"textContainer"===q||"baseContainer"===q)&&-1!==i.indexOf(B))||(G="container"!==q&&B===n.byName.rubyAlign.qname),G||(G=!("textContainer"===q||"text"===q)&&B===n.byName.rubyPosition.qname);}if(!G){var Y=n.byQName[B];"applies"in Y&&(G=-1===Y.applies.indexOf(E.kind));}G&&delete E.styleAttrs[B];}var j=E.styleAttrs[n.byName.ruby.qname];if("p"===E.kind||"span"===E.kind&&("textContainer"===j||"text"===j)){var H=[];o(E,H),function(e){for(var t,n=0;n<e.length;)if("br"!==(t=e[n]).kind&&"preserve"!==t.space){var r=t.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(r)&&(0===n||"br"===(i=e[n-1]).kind||/[\r\n\t ]$/.test(i.text))&&(r=r.substring(1)),t.text=r,0===r.length?e.splice(n,1):n++;}else n++;var i,a;for(n=0;n<e.length;n++)"br"!==(t=e[n]).kind&&"preserve"!==t.space?/[ ]$/.test(t.text)&&(n===e.length-1||"br"===(a=e[n+1]).kind||"preserve"===a.space&&/^[\r\n]/.test(a.text))&&(t.text=t.text.slice(0,-1)):n++;}(H),s(E);}return "div"===E.kind&&n.byName.backgroundImage.qname in E.styleAttrs||"br"===E.kind||"image"===E.kind||"contents"in E&&E.contents.length>0||"span"===E.kind&&null!==E.text||"region"===E.kind&&"always"===E.styleAttrs[n.byName.showBackground.qname]?{region_id:y,element:E}:null;}function o(e,t){if("contents"in e)for(var r=0;r<e.contents.length;r++){var i=e.contents[r],a=i.styleAttrs[n.byName.ruby.qname];("span"!==i.kind||"textContainer"!==a&&"text"!==a)&&("contents"in i?o(i,t):("span"===i.kind&&0!==i.text.length||"br"===i.kind)&&t.push(i));}}function s(e){if("br"===e.kind)return !1;if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)s(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length;}}function u(e){this.contents=[],this.aspectRatio=e.aspectRatio,this.lang=e.lang;}function l(e){for(var t in this.kind=e.kind||"region",this.lang=e.lang,e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)e.styleAttrs.hasOwnProperty(t)&&(this.styleAttrs[t]=e.styleAttrs[t]);"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space);}function c(e,t){if(e&&e.error&&e.error(t))throw t;}}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils);},4403:(e,t,n)=>{t.generateISD=n(4080).generateISD,t.fromXML=n(3362).fromXML,t.renderHTML=n(506).render;},210:(e,t)=>{!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style";}(t);},6811:(e,t,n)=>{!function(e,t,n){function r(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s;}for(var i in e.all=[new r(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new r(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new r(t.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e;},null),new r(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null;},function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,1);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return {h:o,w:s};}),new r(t.ns_tts,"fontFamily","default",["span","p"],!0,!0,function(e){for(var t=e.split(","),n=[],r=0;r<t.length;r++)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n;},null),new r(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,function(e,t,n,r){return "%"!==r.unit?null:Math.abs(r.value)>100?100*Math.sign(r.value):r.value;}),new r(t.ns_tts,"fontSize","1c",["span","p"],!0,!0,n.parseLength,function(t,r,i,a,o){return n.toComputedLength(a.value,a.unit,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h);}),new r(t.ns_tts,"fontStyle","normal",["span","p"],!0,!0,function(e){return e;},null),new r(t.ns_tts,"fontWeight","normal",["span","p"],!0,!0,function(e){return e;},null),new r(t.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return "normal"===e?e:n.parseLength(e);},function(t,r,i,a,o){var s;if("normal"===a)s=a;else if(null===(s=n.toComputedLength(a.value,a.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s;}),new r(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new r(t.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null;},function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,0);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return {h:o,w:s};}),new r(t.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(t.length>4)return null;for(var r=[],i=0;i<t.length;i++){var a=n.parseLength(t[i]);if(!a)return null;r.push(a);}return r;},function(t,r,i,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else {if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]];}var u=i.styleAttrs[e.byName.writingMode.qname];if("lrtb"===u||"lr"===u)s=[s[0],s[3],s[2],s[1]];else if("rltb"===u||"rl"===u)s=[s[0],s[1],s[2],s[3]];else if("tblr"===u)s=[s[3],s[0],s[1],s[2]];else {if("tbrl"!==u&&"tb"!==u)return null;s=[s[3],s[2],s[1],s[0]];}for(var l=[],c=0;c<s.length;c++)if(0===s[c].value)l[c]=new n.ComputedLength(0,0);else if(l[c]=n.toComputedLength(s[c].value,s[c].unit,i.styleAttrs[e.byName.fontSize.qname],0===c||2===c?i.styleAttrs[e.byName.extent.qname].h:i.styleAttrs[e.byName.extent.qname].w,0===c||2===c?t.cellLength.h:t.cellLength.w,0===c||2===c?t.pxLength.h:t.pxLength.w),null===l[c])return null;return l;}),new r(t.ns_tts,"position","top left",["region"],!1,!0,function(e){return n.parsePosition(e);},function(t,r,i,a){var o,s;return null===(o=n.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new n.ComputedLength(-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-i.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new n.ComputedLength(-o.rw-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-i.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-i.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-i.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}));}),new r(t.ns_tts,"ruby","none",["span"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"rubyAlign","center",["span"],!0,!0,function(e){return "center"!==e&&"spaceAround"!==e?null:e;},null),new r(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(e){return e;},null),new r(t.ns_tts,"rubyReserve","none",["p"],!0,!0,function(e){var t=e.split(" "),r=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(r[0]=t[0],2===t.length&&"none"!==t[0]){var i=n.parseLength(t[1]);if(!i)return null;r[1]=i;}return r;},function(t,r,i,a,o){if("none"===a[0])return a;var s;return null===(s=null===a[1]?new n.ComputedLength(.5*i.styleAttrs[e.byName.fontSize.qname].rw,.5*i.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(a[1].value,a[1].unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s];}),new r(t.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e;},function(e,t,n,r,i){return "left"===r?"start":"right"===r?"end":r;}),new r(t.ns_tts,"textCombine","none",["span"],!0,!0,function(e){return "none"===e||"all"===e?e:null;},null),new r(t.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ");},null),new r(t.ns_tts,"textEmphasis","none",["span"],!0,!0,function(e){for(var t=e.split(" "),r={style:null,symbol:null,color:null,position:null},i=0;i<t.length;i++)if("none"===t[i]||"auto"===t[i])r.style=t[i];else if("filled"===t[i]||"open"===t[i])r.style=t[i];else if("circle"===t[i]||"dot"===t[i]||"sesame"===t[i])r.symbol=t[i];else if("current"===t[i])r.color=t[i];else if("outside"===t[i]||"before"===t[i]||"after"===t[i])r.position=t[i];else if(r.color=n.parseColor(t[i]),null===r.color)return null;return null==r.style&&null==r.symbol?r.style="auto":(r.symbol=r.symbol||"circle",r.style=r.style||"filled"),r.position=r.position||"outside",r.color=r.color||"current",r;},null),new r(t.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||r.length>2)return null;var i=n.parseColor(r[0]);if(t.color=i,null!==i&&r.shift(),1!==r.length)return null;var a=n.parseLength(r[0]);return a?(t.thickness=a,t):null;},function(t,r,i,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=i.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=n.toComputedLength(a.thickness.value,a.thickness.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s;}),new r(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,function(t,r,i,a){if("none"===a)return a;for(var o=[],s=0;s<a.length;s++){var u={};if(u.x_off=n.toComputedLength(a[s][0].value,a[s][0].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===u.x_off)return null;if(u.y_off=n.toComputedLength(a[s][1].value,a[s][1].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.y_off)return null;if(null===a[s][2])u.b_radius=0;else if(u.b_radius=n.toComputedLength(a[s][2].value,a[s][2].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.b_radius)return null;null===a[s][3]?u.color=i.styleAttrs[e.byName.color.qname]:u.color=a[s][3],o.push(u);}return o;}),new r(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e;},null),new r(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e;},null),new r(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e;},null),new r(t.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return "auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t;},null),new r(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,function(e,t,r,i,a){return n.toComputedLength(i.value,i.unit,null,null,e.cellLength.w,null);}),new r(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e;},null),new r(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e;},null),new r(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return "true"===e;},null),new r(t.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return "true"===e;},null)],e.byQName={},e.all)e.byQName[e.all[i].qname]=e.all[i];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a];}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscUtils?n(5926):imscUtils);},5926:(e,t)=>{!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=i[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=r.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o;};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n;},e.parseTextShadow=function(t){for(var n=t.match(/([^\(,\)]|\([^\)]+\))+/g),r=[],i=0;i<n.length;i++){var a=n[i].split(" ");if(1===a.length&&"none"===a[0])return "none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){r.push(o);continue;}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){r.push(o);continue;}var u=e.parseColor(a[0]);if(null===u)return null;o[3]=u,r.push(o);}}return r;},e.parsePosition=function(t){var n=t.split(" "),r=function(e){return "center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e;};if(n.length>4)return null;for(var i=0;i<n.length;i++)if(!r(n[i])){var a=e.parseLength(n[i]);if(null===a)return null;n[i]=a;}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var u=n[s++];if(r(u)){var l={value:0,unit:"%"};2!==n.length&&s<n.length&&!r(n[s])&&(l=n[s++]),"right"===u?(o.h.edge=u,o.h.offset=l):"bottom"===u?(o.v.edge=u,o.v.offset=l):"left"===u?o.h.offset=l:"top"===u&&(o.v.offset=l);}else {if(1!==n.length&&2!==n.length)return null;1===s?o.h.offset=u:o.v.offset=u;}}return o;},e.ComputedLength=function(e,t){this.rw=e,this.rh=t;},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh;},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh;},e.toComputedLength=function(t,n,r,i,a,o){return "%"===n&&i?new e.ComputedLength(i.rw*t/100,i.rh*t/100):"em"===n&&r?new e.ComputedLength(r.rw*t,r.rh*t):"c"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null;};}(t);},3516:e=>{e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90;};},2219:(e,t,n)=>{var r=n(3516),i=n(395);e.exports=function(e){return r(e)||i(e);};},395:e=>{e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=48&&t<=57;};},3875:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e));}function n(e,t){for(var n,r="",i=0,a=-1,o=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else {if(47===n)break;n=47;}if(47===n){if(a===s-1||1===o);else if(a!==s-1&&2===o){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",i=0):i=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),a=s,o=0;continue;}}else if(2===r.length||1===r.length){r="",i=0,a=s,o=0;continue;}t&&(r.length>0?r+="/..":r="..",i=2);}else r.length>0?r+="/"+e.slice(a+1,s):r=e.slice(a+1,s),i=s-a-1;a=s,o=0;}else 46===n&&-1!==o?++o:o=-1;}return r;}var r={resolve:function(){for(var e,r="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var o;a>=0?o=arguments[a]:(void 0===e&&(e=process.cwd()),o=e),t(o),0!==o.length&&(r=o+"/"+r,i=47===o.charCodeAt(0));}return r=n(r,!i),i?r.length>0?"/"+r:"/":r.length>0?r:".";},normalize:function(e){if(t(e),0===e.length)return ".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e;},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0);},join:function(){if(0===arguments.length)return ".";for(var e,n=0;n<arguments.length;++n){var i=arguments[n];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i);}return void 0===e?".":r.normalize(e);},relative:function(e,n){if(t(e),t(n),e===n)return "";if((e=r.resolve(e))===(n=r.resolve(n)))return "";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var a=e.length,o=a-i,s=1;s<n.length&&47===n.charCodeAt(s);++s);for(var u=n.length-s,l=o<u?o:u,c=-1,f=0;f<=l;++f){if(f===l){if(u>l){if(47===n.charCodeAt(s+f))return n.slice(s+f+1);if(0===f)return n.slice(s+f);}else o>l&&(47===e.charCodeAt(i+f)?c=f:0===f&&(c=0));break;}var d=e.charCodeAt(i+f);if(d!==n.charCodeAt(s+f))break;47===d&&(c=f);}var g="";for(f=i+c+1;f<=a;++f)f!==a&&47!==e.charCodeAt(f)||(0===g.length?g+="..":g+="/..");return g.length>0?g+n.slice(s+c):(s+=c,47===n.charCodeAt(s)&&++s,n.slice(s));},_makeLong:function(e){return e;},dirname:function(e){if(t(e),0===e.length)return ".";for(var n=e.charCodeAt(0),r=47===n,i=-1,a=!0,o=e.length-1;o>=1;--o)if(47===(n=e.charCodeAt(o))){if(!a){i=o;break;}}else a=!1;return -1===i?r?"/":".":r&&1===i?"//":e.slice(0,i);},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var r,i=0,a=-1,o=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return "";var s=n.length-1,u=-1;for(r=e.length-1;r>=0;--r){var l=e.charCodeAt(r);if(47===l){if(!o){i=r+1;break;}}else -1===u&&(o=!1,u=r+1),s>=0&&(l===n.charCodeAt(s)?-1==--s&&(a=r):(s=-1,a=u));}return i===a?a=u:-1===a&&(a=e.length),e.slice(i,a);}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){i=r+1;break;}}else -1===a&&(o=!1,a=r+1);return -1===a?"":e.slice(i,a);},extname:function(e){t(e);for(var n=-1,r=0,i=-1,a=!0,o=0,s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(47!==u)-1===i&&(a=!1,i=s+1),46===u?-1===n?n=s:1!==o&&(o=1):-1!==n&&(o=-1);else if(!a){r=s+1;break;}}return -1===n||-1===i||0===o||1===o&&n===i-1&&n===r+1?"":e.slice(n,i);},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r;}(0,e);},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var r,i=e.charCodeAt(0),a=47===i;a?(n.root="/",r=1):r=0;for(var o=-1,s=0,u=-1,l=!0,c=e.length-1,f=0;c>=r;--c)if(47!==(i=e.charCodeAt(c)))-1===u&&(l=!1,u=c+1),46===i?-1===o?o=c:1!==f&&(f=1):-1!==o&&(f=-1);else if(!l){s=c+1;break;}return -1===o||-1===u||0===f||1===f&&o===u-1&&o===s+1?-1!==u&&(n.base=n.name=0===s&&a?e.slice(1,u):e.slice(s,u)):(0===s&&a?(n.name=e.slice(1,o),n.base=e.slice(1,u)):(n.name=e.slice(s,o),n.base=e.slice(s,u)),n.ext=e.slice(o,u)),s>0?n.dir=e.slice(0,s-1):a&&(n.dir="/"),n;},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r;},8387:(e,t,n)=>{var r=n(1549),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n];}function o(e,t,n){return i(e,t,n);}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o),a(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n);},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r;},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e);},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e);};},5378:(e,t,n)=>{!function(e){e.parser=function(e,t){return new i(e,t);},e.SAXParser=i,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t);},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,n){if(!(this instanceof i))return new i(t,n);var a=this;!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]="";}(a),a.q=a.c="",a.bufferCheckPosition=e.MAX_BUFFER_LENGTH,a.opt=n||{},a.opt.lowercase=a.opt.lowercase||a.opt.lowercasetags,a.looseCase=a.opt.lowercase?"toLowerCase":"toUpperCase",a.tags=[],a.closed=a.closedRoot=a.sawRoot=!1,a.tag=a.error=null,a.strict=!!t,a.noscript=!(!t&&!a.opt.noscript),a.state=I.BEGIN,a.strictEntities=a.opt.strictEntities,a.ENTITIES=a.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),a.attribList=[],a.opt.xmlns&&(a.ns=Object.create(h)),a.trackPosition=!1!==a.opt.position,a.trackPosition&&(a.position=a.line=a.column=0),w(a,"onready");}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t();}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t;}),i.prototype={end:function(){M(this);},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return O(n,"Cannot write after close. Assign an onready handler.");if(null===t)return M(n);"object"==typeof t&&(t=t.toString());for(var i=0,a="";a=G(t,i++),n.c=a,a;)switch(n.trackPosition&&(n.position++,"\n"===a?(n.line++,n.column=0):n.column++),n.state){case I.BEGIN:if(n.state=I.BEGIN_WHITESPACE,"\ufeff"===a)continue;B(n,a);continue;case I.BEGIN_WHITESPACE:B(n,a);continue;case I.TEXT:if(n.sawRoot&&!n.closedRoot){for(var o=i-1;a&&"<"!==a&&"&"!==a;)(a=G(t,i++))&&n.trackPosition&&(n.position++,"\n"===a?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(o,i-1);}"<"!==a||n.sawRoot&&n.closedRoot&&!n.strict?(!T(s,a)||n.sawRoot&&!n.closedRoot||P(n,"Text data outside of root node."),"&"===a?n.state=I.TEXT_ENTITY:n.textNode+=a):(n.state=I.OPEN_WAKA,n.startTagPosition=n.position);continue;case I.SCRIPT:"<"===a?n.state=I.SCRIPT_ENDING:n.script+=a;continue;case I.SCRIPT_ENDING:"/"===a?n.state=I.CLOSE_TAG:(n.script+="<"+a,n.state=I.SCRIPT);continue;case I.OPEN_WAKA:if("!"===a)n.state=I.SGML_DECL,n.sgmlDecl="";else if(_(s,a));else if(_(p,a))n.state=I.OPEN_TAG,n.tagName=a;else if("/"===a)n.state=I.CLOSE_TAG,n.tagName="";else if("?"===a)n.state=I.PROC_INST,n.procInstName=n.procInstBody="";else {if(P(n,"Unencoded <"),n.startTagPosition+1<n.position){var u=n.position-n.startTagPosition;a=new Array(u).join(" ")+a;}n.textNode+="<"+a,n.state=I.TEXT;}continue;case I.SGML_DECL:"[CDATA["===(n.sgmlDecl+a).toUpperCase()?(N(n,"onopencdata"),n.state=I.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+a==="--"?(n.state=I.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+a).toUpperCase()?(n.state=I.DOCTYPE,(n.doctype||n.sawRoot)&&P(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===a?(N(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=I.TEXT):_(c,a)?(n.state=I.SGML_DECL_QUOTED,n.sgmlDecl+=a):n.sgmlDecl+=a;continue;case I.SGML_DECL_QUOTED:a===n.q&&(n.state=I.SGML_DECL,n.q=""),n.sgmlDecl+=a;continue;case I.DOCTYPE:">"===a?(n.state=I.TEXT,N(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=a,"["===a?n.state=I.DOCTYPE_DTD:_(c,a)&&(n.state=I.DOCTYPE_QUOTED,n.q=a));continue;case I.DOCTYPE_QUOTED:n.doctype+=a,a===n.q&&(n.q="",n.state=I.DOCTYPE);continue;case I.DOCTYPE_DTD:n.doctype+=a,"]"===a?n.state=I.DOCTYPE:_(c,a)&&(n.state=I.DOCTYPE_DTD_QUOTED,n.q=a);continue;case I.DOCTYPE_DTD_QUOTED:n.doctype+=a,a===n.q&&(n.state=I.DOCTYPE_DTD,n.q="");continue;case I.COMMENT:"-"===a?n.state=I.COMMENT_ENDING:n.comment+=a;continue;case I.COMMENT_ENDING:"-"===a?(n.state=I.COMMENT_ENDED,n.comment=D(n.opt,n.comment),n.comment&&N(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+a,n.state=I.COMMENT);continue;case I.COMMENT_ENDED:">"!==a?(P(n,"Malformed comment"),n.comment+="--"+a,n.state=I.COMMENT):n.state=I.TEXT;continue;case I.CDATA:"]"===a?n.state=I.CDATA_ENDING:n.cdata+=a;continue;case I.CDATA_ENDING:"]"===a?n.state=I.CDATA_ENDING_2:(n.cdata+="]"+a,n.state=I.CDATA);continue;case I.CDATA_ENDING_2:">"===a?(n.cdata&&N(n,"oncdata",n.cdata),N(n,"onclosecdata"),n.cdata="",n.state=I.TEXT):"]"===a?n.cdata+="]":(n.cdata+="]]"+a,n.state=I.CDATA);continue;case I.PROC_INST:"?"===a?n.state=I.PROC_INST_ENDING:_(s,a)?n.state=I.PROC_INST_BODY:n.procInstName+=a;continue;case I.PROC_INST_BODY:if(!n.procInstBody&&_(s,a))continue;"?"===a?n.state=I.PROC_INST_ENDING:n.procInstBody+=a;continue;case I.PROC_INST_ENDING:">"===a?(N(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=I.TEXT):(n.procInstBody+="?"+a,n.state=I.PROC_INST_BODY);continue;case I.OPEN_TAG:_(m,a)?n.tagName+=a:(L(n),">"===a?k(n):"/"===a?n.state=I.OPEN_TAG_SLASH:(T(s,a)&&P(n,"Invalid character in tag name"),n.state=I.ATTRIB));continue;case I.OPEN_TAG_SLASH:">"===a?(k(n,!0),U(n)):(P(n,"Forward-slash in opening tag not followed by >"),n.state=I.ATTRIB);continue;case I.ATTRIB:if(_(s,a))continue;">"===a?k(n):"/"===a?n.state=I.OPEN_TAG_SLASH:_(p,a)?(n.attribName=a,n.attribValue="",n.state=I.ATTRIB_NAME):P(n,"Invalid attribute name");continue;case I.ATTRIB_NAME:"="===a?n.state=I.ATTRIB_VALUE:">"===a?(P(n,"Attribute without value"),n.attribValue=n.attribName,F(n),k(n)):_(s,a)?n.state=I.ATTRIB_NAME_SAW_WHITE:_(m,a)?n.attribName+=a:P(n,"Invalid attribute name");continue;case I.ATTRIB_NAME_SAW_WHITE:if("="===a)n.state=I.ATTRIB_VALUE;else {if(_(s,a))continue;P(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",N(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===a?k(n):_(p,a)?(n.attribName=a,n.state=I.ATTRIB_NAME):(P(n,"Invalid attribute name"),n.state=I.ATTRIB);}continue;case I.ATTRIB_VALUE:if(_(s,a))continue;_(c,a)?(n.q=a,n.state=I.ATTRIB_VALUE_QUOTED):(P(n,"Unquoted attribute value"),n.state=I.ATTRIB_VALUE_UNQUOTED,n.attribValue=a);continue;case I.ATTRIB_VALUE_QUOTED:if(a!==n.q){"&"===a?n.state=I.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=a;continue;}F(n),n.q="",n.state=I.ATTRIB_VALUE_CLOSED;continue;case I.ATTRIB_VALUE_CLOSED:_(s,a)?n.state=I.ATTRIB:">"===a?k(n):"/"===a?n.state=I.OPEN_TAG_SLASH:_(p,a)?(P(n,"No whitespace between attributes"),n.attribName=a,n.attribValue="",n.state=I.ATTRIB_NAME):P(n,"Invalid attribute name");continue;case I.ATTRIB_VALUE_UNQUOTED:if(T(f,a)){"&"===a?n.state=I.ATTRIB_VALUE_ENTITY_U:n.attribValue+=a;continue;}F(n),">"===a?k(n):n.state=I.ATTRIB;continue;case I.CLOSE_TAG:if(n.tagName)">"===a?U(n):_(m,a)?n.tagName+=a:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=I.SCRIPT):(T(s,a)&&P(n,"Invalid tagname in closing tag"),n.state=I.CLOSE_TAG_SAW_WHITE);else {if(_(s,a))continue;T(p,a)?n.script?(n.script+="</"+a,n.state=I.SCRIPT):P(n,"Invalid tagname in closing tag."):n.tagName=a;}continue;case I.CLOSE_TAG_SAW_WHITE:if(_(s,a))continue;">"===a?U(n):P(n,"Invalid characters in closing tag");continue;case I.TEXT_ENTITY:case I.ATTRIB_VALUE_ENTITY_Q:case I.ATTRIB_VALUE_ENTITY_U:var l,d;switch(n.state){case I.TEXT_ENTITY:l=I.TEXT,d="textNode";break;case I.ATTRIB_VALUE_ENTITY_Q:l=I.ATTRIB_VALUE_QUOTED,d="attribValue";break;case I.ATTRIB_VALUE_ENTITY_U:l=I.ATTRIB_VALUE_UNQUOTED,d="attribValue";}";"===a?(n[d]+=Z(n),n.entity="",n.state=l):_(n.entity.length?E:y,a)?n.entity+=a:(P(n,"Invalid character in entity name"),n[d]+="&"+n.entity+a,n.entity="",n.state=l);continue;default:throw new Error(n,"Unknown state: "+n.state);}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,a=0,o=r.length;a<o;a++){var s=t[r[a]].length;if(s>n)switch(r[a]){case"textNode":C(t);break;case"cdata":N(t,"oncdata",t.cdata),t.cdata="";break;case"script":N(t,"onscript",t.script),t.script="";break;default:O(t,"Max buffer length exceeded: "+r[a]);}i=Math.max(i,s);}var u=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=u+t.position;}(n),n;},resume:function(){return this.error=null,this;},close:function(){return this.write(null);},flush:function(){var e;C(e=this),""!==e.cdata&&(N(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(N(e,"onscript",e.script),e.script="");}};try{t=n(182).Stream;}catch(e){t=function(){};}var a=e.EVENTS.filter(function(e){return "error"!==e&&"end"!==e;});function o(e,n){if(!(this instanceof o))return new o(e,n);t.apply(this),this._parser=new i(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end");},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null;},this._decoder=null,a.forEach(function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e];},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t);},enumerable:!0,configurable:!1});});}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=n(7503).s;this._decoder=new t("utf8");}e=this._decoder.write(e);}return this._parser.write(e.toString()),this.emit("data",e),!0;},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0;},o.prototype.on=function(e,n){var r=this;return r._parser["on"+e]||-1===a.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t);}),t.prototype.on.call(r,e,n);};var s="\r\n\t ",u="0124356789",l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="'\"",f=s+">",d="http://www.w3.org/XML/1998/namespace",g="http://www.w3.org/2000/xmlns/",h={xml:d,xmlns:g};s=v(s),u=v(u),l=v(l);var p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,E=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function v(e){return e.split("").reduce(function(e,t){return e[t]=!0,e;},{});}function _(e,t){return function(e){return "[object RegExp]"===Object.prototype.toString.call(e);}(e)?!!t.match(e):e[t];}function T(e,t){return !_(e,t);}c=v(c),f=v(f);var S,b,A,I=0;for(var R in e.STATE={BEGIN:I++,BEGIN_WHITESPACE:I++,TEXT:I++,TEXT_ENTITY:I++,OPEN_WAKA:I++,SGML_DECL:I++,SGML_DECL_QUOTED:I++,DOCTYPE:I++,DOCTYPE_QUOTED:I++,DOCTYPE_DTD:I++,DOCTYPE_DTD_QUOTED:I++,COMMENT_STARTING:I++,COMMENT:I++,COMMENT_ENDING:I++,COMMENT_ENDED:I++,CDATA:I++,CDATA_ENDING:I++,CDATA_ENDING_2:I++,PROC_INST:I++,PROC_INST_BODY:I++,PROC_INST_ENDING:I++,OPEN_TAG:I++,OPEN_TAG_SLASH:I++,ATTRIB:I++,ATTRIB_NAME:I++,ATTRIB_NAME_SAW_WHITE:I++,ATTRIB_VALUE:I++,ATTRIB_VALUE_QUOTED:I++,ATTRIB_VALUE_CLOSED:I++,ATTRIB_VALUE_UNQUOTED:I++,ATTRIB_VALUE_ENTITY_Q:I++,ATTRIB_VALUE_ENTITY_U:I++,CLOSE_TAG:I++,CLOSE_TAG_SAW_WHITE:I++,SCRIPT:I++,SCRIPT_ENDING:I++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r;}),e.STATE)e.STATE[e.STATE[R]]=R;function w(e,t,n){e[t]&&e[t](n);}function N(e,t,n){e.textNode&&C(e),w(e,t,n);}function C(e){e.textNode=D(e.opt,e.textNode),e.textNode&&w(e,"ontext",e.textNode),e.textNode="";}function D(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t;}function O(e,t){return C(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,w(e,"onerror",t),e;}function M(e){return e.sawRoot&&!e.closedRoot&&P(e,"Unclosed root tag"),e.state!==I.BEGIN&&e.state!==I.BEGIN_WHITESPACE&&e.state!==I.TEXT&&O(e,"Unexpected end"),C(e),e.c="",e.closed=!0,w(e,"onend"),i.call(e,e.strict,e.opt),e;}function P(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&O(e,t);}function L(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,N(e,"onopentagstart",n);}function x(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i};}function F(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else {if(e.opt.xmlns){var t=x(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==d)P(e,"xml: prefix must be bound to "+d+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==g)P(e,"xmlns: prefix must be bound to "+g+"\nActual: "+e.attribValue);else {var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue;}e.attribList.push([e.attribName,e.attribValue]);}else e.tag.attributes[e.attribName]=e.attribValue,N(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue="";}}function k(e,t){if(e.opt.xmlns){var n=e.tag,r=x(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(P(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){N(e,"onopennamespace",{prefix:t,uri:n.ns[t]});});for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],u=s[0],l=s[1],c=x(u,!0),f=c.prefix,d=c.local,g=""===f?"":n.ns[f]||"",h={name:u,value:l,prefix:f,local:d,uri:g};f&&"xmlns"!==f&&!g&&(P(e,"Unbound namespace prefix: "+JSON.stringify(f)),h.uri=f),e.tag.attributes[u]=h,N(e,"onattribute",h);}e.attribList.length=0;}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),N(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=I.TEXT:e.state=I.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0;}function U(e){if(!e.tagName)return P(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=I.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=I.SCRIPT);N(e,"onscript",e.script),e.script="";}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)P(e,"Unexpected close tag");if(t<0)return P(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=I.TEXT);e.tagName=n;for(var i=e.tags.length;i-->t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,N(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach(function(t){var n=a.ns[t];N(e,"onclosenamespace",{prefix:t,uri:n});});}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=I.TEXT;}function Z(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(P(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t));}function B(e,t){"<"===t?(e.state=I.OPEN_WAKA,e.startTagPosition=e.position):T(s,t)&&(P(e,"Non-whitespace before first tag."),e.textNode=t,e.state=I.TEXT);}function G(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n;}I=e.STATE,String.fromCodePoint||(S=String.fromCharCode,b=Math.floor,A=function(){var e,t,n=16384,r=[],i=-1,a=arguments.length;if(!a)return "";for(var o="";++i<a;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||b(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(i+1===a||r.length>n)&&(o+=S.apply(null,r),r.length=0);}return o;},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:A,configurable:!0,writable:!0}):String.fromCodePoint=A);}(t);},182:(e,t,n)=>{e.exports=i;var r=n(1159).EventEmitter;function i(){r.call(this);}n(1765)(i,r),i.Readable=n(2846),i.Writable=n(8318),i.Duplex=n(6138),i.Transform=n(9798),i.PassThrough=n(5472),i.finished=n(8800),i.pipeline=n(7295),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause();}function a(){n.readable&&n.resume&&n.resume();}n.on("data",i),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",u));var o=!1;function s(){o||(o=!0,e.end());}function u(){o||(o=!0,"function"==typeof e.destroy&&e.destroy());}function l(e){if(c(),0===r.listenerCount(this,"error"))throw e;}function c(){n.removeListener("data",i),e.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c);}return n.on("error",l),e.on("error",l),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e;};},1765:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}));}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n(),e.prototype.constructor=e;}};},3690:e=>{var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return "string"==typeof n?n:n(e,t,r);}(t,r,i))||this;}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i;}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i;}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map(function(e){return String(e);}),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0]);}return "of ".concat(t," ").concat(String(e));}n("ERR_INVALID_OPT_VALUE",function(e,t){return 'The value "'+t+'" is invalid for option "'+e+'"';},TypeError),n("ERR_INVALID_ARG_TYPE",function(e,t,n){var i,a,o,s,u;if("string"==typeof t&&(a="not ",t.substr(0,a.length)===a)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return (void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t;}(e," argument"))o="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else {var l=("number"!=typeof u&&(u=0),u+".".length>(s=e).length||-1===s.indexOf(".",u)?"argument":"property");o='The "'.concat(e,'" ').concat(l," ").concat(i," ").concat(r(t,"type"));}return o+". Received type ".concat(typeof n);},TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",function(e){return "The "+e+" method is not implemented";}),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",function(e){return "Cannot call "+e+" after a stream was destroyed";}),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",function(e){return "Unknown encoding: "+e;},TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t;},6138:(e,t,n)=>{var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t;};e.exports=l;var i=n(2846),a=n(8318);n(1765)(l,i);for(var o=r(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u]);}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)));}function c(){this._writableState.ended||process.nextTick(f,this);}function f(e){e.end();}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark;}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer();}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length;}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed;},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e);}});},5472:(e,t,n)=>{e.exports=i;var r=n(9798);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e);}n(1765)(i,r),i.prototype._transform=function(e,t,n){n(null,e);};},2846:(e,t,n)=>{var r;e.exports=A,A.ReadableState=b,n(1159).EventEmitter;var i,a=function(e,t){return e.listeners(t).length;},o=n(9299),s=n(1549).Buffer,u=n.g.Uint8Array||function(){},l=n(964);i=l&&l.debuglog?l.debuglog("stream"):function(){};var c,f,d,g=n(8393),h=n(6163),p=n(7269).getHighWaterMark,m=n(3690).q,y=m.ERR_INVALID_ARG_TYPE,E=m.ERR_STREAM_PUSH_AFTER_EOF,v=m.ERR_METHOD_NOT_IMPLEMENTED,_=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(1765)(A,o);var T=h.errorOrDestroy,S=["error","close","destroy","pause","resume"];function b(e,t,i){r=r||n(6138),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=p(this,e,"readableHighWaterMark",i),this.buffer=new g(),this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c||(c=n(7503).s),this.decoder=new c(e.encoding),this.encoding=e.encoding);}function A(e){if(r=r||n(6138),!(this instanceof A))return new A(e);var t=this instanceof r;this._readableState=new b(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this);}function I(e,t,n,r,a){i("readableAddChunk",t);var o,l=e._readableState;if(null===t)l.reading=!1,function(e,t){if(i("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length);}t.ended=!0,t.sync?C(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,D(e)));}}(e,l);else if(a||(o=function(e,t){var n,r;return r=t,s.isBuffer(r)||r instanceof u||"string"==typeof t||void 0===t||e.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],t)),n;}(l,t)),o)T(e,o);else if(l.objectMode||t&&t.length>0){if("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e);}(t)),r)l.endEmitted?T(e,new _()):R(e,l,t,!0);else if(l.ended)T(e,new E());else {if(l.destroyed)return !1;l.reading=!1,l.decoder&&!n?(t=l.decoder.write(t),l.objectMode||0!==t.length?R(e,l,t,!1):O(e,l)):R(e,l,t,!1);}}else r||(l.reading=!1,O(e,l));return !l.ended&&(l.length<l.highWaterMark||0===l.length);}function R(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),O(e,t);}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed;},set:function(e){this._readableState&&(this._readableState.destroyed=e);}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(e,t){t(e);},A.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),I(this,e,t,!1,n);},A.prototype.unshift=function(e){return I(this,e,null,!0,!1);},A.prototype.isPaused=function(){return !1===this._readableState.flowing;},A.prototype.setEncoding=function(e){c||(c=n(7503).s);var t=new c(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this;};var w=1073741824;function N(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e;}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));}function C(e){var t=e._readableState;i("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(i("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(D,e));}function D(e){var t=e._readableState;i("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,F(e);}function O(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(M,e,t));}function M(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(i("maybeReadMore read 0"),e.read(0),n===t.length)break;}t.readingMore=!1;}function P(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume();}function L(e){i("readable nexttick read 0"),e.read(0);}function x(e,t){i("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),F(e),t.flowing&&!t.reading&&e.read(0);}function F(e){var t=e._readableState;for(i("flow",t.flowing);t.flowing&&null!==e.read(););}function k(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n;}function U(e){var t=e._readableState;i("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(Z,t,e));}function Z(e,t){if(i("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy();}}function B(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return -1;}A.prototype.read=function(e){i("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return i("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?U(this):C(this),null;if(0===(e=N(e,t))&&t.ended)return 0===t.length&&U(this),null;var r,a=t.needReadable;return i("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&i("length less than watermark",a=!0),t.ended||t.reading?i("reading or ended",a=!1):a&&(i("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=N(n,t))),null===(r=e>0?k(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&U(this)),null!==r&&this.emit("data",r),r;},A.prototype._read=function(e){T(this,new v("_read()"));},A.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e);}r.pipesCount+=1,i("pipe count=%d opts=%j",r.pipesCount,t);var o=t&&!1===t.end||e===process.stdout||e===process.stderr?h:s;function s(){i("onend"),e.end();}r.endEmitted?process.nextTick(o):n.once("end",o),e.on("unpipe",function t(a,o){i("onunpipe"),a===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,i("cleanup"),e.removeListener("close",d),e.removeListener("finish",g),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",t),n.removeListener("end",s),n.removeListener("end",h),n.removeListener("data",c),l=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||u());});var u=function(e){return function(){var t=e._readableState;i("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,F(e));};}(n);e.on("drain",u);var l=!1;function c(t){i("ondata");var a=e.write(t);i("dest.write",a),!1===a&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==B(r.pipes,e))&&!l&&(i("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause());}function f(t){i("onerror",t),h(),e.removeListener("error",f),0===a(e,"error")&&T(e,t);}function d(){e.removeListener("finish",g),h();}function g(){i("onfinish"),e.removeListener("close",d),h();}function h(){i("unpipe"),n.unpipe(e);}return n.on("data",c),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n);}(e,"error",f),e.once("close",d),e.once("finish",g),e.emit("pipe",n),r.flowing||(i("pipe resume"),n.resume()),e;},A.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,{hasUnpiped:!1});return this;}var o=B(t.pipes,e);return -1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this;},A.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),r=this._readableState;return "data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,i("on readable",r.length,r.reading),r.length?C(this):r.reading||process.nextTick(L,this))),n;},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return "readable"===e&&process.nextTick(P,this),n;},A.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return "readable"!==e&&void 0!==e||process.nextTick(P,this),t;},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(i("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(x,e,t));}(this,e)),e.paused=!1,this;},A.prototype.pause=function(){return i("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(i("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this;},A.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var a in e.on("end",function(){if(i("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e);}t.push(null);}),e.on("data",function(a){i("wrapped data"),n.decoder&&(a=n.decoder.write(a)),n.objectMode&&null==a||(n.objectMode||a&&a.length)&&(t.push(a)||(r=!0,e.pause()));}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments);};}(a));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){i("wrapped _read",t),r&&(r=!1,e.resume());},this;},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=n(7299)),f(this);}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark;}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer;}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing;},set:function(e){this._readableState&&(this._readableState.flowing=e);}}),A._fromList=k,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length;}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===d&&(d=n(6233)),d(A,e,t);});},9798:(e,t,n)=>{e.exports=c;var r=n(3690).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,a=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,u=n(6138);function l(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new a());n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark);}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f);}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(t,n){d(e,t,n);});}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s();if(e._transformState.transforming)throw new o();return e.push(null);}n(1765)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t);},c.prototype._transform=function(e,t,n){n(new i("_transform()"));},c.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark);}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform));},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,function(e){t(e);});};},8318:(e,t,n)=>{function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(undefined),r=r.next;}t.corkedRequestsFree.next=e;}(t,e);};}var i;e.exports=A,A.WritableState=b;var a,o={deprecate:n(7839)},s=n(9299),u=n(1549).Buffer,l=n.g.Uint8Array||function(){},c=n(6163),f=n(7269).getHighWaterMark,d=n(3690).q,g=d.ERR_INVALID_ARG_TYPE,h=d.ERR_METHOD_NOT_IMPLEMENTED,p=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,y=d.ERR_STREAM_DESTROYED,E=d.ERR_STREAM_NULL_VALUES,v=d.ERR_STREAM_WRITE_AFTER_END,_=d.ERR_UNKNOWN_ENCODING,T=c.errorOrDestroy;function S(){}function b(e,t,a){i=i||n(6138),e=e||{},"boolean"!=typeof a&&(a=t instanceof i),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if("function"!=typeof i)throw new p();if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0;}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(process.nextTick(i,r),process.nextTick(D,e,t),e._writableState.errorEmitted=!0,T(e,r)):(i(r),e._writableState.errorEmitted=!0,T(e,r),D(e,t));}(e,n,r,t,i);else {var a=N(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),r?process.nextTick(R,e,n,a,i):R(e,n,a,i);}}(t,e);},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this);}function A(e){var t=this instanceof(i=i||n(6138));if(!t&&!a.call(A,this))return new A(e);this._writableState=new b(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this);}function I(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1;}function R(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));}(e,t),t.pendingcb--,r(),D(e,t);}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,a=new Array(i),o=t.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)a[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;a.allBuffers=u,I(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0;}else {for(;n;){var l=n.chunk,c=n.encoding,f=n.callback;if(I(e,t,!1,t.objectMode?1:l.length,l,c,f),n=n.next,t.bufferedRequestCount--,t.writing)break;}null===n&&(t.lastBufferedRequest=null);}t.bufferedRequest=n,t.bufferProcessing=!1;}function N(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing;}function C(e,t){e._final(function(n){t.pendingcb--,n&&T(e,n),t.prefinished=!0,e.emit("prefinish"),D(e,t);});}function D(e,t){var n=N(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(C,e,t)));}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy();}return n;}n(1765)(A,s),b.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t;},function(){try{Object.defineProperty(b.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer();},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")});}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(a=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return !!a.call(this,e)||this===A&&e&&e._writableState instanceof b;}})):a=function(e){return e instanceof this;},A.prototype.pipe=function(){T(this,new m());},A.prototype.write=function(e,t,n){var r,i=this._writableState,a=!1,o=!i.objectMode&&(r=e,u.isBuffer(r)||r instanceof l);return o&&!u.isBuffer(e)&&(e=function(e){return u.from(e);}(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=S),i.ending?function(e,t){var n=new v();T(e,n),process.nextTick(t,n);}(this,n):(o||function(e,t,n,r){var i;return null===n?i=new E():"string"==typeof n||t.objectMode||(i=new g("chunk",["string","Buffer"],n)),!i||(T(e,i),process.nextTick(r,i),!1);}(this,i,e,n))&&(i.pendingcb++,a=function(e,t,n,r,i,a){if(!n){var o=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n)),t;}(t,r,i);r!==o&&(n=!0,i="buffer",r=o);}var s=t.objectMode?1:r.length;t.length+=s;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1;}else I(e,t,!1,s,r,i,a);return l;}(this,i,o,e,t,n)),a;},A.prototype.cork=function(){this._writableState.corked++;},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||w(this,e));},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this;},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer();}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark;}}),A.prototype._write=function(e,t,n){n(new h("_write()"));},A.prototype._writev=null,A.prototype.end=function(e,t,n){var r=this._writableState;return "function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,D(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1;}(this,r,n),this;},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length;}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed;},set:function(e){this._writableState&&(this._writableState.destroyed=e);}}),A.prototype.destroy=c.destroy,A.prototype._undestroy=c.undestroy,A.prototype._destroy=function(e,t){t(e);};},7299:(e,t,n)=>{var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}var a=n(8800),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function g(e,t){return {value:e,done:t};}function h(e){var t=e[o];if(null!==t){var n=e[d].read();null!==n&&(e[c]=null,e[o]=null,e[s]=null,t(g(n,!1)));}}function p(e){process.nextTick(h,e);}var m=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((i(r={get stream(){return this[d];},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(g(void 0,!0));if(this[d].destroyed)return new Promise(function(t,n){process.nextTick(function(){e[u]?n(e[u]):t(g(void 0,!0));});});var n,r=this[c];if(r)n=new Promise(function(e,t){return function(n,r){e.then(function(){t[l]?n(g(void 0,!0)):t[f](n,r);},r);};}(r,this));else {var i=this[d].read();if(null!==i)return Promise.resolve(g(i,!1));n=new Promise(this[f]);}return this[c]=n,n;}},Symbol.asyncIterator,function(){return this;}),i(r,"return",function(){var e=this;return new Promise(function(t,n){e[d].destroy(null,function(e){e?n(e):t(g(void 0,!0));});});}),r),m);e.exports=function(e){var t,n=Object.create(y,(i(t={},d,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,f,{value:function(e,t){var r=n[d].read();r?(n[c]=null,n[o]=null,n[s]=null,e(g(r,!1))):(n[o]=e,n[s]=t);},writable:!0}),t));return n[c]=null,a(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[s];return null!==t&&(n[c]=null,n[o]=null,n[s]=null,t(e)),void(n[u]=e);}var r=n[o];null!==r&&(n[c]=null,n[o]=null,n[s]=null,r(g(void 0,!0))),n[l]=!0;}),e.on("readable",p.bind(null,n)),n;};},8393:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable;})),n.push.apply(n,r);}return n;}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var o=n(1549).Buffer,s=n(9862).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.head=null,this.tail=null,this.length=0;}var t,n;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length;}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length;}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e;}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0;}},{key:"join",value:function(e){if(0===this.length)return "";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n;}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,n,r,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=i,r=s,o.prototype.copy.call(t,n,r),s+=a.data.length,a=a.next;return i;}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n;}},{key:"first",value:function(){return this.head.data;}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?r+=i:r+=i.slice(0,e),0==(e-=a)){a===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break;}++n;}return this.length-=n,r;}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0==(e-=a)){a===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(a));break;}++r;}return this.length-=r,t;}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t));});}return e;}({},t,{depth:0,customInspect:!1}));}}],n&&a(t.prototype,n),e;}();},6163:e=>{function t(e,t){r(e,t),n(e);}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close");}function r(e,t){e.emit("error",t);}e.exports={destroy:function(e,i){var a=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(i?i(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(r,this,e)):process.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!i&&e?a._writableState?a._writableState.errorEmitted?process.nextTick(n,a):(a._writableState.errorEmitted=!0,process.nextTick(t,a,e)):process.nextTick(t,a,e):i?(process.nextTick(n,a),i(e)):process.nextTick(n,a);}),this);},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1);},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t);}};},8800:(e,t,n)=>{var r=n(3690).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,a){if("function"==typeof n)return e(t,null,n);n||(n={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r);}};}(a||i);var o=n.readable||!1!==n.readable&&t.readable,s=n.writable||!1!==n.writable&&t.writable,u=function(){t.writable||c();},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t);},f=t._readableState&&t._readableState.endEmitted,d=function(){o=!1,f=!0,s||a.call(t);},g=function(e){a.call(t,e);},h=function(){var e;return o&&!f?(t._readableState&&t._readableState.ended||(e=new r()),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new r()),a.call(t,e)):void 0;},p=function(){t.req.on("finish",c);};return function(e){return e.setHeader&&"function"==typeof e.abort;}(t)?(t.on("complete",c),t.on("abort",h),t.req?p():t.on("request",p)):s&&!t._writableState&&(t.on("end",u),t.on("close",u)),t.on("end",d),t.on("finish",c),!1!==n.error&&t.on("error",g),t.on("close",h),function(){t.removeListener("complete",c),t.removeListener("abort",h),t.removeListener("request",p),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",d),t.removeListener("error",g),t.removeListener("close",h);};};},6233:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser");};},7295:(e,t,n)=>{var r,i=n(3690).q,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e;}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments));};}(a);var s=!1;e.on("close",function(){s=!0;}),void 0===r&&(r=n(8800)),r(e,{readable:t,writable:i},function(e){if(e)return a(e);s=!0,a();});var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort;}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new o("pipe"));};}function l(e){e();}function c(e,t){return e.pipe(t);}function f(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s;}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map(function(e,n){var a=n<t.length-1;return u(e,a,n>0,function(e){r||(r=e),e&&o.forEach(l),a||(o.forEach(l),i(r));});});return t.reduce(c);};},7269:(e,t,n)=>{var r=n(3690).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var a=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null;}(t,i,n);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new r(i?n:"highWaterMark",a);return Math.floor(a);}return e.objectMode?16:16384;}};},9299:(e,t,n)=>{e.exports=n(1159).EventEmitter;},7503:(e,t,n)=>{var r=n(8387).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return !0;default:return !1;}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return "utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return "utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return "utf16le";case"latin1":case"binary":return "latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0;}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e;}(e),this.encoding){case"utf16le":this.text=u,this.end=l,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=f,t=3;break;default:return this.write=d,void(this.end=g);}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t);}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2;}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�";}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length));}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1);}return n;}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n);}return t;}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n));}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t;}function d(e){return e.toString(this.encoding);}function g(e){return e&&e.length?this.write(e):"";}t.s=a,a.prototype.write=function(e){if(0===e.length)return "";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return "";n=this.lastNeed,this.lastNeed=0;}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||"";},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t;},a.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=o(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=o(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=o(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0;}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r);},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length;};},1067:function(e,t,n){var r;!function(i,a){var o="function",s="undefined",u="object",l="string",c="model",f="name",d="type",g="vendor",h="version",p="architecture",m="console",y="mobile",E="tablet",v="smarttv",_="wearable",T="embedded",S="Amazon",b="Apple",A="ASUS",I="BlackBerry",R="Browser",w="Chrome",N="Firefox",C="Google",D="Huawei",O="LG",M="Microsoft",P="Motorola",L="Opera",x="Samsung",F="Sony",k="Xiaomi",U="Zebra",Z="Facebook",B=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t;},G=function(e,t){return typeof e===l&&-1!==q(t).indexOf(q(e));},q=function(e){return e.toLowerCase();},Y=function(e,t){if(typeof e===l)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,255);},j=function(e,t){for(var n,r,i,s,l,c,f=0;f<t.length&&!l;){var d=t[f],g=t[f+1];for(n=r=0;n<d.length&&!l;)if(l=d[n++].exec(e))for(i=0;i<g.length;i++)c=l[++r],typeof(s=g[i])===u&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):a:this[s[0]]=c?s[1].call(this,c,s[2]):a:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):a):this[s]=c||a;f+=2;}},H=function(e,t){for(var n in t)if(typeof t[n]===u&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(G(t[n][r],e))return "?"===n?a:n;}else if(G(t[n],e))return "?"===n?a:n;return e;},V={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},K={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[h,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[h,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,h],[/opios[\/ ]+([\w\.]+)/i],[h,[f,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[h,[f,L]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[f,h],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[h,[f,"UC"+R]],[/\bqbcore\/([\w\.]+)/i],[h,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[h,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[h,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[h,[f,"IE"]],[/yabrowser\/([\w\.]+)/i],[h,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+R],h],[/\bfocus\/([\w\.]+)/i],[h,[f,N+" Focus"]],[/\bopt\/([\w\.]+)/i],[h,[f,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[h,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[h,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[h,[f,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[h,[f,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[h,[f,N]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+R]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+R],h],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],h],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,h],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,Z],h],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,h],[/\bgsa\/([\w\.]+) .*safari\//i],[h,[f,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[h,[f,w+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,w+" WebView"],h],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[h,[f,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,h],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[h,[f,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[h,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[h,H,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,h],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],h],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[h,[f,N+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[f,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,q]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",q]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,q]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[g,x],[d,E]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[g,x],[d,y]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[g,b],[d,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[g,b],[d,E]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[g,D],[d,E]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[c,[g,D],[d,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[g,k],[d,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[g,k],[d,E]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[g,"OPPO"],[d,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[g,"Vivo"],[d,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[g,"Realme"],[d,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[g,P],[d,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[g,P],[d,E]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[g,O],[d,E]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[g,O],[d,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[g,"Lenovo"],[d,E]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[g,"Nokia"],[d,y]],[/(pixel c)\b/i],[c,[g,C],[d,E]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[g,C],[d,y]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[g,F],[d,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[g,F],[d,E]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[g,"OnePlus"],[d,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[g,S],[d,E]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[g,S],[d,y]],[/(playbook);[-\w\),; ]+(rim)/i],[c,g,[d,E]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[g,I],[d,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[g,A],[d,E]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[g,A],[d,y]],[/(nexus 9)/i],[c,[g,"HTC"],[d,E]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[g,[c,/_/g," "],[d,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[g,"Acer"],[d,E]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[g,"Meizu"],[d,y]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[g,"Sharp"],[d,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[g,c,[d,y]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[g,c,[d,E]],[/(surface duo)/i],[c,[g,M],[d,E]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[g,"Fairphone"],[d,y]],[/(u304aa)/i],[c,[g,"AT&T"],[d,y]],[/\bsie-(\w*)/i],[c,[g,"Siemens"],[d,y]],[/\b(rct\w+) b/i],[c,[g,"RCA"],[d,E]],[/\b(venue[\d ]{2,7}) b/i],[c,[g,"Dell"],[d,E]],[/\b(q(?:mv|ta)\w+) b/i],[c,[g,"Verizon"],[d,E]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[g,"Barnes & Noble"],[d,E]],[/\b(tm\d{3}\w+) b/i],[c,[g,"NuVision"],[d,E]],[/\b(k88) b/i],[c,[g,"ZTE"],[d,E]],[/\b(nx\d{3}j) b/i],[c,[g,"ZTE"],[d,y]],[/\b(gen\d{3}) b.+49h/i],[c,[g,"Swiss"],[d,y]],[/\b(zur\d{3}) b/i],[c,[g,"Swiss"],[d,E]],[/\b((zeki)?tb.*\b) b/i],[c,[g,"Zeki"],[d,E]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[g,"Dragon Touch"],c,[d,E]],[/\b(ns-?\w{0,9}) b/i],[c,[g,"Insignia"],[d,E]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[g,"NextBook"],[d,E]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[g,"Voice"],c,[d,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[g,"LvTel"],c,[d,y]],[/\b(ph-1) /i],[c,[g,"Essential"],[d,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[g,"Envizen"],[d,E]],[/\b(trio[-\w\. ]+) b/i],[c,[g,"MachSpeed"],[d,E]],[/\btu_(1491) b/i],[c,[g,"Rotor"],[d,E]],[/(shield[\w ]+) b/i],[c,[g,"Nvidia"],[d,E]],[/(sprint) (\w+)/i],[g,c,[d,y]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[g,M],[d,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[g,U],[d,E]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[g,U],[d,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[g,c,[d,m]],[/droid.+; (shield) bui/i],[c,[g,"Nvidia"],[d,m]],[/(playstation [345portablevi]+)/i],[c,[g,F],[d,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[g,M],[d,m]],[/smart-tv.+(samsung)/i],[g,[d,v]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[g,x],[d,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[g,O],[d,v]],[/(apple) ?tv/i],[g,[c,b+" TV"],[d,v]],[/crkey/i],[[c,w+"cast"],[g,C],[d,v]],[/droid.+aft(\w)( bui|\))/i],[c,[g,S],[d,v]],[/\(dtv[\);].+(aquos)/i],[c,[g,"Sharp"],[d,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[g,Y],[c,Y],[d,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,v]],[/((pebble))app/i],[g,c,[d,_]],[/droid.+; (glass) \d/i],[c,[g,C],[d,_]],[/droid.+; (wt63?0{2,3})\)/i],[c,[g,U],[d,_]],[/(quest( 2)?)/i],[c,[g,Z],[d,_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[g,[d,T]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[d,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[d,E]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,E]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[d,y]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[h,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[f,h],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[h,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,h],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[h,H,V]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[h,H,V]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[h,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,"Mac OS"],[h,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[h,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,h],[/\(bb(10);/i],[h,[f,I]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[h,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[h,[f,N+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[h,[f,"webOS"]],[/crkey\/([\d\.]+)/i],[h,[f,w+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[f,"Chromium OS"],h],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,h],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],h],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[f,h]]},z=function(e,t){if(typeof e===u&&(t=e,e=a),!(this instanceof z))return new z(e,t).getResult();var n=e||(typeof i!==s&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n;}(K,t):K;return this.getBrowser=function(){var e,t={};return t[f]=a,t[h]=a,j.call(t,n,r.browser),t.major=typeof(e=t.version)===l?e.replace(/[^\d\.]/g,"").split(".")[0]:a,t;},this.getCPU=function(){var e={};return e[p]=a,j.call(e,n,r.cpu),e;},this.getDevice=function(){var e={};return e[g]=a,e[c]=a,e[d]=a,j.call(e,n,r.device),e;},this.getEngine=function(){var e={};return e[f]=a,e[h]=a,j.call(e,n,r.engine),e;},this.getOS=function(){var e={};return e[f]=a,e[h]=a,j.call(e,n,r.os),e;},this.getResult=function(){return {ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()};},this.getUA=function(){return n;},this.setUA=function(e){return n=typeof e===l&&e.length>255?Y(e,255):e,this;},this.setUA(n),this;};z.VERSION="1.0.2",z.BROWSER=B([f,h,"major"]),z.CPU=B([p]),z.DEVICE=B([c,g,d,m,y,v,E,_,T]),z.ENGINE=z.OS=B([f,h]),typeof t!==s?(e.exports&&(t=e.exports=z),t.UAParser=z):n.amdO?(r=function(){return z;}.call(t,n,t,e))===a||(e.exports=r):typeof i!==s&&(i.UAParser=z);var W=typeof i!==s&&(i.jQuery||i.Zepto);if(W&&!W.ua){var X=new z();W.ua=X.getResult(),W.ua.get=function(){return X.getUA();},W.ua.set=function(e){X.setUA(e);var t=X.getResult();for(var n in t)W.ua[n]=t[n];};}}("object"==typeof window?window:this);},7839:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return !1;}catch(e){return !1;}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase();}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0;}return e.apply(this,arguments);};};},9862:()=>{},964:()=>{},3165:e=>{e.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]');},5813:e=>{e.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]');},9460:e=>{e.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}');},7778:e=>{e.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]');},8589:e=>{e.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}');},858:e=>{e.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]');}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports;}n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t;},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]});},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")();}catch(e){if("object"==typeof window)return window;}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return (()=>{n.d(r,{default:()=>c}),n(8416);var e,t=n(1715),i=n(8080),a=n(1737),o=n(7688),s=function(){var e,t="application/dash+xml";function n(n,r,i){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var a,s=n.id||n.name||"video element";if(!(r=r||[].slice.call(n.querySelectorAll("source")).filter(function(e){return e.type==t;})[0])&&n.src)(r=document.createElement("source")).src=n.src;else if(!r&&!n.src)return null;return i=i||{},(a=(0, o.Z)(i).create()).initialize(n,r.src,n.autoplay),e||(e=a.getDebug().getLogger()),e.debug("Converted "+s+" to dash.js player and added content: "+r.src),n._dashjs_player=a,a;}function r(e){return /^VIDEO$/i.test(e.nodeName)?e:r(e.parentNode);}return {create:n,createAll:function(e,i){var a=[];e=e||"[data-dashjs-player]";for(var o=(i=i||document).querySelectorAll(e),s=0;s<o.length;s++){var u=n(o[s],null);a.push(u);}for(var l=i.querySelectorAll('source[type="'+t+'"]'),c=0;c<l.length;c++){var f=n(r(l[c]),null);a.push(f);}return a;}};}();!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?s.createAll():e=window.setInterval(function(){window.dashjs&&(window.clearInterval(e),s.createAll());},500):window.addEventListener("load",function e(){window.removeEventListener("load",e),s.createAll();}));const u=s;var l=n(6398);dashjs.Protection=a.default,dashjs.MetricsReporting=i.default,dashjs.MediaPlayerFactory=u,dashjs.Debug=l.Z,dashjs.supportsMediaSource=t.B;const c=dashjs;})(),r.default;})());})(Dash$1);var Dash = /*@__PURE__*/getDefaultExportFromCjs(Dash$1.exports);

  var t$2="undefined"!=typeof self?self:{};function e$2(e,n){e=e.split(".");var r,i=t$2;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(r=e.shift());)e.length||void 0===n?i=i[r]&&i[r]!==Object.prototype[r]?i[r]:i[r]={}:i[r]=n;}function n$2(){throw Error("Invalid UTF8")}function r$2(t,e){return e=String.fromCharCode.apply(null,e),null==t?e:t+e}let i$2,s$3;const o$2="undefined"!=typeof TextDecoder;let a$3;const c$2="undefined"!=typeof TextEncoder;function h$2(t){if(c$2)t=(a$3||=new TextEncoder).encode(t);else {let n=0;const r=new Uint8Array(3*t.length);for(let i=0;i<t.length;i++){var e=t.charCodeAt(i);if(e<128)r[n++]=e;else {if(e<2048)r[n++]=e>>6|192;else {if(e>=55296&&e<=57343){if(e<=56319&&i<t.length){const s=t.charCodeAt(++i);if(s>=56320&&s<=57343){e=1024*(e-55296)+s-56320+65536,r[n++]=e>>18|240,r[n++]=e>>12&63|128,r[n++]=e>>6&63|128,r[n++]=63&e|128;continue}i--;}e=65533;}r[n++]=e>>12|224,r[n++]=e>>6&63|128;}r[n++]=63&e|128;}}t=n===r.length?r:r.subarray(0,n);}return t}var u$2,l$2;t:{for(var f$2=["CLOSURE_FLAGS"],d$2=t$2,p$2=0;p$2<f$2.length;p$2++)if(null==(d$2=d$2[f$2[p$2]])){l$2=null;break t}l$2=d$2;}var g$2,m$2=l$2&&l$2[610401301];u$2=null!=m$2&&m$2;const y$2=t$2.navigator;function _$2(t){return !!u$2&&(!!g$2&&g$2.brands.some((({brand:e})=>e&&-1!=e.indexOf(t))))}function v$2(e){var n;return (n=t$2.navigator)&&(n=n.userAgent)||(n=""),-1!=n.indexOf(e)}function E$2(){return !!u$2&&(!!g$2&&g$2.brands.length>0)}function w$2(){return E$2()?_$2("Chromium"):(v$2("Chrome")||v$2("CriOS"))&&!(!E$2()&&v$2("Edge"))||v$2("Silk")}function T$2(t){return T$2[" "](t),t}g$2=y$2&&y$2.userAgentData||null,T$2[" "]=function(){};var b$2=!E$2()&&(v$2("Trident")||v$2("MSIE"));!v$2("Android")||w$2(),w$2(),v$2("Safari")&&(w$2()||!E$2()&&v$2("Coast")||!E$2()&&v$2("Opera")||!E$2()&&v$2("Edge")||(E$2()?_$2("Microsoft Edge"):v$2("Edg/"))||E$2()&&_$2("Opera"));var A$2={},k$2=null;function S$2(t){const e=t.length;let n=3*e/4;n%3?n=Math.floor(n):-1!="=.".indexOf(t[e-1])&&(n=-1!="=.".indexOf(t[e-2])?n-2:n-1);const r=new Uint8Array(n);let i=0;return function(t,e){function n(e){for(;r<t.length;){const e=t.charAt(r++),n=k$2[e];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(e))throw Error("Unknown base64 encoding at char: "+e)}return e}x$2();let r=0;for(;;){const t=n(-1),r=n(0),i=n(64),s=n(64);if(64===s&&-1===t)break;e(t<<2|r>>4),64!=i&&(e(r<<4&240|i>>2),64!=s&&e(i<<6&192|s));}}(t,(function(t){r[i++]=t;})),i!==n?r.subarray(0,i):r}function x$2(){if(!k$2){k$2={};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=t.concat(e[n].split(""));A$2[n]=r;for(let t=0;t<r.length;t++){const e=r[t];void 0===k$2[e]&&(k$2[e]=t);}}}}var L$2="undefined"!=typeof Uint8Array,R$2=!b$2&&"function"==typeof btoa;function F$2(t){if(!R$2){var e;void 0===e&&(e=0),x$2(),e=A$2[e];var n=Array(Math.floor(t.length/3)),r=e[64]||"";let c=0,h=0;for(;c<t.length-2;c+=3){var i=t[c],s=t[c+1],o=t[c+2],a=e[i>>2];i=e[(3&i)<<4|s>>4],s=e[(15&s)<<2|o>>6],o=e[63&o],n[h++]=a+i+s+o;}switch(a=0,o=r,t.length-c){case 2:o=e[(15&(a=t[c+1]))<<2]||r;case 1:t=t[c],n[h]=e[t>>2]+e[(3&t)<<4|a>>4]+o+r;}return n.join("")}for(e="",n=0,r=t.length-10240;n<r;)e+=String.fromCharCode.apply(null,t.subarray(n,n+=10240));return e+=String.fromCharCode.apply(null,n?t.subarray(n):t),btoa(e)}const I$2=/[-_.]/g,M$2={"-":"+",_:"/",".":"="};function P$2(t){return M$2[t]||""}function O$2(t){if(!R$2)return S$2(t);I$2.test(t)&&(t=t.replace(I$2,P$2)),t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function C$2(t){return L$2&&null!=t&&t instanceof Uint8Array}var U$2={};function N$2(){return G$2||=new B$2(null,U$2)}function D$2(t){V$2(U$2);var e=t.g;return null==(e=null==e||C$2(e)?e:"string"==typeof e?O$2(e):null)?e:t.g=e}var B$2=class{h(){return new Uint8Array(D$2(this)||0)}constructor(t,e){if(V$2(e),this.g=t,null!=t&&0===t.length)throw Error("ByteString should be constructed with non-empty values")}};let G$2,j$2;function V$2(t){if(t!==U$2)throw Error("illegal external caller")}function X$2(t,e){t.__closure__error__context__984382||(t.__closure__error__context__984382={}),t.__closure__error__context__984382.severity=e;}function H$2(){const e=Error();X$2(e,"incident"),function(e){t$2.setTimeout((()=>{throw e}),0);}(e);}function W$2(t){return X$2(t=Error(t),"warning"),t}function z$2(){return "function"==typeof BigInt}function K$2(t){return Array.prototype.slice.call(t)}var Y$2="function"==typeof Symbol&&"symbol"==typeof Symbol();function $$2(t){return "function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():t}var q$2=$$2(),J$2=$$2("0di"),Z$2=$$2("2ex"),Q$2=$$2("1oa"),tt$2=Y$2?(t,e)=>{t[q$2]|=e;}:(t,e)=>{void 0!==t.G?t.G|=e:Object.defineProperties(t,{G:{value:e,configurable:!0,writable:!0,enumerable:!1}});},et$2=Y$2?(t,e)=>{t[q$2]&=~e;}:(t,e)=>{void 0!==t.G&&(t.G&=~e);},nt$2=Y$2?t=>0|t[q$2]:t=>0|t.G,rt$2=Y$2?t=>t[q$2]:t=>t.G,it$2=Y$2?(t,e)=>{t[q$2]=e;}:(t,e)=>{void 0!==t.G?t.G=e:Object.defineProperties(t,{G:{value:e,configurable:!0,writable:!0,enumerable:!1}});};function st$2(t){return tt$2(t,34),t}function ot$2(t,e){it$2(e,-30975&(0|t));}function at$2(t,e){it$2(e,-30941&(34|t));}var ct$2,ht$2={},ut$2={};function lt$2(t){return !(!t||"object"!=typeof t||t.Ia!==ut$2)}function ft$2(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}function dt$2(t,e){if(null!=t)if("string"==typeof t)t=t?new B$2(t,U$2):N$2();else if(t.constructor!==B$2)if(C$2(t))t=t.length?new B$2(new Uint8Array(t),U$2):N$2();else {if(!e)throw Error();t=void 0;}return t}function pt$2(t){return !(!Array.isArray(t)||t.length)&&!!(1&nt$2(t))}const gt$2=[];function mt$2(t){if(2&t)throw Error()}it$2(gt$2,55),ct$2=Object.freeze(gt$2);class yt$2{constructor(t,e,n){this.l=0,this.g=t,this.h=e,this.m=n;}next(){if(this.l<this.g.length){const t=this.g[this.l++];return {done:!1,value:this.h?this.h.call(this.m,t):t}}return {done:!0,value:void 0}}[Symbol.iterator](){return new yt$2(this.g,this.h,this.m)}}let _t$2;function vt$2(t,e){(e=_t$2?e[_t$2]:void 0)&&(t[_t$2]=K$2(e));}var Et$2=Object.freeze({});function wt$2(t){return t.Pa=!0,t}var Tt$2=wt$2((t=>"number"==typeof t)),bt$2=wt$2((t=>"string"==typeof t)),At$2=wt$2((t=>"boolean"==typeof t)),kt$2="function"==typeof t$2.BigInt&&"bigint"==typeof t$2.BigInt(0),St$2=wt$2((t=>kt$2?t>=Lt$2&&t<=Ft$2:"-"===t[0]?It$2(t,xt$2):It$2(t,Rt$2)));const xt$2=Number.MIN_SAFE_INTEGER.toString(),Lt$2=kt$2?BigInt(Number.MIN_SAFE_INTEGER):void 0,Rt$2=Number.MAX_SAFE_INTEGER.toString(),Ft$2=kt$2?BigInt(Number.MAX_SAFE_INTEGER):void 0;function It$2(t,e){if(t.length>e.length)return !1;if(t.length<e.length||t===e)return !0;for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(r>i)return !1;if(r<i)return !0}}const Mt$2="function"==typeof Uint8Array.prototype.slice;let Pt$2,Ot$2=0,Ct$2=0;function Ut$2(t){const e=t>>>0;Ot$2=e,Ct$2=(t-e)/4294967296>>>0;}function Nt$2(t){if(t<0){Ut$2(-t);const[e,n]=Ht$2(Ot$2,Ct$2);Ot$2=e>>>0,Ct$2=n>>>0;}else Ut$2(t);}function Dt$2(t){const e=Pt$2||=new DataView(new ArrayBuffer(8));e.setFloat32(0,+t,!0),Ct$2=0,Ot$2=e.getUint32(0,!0);}function Bt$2(t,e){const n=4294967296*e+(t>>>0);return Number.isSafeInteger(n)?n:jt$2(t,e)}function Gt$2(t,e){const n=2147483648&e;return n&&(e=~e>>>0,0==(t=1+~t>>>0)&&(e=e+1>>>0)),"number"==typeof(t=Bt$2(t,e))?n?-t:t:n?"-"+t:t}function jt$2(t,e){if(t>>>=0,(e>>>=0)<=2097151)var n=""+(4294967296*e+t);else z$2()?n=""+(BigInt(e)<<BigInt(32)|BigInt(t)):(t=(16777215&t)+6777216*(n=16777215&(t>>>24|e<<8))+6710656*(e=e>>16&65535),n+=8147497*e,e*=2,t>=1e7&&(n+=t/1e7>>>0,t%=1e7),n>=1e7&&(e+=n/1e7>>>0,n%=1e7),n=e+Vt$2(n)+Vt$2(t));return n}function Vt$2(t){return t=String(t),"0000000".slice(t.length)+t}function Xt$2(t){if(t.length<16)Nt$2(Number(t));else if(z$2())t=BigInt(t),Ot$2=Number(t&BigInt(4294967295))>>>0,Ct$2=Number(t>>BigInt(32)&BigInt(4294967295));else {const e=+("-"===t[0]);Ct$2=Ot$2=0;const n=t.length;for(let r=e,i=(n-e)%6+e;i<=n;r=i,i+=6){const e=Number(t.slice(r,i));Ct$2*=1e6,Ot$2=1e6*Ot$2+e,Ot$2>=4294967296&&(Ct$2+=Math.trunc(Ot$2/4294967296),Ct$2>>>=0,Ot$2>>>=0);}if(e){const[t,e]=Ht$2(Ot$2,Ct$2);Ot$2=t,Ct$2=e;}}}function Ht$2(t,e){return e=~e,t?t=1+~t:e+=1,[t,e]}function Wt$2(t){return null==t||"number"==typeof t?t:"NaN"===t||"Infinity"===t||"-Infinity"===t?Number(t):void 0}function zt$2(t){return null==t||"boolean"==typeof t?t:"number"==typeof t?!!t:void 0}const Kt$2=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Yt$2(t){const e=typeof t;switch(e){case"bigint":return !0;case"number":return Number.isFinite(t)}return "string"===e&&Kt$2.test(t)}function $t$2(t){if(null==t)return t;if("string"==typeof t){if(!t)return;t=+t;}return "number"==typeof t&&Number.isFinite(t)?0|t:void 0}function qt$2(t){if(null==t)return t;if("string"==typeof t){if(!t)return;t=+t;}return "number"==typeof t&&Number.isFinite(t)?t>>>0:void 0}function Jt$2(t){return "-"!==t[0]&&(t.length<20||20===t.length&&Number(t.substring(0,6))<184467)}function Zt$2(t){return t=Math.trunc(t),Number.isSafeInteger(t)||(Nt$2(t),t=Gt$2(Ot$2,Ct$2)),t}function Qt$2(t){var e=Math.trunc(Number(t));if(Number.isSafeInteger(e))return String(e);if(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),!("-"===t[0]?t.length<20||20===t.length&&Number(t.substring(0,7))>-922337:t.length<19||19===t.length&&Number(t.substring(0,6))<922337))if(Xt$2(t),t=Ot$2,2147483648&(e=Ct$2))if(z$2())t=""+(BigInt(0|e)<<BigInt(32)|BigInt(t>>>0));else {const[n,r]=Ht$2(t,e);t="-"+jt$2(n,r);}else t=jt$2(t,e);return t}function te$2(t){return null==t?t:"bigint"==typeof t?(St$2(t)?t=Number(t):(t=BigInt.asIntN(64,t),t=St$2(t)?Number(t):String(t)),t):Yt$2(t)?"number"==typeof t?Zt$2(t):Qt$2(t):void 0}function ee$2(t){if(null==t)return t;var e=typeof t;if("bigint"===e)return String(BigInt.asUintN(64,t));if(Yt$2(t)){if("string"===e)return e=Math.trunc(Number(t)),Number.isSafeInteger(e)&&e>=0?t=String(e):(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),Jt$2(t)||(Xt$2(t),t=jt$2(Ot$2,Ct$2))),t;if("number"===e)return (t=Math.trunc(t))>=0&&Number.isSafeInteger(t)?t:function(t){if(t<0){Nt$2(t);var e=jt$2(Ot$2,Ct$2);return t=Number(e),Number.isSafeInteger(t)?t:e}return Jt$2(e=String(t))?e:(Nt$2(t),Bt$2(Ot$2,Ct$2))}(t)}}function ne$2(t){if("string"!=typeof t)throw Error();return t}function re$2(t){if(null!=t&&"string"!=typeof t)throw Error();return t}function ie$2(t){return null==t||"string"==typeof t?t:void 0}function se$2(t,e,n,r){if(null!=t&&"object"==typeof t&&t.X===ht$2)return t;if(!Array.isArray(t))return n?2&r?(t=e[J$2])?e=t:(st$2((t=new e).u),e=e[J$2]=t):e=new e:e=void 0,e;let i=n=nt$2(t);return 0===i&&(i|=32&r),i|=2&r,i!==n&&it$2(t,i),new e(t)}function oe$2(t,e,n){if(e)t:{if(!Yt$2(e=t))throw W$2("int64");switch(typeof e){case"string":e=Qt$2(e);break t;case"bigint":if(t=e=BigInt.asIntN(64,e),bt$2(t)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(t))throw Error(String(t))}else if(Tt$2(t)&&!Number.isSafeInteger(t))throw Error(String(t));e=kt$2?BigInt(e):At$2(e)?e?"1":"0":bt$2(e)?e.trim()||"0":String(e);break t;default:e=Zt$2(e);}}else e=te$2(t);return "string"==typeof(n=null==(t=e)?n?0:void 0:t)&&(e=+n,Number.isSafeInteger(e))?e:n}function ae$2(t){var e;return void 0===ue$2&&(ue$2="function"==typeof Proxy?me$2(Proxy):null),(e=!ue$2)||(void 0===le$2&&(le$2="function"==typeof WeakMap?me$2(WeakMap):null),e=!le$2),e?t:(e=ce$2?.get(t))?e:Math.random()>.01?t:(function(t){if(void 0===fe$2){const t=new ue$2([],{});fe$2=1===Array.prototype.concat.call([],t).length;}fe$2&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(t[Symbol.isConcatSpreadable]=!0);}(t),function(t,e){(ce$2||=new le$2).set(t,e),(he$2||=new le$2).set(e,t);}(t,e=new ue$2(t,{set:(t,e,n)=>(H$2(),t[e]=n,!0)})),e)}let ce$2,he$2,ue$2,le$2,fe$2,de$2,pe$2,ge$2;function me$2(t){try{return -1!==t.toString().indexOf("[native code]")?t:null}catch{return null}}function ye$2(t,e,n){return t=_e$2(t,e[0],e[1],n?1:2),e!==pe$2&&n&&tt$2(t,16384),t}function _e$2(t,e,n,r){if(r=r??0,null==t&&(t=de$2),de$2=void 0,null==t){var i=96;n?(t=[n],i|=512):t=[],e&&(i=-33521665&i|(1023&e)<<15);}else {if(!Array.isArray(t))throw Error("narr");if(2048&(i=nt$2(t)))throw Error("farr");if(64&i)return t;if(1===r||2===r||(i|=64),n&&(i|=512,n!==t[0]))throw Error("mid");t:{if(r=(n=t).length){const t=r-1;if(ft$2(n[t])){if((e=t-(+!!(512&(i|=256))-1))>=1024)throw Error("pvtlmt");i=-33521665&i|(1023&e)<<15;break t}}if(e){if((e=Math.max(e,r-(+!!(512&i)-1)))>1024)throw Error("spvt");i=-33521665&i|(1023&e)<<15;}}}return it$2(t,i),t}const ve$2={};let Ee$2=function(){try{return T$2(new class extends Map{constructor(){super();}}),!1}catch{return !0}}();class we$2{constructor(){this.g=new Map;}get(t){return this.g.get(t)}set(t,e){return this.g.set(t,e),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size;}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,e){return this.g.forEach(t,e)}[Symbol.iterator](){return this.entries()}}const Te$2=Ee$2?(Object.setPrototypeOf(we$2.prototype,Map.prototype),Object.defineProperties(we$2.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),we$2):class extends Map{constructor(){super();}};function be$2(t){return t}function Ae$2(t){if(2&t.M)throw Error("Cannot mutate an immutable Map")}var ke$2=class extends Te$2{constructor(t,e,n=be$2,r=be$2){super();let i=nt$2(t);i|=64,it$2(t,i),this.M=i,this.T=e,this.S=n,this.Z=this.T?Se$2:r;for(let s=0;s<t.length;s++){const o=t[s],a=n(o[0],!1,!0);let c=o[1];e?void 0===c&&(c=null):c=r(o[1],!1,!0,void 0,void 0,i),super.set(a,c);}}oa(t=xe$2){if(0!==this.size)return this.Y(t)}Y(t=xe$2){const e=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=t(r[0]),r[1]=t(r[1]),e.push(r);return e}clear(){Ae$2(this),super.clear();}delete(t){return Ae$2(this),super.delete(this.S(t,!0,!1))}entries(){var t=this.na();return new yt$2(t,Le$2,this)}keys(){return this.Ha()}values(){var t=this.na();return new yt$2(t,ke$2.prototype.get,this)}forEach(t,e){super.forEach(((n,r)=>{t.call(e,this.get(r),r,this);}));}set(t,e){return Ae$2(this),null==(t=this.S(t,!0,!1))?this:null==e?(super.delete(t),this):super.set(t,this.Z(e,!0,!0,this.T,!1,this.M))}Na(t){const e=this.S(t[0],!1,!0);t=t[1],t=this.T?void 0===t?null:t:this.Z(t,!1,!0,void 0,!1,this.M),super.set(e,t);}has(t){return super.has(this.S(t,!1,!1))}get(t){t=this.S(t,!1,!1);const e=super.get(t);if(void 0!==e){var n=this.T;return n?((n=this.Z(e,!1,!0,n,this.sa,this.M))!==e&&super.set(t,n),n):e}}na(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Se$2(t,e,n,r,i,s){return t=se$2(t,r,n,s),i&&(t=De$2(t)),t}function xe$2(t){return t}function Le$2(t){return [t,this.get(t)]}let Re$2;function Fe$2(){return Re$2||=new ke$2(st$2([]),void 0,void 0,void 0,ve$2)}function Ie$2(t,e,n,r,i){if(null!=t){if(Array.isArray(t))t=pt$2(t)?void 0:i&&2&nt$2(t)?t:Me$2(t,e,n,void 0!==r,i);else if(ft$2(t)){const s={};for(let o in t)s[o]=Ie$2(t[o],e,n,r,i);t=s;}else t=e(t,r);return t}}function Me$2(t,e,n,r,i){const s=r||n?nt$2(t):0;r=r?!!(32&s):void 0;const o=K$2(t);for(let t=0;t<o.length;t++)o[t]=Ie$2(o[t],e,n,r,i);return n&&(vt$2(o,t),n(s,o)),o}function Pe$2(t){return Ie$2(t,Oe$2,void 0,void 0,!1)}function Oe$2(t){return t.X===ht$2?t.toJSON():t instanceof ke$2?t.oa(Pe$2):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return St$2(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(pt$2(t))return}else {if(C$2(t))return F$2(t);if(t instanceof B$2){const e=t.g;return null==e?"":"string"==typeof e?e:t.g=F$2(e)}if(t instanceof ke$2)return t.oa()}}return t}(t)}function Ce$2(t,e,n=at$2){if(null!=t){if(L$2&&t instanceof Uint8Array)return e?t:new Uint8Array(t);if(Array.isArray(t)){var r=nt$2(t);return 2&r?t:(e&&=0===r||!!(32&r)&&!(64&r||!(16&r)),e?(it$2(t,-12293&(34|r)),t):Me$2(t,Ce$2,4&r?at$2:n,!0,!0))}return t.X===ht$2?(n=t.u,t=2&(r=rt$2(n))?t:Ue$2(t,n,r,!0)):t instanceof ke$2&&!(2&t.M)&&(n=st$2(t.Y(Ce$2)),t=new ke$2(n,t.T,t.S,t.Z)),t}}function Ue$2(t,e,n,r){return t=t.constructor,de$2=e=Ne$2(e,n,r),e=new t(e),de$2=void 0,e}function Ne$2(t,e,n){const r=n||2&e?at$2:ot$2,i=!!(32&e);return t=function(t,e,n){const r=K$2(t);var i=r.length;const s=256&e?r[i-1]:void 0;for(i+=s?-1:0,e=512&e?1:0;e<i;e++)r[e]=n(r[e]);if(s){e=r[e]={};for(const t in s)e[t]=n(s[t]);}return vt$2(r,t),r}(t,e,(t=>Ce$2(t,i,r))),tt$2(t,32|(n?2:0)),t}function De$2(t){const e=t.u,n=rt$2(e);return 2&n?Ue$2(t,e,n,!1):t}function Be$2(t,e){return je$2(t=t.u,rt$2(t),e)}function Ge$2(t,e,n,r){if(!((e=r+(+!!(512&e)-1))<0||e>=t.length||e>=n))return t[e]}function je$2(t,e,n,r){if(-1===n)return null;const i=e>>15&1023||536870912;if(!(n>=i)){var s=t.length;return r&&256&e&&null!=(r=t[s-1][n])?(Ge$2(t,e,i,n)&&null!=Z$2&&((e=(t=j$2??={})[Z$2]||0)>=4||(t[Z$2]=e+1,H$2())),r):Ge$2(t,e,i,n)}return 256&e?t[t.length-1][n]:void 0}function Ve$2(t,e,n){const r=t.u;let i=rt$2(r);return mt$2(i),Xe$2(r,i,e,n),t}function Xe$2(t,e,n,r){const i=e>>15&1023||536870912;if(n>=i){let s,o=e;if(256&e)s=t[t.length-1];else {if(null==r)return o;s=t[i+(+!!(512&e)-1)]={},o|=256;}return s[n]=r,n<i&&(t[n+(+!!(512&e)-1)]=void 0),o!==e&&it$2(t,o),o}return t[n+(+!!(512&e)-1)]=r,256&e&&(n in(t=t[t.length-1])&&delete t[n]),e}function He$2(t,e){t=t.u;let n=rt$2(t);const r=je$2(t,n,e),i=Wt$2(r);return null!=i&&i!==r&&Xe$2(t,n,e,i),i}function We$2(t){t=t.u;let e=rt$2(t);const n=je$2(t,e,1),r=dt$2(n,!0);return null!=r&&r!==n&&Xe$2(t,e,1,r),r}function ze$2(){return void 0===Et$2?2:4}function Ke$2(t,e,n,r,i){const s=t.u,o=2&(t=rt$2(s))?1:r;i=!!i,r=Ye$2(s,t,e);var a=nt$2(r);if(!(4&a)){4&a&&(r=K$2(r),a=fn$2(a,t),t=Xe$2(s,t,e,r));let i=0,o=0;for(;i<r.length;i++){const t=n(r[i]);null!=t&&(r[o++]=t);}o<i&&(r.length=o),a=-4097&(20|(a=$e$2(a,t))),it$2(r,a&=-8193),2&a&&Object.freeze(r);}let c;return 1===o||4===o&&32&a?qe$2(a)||(i=a,(a|=2)!==i&&it$2(r,a),Object.freeze(r)):(n=5===o&&(!!(32&a)||qe$2(a)||!!ce$2?.get(r)),(2===o||n)&&qe$2(a)&&(r=K$2(r),a=dn$2(a=fn$2(a,t),t,i),it$2(r,a),t=Xe$2(s,t,e,r)),qe$2(a)||(e=a,(a=dn$2(a,t,i))!==e&&it$2(r,a)),n?c=ae$2(r):2!==o||i||ce$2?.delete(r)),c||r}function Ye$2(t,e,n,r){return t=je$2(t,e,n,r),Array.isArray(t)?t:ct$2}function $e$2(t,e){return 0===t&&(t=fn$2(t,e)),1|t}function qe$2(t){return !!(2&t)&&!!(4&t)||!!(2048&t)}function Je$2(t){t=K$2(t);for(let e=0;e<t.length;e++){const n=t[e]=K$2(t[e]);Array.isArray(n[1])&&(n[1]=st$2(n[1]));}return t}function Ze$2(t,e,n,r){t=t.u;let i=rt$2(t);mt$2(i),Xe$2(t,i,e,("0"===r?0===Number(n):n===r)?void 0:n);}function Qe$2(t,e,n,r,i){mt$2(e);var s=!(!(64&e)&&16384&e);const o=(i=Ye$2(t,e,n,i))!==ct$2;if(s||!o){let a=s=o?nt$2(i):0;(!o||2&a||qe$2(a)||4&a&&!(32&a))&&(i=K$2(i),a=fn$2(a,e),e=Xe$2(t,e,n,i)),a=-13&$e$2(a,e),a=dn$2(r?-17&a:16|a,e,!0),a!==s&&it$2(i,a);}return i}function tn$2(t,e){var n=As;return rn$2(en$2(t=t.u),t,rt$2(t),n)===e?e:-1}function en$2(t){if(Y$2)return t[Q$2]??(t[Q$2]=new Map);if(Q$2 in t)return t[Q$2];const e=new Map;return Object.defineProperty(t,Q$2,{value:e}),e}function nn$2(t,e,n,r){const i=en$2(t),s=rn$2(i,t,e,n);return s!==r&&(s&&(e=Xe$2(t,e,s)),i.set(n,r)),e}function rn$2(t,e,n,r){let i=t.get(r);if(null!=i)return i;i=0;for(let t=0;t<r.length;t++){const s=r[t];null!=je$2(e,n,s)&&(0!==i&&(n=Xe$2(e,n,i)),i=s);}return t.set(r,i),i}function sn$2(t,e,n,r){let i,s=rt$2(t);if(null!=(r=je$2(t,s,n,r))&&r.X===ht$2)return (e=De$2(r))!==r&&Xe$2(t,s,n,e),e.u;if(Array.isArray(r)){const t=nt$2(r);i=2&t?ye$2(Ne$2(r,t,!1),e,!0):64&t?r:ye$2(i,e,!0);}else i=ye$2(void 0,e,!0);return i!==r&&Xe$2(t,s,n,i),i}function on$2(t,e,n,r){t=t.u;let i=rt$2(t);return (e=se$2(r=je$2(t,i,n,r),e,!1,i))!==r&&null!=e&&Xe$2(t,i,n,e),e}function an$2(t,e,n,r=!1){if(null==(e=on$2(t,e,n,r)))return e;if(t=t.u,!(2&(r=rt$2(t)))){const i=De$2(e);i!==e&&Xe$2(t,r,n,e=i);}return e}function cn$2(t,e,n,r,i,s,o){t=t.u;var a=!!(2&e);i=a?1:i,s=!!s,o&&=!a,a=Ye$2(t,e,r);var c=nt$2(a),h=!!(4&c);if(!h){var u=a,l=e;const t=!!(2&(c=$e$2(c,e)));t&&(l|=2);let r=!t,i=!0,s=0,o=0;for(;s<u.length;s++){const e=se$2(u[s],n,!1,l);if(e instanceof n){if(!t){const t=!!(2&nt$2(e.u));r&&=!t,i&&=t;}u[o++]=e;}}o<s&&(u.length=o),c|=4,c=i?16|c:-17&c,it$2(u,c=r?8|c:-9&c),t&&Object.freeze(u);}if(o&&!(8&c||!a.length&&(1===i||4===i&&32&c))){for(qe$2(c)&&(a=K$2(a),c=fn$2(c,e),e=Xe$2(t,e,r,a)),n=a,o=c,u=0;u<n.length;u++)(c=n[u])!==(l=De$2(c))&&(n[u]=l);o|=8,o=n.length?-17&o:16|o,it$2(n,o),c=o;}let f;return 1===i||4===i&&32&c?qe$2(c)||(e=c,(c|=!a.length||16&c&&(!h||32&c)?2:2048)!==e&&it$2(a,c),Object.freeze(a)):(h=5===i&&(!!(32&c)||qe$2(c)||!!ce$2?.get(a)),(2===i||h)&&qe$2(c)&&(a=K$2(a),c=dn$2(c=fn$2(c,e),e,s),it$2(a,c),e=Xe$2(t,e,r,a)),qe$2(c)||(r=c,(c=dn$2(c,e,s))!==r&&it$2(a,c)),h?f=ae$2(a):2!==i||s||ce$2?.delete(a)),f||a}function hn$2(t,e,n){const r=rt$2(t.u);return cn$2(t,r,e,n,ze$2(),!1,!(2&r))}function un$2(t,e,n,r){return null==r&&(r=void 0),Ve$2(t,n,r)}function ln$2(t,e,n,r){null==r&&(r=void 0);t:{t=t.u;let i=rt$2(t);if(mt$2(i),null==r){const r=en$2(t);if(rn$2(r,t,i,n)!==e)break t;r.set(n,0);}else i=nn$2(t,i,n,e);Xe$2(t,i,e,r);}}function fn$2(t,e){return -2049&(t=32|(2&e?2|t:-3&t))}function dn$2(t,e,n){return 32&e&&n||(t&=-33),t}function pn$2(t,e,n,r){const i=rt$2(t.u);mt$2(i),t=cn$2(t,i,n,e,2,!0),r=null!=r?r:new n,t.push(r),2&nt$2(r.u)?et$2(t,8):et$2(t,16);}function gn$2(t,e){return t??e}function mn$2(t,e){return $t$2(Be$2(t,e))}function yn$2(t,e){return gn$2(He$2(t,e),0)}function _n$2(t,e){return gn$2(ie$2(Be$2(t,e)),"")}function vn$2(t,e,n){if(null!=n&&"boolean"!=typeof n)throw t=typeof n,Error(`Expected boolean but got ${"object"!=t?t:n?Array.isArray(n)?"array":t:"null"}: ${n}`);Ve$2(t,e,n);}function En$2(t,e,n){if(null!=n){if("number"!=typeof n)throw W$2("int32");if(!Number.isFinite(n))throw W$2("int32");n|=0;}Ve$2(t,e,n);}function wn$2(t,e,n){if(null!=n&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);Ve$2(t,e,n);}function Tn$2(t,e,n){{const o=t.u;let a=rt$2(o);if(mt$2(a),null==n)Xe$2(o,a,e);else {n=he$2?.get(n)||n;var r=t=nt$2(n),i=qe$2(t),s=i||Object.isFrozen(n);for(i||(t=0),s||(n=K$2(n),r=0,t=dn$2(t=fn$2(t,a),a,!0),s=!1),t|=21,i=0;i<n.length;i++){const e=n[i],o=ne$2(e);Object.is(e,o)||(s&&(n=K$2(n),r=0,t=dn$2(t=fn$2(t,a),a,!0),s=!1),n[i]=o);}t!==r&&(s&&(n=K$2(n),t=dn$2(t=fn$2(t,a),a,!0)),it$2(n,t)),Xe$2(o,a,e,n);}}}function bn$2(t,e,n){mt$2(rt$2(t.u)),Ke$2(t,e,ie$2,2,!0).push(ne$2(n));}function An$2(t,e){return Error(`Invalid wire type: ${t} (at position ${e})`)}function kn$2(){return Error("Failed to read varint, encoding is invalid.")}function Sn$2(t,e){return Error(`Tried to read past the end of the data ${e} > ${t}`)}function xn$2(t){if("string"==typeof t)return {buffer:O$2(t),O:!1};if(Array.isArray(t))return {buffer:new Uint8Array(t),O:!1};if(t.constructor===Uint8Array)return {buffer:t,O:!1};if(t.constructor===ArrayBuffer)return {buffer:new Uint8Array(t),O:!1};if(t.constructor===B$2)return {buffer:D$2(t)||new Uint8Array(0),O:!0};if(t instanceof Uint8Array)return {buffer:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),O:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Ln$2(t,e){let n,r=0,i=0,s=0;const o=t.h;let a=t.g;do{n=o[a++],r|=(127&n)<<s,s+=7;}while(s<32&&128&n);for(s>32&&(i|=(127&n)>>4),s=3;s<32&&128&n;s+=7)n=o[a++],i|=(127&n)<<s;if(Un$2(t,a),n<128)return e(r>>>0,i>>>0);throw kn$2()}function Rn$2(t){let e=0,n=t.g;const r=n+10,i=t.h;for(;n<r;){const r=i[n++];if(e|=r,0==(128&r))return Un$2(t,n),!!(127&e)}throw kn$2()}function Fn$2(t){const e=t.h;let n=t.g,r=e[n++],i=127&r;if(128&r&&(r=e[n++],i|=(127&r)<<7,128&r&&(r=e[n++],i|=(127&r)<<14,128&r&&(r=e[n++],i|=(127&r)<<21,128&r&&(r=e[n++],i|=r<<28,128&r&&128&e[n++]&&128&e[n++]&&128&e[n++]&&128&e[n++]&&128&e[n++])))))throw kn$2();return Un$2(t,n),i}function In$2(t){return Fn$2(t)>>>0}function Mn$2(t){var e=t.h;const n=t.g,r=e[n],i=e[n+1],s=e[n+2];return e=e[n+3],Un$2(t,t.g+4),(r<<0|i<<8|s<<16|e<<24)>>>0}function Pn$2(t){var e=Mn$2(t);t=2*(e>>31)+1;const n=e>>>23&255;return e&=8388607,255==n?e?NaN:t*(1/0):0==n?1401298464324817e-60*t*e:t*Math.pow(2,n-150)*(e+8388608)}function On$2(t){return Fn$2(t)}function Cn$2(t,e,{ca:n=!1}={}){t.ca=n,e&&(e=xn$2(e),t.h=e.buffer,t.m=e.O,t.j=0,t.l=t.h.length,t.g=t.j);}function Un$2(t,e){if(t.g=e,e>t.l)throw Sn$2(t.l,e)}function Nn$2(t,e){if(e<0)throw Error(`Tried to read a negative byte length: ${e}`);const n=t.g,r=n+e;if(r>t.l)throw Sn$2(e,t.l-n);return t.g=r,n}function Dn$2(t,e){if(0==e)return N$2();var n=Nn$2(t,e);return t.ca&&t.m?n=t.h.subarray(n,n+e):(t=t.h,n=n===(e=n+e)?new Uint8Array(0):Mt$2?t.slice(n,e):new Uint8Array(t.subarray(n,e))),0==n.length?N$2():new B$2(n,U$2)}ke$2.prototype.toJSON=void 0,ke$2.prototype.Ia=ut$2;var Bn$2=[];function Gn$2(t){var e=t.g;if(e.g==e.l)return !1;t.l=t.g.g;var n=In$2(t.g);if(e=n>>>3,!((n&=7)>=0&&n<=5))throw An$2(n,t.l);if(e<1)throw Error(`Invalid field number: ${e} (at position ${t.l})`);return t.m=e,t.h=n,!0}function jn$2(t){switch(t.h){case 0:0!=t.h?jn$2(t):Rn$2(t.g);break;case 1:Un$2(t=t.g,t.g+8);break;case 2:if(2!=t.h)jn$2(t);else {var e=In$2(t.g);Un$2(t=t.g,t.g+e);}break;case 5:Un$2(t=t.g,t.g+4);break;case 3:for(e=t.m;;){if(!Gn$2(t))throw Error("Unmatched start-group tag: stream EOF");if(4==t.h){if(t.m!=e)throw Error("Unmatched end-group tag");break}jn$2(t);}break;default:throw An$2(t.h,t.l)}}function Vn$2(t,e,n){const r=t.g.l,i=In$2(t.g),s=t.g.g+i;let o=s-r;if(o<=0&&(t.g.l=s,n(e,t,void 0,void 0,void 0),o=s-t.g.g),o)throw Error(`Message parsing ended unexpectedly. Expected to read ${i} bytes, instead read ${i-o} bytes, either the data ended unexpectedly or the message misreported its own length`);return t.g.g=s,t.g.l=r,e}function Xn$2(t){var e=In$2(t.g),a=Nn$2(t=t.g,e);if(t=t.h,o$2){var c,h=t;(c=s$3)||(c=s$3=new TextDecoder("utf-8",{fatal:!0})),e=a+e,h=0===a&&e===h.length?h:h.subarray(a,e);try{var u=c.decode(h);}catch(t){if(void 0===i$2){try{c.decode(new Uint8Array([128]));}catch(t){}try{c.decode(new Uint8Array([97])),i$2=!0;}catch(t){i$2=!1;}}throw !i$2&&(s$3=void 0),t}}else {e=(u=a)+e,a=[];let i,s=null;for(;u<e;){var l=t[u++];l<128?a.push(l):l<224?u>=e?n$2():(i=t[u++],l<194||128!=(192&i)?(u--,n$2()):a.push((31&l)<<6|63&i)):l<240?u>=e-1?n$2():(i=t[u++],128!=(192&i)||224===l&&i<160||237===l&&i>=160||128!=(192&(c=t[u++]))?(u--,n$2()):a.push((15&l)<<12|(63&i)<<6|63&c)):l<=244?u>=e-2?n$2():(i=t[u++],128!=(192&i)||i-144+(l<<28)>>30!=0||128!=(192&(c=t[u++]))||128!=(192&(h=t[u++]))?(u--,n$2()):(l=(7&l)<<18|(63&i)<<12|(63&c)<<6|63&h,l-=65536,a.push(55296+(l>>10&1023),56320+(1023&l)))):n$2(),a.length>=8192&&(s=r$2(s,a),a.length=0);}u=r$2(s,a);}return u}function Hn$2(t){const e=In$2(t.g);return Dn$2(t.g,e)}function Wn$2(t,e,n){var r=In$2(t.g);for(r=t.g.g+r;t.g.g<r;)n.push(e(t.g));}var zn$2=[];let Kn$2;function Yn$2(t,e,n){e.g?e.m(t,e.g,e.h,n,!0):e.m(t,e.h,n,!0);}var $n$2=class{constructor(t,e){this.u=_e$2(t,e);}toJSON(){return qn$2(this)}l(){var t=Eo;return t.g?t.l(this,t.g,t.h,!0):t.l(this,t.h,t.defaultValue,!0)}clone(){const t=this.u;return Ue$2(this,t,rt$2(t),!1)}O(){return !!(2&nt$2(this.u))}};function qn$2(t){t=t.u,t=Kn$2?t:Me$2(t,Oe$2,void 0,void 0,!1);{var e=!Kn$2;let h=t.length;if(h){var n=t[h-1],r=ft$2(n);r?h--:n=void 0;var i=t;if(r){t:{var s,o=n,a=!1;if(o)for(let t in o)isNaN(+t)?(s??={})[t]=o[t]:(r=o[t],Array.isArray(r)&&(pt$2(r)||lt$2(r)&&0===r.size)&&(r=null),null==r&&(a=!0),null!=r&&((s??={})[t]=r));if(a||(s=o),s)for(let t in s){a=s;break t}a=null;}o=null==a?null!=n:a!==n;}for(;h>0&&(null==(s=i[h-1])||pt$2(s)||lt$2(s)&&0===s.size);h--)var c=!0;(i!==t||o||c)&&(e?(c||o||a)&&(i.length=h):i=Array.prototype.slice.call(i,0,h),a&&i.push(a)),c=i;}else c=t;}return c}function Jn$2(t){return t?/^\d+$/.test(t)?(Xt$2(t),new Zn$2(Ot$2,Ct$2)):null:Qn$2||=new Zn$2(0,0)}$n$2.prototype.X=ht$2,$n$2.prototype.toString=function(){try{return Kn$2=!0,qn$2(this).toString()}finally{Kn$2=!1;}};var Zn$2=class{constructor(t,e){this.h=t>>>0,this.g=e>>>0;}};let Qn$2;function tr$2(t){return t?/^-?\d+$/.test(t)?(Xt$2(t),new er$2(Ot$2,Ct$2)):null:nr$2||=new er$2(0,0)}var er$2=class{constructor(t,e){this.h=t>>>0,this.g=e>>>0;}};let nr$2;function rr$2(t,e,n){for(;n>0||e>127;)t.g.push(127&e|128),e=(e>>>7|n<<25)>>>0,n>>>=7;t.g.push(e);}function ir$2(t,e){for(;e>127;)t.g.push(127&e|128),e>>>=7;t.g.push(e);}function sr$2(t,e){if(e>=0)ir$2(t,e);else {for(let n=0;n<9;n++)t.g.push(127&e|128),e>>=7;t.g.push(1);}}function or$2(t,e){t.g.push(e>>>0&255),t.g.push(e>>>8&255),t.g.push(e>>>16&255),t.g.push(e>>>24&255);}function ar$2(t,e){0!==e.length&&(t.l.push(e),t.h+=e.length);}function cr$2(t,e,n){ir$2(t.g,8*e+n);}function hr$2(t,e){return cr$2(t,e,2),e=t.g.end(),ar$2(t,e),e.push(t.h),e}function ur$2(t,e){var n=e.pop();for(n=t.h+t.g.length()-n;n>127;)e.push(127&n|128),n>>>=7,t.h++;e.push(n),t.h++;}function lr$2(t,e,n){cr$2(t,e,2),ir$2(t.g,n.length),ar$2(t,t.g.end()),ar$2(t,n);}function fr$2(t,e,n,r){null!=n&&(e=hr$2(t,e),r(n,t),ur$2(t,e));}function dr$2(){const t=class{constructor(){throw Error()}};return Object.setPrototypeOf(t,t.prototype),t}var pr$2=dr$2(),gr$2=dr$2(),mr$2=dr$2(),yr$2=dr$2(),_r$2=dr$2(),vr$2=dr$2(),Er$2=dr$2(),wr$2=dr$2(),Tr$2=dr$2(),br$2=class{constructor(t,e,n){this.g=t,this.h=e,t=pr$2,this.l=!!t&&n===t||!1;}};function Ar$2(t,e){return new br$2(t,e,pr$2)}function kr$2(t,e,n,r,i){fr$2(t,n,Ur$2(e,r),i);}const Sr$2=Ar$2((function(t,e,n,r,i){return 2===t.h&&(Vn$2(t,sn$2(e,r,n),i),!0)}),kr$2),xr$2=Ar$2((function(t,e,n,r,i){return 2===t.h&&(Vn$2(t,sn$2(e,r,n,!0),i),!0)}),kr$2);var Lr$2=Symbol(),Rr$2=Symbol(),Fr$2=Symbol(),Ir$2=Symbol();let Mr$2,Pr$2;function Or$2(t,e,n,r){var i=r[t];if(i)return i;(i={}).W=function(t){switch(typeof t){case"boolean":return pe$2||=[0,void 0,!0];case"number":return t>0?void 0:0===t?ge$2||=[0,void 0]:[-t,void 0];case"string":return [0,t];case"object":return t}}(r[0]);var s=r[1];let o=1;s&&s.constructor===Object&&(i.ha=s,"function"==typeof(s=r[++o])&&(i.ma=!0,Mr$2??=s,Pr$2??=r[o+1],s=r[o+=2]));const a={};for(;s&&Array.isArray(s)&&s.length&&"number"==typeof s[0]&&s[0]>0;){for(var c=0;c<s.length;c++)a[s[c]]=s;s=r[++o];}for(c=1;void 0!==s;){let t;"number"==typeof s&&(c+=s,s=r[++o]);var h=void 0;if(s instanceof br$2?t=s:(t=Sr$2,o--),t?.l){s=r[++o],h=r;var u=o;"function"==typeof s&&(s=s(),h[u]=s),h=s;}for(u=c+1,"number"==typeof(s=r[++o])&&s<0&&(u-=s,s=r[++o]);c<u;c++){const r=a[c];h?n(i,c,t,h,r):e(i,c,t,r);}}return r[t]=i}function Cr$2(t){return Array.isArray(t)?t[0]instanceof br$2?t:[xr$2,t]:[t,void 0]}function Ur$2(t,e){return t instanceof $n$2?t.u:Array.isArray(t)?ye$2(t,e,!1):void 0}function Nr$2(t,e,n,r){const i=n.g;t[e]=r?(t,e,n)=>i(t,e,n,r):i;}function Dr$2(t,e,n,r,i){const s=n.g;let o,a;t[e]=(t,e,n)=>s(t,e,n,a||=Or$2(Rr$2,Nr$2,Dr$2,r).W,o||=Br$2(r),i);}function Br$2(t){let e=t[Fr$2];if(null!=e)return e;const n=Or$2(Rr$2,Nr$2,Dr$2,t);return e=n.ma?(t,e)=>Mr$2(t,e,n):(t,e)=>{const r=rt$2(t);for(;Gn$2(e)&&4!=e.h;){var i=e.m,s=n[i];if(null==s){var o=n.ha;o&&(o=o[i])&&(null!=(o=Gr$2(o))&&(s=n[i]=o));}null!=s&&s(e,t,i)||(i=(s=e).l,jn$2(s),s.ga?s=void 0:(o=s.g.g-i,s.g.g=i,s=Dn$2(s.g,o)),i=t,s&&(_t$2||=Symbol(),(o=i[_t$2])?o.push(s):i[_t$2]=[s]));}return 16384&r&&st$2(t),!0},t[Fr$2]=e}function Gr$2(t){const e=(t=Cr$2(t))[0].g;if(t=t[1]){const n=Br$2(t),r=Or$2(Rr$2,Nr$2,Dr$2,t).W;return (t,i,s)=>e(t,i,s,r,n)}return e}function jr$2(t,e,n){t[e]=n.h;}function Vr$2(t,e,n,r){let i,s;const o=n.h;t[e]=(t,e,n)=>o(t,e,n,s||=Or$2(Lr$2,jr$2,Vr$2,r).W,i||=Xr$2(r));}function Xr$2(t){let e=t[Ir$2];if(!e){const n=Or$2(Lr$2,jr$2,Vr$2,t);e=(t,e)=>Hr$2(t,e,n),t[Ir$2]=e;}return e}function Hr$2(t,e,n){for(var r=nt$2(t),i=+!!(512&r)-1,s=t.length,o=512&r?1:0,a=s+(256&r?-1:0);o<a;o++){const r=t[o];if(null==r)continue;const s=o-i,a=Wr$2(n,s);a&&a(e,r,s);}if(256&r){r=t[s-1];for(const t in r)i=+t,Number.isNaN(i)||null!=(s=r[i])&&(a=Wr$2(n,i))&&a(e,s,i);}if(t=_t$2?t[_t$2]:void 0)for(ar$2(e,e.g.end()),n=0;n<t.length;n++)ar$2(e,D$2(t[n])||new Uint8Array(0));}function Wr$2(t,e){var n=t[e];if(n)return n;if((n=t.ha)&&(n=n[e])){var r=(n=Cr$2(n))[0].h;if(n=n[1]){const e=Xr$2(n),i=Or$2(Lr$2,jr$2,Vr$2,n).W;n=t.ma?Pr$2(i,e):(t,n,s)=>r(t,n,s,i,e);}else n=r;return t[e]=n}}function zr$2(t,e){if(Array.isArray(e)){var n=nt$2(e);if(4&n)return e;for(var r=0,i=0;r<e.length;r++){const n=t(e[r]);null!=n&&(e[i++]=n);}return i<r&&(e.length=i),it$2(e,-12289&(5|n)),2&n&&Object.freeze(e),e}}function Kr$2(t,e,n){return new br$2(t,e,n)}function Yr$2(t,e,n){return new br$2(t,e,n)}function $r$2(t,e,n){Xe$2(t,rt$2(t),e,n);}var qr$2=Ar$2((function(t,e,n,r,i){return 2===t.h&&(t=Vn$2(t,ye$2([void 0,void 0],r,!0),i),mt$2(r=rt$2(e)),(i=je$2(e,r,n))instanceof ke$2?0!=(2&i.M)?((i=i.Y()).push(t),Xe$2(e,r,n,i)):i.Na(t):Array.isArray(i)?(2&nt$2(i)&&Xe$2(e,r,n,i=Je$2(i)),i.push(t)):Xe$2(e,r,n,[t]),!0)}),(function(t,e,n,r,i){if(e instanceof ke$2)e.forEach(((e,s)=>{fr$2(t,n,ye$2([s,e],r,!1),i);}));else if(Array.isArray(e))for(let s=0;s<e.length;s++){const o=e[s];Array.isArray(o)&&fr$2(t,n,ye$2(o,r,!1),i);}}));function Jr$2(t,e,n){if(e=function(t){if(null==t)return t;const e=typeof t;if("bigint"===e)return String(BigInt.asIntN(64,t));if(Yt$2(t)){if("string"===e)return Qt$2(t);if("number"===e)return Zt$2(t)}}(e),null!=e){if("string"==typeof e)tr$2(e);if(null!=e)switch(cr$2(t,n,0),typeof e){case"number":t=t.g,Nt$2(e),rr$2(t,Ot$2,Ct$2);break;case"bigint":n=BigInt.asUintN(64,e),n=new er$2(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),rr$2(t.g,n.h,n.g);break;default:n=tr$2(e),rr$2(t.g,n.h,n.g);}}}function Zr$2(t,e,n){null!=(e=$t$2(e))&&null!=e&&(cr$2(t,n,0),sr$2(t.g,e));}function Qr$2(t,e,n){null!=(e=zt$2(e))&&(cr$2(t,n,0),t.g.g.push(e?1:0));}function ti$2(t,e,n){null!=(e=ie$2(e))&&lr$2(t,n,h$2(e));}function ei$2(t,e,n,r,i){fr$2(t,n,Ur$2(e,r),i);}function ni$2(t,e,n){null!=(e=null==e||"string"==typeof e||C$2(e)||e instanceof B$2?e:void 0)&&lr$2(t,n,xn$2(e).buffer);}function ri$1(t,e,n){return (5===t.h||2===t.h)&&(e=Qe$2(e,rt$2(e),n,!1,!1),2==t.h?Wn$2(t,Pn$2,e):e.push(Pn$2(t.g)),!0)}var ii$1=Kr$2((function(t,e,n){if(1!==t.h)return !1;var r=t.g;t=Mn$2(r);const i=Mn$2(r);r=2*(i>>31)+1;const s=i>>>20&2047;return t=4294967296*(1048575&i)+t,$r$2(e,n,2047==s?t?NaN:r*(1/0):0==s?5e-324*r*t:r*Math.pow(2,s-1075)*(t+4503599627370496)),!0}),(function(t,e,n){null!=(e=Wt$2(e))&&(cr$2(t,n,1),t=t.g,(n=Pt$2||=new DataView(new ArrayBuffer(8))).setFloat64(0,+e,!0),Ot$2=n.getUint32(0,!0),Ct$2=n.getUint32(4,!0),or$2(t,Ot$2),or$2(t,Ct$2));}),dr$2()),si$1=Kr$2((function(t,e,n){return 5===t.h&&($r$2(e,n,Pn$2(t.g)),!0)}),(function(t,e,n){null!=(e=Wt$2(e))&&(cr$2(t,n,5),t=t.g,Dt$2(e),or$2(t,Ot$2));}),Er$2),oi$1=Yr$2(ri$1,(function(t,e,n){if(null!=(e=zr$2(Wt$2,e)))for(let o=0;o<e.length;o++){var r=t,i=n,s=e[o];null!=s&&(cr$2(r,i,5),r=r.g,Dt$2(s),or$2(r,Ot$2));}}),Er$2),ai$1=Yr$2(ri$1,(function(t,e,n){if(null!=(e=zr$2(Wt$2,e))&&e.length){cr$2(t,n,2),ir$2(t.g,4*e.length);for(let r=0;r<e.length;r++)n=t.g,Dt$2(e[r]),or$2(n,Ot$2);}}),Er$2),ci$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,Ln$2(t.g,Gt$2)),!0)}),Jr$2,vr$2),hi$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,0===(t=Ln$2(t.g,Gt$2))?void 0:t),!0)}),Jr$2,vr$2),ui$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,Ln$2(t.g,Bt$2)),!0)}),(function(t,e,n){if(null!=(e=ee$2(e))){if("string"==typeof e)Jn$2(e);if(null!=e)switch(cr$2(t,n,0),typeof e){case"number":t=t.g,Nt$2(e),rr$2(t,Ot$2,Ct$2);break;case"bigint":n=BigInt.asUintN(64,e),n=new Zn$2(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),rr$2(t.g,n.h,n.g);break;default:n=Jn$2(e),rr$2(t.g,n.h,n.g);}}}),dr$2()),li$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,Fn$2(t.g)),!0)}),Zr$2,yr$2),fi$1=Yr$2((function(t,e,n){return (0===t.h||2===t.h)&&(e=Qe$2(e,rt$2(e),n,!1,!1),2==t.h?Wn$2(t,Fn$2,e):e.push(Fn$2(t.g)),!0)}),(function(t,e,n){if(null!=(e=zr$2($t$2,e))&&e.length){n=hr$2(t,n);for(let n=0;n<e.length;n++)sr$2(t.g,e[n]);ur$2(t,n);}}),yr$2),di$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,0===(t=Fn$2(t.g))?void 0:t),!0)}),Zr$2,yr$2),pi$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,Rn$2(t.g)),!0)}),Qr$2,gr$2),gi$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,!1===(t=Rn$2(t.g))?void 0:t),!0)}),Qr$2,gr$2),mi$1=Yr$2((function(t,e,n){return 2===t.h&&(t=Xn$2(t),Qe$2(e,rt$2(e),n,!1).push(t),!0)}),(function(t,e,n){if(null!=(e=zr$2(ie$2,e)))for(let o=0;o<e.length;o++){var r=t,i=n,s=e[o];null!=s&&lr$2(r,i,h$2(s));}}),mr$2),yi$1=Kr$2((function(t,e,n){return 2===t.h&&($r$2(e,n,""===(t=Xn$2(t))?void 0:t),!0)}),ti$2,mr$2),_i$1=Kr$2((function(t,e,n){return 2===t.h&&($r$2(e,n,Xn$2(t)),!0)}),ti$2,mr$2),vi$1=function(t,e,n=pr$2){return new br$2(t,e,n)}((function(t,e,n,r,i){return 2===t.h&&(r=ye$2(void 0,r,!0),Qe$2(e,rt$2(e),n,!0).push(r),Vn$2(t,r,i),!0)}),(function(t,e,n,r,i){if(Array.isArray(e))for(let s=0;s<e.length;s++)ei$2(t,e[s],n,r,i);})),Ei$1=Ar$2((function(t,e,n,r,i,s){return 2===t.h&&(nn$2(e,nt$2(e),s,n),Vn$2(t,e=sn$2(e,r,n),i),!0)}),ei$2),wi$1=Kr$2((function(t,e,n){return 2===t.h&&($r$2(e,n,Hn$2(t)),!0)}),ni$2,wr$2),Ti$1=Yr$2((function(t,e,n){return (0===t.h||2===t.h)&&(e=Qe$2(e,rt$2(e),n,!1,!1),2==t.h?Wn$2(t,In$2,e):e.push(In$2(t.g)),!0)}),(function(t,e,n){if(null!=(e=zr$2(qt$2,e)))for(let o=0;o<e.length;o++){var r=t,i=n,s=e[o];null!=s&&(cr$2(r,i,0),ir$2(r.g,s));}}),_r$2),bi$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,0===(t=In$2(t.g))?void 0:t),!0)}),(function(t,e,n){null!=(e=qt$2(e))&&null!=e&&(cr$2(t,n,0),ir$2(t.g,e));}),_r$2),Ai$1=Kr$2((function(t,e,n){return 0===t.h&&($r$2(e,n,Fn$2(t.g)),!0)}),(function(t,e,n){null!=(e=$t$2(e))&&(e=parseInt(e,10),cr$2(t,n,0),sr$2(t.g,e));}),Tr$2);class ki$1{constructor(t,e){this.h=t,this.g=e,this.l=an$2,this.m=un$2,this.defaultValue=void 0;}}function Si$1(t,e){return new ki$1(t,e)}function xi$1(t,e){return (n,r)=>{if(zn$2.length){const t=zn$2.pop();t.o(r),Cn$2(t.g,n,r),n=t;}else n=new class{constructor(t,e){if(Bn$2.length){const n=Bn$2.pop();Cn$2(n,t,e),t=n;}else t=new class{constructor(t,e){this.h=null,this.m=!1,this.g=this.l=this.j=0,Cn$2(this,t,e);}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ca=!1;}}(t,e);this.g=t,this.l=this.g.g,this.h=this.m=-1,this.o(e);}o({ga:t=!1}={}){this.ga=t;}}(n,r);try{const r=new t,s=r.u;Br$2(e)(s,n);var i=r;}finally{n.g.clear(),n.m=-1,n.h=-1,zn$2.length<100&&zn$2.push(n);}return i}}function Li$1(t){return function(){const e=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[];}length(){return this.g.length}end(){const t=this.g;return this.g=[],t}};}};Hr$2(this.u,e,Or$2(Lr$2,jr$2,Vr$2,t)),ar$2(e,e.g.end());const n=new Uint8Array(e.h),r=e.l,i=r.length;let s=0;for(let t=0;t<i;t++){const e=r[t];n.set(e,s),s+=e.length;}return e.l=[n],n}}var Ri$1=class extends $n$2{constructor(t){super(t);}},Fi$1=[0,yi$1,Kr$2((function(t,e,n){return 2===t.h&&($r$2(e,n,(t=Hn$2(t))===N$2()?void 0:t),!0)}),(function(t,e,n){if(null!=e){if(e instanceof $n$2){const r=e.Qa;return void(r&&(e=r(e),null!=e&&lr$2(t,n,xn$2(e).buffer)))}if(Array.isArray(e))return}ni$2(t,e,n);}),wr$2)];let Ii$1,Mi$1=globalThis.trustedTypes;function Pi$1(t){void 0===Ii$1&&(Ii$1=function(){let t=null;if(!Mi$1)return t;try{const e=t=>t;t=Mi$1.createPolicy("goog#html",{createHTML:e,createScript:e,createScriptURL:e});}catch(t){}return t}());var e=Ii$1;return new class{constructor(t){this.g=t;}toString(){return this.g+""}}(e?e.createScriptURL(t):t)}function Oi$1(t,...e){if(0===e.length)return Pi$1(t[0]);let n=t[0];for(let r=0;r<e.length;r++)n+=encodeURIComponent(e[r])+t[r+1];return Pi$1(n)}var Ci$1=[0,li$1,Ai$1,pi$1,-1,fi$1,Ai$1,-1],Ui$1=class extends $n$2{constructor(){super();}},Ni$1=[0,pi$1,_i$1,pi$1,Ai$1,-1,Yr$2((function(t,e,n){return (0===t.h||2===t.h)&&(e=Qe$2(e,rt$2(e),n,!1,!1),2==t.h?Wn$2(t,On$2,e):e.push(Fn$2(t.g)),!0)}),(function(t,e,n){if(null!=(e=zr$2($t$2,e))&&e.length){n=hr$2(t,n);for(let n=0;n<e.length;n++)sr$2(t.g,e[n]);ur$2(t,n);}}),Tr$2),_i$1,-1,[0,pi$1,-1],Ai$1,pi$1,-1],Di$1=[0,_i$1,-2],Bi$1=class extends $n$2{constructor(){super();}},Gi$1=[0],ji$1=[0,li$1,pi$1,1,pi$1,-3],Vi$1=class extends $n$2{constructor(t){super(t,2);}},Xi$1={};Xi$1[336783863]=[0,_i$1,pi$1,-1,li$1,[0,[1,2,3,4,5,6,7],Ei$1,Gi$1,Ei$1,Ni$1,Ei$1,Di$1,Ei$1,ji$1,Ei$1,Ci$1,Ei$1,[0,_i$1,-2],Ei$1,[0,_i$1,Ai$1]],[0,_i$1],pi$1,[0,[1,3],[2,4],Ei$1,[0,fi$1],-1,Ei$1,[0,mi$1],-1,vi$1,[0,_i$1,-1]],_i$1];var Hi$1=[0,hi$1,-1,gi$1,-3,hi$1,fi$1,yi$1,di$1,hi$1,-1,gi$1,di$1,gi$1,-2,yi$1];function Wi$1(t,e){Ze$2(t,2,re$2(e),"");}function zi$1(t,e){bn$2(t,3,e);}function Ki$1(t,e){bn$2(t,4,e);}var Yi$1=class extends $n$2{constructor(t){super(t,500);}o(t){return un$2(this,0,7,t)}},$i$1=[-1,{}],qi$1=[0,_i$1,1,$i$1],Ji$1=[0,_i$1,mi$1,$i$1];function Zi$1(t,e){pn$2(t,1,Yi$1,e);}function Qi$1(t,e){bn$2(t,10,e);}function ts(t,e){bn$2(t,15,e);}var es=class extends $n$2{constructor(t){super(t,500);}o(t){return un$2(this,0,1001,t)}},ns=[-500,vi$1,[-500,yi$1,-1,mi$1,-3,[-2,Xi$1,pi$1],vi$1,Fi$1,di$1,-1,qi$1,Ji$1,vi$1,[0,yi$1,gi$1],yi$1,Hi$1,di$1,mi$1,987,mi$1],4,vi$1,[-500,_i$1,-1,[-1,{}],998,_i$1],vi$1,[-500,_i$1,mi$1,-1,[-2,{},pi$1],997,mi$1,-1],di$1,vi$1,[-500,_i$1,mi$1,$i$1,998,mi$1],mi$1,di$1,qi$1,Ji$1,vi$1,[0,yi$1,-1,$i$1],mi$1,-2,Hi$1,yi$1,-1,gi$1,[0,gi$1,bi$1],978,$i$1,vi$1,Fi$1];es.prototype.g=Li$1(ns);var rs=xi$1(es,ns),is=class extends $n$2{constructor(t){super(t);}},ss=class extends $n$2{constructor(t){super(t);}g(){return hn$2(this,is,1)}},os=[0,vi$1,[0,li$1,si$1,_i$1,-1]],as=xi$1(ss,os),cs=class extends $n$2{constructor(t){super(t);}},hs=class extends $n$2{constructor(t){super(t);}},us=class extends $n$2{constructor(t){super(t);}h(){return an$2(this,cs,2)}g(){return hn$2(this,hs,5)}},ls=xi$1(class extends $n$2{constructor(t){super(t);}},[0,mi$1,fi$1,ai$1,[0,Ai$1,[0,li$1,-3],[0,si$1,-3],[0,li$1,-1,[0,vi$1,[0,li$1,-2]]],vi$1,[0,si$1,-1,_i$1,si$1]],_i$1,-1,ci$1,vi$1,[0,li$1,si$1],mi$1,ci$1]),fs=class extends $n$2{constructor(t){super(t);}},ds=xi$1(class extends $n$2{constructor(t){super(t);}},[0,vi$1,[0,si$1,-4]]),ps=class extends $n$2{constructor(t){super(t);}},gs=xi$1(class extends $n$2{constructor(t){super(t);}},[0,vi$1,[0,si$1,-4]]),ms=class extends $n$2{constructor(t){super(t);}},ys=[0,li$1,-1,ai$1,Ai$1],_s=class extends $n$2{constructor(){super();}};_s.prototype.g=Li$1([0,si$1,-4,ci$1]);var vs=class extends $n$2{constructor(t){super(t);}},Es=xi$1(class extends $n$2{constructor(t){super(t);}},[0,vi$1,[0,1,li$1,_i$1,os],ci$1]),ws=class extends $n$2{constructor(t){super(t);}},Ts=class extends $n$2{constructor(t){super(t);}pa(){const t=We$2(this);return null==t?N$2():t}},bs=class extends $n$2{constructor(t){super(t);}},As=[1,2],ks=xi$1(class extends $n$2{constructor(t){super(t);}},[0,vi$1,[0,As,Ei$1,[0,ai$1],Ei$1,[0,wi$1],li$1,_i$1],ci$1]),Ss=class extends $n$2{constructor(t){super(t);}},xs=[0,_i$1,li$1,si$1,mi$1,-1],Ls=class extends $n$2{constructor(t){super(t);}},Rs=[0,pi$1,-1],Fs=class extends $n$2{constructor(t){super(t);}},Is=[1,2,3,4,5],Ms=class extends $n$2{constructor(t){super(t);}g(){return null!=We$2(this)}h(){return null!=ie$2(Be$2(this,2))}},Ps=class extends $n$2{constructor(t){super(t);}g(){return zt$2(Be$2(this,2))??!1}},Os=[0,wi$1,_i$1,[0,li$1,ci$1,-1],[0,ui$1,ci$1]],Cs=[0,Os,pi$1,[0,Is,Ei$1,ji$1,Ei$1,Ni$1,Ei$1,Ci$1,Ei$1,Gi$1,Ei$1,Di$1],Ai$1],Us=class extends $n$2{constructor(t){super(t);}},Ns=[0,Cs,si$1,-1,li$1],Ds=Si$1(502141897,Us);Xi$1[502141897]=Ns;var Bs=xi$1(class extends $n$2{constructor(t){super(t);}},[0,[0,Ai$1,-1,oi$1,Ti$1],ys]),Gs=class extends $n$2{constructor(t){super(t);}},js=class extends $n$2{constructor(t){super(t);}},Vs=[0,Cs,si$1,[0,Cs],pi$1],Xs=[0,Cs,Ns,Vs,si$1,[0,[0,Os]]],Hs=Si$1(508968150,js);Xi$1[508968150]=Xs,Xi$1[508968149]=Vs;var Ws=class extends $n$2{constructor(t){super(t);}},zs=Si$1(513916220,Ws);Xi$1[513916220]=[0,Cs,Xs,li$1];var Ks=class extends $n$2{constructor(t){super(t);}h(){return an$2(this,Ss,2)}g(){Ve$2(this,2);}},Ys=[0,Cs,xs];Xi$1[478825465]=Ys;var $s=class extends $n$2{constructor(t){super(t);}},qs=class extends $n$2{constructor(t){super(t);}},Js=class extends $n$2{constructor(t){super(t);}},Zs=class extends $n$2{constructor(t){super(t);}},Qs=class extends $n$2{constructor(t){super(t);}},to$1=[0,Cs,[0,Cs],Ys,-1],eo$1=[0,Cs,si$1,li$1],no$1=[0,Cs,si$1],ro=[0,Cs,eo$1,no$1,si$1],io=Si$1(479097054,Qs);Xi$1[479097054]=[0,Cs,ro,to$1],Xi$1[463370452]=to$1,Xi$1[464864288]=eo$1;var so=Si$1(462713202,Zs);Xi$1[462713202]=ro,Xi$1[474472470]=no$1;var oo=class extends $n$2{constructor(t){super(t);}},ao=class extends $n$2{constructor(t){super(t);}},co=class extends $n$2{constructor(t){super(t);}},ho=class extends $n$2{constructor(){super();}},uo=[0,Cs,si$1,-1,li$1],lo=[0,Cs,si$1,pi$1];ho.prototype.g=Li$1([0,Cs,no$1,[0,Cs],Ns,Vs,uo,lo]);var fo=class extends $n$2{constructor(t){super(t);}},po=Si$1(456383383,fo);Xi$1[456383383]=[0,Cs,xs];var go=class extends $n$2{constructor(t){super(t);}},mo=Si$1(476348187,go);Xi$1[476348187]=[0,Cs,Rs];var yo=class extends $n$2{constructor(t){super(t);}},_o=class extends $n$2{constructor(t){super(t);}},vo=[0,Ai$1,-1],Eo=Si$1(458105876,class extends $n$2{constructor(t){super(t);}g(){var t=this.u;const e=rt$2(t);const n=2&e;return t=function(t,e,n){var r=_o;const i=2&e;let s=!1;if(null==n){if(i)return Fe$2();n=[];}else if(n.constructor===ke$2){if(0==(2&n.M)||i)return n;n=n.Y();}else Array.isArray(n)?s=!!(2&nt$2(n)):n=[];if(i){if(!n.length)return Fe$2();s||(s=!0,st$2(n));}else s&&(s=!1,n=Je$2(n));return s||(64&nt$2(n)?et$2(n,32):32&e&&tt$2(n,32)),Xe$2(t,e,2,r=new ke$2(n,r,oe$2,void 0)),r}(t,e,je$2(t,e,2)),!n&&_o&&(t.sa=!0),t}});Xi$1[458105876]=[0,vo,qr$2,[!0,ci$1,[0,_i$1,-1,mi$1]]];var wo=class extends $n$2{constructor(t){super(t);}},To=Si$1(458105758,wo);Xi$1[458105758]=[0,Cs,_i$1,vo];var bo=class extends $n$2{constructor(t){super(t);}},Ao=Si$1(443442058,bo);Xi$1[443442058]=[0,Cs,_i$1,li$1,si$1,mi$1,-1],Xi$1[514774813]=uo;var ko=class extends $n$2{constructor(t){super(t);}},So=Si$1(516587230,ko);function xo(t,e){return e=e?e.clone():new Ss,void 0!==t.displayNamesLocale?Ve$2(e,1,re$2(t.displayNamesLocale)):void 0===t.displayNamesLocale&&Ve$2(e,1),void 0!==t.maxResults?En$2(e,2,t.maxResults):"maxResults"in t&&Ve$2(e,2),void 0!==t.scoreThreshold?wn$2(e,3,t.scoreThreshold):"scoreThreshold"in t&&Ve$2(e,3),void 0!==t.categoryAllowlist?Tn$2(e,4,t.categoryAllowlist):"categoryAllowlist"in t&&Ve$2(e,4),void 0!==t.categoryDenylist?Tn$2(e,5,t.categoryDenylist):"categoryDenylist"in t&&Ve$2(e,5),e}function Lo(t,e=-1,n=""){return {categories:t.map((t=>({index:gn$2(mn$2(t,1),0)??-1,score:yn$2(t,2)??0,categoryName:_n$2(t,3)??"",displayName:_n$2(t,4)??""}))),headIndex:e,headName:n}}function Ro(t){var e=Ke$2(t,3,Wt$2,ze$2()),n=Ke$2(t,2,$t$2,ze$2()),r=Ke$2(t,1,ie$2,ze$2()),i=Ke$2(t,9,ie$2,ze$2());const s={categories:[],keypoints:[]};for(let t=0;t<e.length;t++)s.categories.push({score:e[t],index:n[t]??-1,categoryName:r[t]??"",displayName:i[t]??""});if((e=an$2(t,us,4)?.h())&&(s.boundingBox={originX:mn$2(e,1)??0,originY:mn$2(e,2)??0,width:mn$2(e,3)??0,height:mn$2(e,4)??0,angle:0}),an$2(t,us,4)?.g().length)for(const e of an$2(t,us,4).g())s.keypoints.push({x:He$2(e,1)??0,y:He$2(e,2)??0,score:He$2(e,4)??0,label:ie$2(Be$2(e,3))??""});return s}function Fo(t){const e=[];for(const n of hn$2(t,ps,1))e.push({x:yn$2(n,1)??0,y:yn$2(n,2)??0,z:yn$2(n,3)??0,visibility:yn$2(n,4)??0});return e}function Io(t){const e=[];for(const n of hn$2(t,fs,1))e.push({x:yn$2(n,1)??0,y:yn$2(n,2)??0,z:yn$2(n,3)??0,visibility:yn$2(n,4)??0});return e}function Mo(t){return Array.from(t,(t=>t>127?t-256:t))}function Po(t,e){if(t.length!==e.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${t.length} vs. ${e.length}).`);let n=0,r=0,i=0;for(let s=0;s<t.length;s++)n+=t[s]*e[s],r+=t[s]*t[s],i+=e[s]*e[s];if(r<=0||i<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*i)}let Oo;Xi$1[516587230]=[0,Cs,uo,lo,si$1],Xi$1[518928384]=lo;const Co=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Uo(){if(void 0===Oo)try{await WebAssembly.instantiate(Co),Oo=!0;}catch{Oo=!1;}return Oo}async function No(t,e=Oi$1``){const n=await Uo()?"wasm_internal":"wasm_nosimd_internal";return {wasmLoaderPath:`${e}/${t}_${n}.js`,wasmBinaryPath:`${e}/${t}_${n}.wasm`}}var Do=class{};function Bo(){var t=navigator;return "undefined"!=typeof OffscreenCanvas&&(!function(t=navigator){return (t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(t)||!!((t=t.userAgent.match(/Version\/([\d]+).*Safari/))&&t.length>=1&&Number(t[1])>=17))}async function Go(t){if("function"!=typeof importScripts){const e=document.createElement("script");return e.src=t.toString(),e.crossOrigin="anonymous",new Promise(((t,n)=>{e.addEventListener("load",(()=>{t();}),!1),e.addEventListener("error",(t=>{n(t);}),!1),document.body.appendChild(e);}))}importScripts(t.toString());}function jo(t){return void 0!==t.videoWidth?[t.videoWidth,t.videoHeight]:void 0!==t.naturalWidth?[t.naturalWidth,t.naturalHeight]:void 0!==t.displayWidth?[t.displayWidth,t.displayHeight]:[t.width,t.height]}function Vo(t,e,n){t.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(e=t.i.stringToNewUTF8(e)),t.i._free(e);}function Xo(t,e,n){if(!t.i.canvas)throw Error("No OpenGL canvas configured.");if(n?t.i._bindTextureToStream(n):t.i._bindTextureToCanvas(),!(n=t.i.canvas.getContext("webgl2")||t.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");t.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),t.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,i]=jo(e);return !t.l||r===t.i.canvas.width&&i===t.i.canvas.height||(t.i.canvas.width=r,t.i.canvas.height=i),[r,i]}function Ho(t,e,n){t.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(e.length);for(let n=0;n<e.length;n++)r[n]=t.i.stringToNewUTF8(e[n]);e=t.i._malloc(4*r.length),t.i.HEAPU32.set(r,e>>2),n(e);for(const e of r)t.i._free(e);t.i._free(e);}function Wo(t,e,n){t.i.simpleListeners=t.i.simpleListeners||{},t.i.simpleListeners[e]=n;}function zo(t,e,n){let r=[];t.i.simpleListeners=t.i.simpleListeners||{},t.i.simpleListeners[e]=(t,e,i)=>{e?(n(r,i),r=[]):r.push(t);};}Do.forVisionTasks=function(t){return No("vision",t)},Do.forTextTasks=function(t){return No("text",t)},Do.forGenAiExperimentalTasks=function(t){return No("genai_experimental",t)},Do.forGenAiTasks=function(t){return No("genai",t)},Do.forAudioTasks=function(t){return No("audio",t)},Do.isSimdSupported=function(){return Uo()};async function Ko(t,e,n,r){return t=await(async(t,e,n,r,i)=>{if(e&&await Go(e),!self.ModuleFactory)throw Error("ModuleFactory not set.");if(n&&(await Go(n),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&i&&((e=self.Module).locateFile=i.locateFile,i.mainScriptUrlOrBlob&&(e.mainScriptUrlOrBlob=i.mainScriptUrlOrBlob)),i=await self.ModuleFactory(self.Module||i),self.ModuleFactory=self.Module=void 0,new t(i,r)})(t,n.wasmLoaderPath,n.assetLoaderPath,e,{locateFile:t=>t.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&t.endsWith(".data")?n.assetBinaryPath.toString():t}),await t.o(r),t}function Yo(t,e){const n=an$2(t.baseOptions,Ms,1)||new Ms;"string"==typeof e?(Ve$2(n,2,re$2(e)),Ve$2(n,1)):e instanceof Uint8Array&&(Ve$2(n,1,dt$2(e,!1)),Ve$2(n,2)),un$2(t.baseOptions,0,1,n);}function $o(t){try{const e=t.H.length;if(1===e)throw Error(t.H[0].message);if(e>1)throw Error("Encountered multiple errors: "+t.H.map((t=>t.message)).join(", "))}finally{t.H=[];}}function qo(t,e){t.B=Math.max(t.B,e);}function Jo(t,e){t.A=new Yi$1,Wi$1(t.A,"PassThroughCalculator"),zi$1(t.A,"free_memory"),Ki$1(t.A,"free_memory_unused_out"),Qi$1(e,"free_memory"),Zi$1(e,t.A);}function Zo(t,e){zi$1(t.A,e),Ki$1(t.A,e+"_unused_out");}function Qo(t){t.g.addBoolToStream(!0,"free_memory",t.B);}var ta=class{constructor(t){this.g=t,this.H=[],this.B=0,this.g.setAutoRenderToScreen(!1);}l(t,e=!0){if(e){const e=t.baseOptions||{};if(t.baseOptions?.modelAssetBuffer&&t.baseOptions?.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!(an$2(this.baseOptions,Ms,1)?.g()||an$2(this.baseOptions,Ms,1)?.h()||t.baseOptions?.modelAssetBuffer||t.baseOptions?.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(t,e){let n=an$2(t.baseOptions,Fs,3);if(!n){var r=n=new Fs,i=new Bi$1;ln$2(r,4,Is,i);}"delegate"in e&&("GPU"===e.delegate?(e=n,r=new Ui$1,ln$2(e,2,Is,r)):(e=n,r=new Bi$1,ln$2(e,4,Is,r))),un$2(t.baseOptions,0,3,n);}(this,e),e.modelAssetPath)return fetch(e.modelAssetPath.toString()).then((t=>{if(t.ok)return t.arrayBuffer();throw Error(`Failed to fetch model: ${e.modelAssetPath} (${t.status})`)})).then((t=>{try{this.g.i.FS_unlink("/model.dat");}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(t),!0,!1,!1),Yo(this,"/model.dat"),this.m(),this.J();}));if(e.modelAssetBuffer instanceof Uint8Array)Yo(this,e.modelAssetBuffer);else if(e.modelAssetBuffer)return async function(t){const e=[];for(var n=0;;){const{done:r,value:i}=await t.read();if(r)break;e.push(i),n+=i.length;}if(0===e.length)return new Uint8Array(0);if(1===e.length)return e[0];t=new Uint8Array(n),n=0;for(const r of e)t.set(r,n),n+=r.length;return t}(e.modelAssetBuffer).then((t=>{Yo(this,t),this.m(),this.J();}))}return this.m(),this.J(),Promise.resolve()}J(){}ea(){let t;if(this.g.ea((e=>{t=rs(e);})),!t)throw Error("Failed to retrieve CalculatorGraphConfig");return t}setGraph(t,e){this.g.attachErrorListener(((t,e)=>{this.H.push(Error(e));})),this.g.La(),this.g.setGraph(t,e),this.A=void 0,$o(this);}finishProcessing(){this.g.finishProcessing(),$o(this);}close(){this.A=void 0,this.g.closeGraph();}};function ea(t,e){if(!t)throw Error(`Unable to obtain required WebGL resource: ${e}`);return t}ta.prototype.close=ta.prototype.close,e$2("TaskRunner",ta);class na{constructor(t,e,n,r){this.g=t,this.h=e,this.m=n,this.l=r;}bind(){this.g.bindVertexArray(this.h);}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l);}}function ra(t,e,n){const r=t.g;if(n=ea(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,e),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(t.h,n),n}function ia(t,e){const n=t.g,r=ea(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const i=ea(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(t.P),n.vertexAttribPointer(t.P,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const s=ea(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(t.J),n.vertexAttribPointer(t.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(e?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new na(n,r,i,s)}function sa(t,e){if(t.g){if(e!==t.g)throw Error("Cannot change GL context once initialized")}else t.g=e;}function oa(t,e,n,r){return sa(t,e),t.h||(t.m(),t.C()),n?(t.s||(t.s=ia(t,!0)),n=t.s):(t.v||(t.v=ia(t,!1)),n=t.v),e.useProgram(t.h),n.bind(),t.l(),t=r(),n.g.bindVertexArray(null),t}function aa(t,e,n){return sa(t,e),t=ea(e.createTexture(),"Failed to create texture"),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n??e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n??e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),t}function ca(t,e,n){sa(t,e),t.A||(t.A=ea(e.createFramebuffer(),"Failed to create framebuffe.")),e.bindFramebuffer(e.FRAMEBUFFER,t.A),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);}function ha(t){t.g?.bindFramebuffer(t.g.FRAMEBUFFER,null);}var ua=class{H(){return "\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D inputTexture;\n  void main() {\n    gl_FragColor = texture2D(inputTexture, vTex);\n  }\n "}m(){const t=this.g;if(this.h=ea(t.createProgram(),"Failed to create WebGL program"),this.ba=ra(this,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",t.VERTEX_SHADER),this.aa=ra(this,this.H(),t.FRAGMENT_SHADER),t.linkProgram(this.h),!t.getProgramParameter(this.h,t.LINK_STATUS))throw Error(`Error during program linking: ${t.getProgramInfoLog(this.h)}`);this.P=t.getAttribLocation(this.h,"aVertex"),this.J=t.getAttribLocation(this.h,"aTex");}C(){}l(){}close(){if(this.h){const t=this.g;t.deleteProgram(this.h),t.deleteShader(this.ba),t.deleteShader(this.aa);}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close();}};var la=class extends ua{H(){return "\n  precision mediump float;\n  uniform sampler2D backgroundTexture;\n  uniform sampler2D maskTexture;\n  uniform sampler2D colorMappingTexture;\n  varying vec2 vTex;\n  void main() {\n    vec4 backgroundColor = texture2D(backgroundTexture, vTex);\n    float category = texture2D(maskTexture, vTex).r;\n    vec4 categoryColor = texture2D(colorMappingTexture, vec2(category, 0.0));\n    gl_FragColor = mix(backgroundColor, categoryColor, categoryColor.a);\n  }\n "}C(){const t=this.g;t.activeTexture(t.TEXTURE1),this.B=aa(this,t,t.LINEAR),t.activeTexture(t.TEXTURE2),this.j=aa(this,t,t.NEAREST);}m(){super.m();const t=this.g;this.L=ea(t.getUniformLocation(this.h,"backgroundTexture"),"Uniform location"),this.U=ea(t.getUniformLocation(this.h,"colorMappingTexture"),"Uniform location"),this.K=ea(t.getUniformLocation(this.h,"maskTexture"),"Uniform location");}l(){super.l();const t=this.g;t.uniform1i(this.K,0),t.uniform1i(this.L,1),t.uniform1i(this.U,2);}close(){this.B&&this.g.deleteTexture(this.B),this.j&&this.g.deleteTexture(this.j),super.close();}},fa=class extends ua{H(){return "\n  precision mediump float;\n  uniform sampler2D maskTexture;\n  uniform sampler2D defaultTexture;\n  uniform sampler2D overlayTexture;\n  varying vec2 vTex;\n  void main() {\n    float confidence = texture2D(maskTexture, vTex).r;\n    vec4 defaultColor = texture2D(defaultTexture, vTex);\n    vec4 overlayColor = texture2D(overlayTexture, vTex);\n    // Apply the alpha from the overlay and merge in the default color\n    overlayColor = mix(defaultColor, overlayColor, overlayColor.a);\n    gl_FragColor = mix(defaultColor, overlayColor, confidence);\n  }\n "}C(){const t=this.g;t.activeTexture(t.TEXTURE1),this.j=aa(this,t),t.activeTexture(t.TEXTURE2),this.B=aa(this,t);}m(){super.m();const t=this.g;this.K=ea(t.getUniformLocation(this.h,"defaultTexture"),"Uniform location"),this.L=ea(t.getUniformLocation(this.h,"overlayTexture"),"Uniform location"),this.I=ea(t.getUniformLocation(this.h,"maskTexture"),"Uniform location");}l(){super.l();const t=this.g;t.uniform1i(this.I,0),t.uniform1i(this.K,1),t.uniform1i(this.L,2);}close(){this.j&&this.g.deleteTexture(this.j),this.B&&this.g.deleteTexture(this.B),super.close();}};function da(t,e){switch(e){case 0:return t.g.find((t=>t instanceof Uint8Array));case 1:return t.g.find((t=>t instanceof Float32Array));case 2:return t.g.find((t=>"undefined"!=typeof WebGLTexture&&t instanceof WebGLTexture));default:throw Error(`Type is not supported: ${e}`)}}function pa(t){var e=da(t,1);if(!e){if(e=da(t,0))e=new Float32Array(e).map((t=>t/255));else {e=new Float32Array(t.width*t.height);const r=ma(t);var n=_a(t);if(ca(n,r,ga(t)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(t.width*t.height*4),r.readPixels(0,0,t.width,t.height,r.RGBA,r.FLOAT,n);for(let t=0,r=0;t<e.length;++t,r+=4)e[t]=n[r];}else r.readPixels(0,0,t.width,t.height,r.RED,r.FLOAT,e);}t.g.push(e);}return e}function ga(t){let e=da(t,2);if(!e){const n=ma(t);e=va(t);const r=pa(t),i=ya(t);n.texImage2D(n.TEXTURE_2D,0,i,t.width,t.height,0,n.RED,n.FLOAT,r),Ea(t);}return e}function ma(t){if(!t.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return t.h||(t.h=ea(t.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),t.h}function ya(t){if(t=ma(t),!wa)if(t.getExtension("EXT_color_buffer_float")&&t.getExtension("OES_texture_float_linear")&&t.getExtension("EXT_float_blend"))wa=t.R32F;else {if(!t.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");wa=t.R16F;}return wa}function _a(t){return t.l||(t.l=new ua),t.l}function va(t){const e=ma(t);e.viewport(0,0,t.width,t.height),e.activeTexture(e.TEXTURE0);let n=da(t,2);return n||(n=aa(_a(t),e,t.m?e.LINEAR:e.NEAREST),t.g.push(n),t.j=!0),e.bindTexture(e.TEXTURE_2D,n),n}function Ea(t){t.h.bindTexture(t.h.TEXTURE_2D,null);}var wa,Ta=class{constructor(t,e,n,r,i,s,o){this.g=t,this.m=e,this.j=n,this.canvas=r,this.l=i,this.width=s,this.height=o,this.j&&(0===--ba&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources."));}Ga(){return !!da(this,0)}ka(){return !!da(this,1)}R(){return !!da(this,2)}ja(){return (e=da(t=this,0))||(e=pa(t),e=new Uint8Array(e.map((t=>255*t))),t.g.push(e)),e;var t,e;}ia(){return pa(this)}N(){return ga(this)}clone(){const t=[];for(const e of this.g){let n;if(e instanceof Uint8Array)n=new Uint8Array(e);else if(e instanceof Float32Array)n=new Float32Array(e);else {if(!(e instanceof WebGLTexture))throw Error(`Type is not supported: ${e}`);{const t=ma(this),e=_a(this);t.activeTexture(t.TEXTURE1),n=aa(e,t,this.m?t.LINEAR:t.NEAREST),t.bindTexture(t.TEXTURE_2D,n);const r=ya(this);t.texImage2D(t.TEXTURE_2D,0,r,this.width,this.height,0,t.RED,t.FLOAT,null),t.bindTexture(t.TEXTURE_2D,null),ca(e,t,n),oa(e,t,!1,(()=>{va(this),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),Ea(this);})),ha(e),Ea(this);}}t.push(n);}return new Ta(t,this.m,this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&ma(this).deleteTexture(da(this,2)),ba=-1;}};Ta.prototype.close=Ta.prototype.close,Ta.prototype.clone=Ta.prototype.clone,Ta.prototype.getAsWebGLTexture=Ta.prototype.N,Ta.prototype.getAsFloat32Array=Ta.prototype.ia,Ta.prototype.getAsUint8Array=Ta.prototype.ja,Ta.prototype.hasWebGLTexture=Ta.prototype.R,Ta.prototype.hasFloat32Array=Ta.prototype.ka,Ta.prototype.hasUint8Array=Ta.prototype.Ga;var ba=250;const Aa={color:"white",lineWidth:4,radius:6};function ka(t){return {...Aa,fillColor:(t=t||{}).color,...t}}function Sa(t,e){return t instanceof Function?t(e):t}function xa(t,e,n){return Math.max(Math.min(e,n),Math.min(Math.max(e,n),t))}function La(t){if(!t.l)throw Error("CPU rendering requested but CanvasRenderingContext2D not provided.");return t.l}function Ra(t){if(!t.j)throw Error("GPU rendering requested but WebGL2RenderingContext not provided.");return t.j}function Fa(t,e,n){if(e.R())n(e.N());else {const r=e.ka()?e.ia():e.ja();t.m=t.m??new ua;const i=Ra(t);n((t=new Ta([r],e.m,!1,i.canvas,t.m,e.width,e.height)).N()),t.close();}}function Ia(t,e,n,r){const i=function(t){return t.g||(t.g=new la),t.g}(t),s=Ra(t),o=Array.isArray(n)?new ImageData(new Uint8ClampedArray(n),1,1):n;oa(i,s,!0,(()=>{!function(t,e,n,r){const i=t.g;if(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,t.B),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),t.I&&function(t,e){if(t!==e)return !1;t=t.entries(),e=e.entries();for(const[r,i]of t){t=r;const s=i;var n=e.next();if(n.done)return !1;const[o,a]=n.value;if(n=a,t!==o||s[0]!==n[0]||s[1]!==n[1]||s[2]!==n[2]||s[3]!==n[3])return !1}return !!e.next().done}(t.I,r))i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,t.j);else {t.I=r;const e=Array(1024).fill(0);r.forEach(((t,n)=>{if(4!==t.length)throw Error(`Color at index ${n} is not a four-channel value.`);e[4*n]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3];})),i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,t.j),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,256,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array(e));}}(i,e,o,r),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.drawArrays(s.TRIANGLE_FAN,0,4);const t=i.g;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,null);}));}function Ma(t,e,n,r){const i=Ra(t),s=function(t){return t.h||(t.h=new fa),t.h}(t),o=Array.isArray(n)?new ImageData(new Uint8ClampedArray(n),1,1):n,a=Array.isArray(r)?new ImageData(new Uint8ClampedArray(r),1,1):r;oa(s,i,!0,(()=>{var t=s.g;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,s.j),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,o),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,s.B),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.drawArrays(i.TRIANGLE_FAN,0,4),i.bindTexture(i.TEXTURE_2D,null),(t=s.g).activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,null);}));}var Pa=class{constructor(t,e){t instanceof CanvasRenderingContext2D||t instanceof OffscreenCanvasRenderingContext2D?(this.l=t,this.j=e):this.j=t;}za(t,e){if(t){var n=La(this);e=ka(e),n.save();var r=n.canvas,i=0;for(const s of t)n.fillStyle=Sa(e.fillColor,{index:i,from:s}),n.strokeStyle=Sa(e.color,{index:i,from:s}),n.lineWidth=Sa(e.lineWidth,{index:i,from:s}),(t=new Path2D).arc(s.x*r.width,s.y*r.height,Sa(e.radius,{index:i,from:s}),0,2*Math.PI),n.fill(t),n.stroke(t),++i;n.restore();}}ya(t,e,n){if(t&&e){var r=La(this);n=ka(n),r.save();var i=r.canvas,s=0;for(const o of e){r.beginPath(),e=t[o.start];const a=t[o.end];e&&a&&(r.strokeStyle=Sa(n.color,{index:s,from:e,to:a}),r.lineWidth=Sa(n.lineWidth,{index:s,from:e,to:a}),r.moveTo(e.x*i.width,e.y*i.height),r.lineTo(a.x*i.width,a.y*i.height)),++s,r.stroke();}r.restore();}}va(t,e){const n=La(this);e=ka(e),n.save(),n.beginPath(),n.lineWidth=Sa(e.lineWidth,{}),n.strokeStyle=Sa(e.color,{}),n.fillStyle=Sa(e.fillColor,{}),n.moveTo(t.originX,t.originY),n.lineTo(t.originX+t.width,t.originY),n.lineTo(t.originX+t.width,t.originY+t.height),n.lineTo(t.originX,t.originY+t.height),n.lineTo(t.originX,t.originY),n.stroke(),n.fill(),n.restore();}wa(t,e,n=[0,0,0,255]){this.l?function(t,e,n,r){const i=Ra(t);Fa(t,e,(e=>{Ia(t,e,n,r),(e=La(t)).drawImage(i.canvas,0,0,e.canvas.width,e.canvas.height);}));}(this,t,n,e):Ia(this,t.N(),n,e);}xa(t,e,n){this.l?function(t,e,n,r){const i=Ra(t);Fa(t,e,(e=>{Ma(t,e,n,r),(e=La(t)).drawImage(i.canvas,0,0,e.canvas.width,e.canvas.height);}));}(this,t,e,n):Ma(this,t.N(),e,n);}close(){this.g?.close(),this.g=void 0,this.h?.close(),this.h=void 0,this.m?.close(),this.m=void 0;}};function Oa(t,e){switch(e){case 0:return t.g.find((t=>t instanceof ImageData));case 1:return t.g.find((t=>"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap));case 2:return t.g.find((t=>"undefined"!=typeof WebGLTexture&&t instanceof WebGLTexture));default:throw Error(`Type is not supported: ${e}`)}}function Ca(t){var e=Oa(t,0);if(!e){e=Na(t);const n=Da(t),r=new Uint8Array(t.width*t.height*4);ca(n,e,Ua(t)),e.readPixels(0,0,t.width,t.height,e.RGBA,e.UNSIGNED_BYTE,r),ha(n),e=new ImageData(new Uint8ClampedArray(r.buffer),t.width,t.height),t.g.push(e);}return e}function Ua(t){let e=Oa(t,2);if(!e){const n=Na(t);e=Ba(t);const r=Oa(t,1)||Ca(t);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Ga(t);}return e}function Na(t){if(!t.canvas)throw Error("Conversion to different image formats require that a canvas is passed when iniitializing the image.");return t.h||(t.h=ea(t.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),t.h}function Da(t){return t.l||(t.l=new ua),t.l}function Ba(t){const e=Na(t);e.viewport(0,0,t.width,t.height),e.activeTexture(e.TEXTURE0);let n=Oa(t,2);return n||(n=aa(Da(t),e),t.g.push(n),t.m=!0),e.bindTexture(e.TEXTURE_2D,n),n}function Ga(t){t.h.bindTexture(t.h.TEXTURE_2D,null);}function ja(t){const e=Na(t);return oa(Da(t),e,!0,(()=>function(t,e){const n=t.canvas;if(n.width===t.width&&n.height===t.height)return e();const r=n.width,i=n.height;return n.width=t.width,n.height=t.height,t=e(),n.width=r,n.height=i,t}(t,(()=>{if(e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),!(t.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return t.canvas.transferToImageBitmap()}))))}Pa.prototype.close=Pa.prototype.close,Pa.prototype.drawConfidenceMask=Pa.prototype.xa,Pa.prototype.drawCategoryMask=Pa.prototype.wa,Pa.prototype.drawBoundingBox=Pa.prototype.va,Pa.prototype.drawConnectors=Pa.prototype.ya,Pa.prototype.drawLandmarks=Pa.prototype.za,Pa.lerp=function(t,e,n,r,i){return xa(r*(1-(t-e)/(n-e))+i*(1-(n-t)/(n-e)),r,i)},Pa.clamp=xa,e$2("DrawingUtils",Pa);var Va=class{constructor(t,e,n,r,i,s,o){this.g=t,this.j=e,this.m=n,this.canvas=r,this.l=i,this.width=s,this.height=o,(this.j||this.m)&&(0===--Xa&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources."));}Fa(){return !!Oa(this,0)}la(){return !!Oa(this,1)}R(){return !!Oa(this,2)}Da(){return Ca(this)}Ca(){var t=Oa(this,1);return t||(Ua(this),Ba(this),t=ja(this),Ga(this),this.g.push(t),this.j=!0),t}N(){return Ua(this)}clone(){const t=[];for(const e of this.g){let n;if(e instanceof ImageData)n=new ImageData(e.data,this.width,this.height);else if(e instanceof WebGLTexture){const t=Na(this),e=Da(this);t.activeTexture(t.TEXTURE1),n=aa(e,t),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,null),ca(e,t,n),oa(e,t,!1,(()=>{Ba(this),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),Ga(this);})),ha(e),Ga(this);}else {if(!(e instanceof ImageBitmap))throw Error(`Type is not supported: ${e}`);Ua(this),Ba(this),n=ja(this),Ga(this);}t.push(n);}return new Va(t,this.la(),this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Oa(this,1).close(),this.m&&Na(this).deleteTexture(Oa(this,2)),Xa=-1;}};Va.prototype.close=Va.prototype.close,Va.prototype.clone=Va.prototype.clone,Va.prototype.getAsWebGLTexture=Va.prototype.N,Va.prototype.getAsImageBitmap=Va.prototype.Ca,Va.prototype.getAsImageData=Va.prototype.Da,Va.prototype.hasWebGLTexture=Va.prototype.R,Va.prototype.hasImageBitmap=Va.prototype.la,Va.prototype.hasImageData=Va.prototype.Fa;var Xa=250;function Ha(...t){return t.map((([t,e])=>({start:t,end:e})))}const Wa=function(t){return class extends t{La(){this.i._registerModelResourcesGraphService();}}}((za=class{constructor(t,e){this.l=!0,this.i=t,this.g=null,this.h=0,this.m="function"==typeof this.i._addIntToInputStream,void 0!==e?this.i.canvas=e:Bo()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"));}async initializeGraph(t){const e=await(await fetch(t)).arrayBuffer();t=!(t.endsWith(".pbtxt")||t.endsWith(".textproto")),this.setGraph(new Uint8Array(e),t);}setGraphFromString(t){this.setGraph((new TextEncoder).encode(t),!1);}setGraph(t,e){const n=t.length,r=this.i._malloc(n);this.i.HEAPU8.set(t,r),e?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r);}configureAudio(t,e,n,r,i){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Vo(this,r||"input_audio",(r=>{Vo(this,i=i||"audio_header",(i=>{this.i._configureAudio(r,i,t,e??0,n);}));}));}setAutoResizeCanvas(t){this.l=t;}setAutoRenderToScreen(t){this.i._setAutoRenderToScreen(t);}setGpuBufferVerticalFlip(t){this.i.gpuOriginForWebTexturesIsBottomLeft=t;}ea(t){Wo(this,"__graph_config__",(e=>{t(e);})),Vo(this,"__graph_config__",(t=>{this.i._getGraphConfig(t,void 0);})),delete this.i.simpleListeners.__graph_config__;}attachErrorListener(t){this.i.errorListener=t;}attachEmptyPacketListener(t,e){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[t]=e;}addAudioToStream(t,e,n){this.addAudioToStreamWithShape(t,0,0,e,n);}addAudioToStreamWithShape(t,e,n,r,i){const s=4*t.length;this.h!==s&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(s),this.h=s),this.i.HEAPF32.set(t,this.g/4),Vo(this,r,(t=>{this.i._addAudioToInputStream(this.g,e,n,t,i);}));}addGpuBufferToStream(t,e,n){Vo(this,e,(e=>{const[r,i]=Xo(this,t,e);this.i._addBoundTextureToStream(e,r,i,n);}));}addBoolToStream(t,e,n){Vo(this,e,(e=>{this.i._addBoolToInputStream(t,e,n);}));}addDoubleToStream(t,e,n){Vo(this,e,(e=>{this.i._addDoubleToInputStream(t,e,n);}));}addFloatToStream(t,e,n){Vo(this,e,(e=>{this.i._addFloatToInputStream(t,e,n);}));}addIntToStream(t,e,n){Vo(this,e,(e=>{this.i._addIntToInputStream(t,e,n);}));}addUintToStream(t,e,n){Vo(this,e,(e=>{this.i._addUintToInputStream(t,e,n);}));}addStringToStream(t,e,n){Vo(this,e,(e=>{Vo(this,t,(t=>{this.i._addStringToInputStream(t,e,n);}));}));}addStringRecordToStream(t,e,n){Vo(this,e,(e=>{Ho(this,Object.keys(t),(r=>{Ho(this,Object.values(t),(i=>{this.i._addFlatHashMapToInputStream(r,i,Object.keys(t).length,e,n);}));}));}));}addProtoToStream(t,e,n,r){Vo(this,n,(n=>{Vo(this,e,(e=>{const i=this.i._malloc(t.length);this.i.HEAPU8.set(t,i),this.i._addProtoToInputStream(i,t.length,e,n,r),this.i._free(i);}));}));}addEmptyPacketToStream(t,e){Vo(this,t,(t=>{this.i._addEmptyPacketToInputStream(t,e);}));}addBoolVectorToStream(t,e,n){Vo(this,e,(e=>{const r=this.i._allocateBoolVector(t.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const e of t)this.i._addBoolVectorEntry(r,e);this.i._addBoolVectorToInputStream(r,e,n);}));}addDoubleVectorToStream(t,e,n){Vo(this,e,(e=>{const r=this.i._allocateDoubleVector(t.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const e of t)this.i._addDoubleVectorEntry(r,e);this.i._addDoubleVectorToInputStream(r,e,n);}));}addFloatVectorToStream(t,e,n){Vo(this,e,(e=>{const r=this.i._allocateFloatVector(t.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const e of t)this.i._addFloatVectorEntry(r,e);this.i._addFloatVectorToInputStream(r,e,n);}));}addIntVectorToStream(t,e,n){Vo(this,e,(e=>{const r=this.i._allocateIntVector(t.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const e of t)this.i._addIntVectorEntry(r,e);this.i._addIntVectorToInputStream(r,e,n);}));}addUintVectorToStream(t,e,n){Vo(this,e,(e=>{const r=this.i._allocateUintVector(t.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const e of t)this.i._addUintVectorEntry(r,e);this.i._addUintVectorToInputStream(r,e,n);}));}addStringVectorToStream(t,e,n){Vo(this,e,(e=>{const r=this.i._allocateStringVector(t.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const e of t)Vo(this,e,(t=>{this.i._addStringVectorEntry(r,t);}));this.i._addStringVectorToInputStream(r,e,n);}));}addBoolToInputSidePacket(t,e){Vo(this,e,(e=>{this.i._addBoolToInputSidePacket(t,e);}));}addDoubleToInputSidePacket(t,e){Vo(this,e,(e=>{this.i._addDoubleToInputSidePacket(t,e);}));}addFloatToInputSidePacket(t,e){Vo(this,e,(e=>{this.i._addFloatToInputSidePacket(t,e);}));}addIntToInputSidePacket(t,e){Vo(this,e,(e=>{this.i._addIntToInputSidePacket(t,e);}));}addUintToInputSidePacket(t,e){Vo(this,e,(e=>{this.i._addUintToInputSidePacket(t,e);}));}addStringToInputSidePacket(t,e){Vo(this,e,(e=>{Vo(this,t,(t=>{this.i._addStringToInputSidePacket(t,e);}));}));}addProtoToInputSidePacket(t,e,n){Vo(this,n,(n=>{Vo(this,e,(e=>{const r=this.i._malloc(t.length);this.i.HEAPU8.set(t,r),this.i._addProtoToInputSidePacket(r,t.length,e,n),this.i._free(r);}));}));}addBoolVectorToInputSidePacket(t,e){Vo(this,e,(e=>{const n=this.i._allocateBoolVector(t.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(const e of t)this.i._addBoolVectorEntry(n,e);this.i._addBoolVectorToInputSidePacket(n,e);}));}addDoubleVectorToInputSidePacket(t,e){Vo(this,e,(e=>{const n=this.i._allocateDoubleVector(t.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(const e of t)this.i._addDoubleVectorEntry(n,e);this.i._addDoubleVectorToInputSidePacket(n,e);}));}addFloatVectorToInputSidePacket(t,e){Vo(this,e,(e=>{const n=this.i._allocateFloatVector(t.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(const e of t)this.i._addFloatVectorEntry(n,e);this.i._addFloatVectorToInputSidePacket(n,e);}));}addIntVectorToInputSidePacket(t,e){Vo(this,e,(e=>{const n=this.i._allocateIntVector(t.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(const e of t)this.i._addIntVectorEntry(n,e);this.i._addIntVectorToInputSidePacket(n,e);}));}addUintVectorToInputSidePacket(t,e){Vo(this,e,(e=>{const n=this.i._allocateUintVector(t.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(const e of t)this.i._addUintVectorEntry(n,e);this.i._addUintVectorToInputSidePacket(n,e);}));}addStringVectorToInputSidePacket(t,e){Vo(this,e,(e=>{const n=this.i._allocateStringVector(t.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(const e of t)Vo(this,e,(t=>{this.i._addStringVectorEntry(n,t);}));this.i._addStringVectorToInputSidePacket(n,e);}));}attachBoolListener(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachBoolListener(t);}));}attachBoolVectorListener(t,e){zo(this,t,e),Vo(this,t,(t=>{this.i._attachBoolVectorListener(t);}));}attachIntListener(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachIntListener(t);}));}attachIntVectorListener(t,e){zo(this,t,e),Vo(this,t,(t=>{this.i._attachIntVectorListener(t);}));}attachUintListener(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachUintListener(t);}));}attachUintVectorListener(t,e){zo(this,t,e),Vo(this,t,(t=>{this.i._attachUintVectorListener(t);}));}attachDoubleListener(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachDoubleListener(t);}));}attachDoubleVectorListener(t,e){zo(this,t,e),Vo(this,t,(t=>{this.i._attachDoubleVectorListener(t);}));}attachFloatListener(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachFloatListener(t);}));}attachFloatVectorListener(t,e){zo(this,t,e),Vo(this,t,(t=>{this.i._attachFloatVectorListener(t);}));}attachStringListener(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachStringListener(t);}));}attachStringVectorListener(t,e){zo(this,t,e),Vo(this,t,(t=>{this.i._attachStringVectorListener(t);}));}attachProtoListener(t,e,n){Wo(this,t,e),Vo(this,t,(t=>{this.i._attachProtoListener(t,n||!1);}));}attachProtoVectorListener(t,e,n){zo(this,t,e),Vo(this,t,(t=>{this.i._attachProtoVectorListener(t,n||!1);}));}attachAudioListener(t,e,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Wo(this,t,((t,n)=>{t=new Float32Array(t.buffer,t.byteOffset,t.length/4),e(t,n);})),Vo(this,t,(t=>{this.i._attachAudioListener(t,n||!1);}));}finishProcessing(){this.i._waitUntilIdle();}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0;}},class extends za{get fa(){return this.i}ra(t,e,n){Vo(this,e,(e=>{const[r,i]=Xo(this,t,e);this.fa._addBoundTextureAsImageToStream(e,r,i,n);}));}V(t,e){Wo(this,t,e),Vo(this,t,(t=>{this.fa._attachImageListener(t);}));}da(t,e){zo(this,t,e),Vo(this,t,(t=>{this.fa._attachImageVectorListener(t);}));}}));var za,Ka=class extends Wa{};async function Ya(t,e,n){return async function(t,e,n,r){return Ko(t,e,n,r)}(t,n.canvas??(Bo()?void 0:document.createElement("canvas")),e,n)}function $a(t,e,n,r){if(t.U){const s=new _s;if(n?.regionOfInterest){if(!t.qa)throw Error("This task doesn't support region-of-interest.");var i=n.regionOfInterest;if(i.left>=i.right||i.top>=i.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(i.left<0||i.top<0||i.right>1||i.bottom>1)throw Error("Expected RectF values to be in [0,1].");wn$2(s,1,(i.left+i.right)/2),wn$2(s,2,(i.top+i.bottom)/2),wn$2(s,4,i.right-i.left),wn$2(s,3,i.bottom-i.top);}else wn$2(s,1,.5),wn$2(s,2,.5),wn$2(s,4,1),wn$2(s,3,1);if(n?.rotationDegrees){if(n?.rotationDegrees%90!=0)throw Error("Expected rotation to be a multiple of 90°.");if(wn$2(s,5,-Math.PI*n.rotationDegrees/180),n?.rotationDegrees%180!=0){const[t,r]=jo(e);n=yn$2(s,3)*r/t,i=yn$2(s,4)*t/r,wn$2(s,4,n),wn$2(s,3,i);}}t.g.addProtoToStream(s.g(),"mediapipe.NormalizedRect",t.U,r);}t.g.ra(e,t.ba,r??performance.now()),t.finishProcessing();}function qa(t,e,n){if(t.baseOptions?.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");$a(t,e,n,t.B+1);}function Ja(t,e,n,r){if(!t.baseOptions?.g())throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");$a(t,e,n,r);}function Za(t,e,n,r){var i=e.data;const s=e.width,o=s*(e=e.height);if((i instanceof Uint8Array||i instanceof Float32Array)&&i.length!==o)throw Error("Unsupported channel count: "+i.length/o);return t=new Ta([i],n,!1,t.g.i.canvas,t.P,s,e),r?t.clone():t}var Qa=class extends ta{constructor(t,e,n,r){super(t),this.g=t,this.ba=e,this.U=n,this.qa=r,this.P=new ua;}l(t,e=!0){if("runningMode"in t&&vn$2(this.baseOptions,2,!!t.runningMode&&"IMAGE"!==t.runningMode),void 0!==t.canvas&&this.g.i.canvas!==t.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(t,e)}close(){this.P.close(),super.close();}};Qa.prototype.close=Qa.prototype.close;var tc=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect_in",!1),this.j={detections:[]},un$2(t=this.h=new Us,0,1,e=new Ps),wn$2(this.h,2,.5),wn$2(this.h,3,.3);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return "minDetectionConfidence"in t&&wn$2(this.h,2,t.minDetectionConfidence??.5),"minSuppressionThreshold"in t&&wn$2(this.h,3,t.minSuppressionThreshold??.3),this.l(t)}D(t,e){return this.j={detections:[]},qa(this,t,e),this.j}F(t,e,n){return this.j={detections:[]},Ja(this,t,n,e),this.j}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect_in"),ts(t,"detections");const e=new Vi$1;Yn$2(e,Ds,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect_in"),Ki$1(n,"DETECTIONS:detections"),n.o(e),Zi$1(t,n),this.g.attachProtoVectorListener("detections",((t,e)=>{for(const e of t)t=ls(e),this.j.detections.push(Ro(t));qo(this,e);})),this.g.attachEmptyPacketListener("detections",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};tc.prototype.detectForVideo=tc.prototype.F,tc.prototype.detect=tc.prototype.D,tc.prototype.setOptions=tc.prototype.o,tc.createFromModelPath=async function(t,e){return Ya(tc,t,{baseOptions:{modelAssetPath:e}})},tc.createFromModelBuffer=function(t,e){return Ya(tc,t,{baseOptions:{modelAssetBuffer:e}})},tc.createFromOptions=function(t,e){return Ya(tc,t,e)};var ec=Ha([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),nc=Ha([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),rc=Ha([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),ic=Ha([474,475],[475,476],[476,477],[477,474]),sc=Ha([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),oc=Ha([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),ac=Ha([469,470],[470,471],[471,472],[472,469]),cc=Ha([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),hc=[...ec,...nc,...rc,...sc,...oc,...cc],uc=Ha([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function lc(t){t.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]};}var fc=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,un$2(t=this.h=new js,0,1,e=new Ps),this.v=new Gs,un$2(this.h,0,3,this.v),this.s=new Us,un$2(this.h,0,2,this.s),En$2(this.s,4,1),wn$2(this.s,2,.5),wn$2(this.v,2,.5),wn$2(this.h,4,.5);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return "numFaces"in t&&En$2(this.s,4,t.numFaces??1),"minFaceDetectionConfidence"in t&&wn$2(this.s,2,t.minFaceDetectionConfidence??.5),"minTrackingConfidence"in t&&wn$2(this.h,4,t.minTrackingConfidence??.5),"minFacePresenceConfidence"in t&&wn$2(this.v,2,t.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in t&&(this.outputFaceBlendshapes=!!t.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in t&&(this.outputFacialTransformationMatrixes=!!t.outputFacialTransformationMatrixes),this.l(t)}D(t,e){return lc(this),qa(this,t,e),this.j}F(t,e,n){return lc(this),Ja(this,t,n,e),this.j}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect"),ts(t,"face_landmarks");const e=new Vi$1;Yn$2(e,Hs,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"NORM_LANDMARKS:face_landmarks"),n.o(e),Zi$1(t,n),this.g.attachProtoVectorListener("face_landmarks",((t,e)=>{for(const e of t)t=gs(e),this.j.faceLandmarks.push(Fo(t));qo(this,e);})),this.g.attachEmptyPacketListener("face_landmarks",(t=>{qo(this,t);})),this.outputFaceBlendshapes&&(ts(t,"blendshapes"),Ki$1(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",((t,e)=>{if(this.outputFaceBlendshapes)for(const e of t)t=as(e),this.j.faceBlendshapes.push(Lo(t.g()??[]));qo(this,e);})),this.g.attachEmptyPacketListener("blendshapes",(t=>{qo(this,t);}))),this.outputFacialTransformationMatrixes&&(ts(t,"face_geometry"),Ki$1(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",((t,e)=>{if(this.outputFacialTransformationMatrixes)for(const e of t)(t=an$2(Bs(e),ms,2))&&this.j.facialTransformationMatrixes.push({rows:gn$2(mn$2(t,1),0)??0,columns:gn$2(mn$2(t,2),0)??0,data:Ke$2(t,3,Wt$2,ze$2()).slice()??[]});qo(this,e);})),this.g.attachEmptyPacketListener("face_geometry",(t=>{qo(this,t);}))),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};fc.prototype.detectForVideo=fc.prototype.F,fc.prototype.detect=fc.prototype.D,fc.prototype.setOptions=fc.prototype.o,fc.createFromModelPath=function(t,e){return Ya(fc,t,{baseOptions:{modelAssetPath:e}})},fc.createFromModelBuffer=function(t,e){return Ya(fc,t,{baseOptions:{modelAssetBuffer:e}})},fc.createFromOptions=function(t,e){return Ya(fc,t,e)},fc.FACE_LANDMARKS_LIPS=ec,fc.FACE_LANDMARKS_LEFT_EYE=nc,fc.FACE_LANDMARKS_LEFT_EYEBROW=rc,fc.FACE_LANDMARKS_LEFT_IRIS=ic,fc.FACE_LANDMARKS_RIGHT_EYE=sc,fc.FACE_LANDMARKS_RIGHT_EYEBROW=oc,fc.FACE_LANDMARKS_RIGHT_IRIS=ac,fc.FACE_LANDMARKS_FACE_OVAL=cc,fc.FACE_LANDMARKS_CONTOURS=hc,fc.FACE_LANDMARKS_TESSELATION=uc;var dc=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!0),un$2(t=this.j=new Ws,0,1,e=new Ps);}get baseOptions(){return an$2(this.j,Ps,1)}set baseOptions(t){un$2(this.j,0,1,t);}o(t){return super.l(t)}Oa(t,e,n){const r="function"!=typeof e?e:{};if(this.h="function"==typeof e?e:n,qa(this,t,r??{}),!this.h)return this.s}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect"),ts(t,"stylized_image");const e=new Vi$1;Yn$2(e,zs,this.j);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"STYLIZED_IMAGE:stylized_image"),n.o(e),Zi$1(t,n),this.g.V("stylized_image",((t,e)=>{var n=!this.h,r=t.data,i=t.width;const s=i*(t=t.height);if(r instanceof Uint8Array)if(r.length===3*s){const e=new Uint8ClampedArray(4*s);for(let t=0;t<s;++t)e[4*t]=r[3*t],e[4*t+1]=r[3*t+1],e[4*t+2]=r[3*t+2],e[4*t+3]=255;r=new ImageData(e,i,t);}else {if(r.length!==4*s)throw Error("Unsupported channel count: "+r.length/s);r=new ImageData(new Uint8ClampedArray(r.buffer,r.byteOffset,r.length),i,t);}else if(!(r instanceof WebGLTexture))throw Error(`Unsupported format: ${r.constructor.name}`);i=new Va([r],!1,!1,this.g.i.canvas,this.P,i,t),this.s=n=n?i.clone():i,this.h&&this.h(n),qo(this,e);})),this.g.attachEmptyPacketListener("stylized_image",(t=>{this.s=null,this.h&&this.h(null),qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};dc.prototype.stylize=dc.prototype.Oa,dc.prototype.setOptions=dc.prototype.o,dc.createFromModelPath=function(t,e){return Ya(dc,t,{baseOptions:{modelAssetPath:e}})},dc.createFromModelBuffer=function(t,e){return Ya(dc,t,{baseOptions:{modelAssetBuffer:e}})},dc.createFromOptions=function(t,e){return Ya(dc,t,e)};var pc=Ha([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function gc(t){t.gestures=[],t.landmarks=[],t.worldLandmarks=[],t.handedness=[];}function mc(t){return 0===t.gestures.length?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:t.gestures,landmarks:t.landmarks,worldLandmarks:t.worldLandmarks,handedness:t.handedness,handednesses:t.handedness}}function yc(t,e=!0){const n=[];for(const i of t){var r=as(i);t=[];for(const n of r.g())r=e&&null!=mn$2(n,1)?gn$2(mn$2(n,1),0):-1,t.push({score:yn$2(n,2)??0,index:r,categoryName:_n$2(n,3)??"",displayName:_n$2(n,4)??""});n.push(t);}return n}var _c=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],un$2(t=this.j=new Qs,0,1,e=new Ps),this.s=new Zs,un$2(this.j,0,2,this.s),this.C=new Js,un$2(this.s,0,3,this.C),this.v=new qs,un$2(this.s,0,2,this.v),this.h=new $s,un$2(this.j,0,3,this.h),wn$2(this.v,2,.5),wn$2(this.s,4,.5),wn$2(this.C,2,.5);}get baseOptions(){return an$2(this.j,Ps,1)}set baseOptions(t){un$2(this.j,0,1,t);}o(t){if(En$2(this.v,3,t.numHands??1),"minHandDetectionConfidence"in t&&wn$2(this.v,2,t.minHandDetectionConfidence??.5),"minTrackingConfidence"in t&&wn$2(this.s,4,t.minTrackingConfidence??.5),"minHandPresenceConfidence"in t&&wn$2(this.C,2,t.minHandPresenceConfidence??.5),t.cannedGesturesClassifierOptions){var e=new Ks,n=e,r=xo(t.cannedGesturesClassifierOptions,an$2(this.h,Ks,3)?.h());un$2(n,0,2,r),un$2(this.h,0,3,e);}else void 0===t.cannedGesturesClassifierOptions&&an$2(this.h,Ks,3)?.g();return t.customGesturesClassifierOptions?(un$2(n=e=new Ks,0,2,r=xo(t.customGesturesClassifierOptions,an$2(this.h,Ks,4)?.h())),un$2(this.h,0,4,e)):void 0===t.customGesturesClassifierOptions&&an$2(this.h,Ks,4)?.g(),this.l(t)}Ja(t,e){return gc(this),qa(this,t,e),mc(this)}Ka(t,e,n){return gc(this),Ja(this,t,n,e),mc(this)}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect"),ts(t,"hand_gestures"),ts(t,"hand_landmarks"),ts(t,"world_hand_landmarks"),ts(t,"handedness");const e=new Vi$1;Yn$2(e,io,this.j);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"HAND_GESTURES:hand_gestures"),Ki$1(n,"LANDMARKS:hand_landmarks"),Ki$1(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ki$1(n,"HANDEDNESS:handedness"),n.o(e),Zi$1(t,n),this.g.attachProtoVectorListener("hand_landmarks",((t,e)=>{for(const e of t){t=gs(e);const n=[];for(const e of hn$2(t,ps,1))n.push({x:yn$2(e,1)??0,y:yn$2(e,2)??0,z:yn$2(e,3)??0,visibility:yn$2(e,4)??0});this.landmarks.push(n);}qo(this,e);})),this.g.attachEmptyPacketListener("hand_landmarks",(t=>{qo(this,t);})),this.g.attachProtoVectorListener("world_hand_landmarks",((t,e)=>{for(const e of t){t=ds(e);const n=[];for(const e of hn$2(t,fs,1))n.push({x:yn$2(e,1)??0,y:yn$2(e,2)??0,z:yn$2(e,3)??0,visibility:yn$2(e,4)??0});this.worldLandmarks.push(n);}qo(this,e);})),this.g.attachEmptyPacketListener("world_hand_landmarks",(t=>{qo(this,t);})),this.g.attachProtoVectorListener("hand_gestures",((t,e)=>{this.gestures.push(...yc(t,!1)),qo(this,e);})),this.g.attachEmptyPacketListener("hand_gestures",(t=>{qo(this,t);})),this.g.attachProtoVectorListener("handedness",((t,e)=>{this.handedness.push(...yc(t)),qo(this,e);})),this.g.attachEmptyPacketListener("handedness",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};function vc(t){return {landmarks:t.landmarks,worldLandmarks:t.worldLandmarks,handednesses:t.handedness,handedness:t.handedness}}_c.prototype.recognizeForVideo=_c.prototype.Ka,_c.prototype.recognize=_c.prototype.Ja,_c.prototype.setOptions=_c.prototype.o,_c.createFromModelPath=function(t,e){return Ya(_c,t,{baseOptions:{modelAssetPath:e}})},_c.createFromModelBuffer=function(t,e){return Ya(_c,t,{baseOptions:{modelAssetBuffer:e}})},_c.createFromOptions=function(t,e){return Ya(_c,t,e)},_c.HAND_CONNECTIONS=pc;var Ec=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],un$2(t=this.h=new Zs,0,1,e=new Ps),this.s=new Js,un$2(this.h,0,3,this.s),this.j=new qs,un$2(this.h,0,2,this.j),En$2(this.j,3,1),wn$2(this.j,2,.5),wn$2(this.s,2,.5),wn$2(this.h,4,.5);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return "numHands"in t&&En$2(this.j,3,t.numHands??1),"minHandDetectionConfidence"in t&&wn$2(this.j,2,t.minHandDetectionConfidence??.5),"minTrackingConfidence"in t&&wn$2(this.h,4,t.minTrackingConfidence??.5),"minHandPresenceConfidence"in t&&wn$2(this.s,2,t.minHandPresenceConfidence??.5),this.l(t)}D(t,e){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],qa(this,t,e),vc(this)}F(t,e,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ja(this,t,n,e),vc(this)}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect"),ts(t,"hand_landmarks"),ts(t,"world_hand_landmarks"),ts(t,"handedness");const e=new Vi$1;Yn$2(e,so,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"LANDMARKS:hand_landmarks"),Ki$1(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ki$1(n,"HANDEDNESS:handedness"),n.o(e),Zi$1(t,n),this.g.attachProtoVectorListener("hand_landmarks",((t,e)=>{for(const e of t)t=gs(e),this.landmarks.push(Fo(t));qo(this,e);})),this.g.attachEmptyPacketListener("hand_landmarks",(t=>{qo(this,t);})),this.g.attachProtoVectorListener("world_hand_landmarks",((t,e)=>{for(const e of t)t=ds(e),this.worldLandmarks.push(Io(t));qo(this,e);})),this.g.attachEmptyPacketListener("world_hand_landmarks",(t=>{qo(this,t);})),this.g.attachProtoVectorListener("handedness",((t,e)=>{var n=this.handedness,r=n.push;const i=[];for(const e of t){t=as(e);const n=[];for(const e of t.g())n.push({score:yn$2(e,2)??0,index:gn$2(mn$2(e,1),0)??-1,categoryName:_n$2(e,3)??"",displayName:_n$2(e,4)??""});i.push(n);}r.call(n,...i),qo(this,e);})),this.g.attachEmptyPacketListener("handedness",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};Ec.prototype.detectForVideo=Ec.prototype.F,Ec.prototype.detect=Ec.prototype.D,Ec.prototype.setOptions=Ec.prototype.o,Ec.createFromModelPath=function(t,e){return Ya(Ec,t,{baseOptions:{modelAssetPath:e}})},Ec.createFromModelBuffer=function(t,e){return Ya(Ec,t,{baseOptions:{modelAssetBuffer:e}})},Ec.createFromOptions=function(t,e){return Ya(Ec,t,e)},Ec.HAND_CONNECTIONS=pc;var wc=Ha([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function Tc(t){t.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]};}function bc(t){try{if(!t.C)return t.h;t.C(t.h);}finally{Qo(t);}}function Ac(t,e){t=gs(t),e.push(Fo(t));}var kc=class extends Qa{constructor(t,e){super(new Ka(t,e),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,un$2(t=this.j=new ho,0,1,e=new Ps),this.K=new Js,un$2(this.j,0,2,this.K),this.aa=new oo,un$2(this.j,0,3,this.aa),this.s=new Us,un$2(this.j,0,4,this.s),this.I=new Gs,un$2(this.j,0,5,this.I),this.v=new ao,un$2(this.j,0,6,this.v),this.L=new co,un$2(this.j,0,7,this.L),wn$2(this.s,2,.5),wn$2(this.s,3,.3),wn$2(this.I,2,.5),wn$2(this.v,2,.5),wn$2(this.v,3,.3),wn$2(this.L,2,.5),wn$2(this.K,2,.5);}get baseOptions(){return an$2(this.j,Ps,1)}set baseOptions(t){un$2(this.j,0,1,t);}o(t){return "minFaceDetectionConfidence"in t&&wn$2(this.s,2,t.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in t&&wn$2(this.s,3,t.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in t&&wn$2(this.I,2,t.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in t&&(this.outputFaceBlendshapes=!!t.outputFaceBlendshapes),"minPoseDetectionConfidence"in t&&wn$2(this.v,2,t.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in t&&wn$2(this.v,3,t.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in t&&wn$2(this.L,2,t.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in t&&(this.outputPoseSegmentationMasks=!!t.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in t&&wn$2(this.K,2,t.minHandLandmarksConfidence??.5),this.l(t)}D(t,e,n){const r="function"!=typeof e?e:{};return this.C="function"==typeof e?e:n,Tc(this),qa(this,t,r),bc(this)}F(t,e,n,r){const i="function"!=typeof n?n:{};return this.C="function"==typeof n?n:r,Tc(this),Ja(this,t,i,e),bc(this)}m(){var t=new es;Qi$1(t,"input_frames_image"),ts(t,"pose_landmarks"),ts(t,"pose_world_landmarks"),ts(t,"face_landmarks"),ts(t,"left_hand_landmarks"),ts(t,"left_hand_world_landmarks"),ts(t,"right_hand_landmarks"),ts(t,"right_hand_world_landmarks");const e=new Vi$1,n=new Ri$1;Ze$2(n,1,re$2("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(t,e){if(null!=e)if(Array.isArray(e))Ve$2(t,2,Me$2(e,Oe$2,void 0,void 0,!1));else {if(!("string"==typeof e||e instanceof B$2||C$2(e)))throw Error("invalid value in Any.value field: "+e+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");Ze$2(t,2,dt$2(e,!1),N$2());}}(n,this.j.g());const r=new Yi$1;Wi$1(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),pn$2(r,8,Ri$1,n),zi$1(r,"IMAGE:input_frames_image"),Ki$1(r,"POSE_LANDMARKS:pose_landmarks"),Ki$1(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Ki$1(r,"FACE_LANDMARKS:face_landmarks"),Ki$1(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Ki$1(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Ki$1(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Ki$1(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(e),Zi$1(t,r),Jo(this,t),this.g.attachProtoListener("pose_landmarks",((t,e)=>{Ac(t,this.h.poseLandmarks),qo(this,e);})),this.g.attachEmptyPacketListener("pose_landmarks",(t=>{qo(this,t);})),this.g.attachProtoListener("pose_world_landmarks",((t,e)=>{var n=this.h.poseWorldLandmarks;t=ds(t),n.push(Io(t)),qo(this,e);})),this.g.attachEmptyPacketListener("pose_world_landmarks",(t=>{qo(this,t);})),this.outputPoseSegmentationMasks&&(Ki$1(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),Zo(this,"pose_segmentation_mask"),this.g.V("pose_segmentation_mask",((t,e)=>{this.h.poseSegmentationMasks=[Za(this,t,!0,!this.C)],qo(this,e);})),this.g.attachEmptyPacketListener("pose_segmentation_mask",(t=>{this.h.poseSegmentationMasks=[],qo(this,t);}))),this.g.attachProtoListener("face_landmarks",((t,e)=>{Ac(t,this.h.faceLandmarks),qo(this,e);})),this.g.attachEmptyPacketListener("face_landmarks",(t=>{qo(this,t);})),this.outputFaceBlendshapes&&(ts(t,"extra_blendshapes"),Ki$1(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",((t,e)=>{var n=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(t=as(t),n.push(Lo(t.g()??[]))),qo(this,e);})),this.g.attachEmptyPacketListener("extra_blendshapes",(t=>{qo(this,t);}))),this.g.attachProtoListener("left_hand_landmarks",((t,e)=>{Ac(t,this.h.leftHandLandmarks),qo(this,e);})),this.g.attachEmptyPacketListener("left_hand_landmarks",(t=>{qo(this,t);})),this.g.attachProtoListener("left_hand_world_landmarks",((t,e)=>{var n=this.h.leftHandWorldLandmarks;t=ds(t),n.push(Io(t)),qo(this,e);})),this.g.attachEmptyPacketListener("left_hand_world_landmarks",(t=>{qo(this,t);})),this.g.attachProtoListener("right_hand_landmarks",((t,e)=>{Ac(t,this.h.rightHandLandmarks),qo(this,e);})),this.g.attachEmptyPacketListener("right_hand_landmarks",(t=>{qo(this,t);})),this.g.attachProtoListener("right_hand_world_landmarks",((t,e)=>{var n=this.h.rightHandWorldLandmarks;t=ds(t),n.push(Io(t)),qo(this,e);})),this.g.attachEmptyPacketListener("right_hand_world_landmarks",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};kc.prototype.detectForVideo=kc.prototype.F,kc.prototype.detect=kc.prototype.D,kc.prototype.setOptions=kc.prototype.o,kc.createFromModelPath=function(t,e){return Ya(kc,t,{baseOptions:{modelAssetPath:e}})},kc.createFromModelBuffer=function(t,e){return Ya(kc,t,{baseOptions:{modelAssetBuffer:e}})},kc.createFromOptions=function(t,e){return Ya(kc,t,e)},kc.HAND_CONNECTIONS=pc,kc.POSE_CONNECTIONS=wc,kc.FACE_LANDMARKS_LIPS=ec,kc.FACE_LANDMARKS_LEFT_EYE=nc,kc.FACE_LANDMARKS_LEFT_EYEBROW=rc,kc.FACE_LANDMARKS_LEFT_IRIS=ic,kc.FACE_LANDMARKS_RIGHT_EYE=sc,kc.FACE_LANDMARKS_RIGHT_EYEBROW=oc,kc.FACE_LANDMARKS_RIGHT_IRIS=ac,kc.FACE_LANDMARKS_FACE_OVAL=cc,kc.FACE_LANDMARKS_CONTOURS=hc,kc.FACE_LANDMARKS_TESSELATION=uc;var Sc=class extends Qa{constructor(t,e){super(new Ka(t,e),"input_image","norm_rect",!0),this.j={classifications:[]},un$2(t=this.h=new fo,0,1,e=new Ps);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return un$2(this.h,0,2,xo(t,an$2(this.h,Ss,2))),this.l(t)}ta(t,e){return this.j={classifications:[]},qa(this,t,e),this.j}ua(t,e,n){return this.j={classifications:[]},Ja(this,t,n,e),this.j}m(){var t=new es;Qi$1(t,"input_image"),Qi$1(t,"norm_rect"),ts(t,"classifications");const e=new Vi$1;Yn$2(e,po,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),zi$1(n,"IMAGE:input_image"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"CLASSIFICATIONS:classifications"),n.o(e),Zi$1(t,n),this.g.attachProtoListener("classifications",((t,e)=>{this.j=function(t){const e={classifications:hn$2(t,vs,1).map((t=>Lo(an$2(t,ss,4)?.g()??[],gn$2(mn$2(t,2),0),_n$2(t,3))))};return null!=te$2(Be$2(t,2))&&(e.timestampMs=gn$2(te$2(Be$2(t,2)),0)),e}(Es(t)),qo(this,e);})),this.g.attachEmptyPacketListener("classifications",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};Sc.prototype.classifyForVideo=Sc.prototype.ua,Sc.prototype.classify=Sc.prototype.ta,Sc.prototype.setOptions=Sc.prototype.o,Sc.createFromModelPath=function(t,e){return Ya(Sc,t,{baseOptions:{modelAssetPath:e}})},Sc.createFromModelBuffer=function(t,e){return Ya(Sc,t,{baseOptions:{modelAssetBuffer:e}})},Sc.createFromOptions=function(t,e){return Ya(Sc,t,e)};var xc=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!0),this.h=new go,this.embeddings={embeddings:[]},un$2(t=this.h,0,1,e=new Ps);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){var e=this.h,n=an$2(this.h,Ls,2);return n=n?n.clone():new Ls,void 0!==t.l2Normalize?vn$2(n,1,t.l2Normalize):"l2Normalize"in t&&Ve$2(n,1),void 0!==t.quantize?vn$2(n,2,t.quantize):"quantize"in t&&Ve$2(n,2),un$2(e,0,2,n),this.l(t)}Aa(t,e){return qa(this,t,e),this.embeddings}Ba(t,e,n){return Ja(this,t,n,e),this.embeddings}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect"),ts(t,"embeddings_out");const e=new Vi$1;Yn$2(e,mo,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"EMBEDDINGS:embeddings_out"),n.o(e),Zi$1(t,n),this.g.attachProtoListener("embeddings_out",((t,e)=>{t=ks(t),this.embeddings=function(t){return {embeddings:hn$2(t,bs,1).map((t=>{const e={headIndex:gn$2(mn$2(t,3),0)??-1,headName:_n$2(t,4)??""};if(void 0!==on$2(t,ws,tn$2(t,1)))t=Ke$2(t=an$2(t,ws,tn$2(t,1)),1,Wt$2,ze$2()),e.floatEmbedding=t.slice();else {const n=new Uint8Array(0);e.quantizedEmbedding=an$2(t,Ts,tn$2(t,2))?.pa()?.h()??n;}return e})),timestampMs:gn$2(te$2(Be$2(t,2)),0)}}(t),qo(this,e);})),this.g.attachEmptyPacketListener("embeddings_out",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};xc.cosineSimilarity=function(t,e){if(t.floatEmbedding&&e.floatEmbedding)t=Po(t.floatEmbedding,e.floatEmbedding);else {if(!t.quantizedEmbedding||!e.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");t=Po(Mo(t.quantizedEmbedding),Mo(e.quantizedEmbedding));}return t},xc.prototype.embedForVideo=xc.prototype.Ba,xc.prototype.embed=xc.prototype.Aa,xc.prototype.setOptions=xc.prototype.o,xc.createFromModelPath=function(t,e){return Ya(xc,t,{baseOptions:{modelAssetPath:e}})},xc.createFromModelBuffer=function(t,e){return Ya(xc,t,{baseOptions:{modelAssetBuffer:e}})},xc.createFromOptions=function(t,e){return Ya(xc,t,e)};var Lc=class{constructor(t,e,n){this.confidenceMasks=t,this.categoryMask=e,this.qualityScores=n;}close(){this.confidenceMasks?.forEach((t=>{t.close();})),this.categoryMask?.close();}};function Rc(t){t.categoryMask=void 0,t.confidenceMasks=void 0,t.qualityScores=void 0;}function Fc(t){try{const e=new Lc(t.confidenceMasks,t.categoryMask,t.qualityScores);if(!t.j)return e;t.j(e);}finally{Qo(t);}}Lc.prototype.close=Lc.prototype.close;var Ic=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new wo,this.v=new yo,un$2(this.h,0,3,this.v),un$2(t=this.h,0,1,e=new Ps);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return void 0!==t.displayNamesLocale?Ve$2(this.h,2,re$2(t.displayNamesLocale)):"displayNamesLocale"in t&&Ve$2(this.h,2),"outputCategoryMask"in t&&(this.outputCategoryMask=t.outputCategoryMask??!1),"outputConfidenceMasks"in t&&(this.outputConfidenceMasks=t.outputConfidenceMasks??!0),super.l(t)}J(){!function(t){const e=hn$2(t.ea(),Yi$1,1).filter((t=>_n$2(t,1).includes("mediapipe.tasks.TensorsToSegmentationCalculator")));if(t.s=[],e.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");1===e.length&&(an$2(e[0],Vi$1,7)?.l()?.g()??new Map).forEach(((e,n)=>{t.s[Number(n)]=_n$2(e,1);}));}(this);}segment(t,e,n){const r="function"!=typeof e?e:{};return this.j="function"==typeof e?e:n,Rc(this),qa(this,t,r),Fc(this)}Ma(t,e,n,r){const i="function"!=typeof n?n:{};return this.j="function"==typeof n?n:r,Rc(this),Ja(this,t,i,e),Fc(this)}Ea(){return this.s}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect");const e=new Vi$1;Yn$2(e,To,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),n.o(e),Zi$1(t,n),Jo(this,t),this.outputConfidenceMasks&&(ts(t,"confidence_masks"),Ki$1(n,"CONFIDENCE_MASKS:confidence_masks"),Zo(this,"confidence_masks"),this.g.da("confidence_masks",((t,e)=>{this.confidenceMasks=t.map((t=>Za(this,t,!0,!this.j))),qo(this,e);})),this.g.attachEmptyPacketListener("confidence_masks",(t=>{this.confidenceMasks=[],qo(this,t);}))),this.outputCategoryMask&&(ts(t,"category_mask"),Ki$1(n,"CATEGORY_MASK:category_mask"),Zo(this,"category_mask"),this.g.V("category_mask",((t,e)=>{this.categoryMask=Za(this,t,!1,!this.j),qo(this,e);})),this.g.attachEmptyPacketListener("category_mask",(t=>{this.categoryMask=void 0,qo(this,t);}))),ts(t,"quality_scores"),Ki$1(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((t,e)=>{this.qualityScores=t,qo(this,e);})),this.g.attachEmptyPacketListener("quality_scores",(t=>{this.categoryMask=void 0,qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};Ic.prototype.getLabels=Ic.prototype.Ea,Ic.prototype.segmentForVideo=Ic.prototype.Ma,Ic.prototype.segment=Ic.prototype.segment,Ic.prototype.setOptions=Ic.prototype.o,Ic.createFromModelPath=function(t,e){return Ya(Ic,t,{baseOptions:{modelAssetPath:e}})},Ic.createFromModelBuffer=function(t,e){return Ya(Ic,t,{baseOptions:{modelAssetBuffer:e}})},Ic.createFromOptions=function(t,e){return Ya(Ic,t,e)};var Mc=class{constructor(t,e,n){this.confidenceMasks=t,this.categoryMask=e,this.qualityScores=n;}close(){this.confidenceMasks?.forEach((t=>{t.close();})),this.categoryMask?.close();}};Mc.prototype.close=Mc.prototype.close;var Pc=class extends $n$2{constructor(t){super(t);}},Oc=[0,li$1,-2],Cc=[0,ii$1,-3,pi$1,ii$1,-1],Uc=[0,Cc],Nc=[0,Cc,li$1,-1],Dc=class extends $n$2{constructor(t){super(t);}},Bc=[0,ii$1,-1,pi$1],Gc=class extends $n$2{constructor(){super();}},jc=class extends $n$2{constructor(t){super(t);}},Vc=[1,2,3,4,5,6,7,8,9,10,14,15],Xc=class extends $n$2{constructor(){super();}};Xc.prototype.g=Li$1([0,vi$1,[0,Vc,Ei$1,Cc,Ei$1,[0,Cc,Oc],Ei$1,Uc,Ei$1,[0,Uc,Oc],Ei$1,Bc,Ei$1,[0,ii$1,-3,pi$1,Ai$1],Ei$1,[0,ii$1,-3,pi$1],Ei$1,[0,_i$1,ii$1,-2,pi$1,li$1,pi$1,-1,2,ii$1,Oc],Ei$1,Nc,Ei$1,[0,Nc,Oc],ii$1,Oc,_i$1,Ei$1,[0,ii$1,-3,pi$1,Oc,-1],Ei$1,[0,vi$1,Bc]],_i$1,[0,_i$1,li$1,-1,pi$1]]);var Hc=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new wo,this.s=new yo,un$2(this.h,0,3,this.s),un$2(t=this.h,0,1,e=new Ps);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return "outputCategoryMask"in t&&(this.outputCategoryMask=t.outputCategoryMask??!1),"outputConfidenceMasks"in t&&(this.outputConfidenceMasks=t.outputConfidenceMasks??!0),super.l(t)}segment(t,e,n,r){const i="function"!=typeof n?n:{};this.j="function"==typeof n?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new Xc;const s=new jc;var o=new Pc;if(En$2(o,1,255),un$2(s,0,12,o),e.keypoint&&e.scribble)throw Error("Cannot provide both keypoint and scribble.");if(e.keypoint){var a=new Dc;vn$2(a,3,!0),wn$2(a,1,e.keypoint.x),wn$2(a,2,e.keypoint.y),ln$2(s,5,Vc,a);}else {if(!e.scribble)throw Error("Must provide either a keypoint or a scribble.");for(a of(o=new Gc,e.scribble))vn$2(e=new Dc,3,!0),wn$2(e,1,a.x),wn$2(e,2,a.y),pn$2(o,1,Dc,e);ln$2(s,15,Vc,o);}pn$2(r,1,jc,s),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),qa(this,t,i);t:{try{const t=new Mc(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var c=t;break t}this.j(t);}finally{Qo(this);}c=void 0;}return c}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"roi_in"),Qi$1(t,"norm_rect_in");const e=new Vi$1;Yn$2(e,To,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"ROI:roi_in"),zi$1(n,"NORM_RECT:norm_rect_in"),n.o(e),Zi$1(t,n),Jo(this,t),this.outputConfidenceMasks&&(ts(t,"confidence_masks"),Ki$1(n,"CONFIDENCE_MASKS:confidence_masks"),Zo(this,"confidence_masks"),this.g.da("confidence_masks",((t,e)=>{this.confidenceMasks=t.map((t=>Za(this,t,!0,!this.j))),qo(this,e);})),this.g.attachEmptyPacketListener("confidence_masks",(t=>{this.confidenceMasks=[],qo(this,t);}))),this.outputCategoryMask&&(ts(t,"category_mask"),Ki$1(n,"CATEGORY_MASK:category_mask"),Zo(this,"category_mask"),this.g.V("category_mask",((t,e)=>{this.categoryMask=Za(this,t,!1,!this.j),qo(this,e);})),this.g.attachEmptyPacketListener("category_mask",(t=>{this.categoryMask=void 0,qo(this,t);}))),ts(t,"quality_scores"),Ki$1(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((t,e)=>{this.qualityScores=t,qo(this,e);})),this.g.attachEmptyPacketListener("quality_scores",(t=>{this.categoryMask=void 0,qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};Hc.prototype.segment=Hc.prototype.segment,Hc.prototype.setOptions=Hc.prototype.o,Hc.createFromModelPath=function(t,e){return Ya(Hc,t,{baseOptions:{modelAssetPath:e}})},Hc.createFromModelBuffer=function(t,e){return Ya(Hc,t,{baseOptions:{modelAssetBuffer:e}})},Hc.createFromOptions=function(t,e){return Ya(Hc,t,e)};var Wc=class extends Qa{constructor(t,e){super(new Ka(t,e),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},un$2(t=this.h=new bo,0,1,e=new Ps);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return void 0!==t.displayNamesLocale?Ve$2(this.h,2,re$2(t.displayNamesLocale)):"displayNamesLocale"in t&&Ve$2(this.h,2),void 0!==t.maxResults?En$2(this.h,3,t.maxResults):"maxResults"in t&&Ve$2(this.h,3),void 0!==t.scoreThreshold?wn$2(this.h,4,t.scoreThreshold):"scoreThreshold"in t&&Ve$2(this.h,4),void 0!==t.categoryAllowlist?Tn$2(this.h,5,t.categoryAllowlist):"categoryAllowlist"in t&&Ve$2(this.h,5),void 0!==t.categoryDenylist?Tn$2(this.h,6,t.categoryDenylist):"categoryDenylist"in t&&Ve$2(this.h,6),this.l(t)}D(t,e){return this.j={detections:[]},qa(this,t,e),this.j}F(t,e,n){return this.j={detections:[]},Ja(this,t,n,e),this.j}m(){var t=new es;Qi$1(t,"input_frame_gpu"),Qi$1(t,"norm_rect"),ts(t,"detections");const e=new Vi$1;Yn$2(e,Ao,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),zi$1(n,"IMAGE:input_frame_gpu"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"DETECTIONS:detections"),n.o(e),Zi$1(t,n),this.g.attachProtoVectorListener("detections",((t,e)=>{for(const e of t)t=ls(e),this.j.detections.push(Ro(t));qo(this,e);})),this.g.attachEmptyPacketListener("detections",(t=>{qo(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};Wc.prototype.detectForVideo=Wc.prototype.F,Wc.prototype.detect=Wc.prototype.D,Wc.prototype.setOptions=Wc.prototype.o,Wc.createFromModelPath=async function(t,e){return Ya(Wc,t,{baseOptions:{modelAssetPath:e}})},Wc.createFromModelBuffer=function(t,e){return Ya(Wc,t,{baseOptions:{modelAssetBuffer:e}})},Wc.createFromOptions=function(t,e){return Ya(Wc,t,e)};var zc=class{constructor(t,e,n){this.landmarks=t,this.worldLandmarks=e,this.segmentationMasks=n;}close(){this.segmentationMasks?.forEach((t=>{t.close();}));}};function Kc(t){t.landmarks=[],t.worldLandmarks=[],t.segmentationMasks=void 0;}function Yc(t){try{const e=new zc(t.landmarks,t.worldLandmarks,t.segmentationMasks);if(!t.s)return e;t.s(e);}finally{Qo(t);}}zc.prototype.close=zc.prototype.close;var $c=class extends Qa{constructor(t,e){super(new Ka(t,e),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,un$2(t=this.h=new ko,0,1,e=new Ps),this.v=new co,un$2(this.h,0,3,this.v),this.j=new ao,un$2(this.h,0,2,this.j),En$2(this.j,4,1),wn$2(this.j,2,.5),wn$2(this.v,2,.5),wn$2(this.h,4,.5);}get baseOptions(){return an$2(this.h,Ps,1)}set baseOptions(t){un$2(this.h,0,1,t);}o(t){return "numPoses"in t&&En$2(this.j,4,t.numPoses??1),"minPoseDetectionConfidence"in t&&wn$2(this.j,2,t.minPoseDetectionConfidence??.5),"minTrackingConfidence"in t&&wn$2(this.h,4,t.minTrackingConfidence??.5),"minPosePresenceConfidence"in t&&wn$2(this.v,2,t.minPosePresenceConfidence??.5),"outputSegmentationMasks"in t&&(this.outputSegmentationMasks=t.outputSegmentationMasks??!1),this.l(t)}D(t,e,n){const r="function"!=typeof e?e:{};return this.s="function"==typeof e?e:n,Kc(this),qa(this,t,r),Yc(this)}F(t,e,n,r){const i="function"!=typeof n?n:{};return this.s="function"==typeof n?n:r,Kc(this),Ja(this,t,i,e),Yc(this)}m(){var t=new es;Qi$1(t,"image_in"),Qi$1(t,"norm_rect"),ts(t,"normalized_landmarks"),ts(t,"world_landmarks"),ts(t,"segmentation_masks");const e=new Vi$1;Yn$2(e,So,this.h);const n=new Yi$1;Wi$1(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),zi$1(n,"IMAGE:image_in"),zi$1(n,"NORM_RECT:norm_rect"),Ki$1(n,"NORM_LANDMARKS:normalized_landmarks"),Ki$1(n,"WORLD_LANDMARKS:world_landmarks"),n.o(e),Zi$1(t,n),Jo(this,t),this.g.attachProtoVectorListener("normalized_landmarks",((t,e)=>{this.landmarks=[];for(const e of t)t=gs(e),this.landmarks.push(Fo(t));qo(this,e);})),this.g.attachEmptyPacketListener("normalized_landmarks",(t=>{this.landmarks=[],qo(this,t);})),this.g.attachProtoVectorListener("world_landmarks",((t,e)=>{this.worldLandmarks=[];for(const e of t)t=ds(e),this.worldLandmarks.push(Io(t));qo(this,e);})),this.g.attachEmptyPacketListener("world_landmarks",(t=>{this.worldLandmarks=[],qo(this,t);})),this.outputSegmentationMasks&&(Ki$1(n,"SEGMENTATION_MASK:segmentation_masks"),Zo(this,"segmentation_masks"),this.g.da("segmentation_masks",((t,e)=>{this.segmentationMasks=t.map((t=>Za(this,t,!0,!this.s))),qo(this,e);})),this.g.attachEmptyPacketListener("segmentation_masks",(t=>{this.segmentationMasks=[],qo(this,t);}))),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};$c.prototype.detectForVideo=$c.prototype.F,$c.prototype.detect=$c.prototype.D,$c.prototype.setOptions=$c.prototype.o,$c.createFromModelPath=function(t,e){return Ya($c,t,{baseOptions:{modelAssetPath:e}})},$c.createFromModelBuffer=function(t,e){return Ya($c,t,{baseOptions:{modelAssetBuffer:e}})},$c.createFromOptions=function(t,e){return Ya($c,t,e)},$c.POSE_CONNECTIONS=wc;

  class Player extends Lightning.Component {
    static _template() {
      return {
        alpha: 1,
        rect: true,
        color: colors.background,
        w: App$1.width,
        h: App$1.height
      };
    }
    _init() {
      VideoPlayer.consumer(this);
    }
    _focus() {
      this.patch({
        alpha: 1
      });
    }
    _unfocus() {
      this.patch({
        alpha: 0
      });
    }
    initializePlayback() {
      this.widgets.progressbar.ClearTimeInterval();
      this.widgets.playercontrols.patchTitle = '';
      this.widgets.loader.alpha = 0;
      this.widgets.progressbar.dimensions = [Player.width, Player.height];
      this.playing = true;
      this.skipLength = 10;
      this.buttonData = this.buttonsdata();
      this.widgets.playercontrols.setIndexToDefault();
      this.widgets.playercontrols.data = {
        data: this.buttonData,
        index: 0
      };
      this.widgets.progressbar.dimensions = [Player.width, Player.height];
      this.widgets.progressbar.alpha = 1;
      this.status = 'loaded';
      this.dash = Dash.MediaPlayer().create();
      this.videoEl = VideoPlayer._videoEl;
      this.play();
      // Call object detection after playback is initialized
      this._createObjDetection();
    }
    buttonsdata() {
      const buttonData = [{
        action: 'play',
        y: 50,
        mountX: 0.5,
        mountY: 0.5,
        color: colors.focusBorderColor
      }, {
        action: 'centerButtons',
        alpha: this.widgets.loader.alpha ? 0 : 1,
        src: rewindImage
      }, {
        action: 'centerButtons',
        alpha: this.widgets.loader.alpha ? 0 : 1,
        src: this.playing ? pauseImageCenter : playImageCenter
      }, {
        action: 'centerButtons',
        alpha: this.widgets.loader.alpha ? 0 : 1,
        src: forwardImage
      }];
      const playButton = buttonData[0];
      if (this.playing) {
        playButton.src = this.actionFocussed === 'play' ? pauseHighlight : pausePlain;
      } else {
        playButton.src = this.actionFocussed === 'play' ? playHighlight : playPlain;
      }
      return buttonData;
    }
    iconChangeOnFocusedFunc(action) {
      this.actionFocussed = action;
      this.buttonData = this.buttonsdata();
      this.widgets.playercontrols.updateBtns = {
        data: this.buttonData
      };
    }
    play() {
      this.seeked = false;
      this.dash.initialize(this.videoEl, null, false);
      this.dash.attachView(this.videoEl);
      this.dash.attachSource(playbackURL);
      this.videoEl.onplay = () => {
        Router.getActivePage().widgets.progressbar.showOrHideProgressBarDot(false);
      };
      this.videoEl.onloadstart = () => {
        Router.getActivePage().widgets.progressbar.showOrHideProgressBarDot(false);
      };
      this.videoEl.onloadedmetadata = () => {
        Router.getActivePage().widgets.progressbar.updateData([VideoPlayer.duration, VideoPlayer.currentTime]);
        Router.getActivePage().widgets.progressbar.showOrHideProgressBarDot(false);
        VideoPlayer.show();
        VideoPlayer.play();
        setTimeout(() => {
          this.patch({
            rect: false
          });
        }, 1000);
        this.buttonData = this.buttonsdata();
        this.widgets.playercontrols.data = {
          data: this.buttonData,
          index: 0
        };
        Router.focusWidget('PlayerControls');
      };
      this.videoEl.ontimeupdate = () => {
        this.widgets.progressbar.updateData([VideoPlayer.duration, VideoPlayer.currentTime]);
        this.barTime = VideoPlayer.currentTime;
      };
      this.videoEl.onended = () => {
        Router.getActivePage().widgets.progressbar.showOrHideProgressBarDot(false);
        VideoPlayer.close();
        this.patch({
          rect: true
        });
        Router.back();
        this.dash.destroy();
      };
      this.videoEl.onplaying = () => {
        Router.getActivePage().widgets.progressbar.showOrHideProgressBarDot(true);
      };
      const videoDate = new Date();
      this.videoStartTime = videoDate;
      setTimeout(() => {
        this.widgets.playercontrols.setSmooth('alpha', 0);
        this.widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _handleBack() {
      this.widgets.loader.alpha = 1;
      this.buttonData = this.buttonsdata();
      this.widgets.playercontrols.data = {
        data: this.buttonData,
        index: 0
      };
      this.widgets.progressbar.alpha = 0;
      this.widgets.playercontrols.alpha = 0;
      this.dash.destroy();
      VideoPlayer.close();
      this.patch({
        rect: true
      });
      Router.back();
    }
    $backDetails() {
      this.dash.destroy();
      VideoPlayer.close();
      this.patch({
        rect: true
      });
    }
    _getFocused() {
      return Router.focusWidget('PlayerControls');
    }
    _handlePlay() {
      clearTimeout(this.timer);
      this.widgets.loader.alpha = 0;
      this.widgets.progressbar.setSmooth('alpha', 1);
      this.widgets.playercontrols.setSmooth('alpha', 1);
      this.widgets.playercontrols._play();
      VideoPlayer.play();
      this.status = 'play';
      this.playing = true;
      this.hideControls();
    }
    hideControls() {
      this.buttonData = this.buttonsdata();
      this.widgets.playercontrols.data = {
        data: this.buttonData,
        index: 0
      };
      this.timer = setTimeout(() => {
        this.widgets.playercontrols.setSmooth('alpha', 0);
        this.widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _handlePause() {
      clearTimeout(this.timer);
      this.widgets.loader.alpha = 0;
      this.widgets.progressbar.setSmooth('alpha', 1);
      this.widgets.playercontrols.setSmooth('alpha', 1);
      this.widgets.playercontrols._pause();
      VideoPlayer.pause();
      this.status = 'pause';
      this.playing = false;
      this.hideControls();
    }
    _handlePlayPause() {
      this.status = this.status == 'pause' ? 'play' : 'pause';
      clearTimeout(this.timer);
      this.widgets.loader.alpha = 0;
      this.widgets.progressbar.setSmooth('alpha', 1);
      this.widgets.playercontrols.setSmooth('alpha', 1);
      if (this.status == 'pause') {
        VideoPlayer.pause();
        this.playing = false;
      } else {
        VideoPlayer.play();
        this.playing = true;
      }
      this.buttonData = this.buttonsdata();
      this.widgets.playercontrols.data = {
        data: this.buttonData,
        index: 0
      };
      this.timer = setTimeout(() => {
        this.widgets.playercontrols.setSmooth('alpha', 0);
        this.widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _handleStop() {
      clearTimeout(this.timer);
      this.widgets.progressbar.setSmooth('alpha', 1);
      this.widgets.playercontrols.setSmooth('alpha', 1);
      VideoPlayer.close();
      this.patch({
        rect: true
      });
      this.timer = setTimeout(() => {
        this.widgets.playercontrols.setSmooth('alpha', 0);
        this.widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _handleRewind() {
      this.showControls();
      this.barTime = VideoPlayer.currentTime - this.skipLength;
      VideoPlayer.pause();
      if (VideoPlayer.currentTime <= 0 || this.barTime < 0) {
        this.widgets.progressbar.updateData([VideoPlayer.duration, 0]);
        VideoPlayer.seek(0);
      } else {
        this.widgets.progressbar.updateData([VideoPlayer.duration, this.barTime]);
        VideoPlayer.seek(Math.ceil(this.barTime));
      }
      this.startPlayback();
    }
    _handleForward() {
      this.showControls();
      VideoPlayer.pause();
      if (VideoPlayer.currentTime + this.skipLength >= VideoPlayer.duration - 5) {
        this.widgets.progressbar.updateData([VideoPlayer.duration, VideoPlayer.duration - 5]);
        VideoPlayer.seek(VideoPlayer.duration - 5);
      } else {
        this.barTime = VideoPlayer.currentTime + this.skipLength;
        VideoPlayer.seek(this.barTime);
        this.widgets.progressbar.updateData([VideoPlayer.duration, this.barTime]);
      }
      this.startPlayback();
    }
    showControls() {
      clearTimeout(this.timer);
      this.widgets.progressbar.setSmooth('alpha', 1);
      this.widgets.playercontrols.setSmooth('alpha', 1);
      this.widgets.loader.alpha = 1;
    }
    startPlayback() {
      this.playing = true;
      this.buttonData = this.buttonsdata();
      this.widgets.playercontrols.data = {
        data: this.buttonData,
        index: 0
      };
      this.timer = setTimeout(() => {
        this.widgets.loader.alpha = 0;
        VideoPlayer.play();
        this.status = 'play';
        this.playing = true;
        this.widgets.playercontrols.setSmooth('alpha', 0);
        this.widgets.progressbar.setSmooth('alpha', 0);
      }, 2000);
    }
    $playPause(value) {
      switch (value) {
        case 'play':
          {
            this._handlePlayPause();
            break;
          }
        case 'rewind':
          {
            this._handleRewind();
            break;
          }
        case 'forward':
          {
            this._handleForward();
            break;
          }
      }
    }
    $videoPlayerEnded() {
      setTimeout(() => {
        VideoPlayer.close();
        this.dash.destroy();
        Router.back();
      }, 1000);
    }
    $videoPlayerPlay() {
      this.widgets.playercontrols._play();
    }
    $videoPlayerPause() {
      this.widgets.playercontrols._pause();
    }
    static get width() {
      return 1820;
    }
    static get height() {
      return 7;
    }
    clearTimer() {
      clearTimeout(this.timer);
      this.widgets.progressbar.setSmooth('alpha', 1);
      this.widgets.playercontrols.setSmooth('alpha', 1);
      this.timer = setTimeout(() => {
        this.widgets.playercontrols.setSmooth('alpha', 0);
        this.widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    async _createObjDetection() {
      let runningMode = "VIDEO";

      // Initialize object detector
      const objectDetector = await Wc.createFromOptions(await Do.forVisionTasks('https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm'), {
        baseOptions: {
          modelAssetPath: "https://storage.googleapis.com/mediapipe-tasks/object_detector/efficientdet_lite0_uint8.tflite"
        },
        scoreThreshold: 0.5,
        runningMode: runningMode
      });
      const processVideoFrame = async () => {
        if (this.videoEl && !this.videoEl.paused && !this.videoEl.ended) {
          try {
            // Perform object detection on the current video frame
            const objDetection = await objectDetector.detectForVideo(this.videoEl, performance.now());
            const detections = objDetection.detections;
            console.log('Object Detection (Video):', detections);

            // Handle bounding boxes or log results here
            detections.forEach((detection, index) => {
              const boundingBox = detection.boundingBox;
              const category = detection.categories[0]; // First category
              console.log("Detection #".concat(index));
              console.log(" Box: (x: ".concat(boundingBox.originX, ", y: ").concat(boundingBox.originY, ", w: ").concat(boundingBox.width, ", h: ").concat(boundingBox.height, ")"));
              console.log(" Class: ".concat(category.categoryName, ", Score: ").concat(category.score.toFixed(2)));
            });
          } catch (error) {
            console.error('Error during object detection:', error);
          }

          // Request the next frame
          requestAnimationFrame(processVideoFrame);
        }
      };

      // Start processing video frames
      processVideoFrame();
    }
  }

  class SubCategory extends Lightning.Component {
    _init() {
      this.widgets.loader.alpha = 1;
    }
    _focus() {
      this.patch({
        alpha: 1
      });
    }
    prepareData(collectionKey) {
      const selectedCollection = homePageInfo.find(collection => collection.key == collectionKey);
      if (categories$1 && !this.widgets.menu.categories) {
        this.widgets.menu.data = categories$1;
        this.widgets.iconmenu.data = categories$1;
        this.widgets.menu.alpha = 0;
        this.widgets.iconmenu.alpha = 1;
        if (Storage.get(activeCategory)) {
          this.widgets.menu.activeIndex = Storage.get(activeCategory);
          this.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
        }
      }
      this.widgets.loader.alpha = 0;
      this.dataLength = selectedCollection.list.length;
      if (this.dataLength > 0) {
        this.widgets.emptypage.alpha = 0;
        this.widgets.banneritem.alpha = 1;
        this.widgets.videogrid.data = selectedCollection;
        this.widgets.videogrid.alpha = 1;
        Router.focusWidget('VideoGrid');
      } else this.showEmptyPage();
    }
    showEmptyPage() {
      this.widgets.videogrid.alpha = 0;
      this.widgets.banneritem.alpha = 0;
      this.widgets.emptypage.data = {
        status: true,
        Message: Language.translate('no_content_found_string'),
        Image: emptyPageIcon
      };
      Router.focusWidget('EmptyPage');
    }
    _getFocused() {
      this.dataLength > 0 ? Router.focusWidget('VideoGrid') : Router.focusWidget('EmptyPage');
    }
    _handleBack() {
      Router.back();
    }
  }

  var t$1="undefined"!=typeof self?self:{};let e$1;const n$1="undefined"!=typeof TextEncoder;function r$1(t){if(n$1)t=(e$1||=new TextEncoder).encode(t);else {let e=0;const n=new Uint8Array(3*t.length);for(let i=0;i<t.length;i++){var r=t.charCodeAt(i);if(r<128)n[e++]=r;else {if(r<2048)n[e++]=r>>6|192;else {if(r>=55296&&r<=57343){if(r<=56319&&i<t.length){const o=t.charCodeAt(++i);if(o>=56320&&o<=57343){r=1024*(r-55296)+o-56320+65536,n[e++]=r>>18|240,n[e++]=r>>12&63|128,n[e++]=r>>6&63|128,n[e++]=63&r|128;continue}i--;}r=65533;}n[e++]=r>>12|224,n[e++]=r>>6&63|128;}n[e++]=63&r|128;}}t=e===n.length?n:n.subarray(0,e);}return t}var i$1,o$1;t:{for(var s$2=["CLOSURE_FLAGS"],a$2=t$1,u$1=0;u$1<s$2.length;u$1++)if(null==(a$2=a$2[s$2[u$1]])){o$1=null;break t}o$1=a$2;}var c$1,l$1=o$1&&o$1[610401301];i$1=null!=l$1&&l$1;const h$1=t$1.navigator;function f$1(t){return !!i$1&&(!!c$1&&c$1.brands.some((({brand:e})=>e&&-1!=e.indexOf(t))))}function d$1(e){var n;return (n=t$1.navigator)&&(n=n.userAgent)||(n=""),-1!=n.indexOf(e)}function p$1(){return !!i$1&&(!!c$1&&c$1.brands.length>0)}function g$1(){return p$1()?f$1("Chromium"):(d$1("Chrome")||d$1("CriOS"))&&!(!p$1()&&d$1("Edge"))||d$1("Silk")}c$1=h$1&&h$1.userAgentData||null;var m$1=!p$1()&&(d$1("Trident")||d$1("MSIE"));!d$1("Android")||g$1(),g$1(),d$1("Safari")&&(g$1()||!p$1()&&d$1("Coast")||!p$1()&&d$1("Opera")||!p$1()&&d$1("Edge")||(p$1()?f$1("Microsoft Edge"):d$1("Edg/"))||p$1()&&f$1("Opera"));var _$1={},b$1=null;function y$1(t){const e=t.length;let n=3*e/4;n%3?n=Math.floor(n):-1!="=.".indexOf(t[e-1])&&(n=-1!="=.".indexOf(t[e-2])?n-2:n-1);const r=new Uint8Array(n);let i=0;return function(t,e){function n(e){for(;r<t.length;){const e=t.charAt(r++),n=b$1[e];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(e))throw Error("Unknown base64 encoding at char: "+e)}return e}v$1();let r=0;for(;;){const t=n(-1),r=n(0),i=n(64),o=n(64);if(64===o&&-1===t)break;e(t<<2|r>>4),64!=i&&(e(r<<4&240|i>>2),64!=o&&e(i<<6&192|o));}}(t,(function(t){r[i++]=t;})),i!==n?r.subarray(0,i):r}function v$1(){if(!b$1){b$1={};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=t.concat(e[n].split(""));_$1[n]=r;for(let t=0;t<r.length;t++){const e=r[t];void 0===b$1[e]&&(b$1[e]=t);}}}}var w$1="undefined"!=typeof Uint8Array,S$1=!m$1&&"function"==typeof btoa;function A$1(t){if(!S$1){var e;void 0===e&&(e=0),v$1(),e=_$1[e];var n=Array(Math.floor(t.length/3)),r=e[64]||"";let u=0,c=0;for(;u<t.length-2;u+=3){var i=t[u],o=t[u+1],s=t[u+2],a=e[i>>2];i=e[(3&i)<<4|o>>4],o=e[(15&o)<<2|s>>6],s=e[63&s],n[c++]=a+i+o+s;}switch(a=0,s=r,t.length-u){case 2:s=e[(15&(a=t[u+1]))<<2]||r;case 1:t=t[u],n[c]=e[t>>2]+e[(3&t)<<4|a>>4]+s+r;}return n.join("")}for(e="",n=0,r=t.length-10240;n<r;)e+=String.fromCharCode.apply(null,t.subarray(n,n+=10240));return e+=String.fromCharCode.apply(null,n?t.subarray(n):t),btoa(e)}const T$1=/[-_.]/g,E$1={"-":"+",_:"/",".":"="};function I$1(t){return E$1[t]||""}function P$1(t){if(!S$1)return y$1(t);T$1.test(t)&&(t=t.replace(T$1,I$1)),t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function O$1(t){return w$1&&null!=t&&t instanceof Uint8Array}var L$1={};function U$1(){return x$1||=new B$1(null,L$1)}var B$1=class{constructor(t,e){if(k$1(e),this.i=t,null!=t&&0===t.length)throw Error("ByteString should be constructed with non-empty values")}};let x$1,N$1;function k$1(t){if(t!==L$1)throw Error("illegal external caller")}function j$1(t,e){t.__closure__error__context__984382||(t.__closure__error__context__984382={}),t.__closure__error__context__984382.severity=e;}function F$1(){const e=Error();j$1(e,"incident"),function(e){t$1.setTimeout((()=>{throw e}),0);}(e);}function D$1(t){return j$1(t=Error(t),"warning"),t}function V$1(){return "function"==typeof BigInt}function M$1(t){return Array.prototype.slice.call(t)}var C$1="function"==typeof Symbol&&"symbol"==typeof Symbol();function R$1(t){return "function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():t}var G$1=R$1(),z$1=R$1("2ex"),W$1=R$1("1oa"),H$1=C$1?(t,e)=>{t[G$1]|=e;}:(t,e)=>{void 0!==t.s?t.s|=e:Object.defineProperties(t,{s:{value:e,configurable:!0,writable:!0,enumerable:!1}});},$$1=C$1?(t,e)=>{t[G$1]&=~e;}:(t,e)=>{void 0!==t.s&&(t.s&=~e);},q$1=C$1?t=>0|t[G$1]:t=>0|t.s,K$1=C$1?t=>t[G$1]:t=>t.s,Y$1=C$1?(t,e)=>{t[G$1]=e;}:(t,e)=>{void 0!==t.s?t.s=e:Object.defineProperties(t,{s:{value:e,configurable:!0,writable:!0,enumerable:!1}});};function J$1(t,e){Y$1(e,-30975&(0|t));}function X$1(t,e){Y$1(e,-30941&(34|t));}var Z$1,Q$1={},tt$1={};function et$1(t){return !(!t||"object"!=typeof t||t.i!==tt$1)}function nt$1(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}function rt$1(t){return !(!Array.isArray(t)||t.length)&&!!(1&q$1(t))}const it$1=[];function ot$1(t){if(2&t)throw Error()}Y$1(it$1,55),Z$1=Object.freeze(it$1);var st$1=Object.freeze({});function at$1(t){return t.ba=!0,t}var ut$1=at$1((t=>"number"==typeof t)),ct$1=at$1((t=>"string"==typeof t)),lt$1=at$1((t=>"boolean"==typeof t)),ht$1="function"==typeof t$1.BigInt&&"bigint"==typeof t$1.BigInt(0),ft$1=at$1((t=>ht$1?t>=pt$1&&t<=mt$1:"-"===t[0]?_t$1(t,dt$1):_t$1(t,gt$1)));const dt$1=Number.MIN_SAFE_INTEGER.toString(),pt$1=ht$1?BigInt(Number.MIN_SAFE_INTEGER):void 0,gt$1=Number.MAX_SAFE_INTEGER.toString(),mt$1=ht$1?BigInt(Number.MAX_SAFE_INTEGER):void 0;function _t$1(t,e){if(t.length>e.length)return !1;if(t.length<e.length||t===e)return !0;for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(r>i)return !1;if(r<i)return !0}}let bt$1,yt$1=0,vt$1=0;function wt$1(t){const e=t>>>0;yt$1=e,vt$1=(t-e)/4294967296>>>0;}function St$1(t){if(t<0){wt$1(-t);const[e,n]=Pt$1(yt$1,vt$1);yt$1=e>>>0,vt$1=n>>>0;}else wt$1(t);}function At$1(t,e){const n=4294967296*e+(t>>>0);return Number.isSafeInteger(n)?n:Tt$1(t,e)}function Tt$1(t,e){if(t>>>=0,(e>>>=0)<=2097151)var n=""+(4294967296*e+t);else V$1()?n=""+(BigInt(e)<<BigInt(32)|BigInt(t)):(t=(16777215&t)+6777216*(n=16777215&(t>>>24|e<<8))+6710656*(e=e>>16&65535),n+=8147497*e,e*=2,t>=1e7&&(n+=t/1e7>>>0,t%=1e7),n>=1e7&&(e+=n/1e7>>>0,n%=1e7),n=e+Et$1(n)+Et$1(t));return n}function Et$1(t){return t=String(t),"0000000".slice(t.length)+t}function It$1(t){if(t.length<16)St$1(Number(t));else if(V$1())t=BigInt(t),yt$1=Number(t&BigInt(4294967295))>>>0,vt$1=Number(t>>BigInt(32)&BigInt(4294967295));else {const e=+("-"===t[0]);vt$1=yt$1=0;const n=t.length;for(let r=e,i=(n-e)%6+e;i<=n;r=i,i+=6){const e=Number(t.slice(r,i));vt$1*=1e6,yt$1=1e6*yt$1+e,yt$1>=4294967296&&(vt$1+=Math.trunc(yt$1/4294967296),vt$1>>>=0,yt$1>>>=0);}if(e){const[t,e]=Pt$1(yt$1,vt$1);yt$1=t,vt$1=e;}}}function Pt$1(t,e){return e=~e,t?t=1+~t:e+=1,[t,e]}function Ot$1(t){if(null!=t&&"number"!=typeof t)throw Error(`Value of float/double field must be a number, found ${typeof t}: ${t}`);return t}function Lt$1(t){return null==t||"number"==typeof t?t:"NaN"===t||"Infinity"===t||"-Infinity"===t?Number(t):void 0}const Ut$1=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Bt$1(t){const e=typeof t;switch(e){case"bigint":return !0;case"number":return Number.isFinite(t)}return "string"===e&&Ut$1.test(t)}function xt$1(t){if("number"!=typeof t)throw D$1("int32");if(!Number.isFinite(t))throw D$1("int32");return 0|t}function Nt$1(t){return null==t?t:xt$1(t)}function kt$1(t){if(null==t)return t;if("string"==typeof t){if(!t)return;t=+t;}return "number"==typeof t&&Number.isFinite(t)?0|t:void 0}function jt$1(t){if(null!=t){if("number"!=typeof t)throw D$1("uint32");if(!Number.isFinite(t))throw D$1("uint32");t>>>=0;}return t}function Ft$1(t){if(null==t)return t;if("string"==typeof t){if(!t)return;t=+t;}return "number"==typeof t&&Number.isFinite(t)?t>>>0:void 0}function Dt$1(t){return "-"!==t[0]&&(t.length<20||20===t.length&&Number(t.substring(0,6))<184467)}function Vt$1(t){if(null==t)return t;var e=typeof t;if("bigint"===e)return String(BigInt.asUintN(64,t));if(Bt$1(t)){if("string"===e)return e=Math.trunc(Number(t)),Number.isSafeInteger(e)&&e>=0?t=String(e):(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),Dt$1(t)||(It$1(t),t=Tt$1(yt$1,vt$1))),t;if("number"===e)return (t=Math.trunc(t))>=0&&Number.isSafeInteger(t)?t:function(t){if(t<0){St$1(t);var e=Tt$1(yt$1,vt$1);return t=Number(e),Number.isSafeInteger(t)?t:e}return Dt$1(e=String(t))?e:(St$1(t),At$1(yt$1,vt$1))}(t)}}function Mt$1(t){return null==t||"string"==typeof t?t:void 0}function Ct$1(t,e,n){if(null!=t&&"object"==typeof t&&t.L===Q$1)return t;if(Array.isArray(t)){var r=q$1(t),i=r;return 0===i&&(i|=32&n),(i|=2&n)!==r&&Y$1(t,i),new e(t)}}function Rt$1(t){var e;return void 0===Wt$1&&(Wt$1="function"==typeof Proxy?Xt$1(Proxy):null),(e=!Wt$1)||(void 0===Ht$1&&(Ht$1="function"==typeof WeakMap?Xt$1(WeakMap):null),e=!Ht$1),e?t:(e=Gt$1?.get(t))?e:Math.random()>.01?t:(function(t){if(void 0===$t$1){const t=new Wt$1([],{});$t$1=1===Array.prototype.concat.call([],t).length;}$t$1&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(t[Symbol.isConcatSpreadable]=!0);}(t),function(t,e){(Gt$1||=new Ht$1).set(t,e),(zt$1||=new Ht$1).set(e,t);}(t,e=new Wt$1(t,{set:(t,e,n)=>(F$1(),t[e]=n,!0)})),e)}let Gt$1,zt$1,Wt$1,Ht$1,$t$1,qt$1,Kt$1,Yt$1,Jt$1;function Xt$1(t){try{return -1!==t.toString().indexOf("[native code]")?t:null}catch{return null}}function Zt$1(t,e,n){return t=Qt$1(t,e[0],e[1],n?1:2),e!==Kt$1&&n&&H$1(t,16384),t}function Qt$1(t,e,n,r){if(r=r??0,null==t&&(t=qt$1),qt$1=void 0,null==t){var i=96;n?(t=[n],i|=512):t=[],e&&(i=-33521665&i|(1023&e)<<15);}else {if(!Array.isArray(t))throw Error("narr");if(2048&(i=q$1(t)))throw Error("farr");if(64&i)return t;if(1===r||2===r||(i|=64),n&&(i|=512,n!==t[0]))throw Error("mid");t:{if(r=(n=t).length){const t=r-1;if(nt$1(n[t])){if((e=t-(+!!(512&(i|=256))-1))>=1024)throw Error("pvtlmt");i=-33521665&i|(1023&e)<<15;break t}}if(e){if((e=Math.max(e,r-(+!!(512&i)-1)))>1024)throw Error("spvt");i=-33521665&i|(1023&e)<<15;}}}return Y$1(t,i),t}function te$1(t,e,n,r,i){if(null!=t){if(Array.isArray(t))t=rt$1(t)?void 0:i&&2&q$1(t)?t:ee$1(t,e,n,void 0!==r,i);else if(nt$1(t)){const o={};for(let s in t)o[s]=te$1(t[s],e,n,r,i);t=o;}else t=e(t,r);return t}}function ee$1(t,e,n,r,i){const o=r||n?q$1(t):0;r=r?!!(32&o):void 0,t=M$1(t);for(let o=0;o<t.length;o++)t[o]=te$1(t[o],e,n,r,i);return n&&n(o,t),t}function ne$1(t){return t.L===Q$1?t.toJSON():function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return ft$1(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(rt$1(t))return}else {if(O$1(t))return A$1(t);if(t instanceof B$1){const e=t.i;return null==e?"":"string"==typeof e?e:t.i=A$1(e)}}}return t}(t)}function re$1(t,e,n=X$1){if(null!=t){if(w$1&&t instanceof Uint8Array)return e?t:new Uint8Array(t);if(Array.isArray(t)){var r=q$1(t);return 2&r?t:(e&&=0===r||!!(32&r)&&!(64&r||!(16&r)),e?(Y$1(t,-12293&(34|r)),t):ee$1(t,re$1,4&r?X$1:n,!0,!0))}return t.L===Q$1&&(n=t.m,t=2&(r=K$1(n))?t:ie$1(t,n,r,!0)),t}}function ie$1(t,e,n,r){return t=t.constructor,qt$1=e=function(t,e,n){const r=n||2&e?X$1:J$1,i=!!(32&e);return t=function(t,e,n){var r=(t=M$1(t)).length;const i=256&e?t[r-1]:void 0;for(r+=i?-1:0,e=512&e?1:0;e<r;e++)t[e]=n(t[e]);if(i){e=t[e]={};for(const t in i)e[t]=n(i[t]);}return t}(t,e,(t=>re$1(t,i,r))),H$1(t,32|(n?2:0)),t}(e,n,r),e=new t(e),qt$1=void 0,e}function oe$1(t){const e=t.m,n=K$1(e);return 2&n?ie$1(t,e,n,!1):t}function se$1(t,e){return ue$1(t=t.m,K$1(t),e)}function ae$1(t,e,n,r){if(!((e=r+(+!!(512&e)-1))<0||e>=t.length||e>=n))return t[e]}function ue$1(t,e,n,r){if(-1===n)return null;const i=e>>15&1023||536870912;if(!(n>=i)){var o=t.length;return r&&256&e&&null!=(r=t[o-1][n])?(ae$1(t,e,i,n)&&null!=z$1&&((e=(t=N$1??={})[z$1]||0)>=4||(t[z$1]=e+1,F$1())),r):ae$1(t,e,i,n)}return 256&e?t[t.length-1][n]:void 0}function ce$1(t,e,n){const r=t.m;let i=K$1(r);return ot$1(i),le$1(r,i,e,n),t}function le$1(t,e,n,r){const i=e>>15&1023||536870912;if(n>=i){let o,s=e;if(256&e)o=t[t.length-1];else {if(null==r)return s;o=t[i+(+!!(512&e)-1)]={},s|=256;}return o[n]=r,n<i&&(t[n+(+!!(512&e)-1)]=void 0),s!==e&&Y$1(t,s),s}return t[n+(+!!(512&e)-1)]=r,256&e&&(n in(t=t[t.length-1])&&delete t[n]),e}function he$1(t,e,n,r,i){const o=t.m,s=2&(t=K$1(o))?1:r;i=!!i,r=fe$1(o,t,e);var a=q$1(r);if(!(4&a)){4&a&&(r=M$1(r),a=we$1(a,t),t=le$1(o,t,e,r));let i=0,s=0;for(;i<r.length;i++){const t=n(r[i]);null!=t&&(r[s++]=t);}s<i&&(r.length=s),a=-4097&(20|(a=de$1(a,t))),Y$1(r,a&=-8193),2&a&&Object.freeze(r);}let u;return 1===s||4===s&&32&a?pe$1(a)||(i=a,(a|=2)!==i&&Y$1(r,a),Object.freeze(r)):(n=5===s&&(!!(32&a)||pe$1(a)||!!Gt$1?.get(r)),(2===s||n)&&pe$1(a)&&(r=M$1(r),a=Se$1(a=we$1(a,t),t,i),Y$1(r,a),t=le$1(o,t,e,r)),pe$1(a)||(e=a,(a=Se$1(a,t,i))!==e&&Y$1(r,a)),n?u=Rt$1(r):2!==s||i||Gt$1?.delete(r)),u||r}function fe$1(t,e,n){return t=ue$1(t,e,n),Array.isArray(t)?t:Z$1}function de$1(t,e){return 0===t&&(t=we$1(t,e)),1|t}function pe$1(t){return !!(2&t)&&!!(4&t)||!!(2048&t)}function ge$1(t,e,n){t=t.m;let r=K$1(t);if(ot$1(r),null==n)le$1(t,r,e);else {n=zt$1?.get(n)||n;var i=q$1(n),o=i,s=pe$1(i),a=s||Object.isFrozen(n);for(s||(i=0),a||(n=M$1(n),o=0,i=Se$1(i=we$1(i,r),r,!0),a=!1),i|=21,s=0;s<n.length;s++){const t=n[s],e=xt$1(t);Object.is(t,e)||(a&&(n=M$1(n),o=0,i=Se$1(i=we$1(i,r),r,!0),a=!1),n[s]=e);}i!==o&&(a&&(n=M$1(n),i=Se$1(i=we$1(i,r),r,!0)),Y$1(n,i)),le$1(t,r,e,n);}}function me$1(t,e,n,r){t=t.m;let i=K$1(t);ot$1(i),le$1(t,i,e,("0"===r?0===Number(n):n===r)?void 0:n);}function _e$1(t){if(C$1)return t[W$1]??(t[W$1]=new Map);if(W$1 in t)return t[W$1];const e=new Map;return Object.defineProperty(t,W$1,{value:e}),e}function be$1(t,e,n){var r=Hr$1;let i=t.get(r);if(null!=i)return i;i=0;for(let t=0;t<r.length;t++){const o=r[t];null!=ue$1(e,n,o)&&(0!==i&&(n=le$1(e,n,i)),i=o);}return t.set(r,i),i}function ye$1(t,e,n){var r=t.m,i=K$1(r),o=ue$1(r,i,n,!1);return (e=Ct$1(o,e,i))!==o&&null!=e&&le$1(r,i,n,e),null==(r=e)||(t=t.m,2&(i=K$1(t))||(o=oe$1(r))!==r&&le$1(t,i,n,r=o)),r}function ve$1(t,e,n){return null==n&&(n=void 0),ce$1(t,e,n)}function we$1(t,e){return -2049&(t=32|(2&e?2|t:-3&t))}function Se$1(t,e,n){return 32&e&&n||(t&=-33),t}function Ae$1(t,e,n,r){var i,o=K$1(t.m);ot$1(o);const s=t.m,a=(t=!!(2&o))?1:2;d&&=!t,t=fe$1(s,o,e);var u=q$1(t),c=!!(4&u);if(!c){var l=t,h=o,f=!!(2&(u=de$1(u,o)));f&&(h|=2);let e=!f,r=!0,i=0,s=0;for(;i<l.length;i++){const t=Ct$1(l[i],n,h);if(t instanceof n){if(!f){const n=!!(2&q$1(t.m));e&&=!n,r&&=n;}l[s++]=t;}}s<i&&(l.length=s),u|=4,u=r?16|u:-17&u,Y$1(l,u=e?8|u:-9&u),f&&Object.freeze(l);}if(d&&!(8&u||!t.length&&(1===a||4===a&&32&u))){pe$1(u)&&(t=M$1(t),u=we$1(u,o),o=le$1(s,o,e,t));var d=t;for(l=u,u=0;u<d.length;u++)(h=d[u])!==(f=oe$1(h))&&(d[u]=f);l|=8,l=d.length?-17&l:16|l,Y$1(d,l),u=l;}1===a||4===a&&32&u?pe$1(u)||(e=u,(u|=!t.length||16&u&&(!c||32&u)?2:2048)!==e&&Y$1(t,u),Object.freeze(t)):(c=5===a&&(!!(32&u)||pe$1(u)||!!Gt$1?.get(t)),(2===a||c)&&pe$1(u)&&(t=M$1(t),u=Se$1(u=we$1(u,o),o,!0),Y$1(t,u),o=le$1(s,o,e,t)),pe$1(u)||(e=u,(u=Se$1(u,o,!0))!==e&&Y$1(t,u)),c&&(i=Rt$1(t))),i=i||t,r=null!=r?r:new n,i.push(r),2&q$1(r.m)?$$1(i,8):$$1(i,16);}function Te$1(t){return t??0}function Ee$1(t,e){return Te$1(Ft$1(se$1(t,e)))}function Ie$1(t,e,n){me$1(t,e,Nt$1(n),0);}function Pe$1(t,e,n){if(null!=n&&"string"!=typeof n)throw Error();me$1(t,e,n,"");}function Oe$1(t,e,n){if(ot$1(K$1(t.m)),e=(t=he$1(t,e,Mt$1,2,!0)).push,"string"!=typeof n)throw Error();e.call(t,n);}function Le$1(t){if("string"==typeof t)return {buffer:P$1(t),C:!1};if(Array.isArray(t))return {buffer:new Uint8Array(t),C:!1};if(t.constructor===Uint8Array)return {buffer:t,C:!1};if(t.constructor===ArrayBuffer)return {buffer:new Uint8Array(t),C:!1};if(t.constructor===B$1){k$1(L$1);var e=t.i;return {buffer:(null==(e=null==e||O$1(e)?e:"string"==typeof e?P$1(e):null)?e:t.i=e)||new Uint8Array(0),C:!0}}if(t instanceof Uint8Array)return {buffer:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}var Ue$1=class{constructor(t,e){this.m=Qt$1(t,e);}toJSON(){return Be$1(this)}C(){return !!(2&q$1(this.m))}};function Be$1(t){t=t.m,t=Jt$1?t:ee$1(t,ne$1,void 0,void 0,!1);{var e=!Jt$1;let c=t.length;if(c){var n=t[c-1],r=nt$1(n);r?c--:n=void 0;var i=t;if(r){t:{var o,s=n,a=!1;if(s)for(let t in s)isNaN(+t)?(o??={})[t]=s[t]:(r=s[t],Array.isArray(r)&&(rt$1(r)||et$1(r)&&0===r.size)&&(r=null),null==r&&(a=!0),null!=r&&((o??={})[t]=r));if(a||(o=s),o)for(let t in o){a=o;break t}a=null;}s=null==a?null!=n:a!==n;}for(;c>0&&(null==(o=i[c-1])||rt$1(o)||et$1(o)&&0===o.size);c--)var u=!0;(i!==t||s||u)&&(e?(u||s||a)&&(i.length=c):i=Array.prototype.slice.call(i,0,c),a&&i.push(a)),u=i;}else u=t;}return u}function xe$1(t){return t?/^\d+$/.test(t)?(It$1(t),new Ne$1(yt$1,vt$1)):null:ke$1||=new Ne$1(0,0)}Ue$1.prototype.L=Q$1,Ue$1.prototype.toString=function(){try{return Jt$1=!0,Be$1(this).toString()}finally{Jt$1=!1;}};var Ne$1=class{constructor(t,e){this.j=t>>>0,this.i=e>>>0;}};let ke$1;function je$1(t){return t?/^-?\d+$/.test(t)?(It$1(t),new Fe$1(yt$1,vt$1)):null:De$1||=new Fe$1(0,0)}var Fe$1=class{constructor(t,e){this.j=t>>>0,this.i=e>>>0;}};let De$1;function Ve$1(t,e,n){for(;n>0||e>127;)t.i.push(127&e|128),e=(e>>>7|n<<25)>>>0,n>>>=7;t.i.push(e);}function Me$1(t,e){for(;e>127;)t.i.push(127&e|128),e>>>=7;t.i.push(e);}function Ce$1(t,e){if(e>=0)Me$1(t,e);else {for(let n=0;n<9;n++)t.i.push(127&e|128),e>>=7;t.i.push(1);}}function Re$1(t,e){0!==e.length&&(t.l.push(e),t.j+=e.length);}function Ge$1(t,e,n){Me$1(t.i,8*e+n);}function ze$1(t,e){return Ge$1(t,e,2),e=t.i.end(),Re$1(t,e),e.push(t.j),e}function We$1(t,e){var n=e.pop();for(n=t.j+t.i.length()-n;n>127;)e.push(127&n|128),n>>>=7,t.j++;e.push(n),t.j++;}function He$1(t,e,n){Ge$1(t,e,2),Me$1(t.i,n.length),Re$1(t,t.i.end()),Re$1(t,n);}function $e$1(){const t=class{constructor(){throw Error()}};return Object.setPrototypeOf(t,t.prototype),t}var qe$1=$e$1(),Ke$1=$e$1(),Ye$1=$e$1(),Je$1=$e$1(),Xe$1=$e$1(),Ze$1=$e$1(),Qe$1=class{constructor(t,e){this.i=t,t=qe$1,this.j=!!t&&e===t||!1;}};function tn$1(t,e,n,r,i){null!=(e=un$1(e,r))&&(n=ze$1(t,n),i(e,t),We$1(t,n));}const en$1=new Qe$1(tn$1,qe$1),nn$1=new Qe$1(tn$1,qe$1);var rn$1=Symbol(),on$1=Symbol();let sn$1;function an$1(t){var e=cn$1,n=ln$1,r=t[rn$1];if(r)return r;(r={}).N=function(t){switch(typeof t){case"boolean":return Kt$1||=[0,void 0,!0];case"number":return t>0?void 0:0===t?Yt$1||=[0,void 0]:[-t,void 0];case"string":return [0,t];case"object":return t}}(t[0]);var i=t[1];let o=1;i&&i.constructor===Object&&(r.S=i,"function"==typeof(i=t[++o])&&(r.W=!0,sn$1??=t[o+1],i=t[o+=2]));const s={};for(;i&&Array.isArray(i)&&i.length&&"number"==typeof i[0]&&i[0]>0;){for(var a=0;a<i.length;a++)s[i[a]]=i;i=t[++o];}for(a=1;void 0!==i;){let s;"number"==typeof i&&(a+=i,i=t[++o]);var u=void 0;if(i instanceof Qe$1?s=i:(s=en$1,o--),s?.j){i=t[++o],u=t;var c=o;"function"==typeof i&&(i=i(),u[c]=i),u=i;}for(c=a+1,"number"==typeof(i=t[++o])&&i<0&&(c-=i,i=t[++o]);a<c;a++)u?n(r,a,s,u):e(r,a,s);}return t[rn$1]=r}function un$1(t,e){return t instanceof Ue$1?t.m:Array.isArray(t)?Zt$1(t,e,!1):void 0}function cn$1(t,e,n){t[e]=n.i;}function ln$1(t,e,n,r){let i,o;const s=n.i;t[e]=(t,e,n)=>s(t,e,n,o||=an$1(r).N,i||=hn$1(r));}function hn$1(t){let e=t[on$1];if(!e){const n=an$1(t);e=(t,e)=>fn$1(t,e,n),t[on$1]=e;}return e}function fn$1(t,e,n){var r=q$1(t),i=+!!(512&r)-1,o=t.length,s=512&r?1:0;const a=o+(256&r?-1:0);for(;s<a;s++){const r=t[s];if(null==r)continue;const o=s-i,a=dn$1(n,o);a&&a(e,r,o);}if(256&r){t=t[o-1];for(const s in t)r=+s,Number.isNaN(r)||null!=(i=t[r])&&(o=dn$1(n,r))&&o(e,i,r);}}function dn$1(t,e){var n=t[e];if(n)return n;if((n=t.S)&&(n=n[e])){var r=(n=Array.isArray(n)?n[0]instanceof Qe$1?n:[nn$1,n]:[n,void 0])[0].i;if(n=n[1]){const e=hn$1(n),i=an$1(n).N;n=t.W?sn$1(i,e):(t,n,o)=>r(t,n,o,i,e);}else n=r;return t[e]=n}}var pn$1,gn$1=0,mn$1=gn$1;if(ct$1(mn$1)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(mn$1))throw Error(String(mn$1))}else if((pn$1=ut$1(mn$1))&&(pn$1=!Number.isSafeInteger(mn$1)),pn$1)throw Error(String(mn$1));function _n$1(t,e){if(Array.isArray(e)){var n=q$1(e);if(4&n)return e;for(var r=0,i=0;r<e.length;r++){const n=t(e[r]);null!=n&&(e[i++]=n);}return i<r&&(e.length=i),Y$1(e,-12289&(5|n)),2&n&&Object.freeze(e),e}}function bn$1(t,e){return new Qe$1(t,e)}function yn$1(t,e,n){null!=(e=Lt$1(e))&&(Ge$1(t,n,5),t=t.i,(n=bt$1||=new DataView(new ArrayBuffer(8))).setFloat32(0,+e,!0),vt$1=0,e=yt$1=n.getUint32(0,!0),t.i.push(e>>>0&255),t.i.push(e>>>8&255),t.i.push(e>>>16&255),t.i.push(e>>>24&255));}function vn$1(t,e,n){null!=(e=kt$1(e))&&null!=e&&(Ge$1(t,n,0),Ce$1(t.i,e));}function wn$1(t,e,n){null!=(e=null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0)&&(Ge$1(t,n,0),t.i.i.push(e?1:0));}function Sn$1(t,e,n){null!=(e=Mt$1(e))&&He$1(t,n,r$1(e));}function An$1(t,e,n,r,i){null!=(e=un$1(e,r))&&(n=ze$1(t,n),i(e,t),We$1(t,n));}function Tn$1(t,e,n){null!=(e=kt$1(e))&&(e=parseInt(e,10),Ge$1(t,n,0),Ce$1(t.i,e));}ht$1||(gn$1=lt$1(gn$1)?gn$1?"1":"0":ct$1(gn$1)?gn$1.trim()||"0":String(gn$1));var En$1,In$1=bn$1(yn$1,Xe$1),Pn$1=bn$1(yn$1,Xe$1),On$1=bn$1((function(t,e,n){if(e=function(t){if(null==t)return t;var e=typeof t;if("bigint"===e)return String(BigInt.asIntN(64,t));if(Bt$1(t)){if("string"===e){if(e=Math.trunc(Number(t)),Number.isSafeInteger(e))t=String(e);else if(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),!("-"===t[0]?t.length<20||20===t.length&&Number(t.substring(0,7))>-922337:t.length<19||19===t.length&&Number(t.substring(0,6))<922337))if(It$1(t),t=yt$1,2147483648&(e=vt$1))if(V$1())t=""+(BigInt(0|e)<<BigInt(32)|BigInt(t>>>0));else {const[n,r]=Pt$1(t,e);t="-"+Tt$1(n,r);}else t=Tt$1(t,e);return t}if("number"===e){if(t=Math.trunc(t),!Number.isSafeInteger(t)){St$1(t),e=yt$1;var n=vt$1;(t=2147483648&n)&&(n=~n>>>0,0==(e=1+~e>>>0)&&(n=n+1>>>0)),t="number"==typeof(e=At$1(e,n))?t?-e:e:t?"-"+e:e;}return t}}}(e),null!=e){if("string"==typeof e)je$1(e);if(null!=e)switch(Ge$1(t,n,0),typeof e){case"number":t=t.i,St$1(e),Ve$1(t,yt$1,vt$1);break;case"bigint":n=BigInt.asUintN(64,e),n=new Fe$1(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ve$1(t.i,n.j,n.i);break;default:n=je$1(e),Ve$1(t.i,n.j,n.i);}}}),$e$1()),Ln$1=bn$1((function(t,e,n){if(null!=(e=Vt$1(e))){if("string"==typeof e)xe$1(e);if(null!=e)switch(Ge$1(t,n,0),typeof e){case"number":t=t.i,St$1(e),Ve$1(t,yt$1,vt$1);break;case"bigint":n=BigInt.asUintN(64,e),n=new Ne$1(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ve$1(t.i,n.j,n.i);break;default:n=xe$1(e),Ve$1(t.i,n.j,n.i);}}}),$e$1()),Un$1=bn$1(vn$1,Je$1);En$1=new Qe$1((function(t,e,n){if(null!=(e=_n$1(kt$1,e))&&e.length){n=ze$1(t,n);for(let n=0;n<e.length;n++)Ce$1(t.i,e[n]);We$1(t,n);}}),Je$1);var Bn$1,xn$1=bn$1(vn$1,Je$1),Nn$1=bn$1(vn$1,Je$1),kn$1=bn$1(wn$1,Ke$1),jn$1=bn$1(wn$1,Ke$1),Fn$1=bn$1(Sn$1,Ye$1);Bn$1=new Qe$1((function(t,e,n){if(null!=(e=_n$1(Mt$1,e)))for(let a=0;a<e.length;a++){var i=t,o=n,s=e[a];null!=s&&He$1(i,o,r$1(s));}}),Ye$1);var Dn$1,Vn$1=bn$1(Sn$1,Ye$1),Mn$1=bn$1(Sn$1,Ye$1),Cn$1=function(t,e,n=qe$1){return new Qe$1(e,n)}(0,(function(t,e,n,r,i){if(Array.isArray(e))for(let o=0;o<e.length;o++)An$1(t,e[o],n,r,i);})),Rn$1=new Qe$1(An$1,qe$1),Gn$1=bn$1((function(t,e,n){null!=(e=Ft$1(e))&&null!=e&&(Ge$1(t,n,0),Me$1(t.i,e));}),$e$1()),zn$1=bn$1(Tn$1,Ze$1);Dn$1=new Qe$1((function(t,e,n){if(null!=(e=_n$1(kt$1,e))&&e.length){n=ze$1(t,n);for(let n=0;n<e.length;n++)Ce$1(t.i,e[n]);We$1(t,n);}}),Ze$1);var Wn$1=bn$1(Tn$1,Ze$1);function Hn$1(t){return function(){const e=new class{constructor(){this.l=[],this.j=0,this.i=new class{constructor(){this.i=[];}length(){return this.i.length}end(){const t=this.i;return this.i=[],t}};}};fn$1(this.m,e,an$1(t)),Re$1(e,e.i.end());const n=new Uint8Array(e.j),r=e.l,i=r.length;let o=0;for(let t=0;t<i;t++){const e=r[t];n.set(e,o),o+=e.length;}return e.l=[n],n}}function $n$1(t,e){if(null!=e)if(Array.isArray(e))ce$1(t,2,ee$1(e,ne$1,void 0,void 0,!1));else {if(!("string"==typeof e||e instanceof B$1||O$1(e)))throw Error("invalid value in Any.value field: "+e+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");if(null!=e)if("string"==typeof e)e=e?new B$1(e,L$1):U$1();else if(e.constructor!==B$1){if(!O$1(e))throw Error();e=e.length?new B$1(new Uint8Array(e),L$1):U$1();}me$1(t,2,e,U$1());}}var qn$1=class extends Ue$1{constructor(t){super(t);}},Kn$1=[0,Vn$1,bn$1((function(t,e,n){if(null!=e){if(e instanceof Ue$1){const r=e.ca;return void(r&&(e=r(e),null!=e&&He$1(t,n,Le$1(e).buffer)))}if(Array.isArray(e))return}null!=(e=null==e||"string"==typeof e||O$1(e)||e instanceof B$1?e:void 0)&&He$1(t,n,Le$1(e).buffer);}),$e$1())];let Yn$1,Jn$1=globalThis.trustedTypes;function Xn$1(t){void 0===Yn$1&&(Yn$1=function(){let t=null;if(!Jn$1)return t;try{const e=t=>t;t=Jn$1.createPolicy("goog#html",{createHTML:e,createScript:e,createScriptURL:e});}catch(t){}return t}());var e=Yn$1;return new class{constructor(t){this.i=t;}toString(){return this.i+""}}(e?e.createScriptURL(t):t)}function Zn$1(t,...e){if(0===e.length)return Xn$1(t[0]);let n=t[0];for(let r=0;r<e.length;r++)n+=encodeURIComponent(e[r])+t[r+1];return Xn$1(n)}var Qn$1={};Qn$1[336783863]=[0,Fn$1,kn$1,-1,Un$1,[0,[1,2,3,4,5,6,7],Rn$1,[0],Rn$1,[0,kn$1,Fn$1,kn$1,zn$1,-1,Dn$1,Fn$1,-1,[0,kn$1,-1],zn$1,kn$1,-1],Rn$1,[0,Fn$1,-2],Rn$1,[0,Un$1,kn$1,1,kn$1,-3],Rn$1,[0,Un$1,zn$1,kn$1,-1,En$1,zn$1,-1],Rn$1,[0,Fn$1,-2],Rn$1,[0,Fn$1,zn$1]],[0,Fn$1],kn$1,[0,[1,3],[2,4],Rn$1,[0,En$1],-1,Rn$1,[0,Bn$1],-1,Cn$1,[0,Fn$1,-1]],Fn$1];var tr$1=class extends Ue$1{constructor(t){super(t);}},er$1=[0,On$1,-1,jn$1,-3,On$1,En$1,Vn$1,xn$1,On$1,-1,jn$1,xn$1,jn$1,-2,Vn$1],nr$1=class extends Ue$1{constructor(t){super(t,500);}K(t){return ve$1(this,7,t)}},rr$1=[-1,{}],ir$1=[0,Fn$1,1,rr$1],or$1=[0,Fn$1,Bn$1,rr$1];function sr$1(t,e){Ae$1(t,1,nr$1,e);}var ar$1=class extends Ue$1{constructor(){super(void 0,500);}K(t){return ve$1(this,1001,t)}};ar$1.prototype.i=Hn$1([-500,Cn$1,[-500,Vn$1,-1,Bn$1,-3,[-2,Qn$1,kn$1],Cn$1,Kn$1,xn$1,-1,ir$1,or$1,Cn$1,[0,Vn$1,jn$1],Vn$1,er$1,xn$1,Bn$1,987,Bn$1],4,Cn$1,[-500,Fn$1,-1,[-1,{}],998,Fn$1],Cn$1,[-500,Fn$1,Bn$1,-1,[-2,{},kn$1],997,Bn$1,-1],xn$1,Cn$1,[-500,Fn$1,Bn$1,rr$1,998,Bn$1],Bn$1,xn$1,ir$1,or$1,Cn$1,[0,Vn$1,-1,rr$1],Bn$1,-2,er$1,Vn$1,-1,jn$1,[0,jn$1,Gn$1],978,rr$1,Cn$1,Kn$1]);var ur$1=class extends Ue$1{constructor(t){super(t);}};let cr$1;const lr$1=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function hr$1(){if(void 0===cr$1)try{await WebAssembly.instantiate(lr$1),cr$1=!0;}catch{cr$1=!1;}return cr$1}async function fr$1(t,e=Zn$1``){const n=await hr$1()?"wasm_internal":"wasm_nosimd_internal";return {wasmLoaderPath:`${e}/${t}_${n}.js`,wasmBinaryPath:`${e}/${t}_${n}.wasm`}}var dr$1=class{};function pr$1(){var t=navigator;return "undefined"!=typeof OffscreenCanvas&&(!function(t=navigator){return (t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(t)||!!((t=t.userAgent.match(/Version\/([\d]+).*Safari/))&&t.length>=1&&Number(t[1])>=17))}async function gr$1(t){if("function"!=typeof importScripts){const e=document.createElement("script");return e.src=t.toString(),e.crossOrigin="anonymous",new Promise(((t,n)=>{e.addEventListener("load",(()=>{t();}),!1),e.addEventListener("error",(t=>{n(t);}),!1),document.body.appendChild(e);}))}importScripts(t.toString());}dr$1.forVisionTasks=function(t){return fr$1("vision",t)},dr$1.forTextTasks=function(t){return fr$1("text",t)},dr$1.forGenAiExperimentalTasks=function(t){return fr$1("genai_experimental",t)},dr$1.forGenAiTasks=function(t){return fr$1("genai",t)},dr$1.forAudioTasks=function(t){return fr$1("audio",t)},dr$1.isSimdSupported=function(){return hr$1()};function mr$1(t,e,n){t.o||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(e=t.h.stringToNewUTF8(e)),t.h._free(e);}function _r$1(t,e,n){t.o||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(e.length);for(let n=0;n<e.length;n++)r[n]=t.h.stringToNewUTF8(e[n]);e=t.h._malloc(4*r.length),t.h.HEAPU32.set(r,e>>2),n(e);for(const e of r)t.h._free(e);t.h._free(e);}function br$1(t,e,n){t.h.simpleListeners=t.h.simpleListeners||{},t.h.simpleListeners[e]=n;}function yr$1(t,e,n){let r=[];t.h.simpleListeners=t.h.simpleListeners||{},t.h.simpleListeners[e]=(t,e,i)=>{e?(n(r,i),r=[]):r.push(t);};}const vr$1=(wr$1=class{constructor(t,e){this.l=!0,this.h=t,this.i=null,this.j=0,this.o="function"==typeof this.h._addIntToInputStream,void 0!==e?this.h.canvas=e:pr$1()?this.h.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.h.canvas=document.createElement("canvas"));}async initializeGraph(t){const e=await(await fetch(t)).arrayBuffer();t=!(t.endsWith(".pbtxt")||t.endsWith(".textproto")),this.setGraph(new Uint8Array(e),t);}setGraphFromString(t){this.setGraph((new TextEncoder).encode(t),!1);}setGraph(t,e){const n=t.length,r=this.h._malloc(n);this.h.HEAPU8.set(t,r),e?this.h._changeBinaryGraph(n,r):this.h._changeTextGraph(n,r),this.h._free(r);}configureAudio(t,e,n,r,i){this.h._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),mr$1(this,r||"input_audio",(r=>{mr$1(this,i=i||"audio_header",(i=>{this.h._configureAudio(r,i,t,e??0,n);}));}));}setAutoResizeCanvas(t){this.l=t;}setAutoRenderToScreen(t){this.h._setAutoRenderToScreen(t);}setGpuBufferVerticalFlip(t){this.h.gpuOriginForWebTexturesIsBottomLeft=t;}attachErrorListener(t){this.h.errorListener=t;}attachEmptyPacketListener(t,e){this.h.emptyPacketListeners=this.h.emptyPacketListeners||{},this.h.emptyPacketListeners[t]=e;}addAudioToStream(t,e,n){this.addAudioToStreamWithShape(t,0,0,e,n);}addAudioToStreamWithShape(t,e,n,r,i){const o=4*t.length;this.j!==o&&(this.i&&this.h._free(this.i),this.i=this.h._malloc(o),this.j=o),this.h.HEAPF32.set(t,this.i/4),mr$1(this,r,(t=>{this.h._addAudioToInputStream(this.i,e,n,t,i);}));}addGpuBufferToStream(t,e,n){mr$1(this,e,(e=>{if(!this.h.canvas)throw Error("No OpenGL canvas configured.");e?this.h._bindTextureToStream(e):this.h._bindTextureToCanvas();const r=this.h.canvas.getContext("webgl2")||this.h.canvas.getContext("webgl");if(!r)throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);const[i,o]=void 0!==t.videoWidth?[t.videoWidth,t.videoHeight]:void 0!==t.naturalWidth?[t.naturalWidth,t.naturalHeight]:void 0!==t.displayWidth?[t.displayWidth,t.displayHeight]:[t.width,t.height];!this.l||i===this.h.canvas.width&&o===this.h.canvas.height||(this.h.canvas.width=i,this.h.canvas.height=o);const[s,a]=[i,o];this.h._addBoundTextureToStream(e,s,a,n);}));}addBoolToStream(t,e,n){mr$1(this,e,(e=>{this.h._addBoolToInputStream(t,e,n);}));}addDoubleToStream(t,e,n){mr$1(this,e,(e=>{this.h._addDoubleToInputStream(t,e,n);}));}addFloatToStream(t,e,n){mr$1(this,e,(e=>{this.h._addFloatToInputStream(t,e,n);}));}addIntToStream(t,e,n){mr$1(this,e,(e=>{this.h._addIntToInputStream(t,e,n);}));}addUintToStream(t,e,n){mr$1(this,e,(e=>{this.h._addUintToInputStream(t,e,n);}));}addStringToStream(t,e,n){mr$1(this,e,(e=>{mr$1(this,t,(t=>{this.h._addStringToInputStream(t,e,n);}));}));}addStringRecordToStream(t,e,n){mr$1(this,e,(e=>{_r$1(this,Object.keys(t),(r=>{_r$1(this,Object.values(t),(i=>{this.h._addFlatHashMapToInputStream(r,i,Object.keys(t).length,e,n);}));}));}));}addProtoToStream(t,e,n,r){mr$1(this,n,(n=>{mr$1(this,e,(e=>{const i=this.h._malloc(t.length);this.h.HEAPU8.set(t,i),this.h._addProtoToInputStream(i,t.length,e,n,r),this.h._free(i);}));}));}addEmptyPacketToStream(t,e){mr$1(this,t,(t=>{this.h._addEmptyPacketToInputStream(t,e);}));}addBoolVectorToStream(t,e,n){mr$1(this,e,(e=>{const r=this.h._allocateBoolVector(t.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const e of t)this.h._addBoolVectorEntry(r,e);this.h._addBoolVectorToInputStream(r,e,n);}));}addDoubleVectorToStream(t,e,n){mr$1(this,e,(e=>{const r=this.h._allocateDoubleVector(t.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const e of t)this.h._addDoubleVectorEntry(r,e);this.h._addDoubleVectorToInputStream(r,e,n);}));}addFloatVectorToStream(t,e,n){mr$1(this,e,(e=>{const r=this.h._allocateFloatVector(t.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const e of t)this.h._addFloatVectorEntry(r,e);this.h._addFloatVectorToInputStream(r,e,n);}));}addIntVectorToStream(t,e,n){mr$1(this,e,(e=>{const r=this.h._allocateIntVector(t.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const e of t)this.h._addIntVectorEntry(r,e);this.h._addIntVectorToInputStream(r,e,n);}));}addUintVectorToStream(t,e,n){mr$1(this,e,(e=>{const r=this.h._allocateUintVector(t.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const e of t)this.h._addUintVectorEntry(r,e);this.h._addUintVectorToInputStream(r,e,n);}));}addStringVectorToStream(t,e,n){mr$1(this,e,(e=>{const r=this.h._allocateStringVector(t.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const e of t)mr$1(this,e,(t=>{this.h._addStringVectorEntry(r,t);}));this.h._addStringVectorToInputStream(r,e,n);}));}addBoolToInputSidePacket(t,e){mr$1(this,e,(e=>{this.h._addBoolToInputSidePacket(t,e);}));}addDoubleToInputSidePacket(t,e){mr$1(this,e,(e=>{this.h._addDoubleToInputSidePacket(t,e);}));}addFloatToInputSidePacket(t,e){mr$1(this,e,(e=>{this.h._addFloatToInputSidePacket(t,e);}));}addIntToInputSidePacket(t,e){mr$1(this,e,(e=>{this.h._addIntToInputSidePacket(t,e);}));}addUintToInputSidePacket(t,e){mr$1(this,e,(e=>{this.h._addUintToInputSidePacket(t,e);}));}addStringToInputSidePacket(t,e){mr$1(this,e,(e=>{mr$1(this,t,(t=>{this.h._addStringToInputSidePacket(t,e);}));}));}addProtoToInputSidePacket(t,e,n){mr$1(this,n,(n=>{mr$1(this,e,(e=>{const r=this.h._malloc(t.length);this.h.HEAPU8.set(t,r),this.h._addProtoToInputSidePacket(r,t.length,e,n),this.h._free(r);}));}));}addBoolVectorToInputSidePacket(t,e){mr$1(this,e,(e=>{const n=this.h._allocateBoolVector(t.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(const e of t)this.h._addBoolVectorEntry(n,e);this.h._addBoolVectorToInputSidePacket(n,e);}));}addDoubleVectorToInputSidePacket(t,e){mr$1(this,e,(e=>{const n=this.h._allocateDoubleVector(t.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(const e of t)this.h._addDoubleVectorEntry(n,e);this.h._addDoubleVectorToInputSidePacket(n,e);}));}addFloatVectorToInputSidePacket(t,e){mr$1(this,e,(e=>{const n=this.h._allocateFloatVector(t.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(const e of t)this.h._addFloatVectorEntry(n,e);this.h._addFloatVectorToInputSidePacket(n,e);}));}addIntVectorToInputSidePacket(t,e){mr$1(this,e,(e=>{const n=this.h._allocateIntVector(t.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(const e of t)this.h._addIntVectorEntry(n,e);this.h._addIntVectorToInputSidePacket(n,e);}));}addUintVectorToInputSidePacket(t,e){mr$1(this,e,(e=>{const n=this.h._allocateUintVector(t.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(const e of t)this.h._addUintVectorEntry(n,e);this.h._addUintVectorToInputSidePacket(n,e);}));}addStringVectorToInputSidePacket(t,e){mr$1(this,e,(e=>{const n=this.h._allocateStringVector(t.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(const e of t)mr$1(this,e,(t=>{this.h._addStringVectorEntry(n,t);}));this.h._addStringVectorToInputSidePacket(n,e);}));}attachBoolListener(t,e){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachBoolListener(t);}));}attachBoolVectorListener(t,e){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachBoolVectorListener(t);}));}attachIntListener(t,e){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachIntListener(t);}));}attachIntVectorListener(t,e){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachIntVectorListener(t);}));}attachUintListener(t,e){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachUintListener(t);}));}attachUintVectorListener(t,e){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachUintVectorListener(t);}));}attachDoubleListener(t,e){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachDoubleListener(t);}));}attachDoubleVectorListener(t,e){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachDoubleVectorListener(t);}));}attachFloatListener(t,e){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachFloatListener(t);}));}attachFloatVectorListener(t,e){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachFloatVectorListener(t);}));}attachStringListener(t,e){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachStringListener(t);}));}attachStringVectorListener(t,e){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachStringVectorListener(t);}));}attachProtoListener(t,e,n){br$1(this,t,e),mr$1(this,t,(t=>{this.h._attachProtoListener(t,n||!1);}));}attachProtoVectorListener(t,e,n){yr$1(this,t,e),mr$1(this,t,(t=>{this.h._attachProtoVectorListener(t,n||!1);}));}attachAudioListener(t,e,n){this.h._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),br$1(this,t,((t,n)=>{t=new Float32Array(t.buffer,t.byteOffset,t.length/4),e(t,n);})),mr$1(this,t,(t=>{this.h._attachAudioListener(t,n||!1);}));}finishProcessing(){this.h._waitUntilIdle();}closeGraph(){this.h._closeGraph(),this.h.simpleListeners=void 0,this.h.emptyPacketListeners=void 0;}},class extends wr$1{Y(){this.h._registerModelResourcesGraphService();}});var wr$1;async function Sr$1(t,e){const n=await(async(t,e,n)=>{var r=ni$1;if(t&&await gr$1(t),!self.ModuleFactory)throw Error("ModuleFactory not set.");if(e&&(await gr$1(e),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&n&&((t=self.Module).locateFile=n.locateFile,n.mainScriptUrlOrBlob&&(t.mainScriptUrlOrBlob=n.mainScriptUrlOrBlob)),n=await self.ModuleFactory(self.Module||n),self.ModuleFactory=self.Module=void 0,new r(n,null)})(t.wasmLoaderPath,t.assetLoaderPath,{locateFile:e=>e.endsWith(".wasm")?t.wasmBinaryPath.toString():t.assetBinaryPath&&e.endsWith(".data")?t.assetBinaryPath.toString():e});return await n.K(e),n}async function Ar$1(t,e){return Sr$1(t,e)}function Tr$1(t){try{const e=t.H.length;if(1===e)throw Error(t.H[0].message);if(e>1)throw Error("Encountered multiple errors: "+t.H.map((t=>t.message)).join(", "))}finally{t.H=[];}}function Er$1(t,e){t.G=Math.max(t.G,e);}var Ir$1=class{constructor(t){this.i=t,this.H=[],this.G=0,this.i.setAutoRenderToScreen(!1);}setGraph(t,e){this.i.attachErrorListener(((t,e)=>{this.H.push(Error(e));})),this.i.Y(),this.i.setGraph(t,e),Tr$1(this);}finishProcessing(){this.i.finishProcessing(),Tr$1(this);}close(){this.i.closeGraph();}};Ir$1.prototype.close=Ir$1.prototype.close;var Pr$1=class extends Ue$1{constructor(t){super(t);}};function Or$1(t,e){ve$1(t,1,e);}var Lr$1=class extends Ue$1{constructor(){super();}},Ur$1=[0,Wn$1,xn$1,Pn$1,-1,Un$1];function Br$1(t,e,n,r){if(void 0!==t.data){var i=new Uint8Array(t.data.buffer,e,n);return 1===r&&function(t,e,n){t.i.push([e,n]),t.i.sort(((t,e)=>t[0]-e[0])),e=0;for(const[r,i]of t.i){const t=i;(n=r)<=e&&(e=Math.max(e,n+t));}e===t.length&&(t.data=void 0);}(t,e,n),i}}class xr$1{constructor(t){this.i=[],this.data=t,this.length=t.length;}}var Nr$1=class{constructor(t,e,n){this.i=t,this.j=e,this.l=n;}get size(){let t=0;for(let e=0;e<this.i.length;e++)t+=this.i[e].length;return t}};function kr$1(t){if(t.i)try{t.h._free(t.j);}catch{}finally{t.i=!1;}}var jr$1=class{constructor(t,e){this.h=t,this.l=e,this.j=this.h._malloc(e)>>>0,this.o=this.h.HEAPU8,this.i=!!this.j;}get offset(){if(!this.i)throw Error("WasmFileReference has been freed.");return this.j}get size(){if(!this.i)throw Error("WasmFileReference has been freed.");return this.l}set(t,e){this.o.set(t,this.j+(e??0));}},Fr$1=class extends Ue$1{constructor(){super();}};Fr$1.prototype.i=Hn$1([0,Vn$1,2,Bn$1,xn$1,jn$1]);var Dr$1=class extends Ue$1{constructor(){super();}},Vr$1=class extends Ue$1{constructor(){super();}},Mr$1=class extends Ue$1{constructor(){super();}},Cr$1=class extends Ue$1{constructor(){super();}},Rr$1=[0,xn$1,-6,1,xn$1,1,[0,jn$1,Wn$1,-2],[0,jn$1,Pn$1],Wn$1,-2,[0,jn$1,-1,Wn$1,Pn$1,zn$1,Un$1],1,jn$1,xn$1,Un$1,-1,[0,Wn$1,xn$1],jn$1,-1,In$1,xn$1,-1],Gr$1=[0,[4,6],Rr$1,xn$1,1,Nn$1,Bn$1,Mn$1,Dn$1,[0,Vn$1,-2],Un$1,[0,[0,xn$1,-1,Cn$1,[0,xn$1,[0,xn$1,-1],-1,[0,Wn$1,-1],jn$1],jn$1,-2,xn$1,-1],[0,xn$1,-1,jn$1],Rr$1,jn$1,xn$1],Fn$1,-3,[0,xn$1,jn$1],Rr$1];Cr$1.prototype.i=Hn$1([0,Vn$1,8,[0,jn$1,-6],1,xn$1,1,xn$1,[0,Cn$1,[0,Vn$1,Ln$1,-1,Wn$1],Gr$1,xn$1],[0,xn$1,jn$1,-3],1,Wn$1,1,Gr$1,1,xn$1,5,Wn$1,En$1,1,Ur$1]);var zr$1=class extends Ue$1{constructor(){super();}},Wr$1=class extends Ue$1{constructor(){super();}},Hr$1=[2,4];Wr$1.prototype.i=Hn$1([0,Hr$1,xn$1,Mn$1,xn$1,Rn$1,[0,1,Vn$1]]);const $r$1=function(t){return class e extends t{static async Z(t,n){let r;n||=await e.O();const i=[];for(const e of t?.requiredFeatures??[])n.features.has(e)?i.push(e):console.warn(`WebGPU feature ${e} is not supported.`);t={...t,requiredFeatures:i};try{r=await n.requestDevice(t);}catch(t){throw console.error("Unable to initialize WebGPU with the requested features."),t}return (t=r).adapterInfo||(t.adapterInfo=n.info),r}static async O(t){if(!(t=await navigator.gpu.requestAdapter(t)))throw Error("Unable to request adapter from navigator.gpu; Ensure WebGPU is enabled.");return t}V(t){if(e)"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.id="canvas_webgpu");else var e=new OffscreenCanvas(1,1);e.getContext("webgpu").configure({device:t,format:navigator.gpu.getPreferredCanvasFormat()}),this.h.preinitializedWebGPUDevice=t;}R(){return this.h.ccall("closeGraph","void",[],[],{async:!0})}}}(function(t){return class extends t{addStreamingReaderToInputSidePacket(t,e){this.h.addStreamingReaderToInputSidePacket(((e,n,r)=>async function(t,e,n,r,i){if(2===i)return t.i=[],t.j=()=>Promise.resolve(void 0),setTimeout((()=>{t.l();}),0),Promise.resolve(0);for(;t.size<n+r;){var o=await t.j();if(void 0===o)break;t.i.push(new xr$1(o));}if(t.size<n+r)throw Error(`Data size is too small: ${t.size}, expected at least ${n+r}.`);o=e._malloc(r)>>>0;let s=0;for(let a=0;a<t.i.length;a++){const u=t.i[a];if(n>=u.length){n-=u.length;continue}const c=Math.min(r,u.length-n);if(void 0===(n=Br$1(u,n,c,i)))throw Error("Data has already been released.");if(e.HEAPU8.set(n,o+s),n=0,s+=c,0==(r-=c))break}if(0!==r)throw Error("Data not found.");return Promise.resolve(o)}(t,this.h,e,n,r)),e);}}}(function(t){return class extends t{P(t,e){mr$1(this,"lora_model_ref_in",(n=>{this.h._addRawDataSpanToInputStream(t.offset,t.size,n,e);}));}}}(class extends vr$1{})));class qr$1 extends $r$1{}var Kr$1=class{constructor(t){this.j=t,this.i=Yr$1,Yr$1++;}},Yr$1=0;class Jr$1{constructor(){let t,e;this.promise=new Promise(((n,r)=>{t=n,e=r;})),this.resolve=t,this.reject=e;}}function Xr$1(t){return 1===t?1:t+t%2}async function Zr$1(){const t=await qr$1.O({powerPreference:"high-performance"});var e=t.limits.maxBufferSize;if(t.limits.maxStorageBufferBindingSize<524550144)throw Error(`The WebGPU device is unable to execute LLM tasks, because the required maxStorageBufferBindingSize is at least 524550144 but your device only supports maxStorageBufferBindingSize of ${e}`);if(e>=786825216)e=786825216;else {if(!(e>=524550144))throw Error(`The WebGPU device is unable to execute LLM tasks, because the required maxBufferSize is at least 524550144 but your device only supports maxBufferSize of ${e}`);e=524550144;}if(e={requiredFeatures:["shader-f16"],requiredLimits:{maxStorageBufferBindingSize:524550144,maxBufferSize:e,maxStorageBuffersPerShaderStage:t.limits.maxStorageBuffersPerShaderStage}},t.features.has("subgroups")){console.warn("Experimental Chromium WGSL subgroup support detected. Enabling this feature in the inference engine.");const n=["shader-f16","subgroups"];t.features.has("subgroups-f16")&&n.push("subgroups-f16"),e.requiredFeatures=n;}return qr$1.Z(e,t)}function Qr$1(t){const e=function(t){const e=new ar$1;Oe$1(e,10,"text_in"),Oe$1(e,10,"token_cost_in"),Oe$1(e,10,"lora_model_id_to_apply_in"),Oe$1(e,10,"lora_model_ref_in"),Oe$1(e,10,"lora_model_id_to_load_in"),Oe$1(e,16,"streaming_reader"),Oe$1(e,15,"text_out"),Oe$1(e,15,"text_end"),Oe$1(e,15,"token_cost_out");var n=new nr$1;Pe$1(n,2,"TokenizerInputBuildCalculator"),Oe$1(n,3,"PROMPT:text_in"),Oe$1(n,3,"LORA_ID:lora_model_id_to_apply_in"),Oe$1(n,4,"prompt"),sr$1(e,n),Pe$1(n=new nr$1,2,"ModelDataCalculator"),Oe$1(n,6,"MODEL_DATA:__side_packet_1"),Oe$1(n,6,"MODEL_TYPE:model_type"),Oe$1(n,5,"READ_DATA_FN:streaming_reader"),Oe$1(n,3,"LORA_MODEL_SPAN:lora_model_ref_in"),Oe$1(n,3,"LORA_MODEL_ID:lora_model_id_to_load_in"),Oe$1(n,4,"LORA_DATA:lora_model_data"),sr$1(e,n),Pe$1(n=new nr$1,2,"Gpt2UnicodeMappingCalculator"),Oe$1(n,5,"MODEL_TYPE:model_type"),Oe$1(n,6,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),sr$1(e,n),Pe$1(n=new qn$1,1,"type.googleapis.com/odml.infra.proto.TokenizerCalculatorOptions");var r=new Wr$1,i=Ee$1(t.j,2);Ie$1(r,1,i),Pe$1(i=new zr$1,2,"spm_vocab_model"),null==i&&(i=void 0);t:{var o=r.m,s=K$1(o);if(ot$1(s),null==i){var a=_e$1(o);if(4!==be$1(a,o,s))break t;a.set(Hr$1,0);}else {const t=_e$1(a=o),e=be$1(t,a,s);4!==e&&(e&&(s=le$1(a,s,e)),t.set(Hr$1,4));}le$1(o,s,4,i);}return Ie$1(r,3,2),$n$1(n,r.i()),Pe$1(r=new nr$1,2,"TokenizerCalculator"),Ae$1(r,8,qn$1,n),Oe$1(r,5,"MODEL_DATA:__side_packet_1"),Oe$1(r,3,"PROMPT_AND_INPUT_OPTIONS:prompt"),Oe$1(r,5,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),Oe$1(r,6,"PROCESSOR_GETTER:__input_side_1"),Oe$1(r,4,"IDS_AND_INPUT_OPTIONS:__stream_0"),sr$1(e,r),Pe$1(n=new qn$1,1,"type.googleapis.com/odml.infra.proto.LlmGpuCalculatorOptions"),Ie$1(r=new Cr$1,12,3),Pe$1(r,1,"llm.tflite"),Ie$1(r,14,0),i=Xr$1(Ee$1(t.j,5)),Ie$1(r,22,i),i=ye$1(t.j,Pr$1,3),ve$1(r,31,i),me$1(i=new Dr$1,1,!0,!1),me$1(i,2,!0,!1),me$1(i,5,!0,!1),ve$1(r,10,i),i=he$1(t.j,4,kt$1,void 0===st$1?2:4),ge$1(r,29,i),i=new Mr$1,Ie$1(o=new Vr$1,1,1),a=Ee$1(t.j,2),Ie$1(o,2,a),ve$1(i,1,o),ve$1(r,20,i),$n$1(n,r.i()),Pe$1(r=new nr$1,2,"LlmGpuCalculator"),Ae$1(r,8,qn$1,n),Oe$1(r,3,"IDS_AND_INPUT_OPTIONS:__stream_0"),Oe$1(r,3,"FINISH:finish"),Oe$1(r,3,"LORA_DATA:lora_model_data"),Oe$1(r,5,"MODEL_DATA:__side_packet_1"),Oe$1(r,4,"DECODED_IDS:__stream_3"),Oe$1(r,4,"OUTPUT_END:__stream_4"),Pe$1(n=new tr$1,1,"FINISH"),me$1(n,2,!0,!1),Ae$1(r,13,tr$1,n),sr$1(e,r),Pe$1(n=new nr$1,2,"IsPacketPresentCalculator"),Oe$1(n,3,"__stream_4"),Oe$1(n,4,"text_end"),sr$1(e,n),Pe$1(n=new qn$1,1,"type.googleapis.com/odml.infra.proto.DetokenizerCalculatorOptions"),r=new Fr$1,t=Xr$1(Ee$1(t.j,5)),Ie$1(r,5,t),Oe$1(r,4,"<eos>"),Oe$1(r,4,"<|endoftext|>"),$n$1(n,r.i()),Pe$1(t=new nr$1,2,"DetokenizerCalculator"),Ae$1(t,8,qn$1,n),Oe$1(t,3,"IDS_AND_INPUT_OPTIONS:__stream_3"),Oe$1(t,5,"PROCESSOR_GETTER:__input_side_1"),Oe$1(t,5,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),Oe$1(t,5,"MODEL_DATA:__side_packet_1"),Oe$1(t,4,"FINISH_AND_INPUT_OPTIONS:finish"),Oe$1(t,4,"WORDS:text_out"),sr$1(e,t),Pe$1(t=new nr$1,2,"TokenCostCalculator"),Oe$1(t,3,"PROMPT:token_cost_in"),Oe$1(t,5,"PROCESSOR_GETTER:__input_side_1"),Oe$1(t,5,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),Oe$1(t,4,"NUM_TOKENS:token_cost_out"),sr$1(e,t),e}(t);t.i.attachStringVectorListener("text_out",((e,n)=>{e=function(t,e){return null==t||0===t.length?[]:t.map((t=>(t=(t=t.replaceAll("▁"," ")).replaceAll("<0x0A>","\n"),e&&(t=t.trimStart()),t.split("\\[eod\\]",1)[0])))}(e,0===t.D.length),e.forEach(((e,n)=>{n<Ee$1(t.j,5)&&t.D[n].push(e);})),t.A&&0===t.B.length&&(t.F?(e.length>Ee$1(t.j,5)&&e.pop(),t.A(e,!1)):t.A(e[0],!1)),Er$1(t,n);})),t.i.attachEmptyPacketListener("text_out",(e=>{Er$1(t,e);})),t.i.attachBoolListener("text_end",((e,n)=>{if(t.l=!1,Er$1(t,n),ti$1(t),t.o&&(t.o.resolve(t.D.map((t=>t.join("")))),t.o=void 0),t.A)if(t.F){for(e=[],n=0;n<Ee$1(t.j,5);n++)e.push("");t.A(e,!0);}else t.A("",!0);t.F=void 0;})),t.i.attachEmptyPacketListener("text_end",(e=>{t.l=!1,t.F=void 0,Er$1(t,e),ti$1(t),t.o&&(t.o.resolve(t.D.map((t=>t.join("")))),t.o=void 0);})),t.i.attachIntListener("token_cost_out",((e,n)=>{t.M=e,Er$1(t,n);})),t.J&&t.i.addStreamingReaderToInputSidePacket(t.J,"streaming_reader");const n=e.i();return t.v?.removeEventListener("uncapturederror",t.I),t.i.R().then((()=>{t.v?.addEventListener("uncapturederror",t.I),t.B.length=0,t.setGraph(new Uint8Array(n),!0),t.finishProcessing();}))}function ti$1(t){if(t.B.length>0){const e=[...t.B];if(t.B.length=0,!t.o)throw e;t.o.reject(e),t.o=void 0;}}function ei$1(t,e,n,r){if(t.l)throw Error("Previous invocation or loading is still ongoing.");for(t.A="function"==typeof n?n:r,t.l=!0,t.D.length=0,r=0;r<Ee$1(t.j,5);r++)t.D[r]=[];if(r=t.G+1,t.i.addStringToStream(e,"text_in",r),n instanceof Kr$1){if(n.j!==t)throw t.l=!1,t.F=void 0,Error("The LoRA model was not loaded by this LLM Inference task.");t.i.addUintToStream(n.i,"lora_model_id_to_apply_in",r);}else t.i.addEmptyPacketToStream("lora_model_id_to_apply_in",r);return t.finishProcessing(),t.o=new Jr$1,t.o.promise}var ni$1=class extends Ir$1{constructor(t,e){super(new qr$1(t,e)),this.D=[],this.l=!1,this.B=[],this.I=t=>{const e=(t=t.error).message.match(/exceeds the max buffer size limit \(([0-9]+)\)\./);e&&Number(e[1])>524550144?t=Error(`Failed to run this LLM model, but you could try a smaller LLM model. WebGPU throws: "${t.message}"`):t.message.match(/is larger than the maximum binding size/)&&(t=Error(`Failed to run LLM inference, the supported max binding size is smaller than the required size. WebGPU throws: "${t.message}"`)),this.B.push(t);},this.j=new Lr$1,Or$1(this.j,new ur$1),this.u=new Pr$1,ve$1(this.j,3,this.u),ce$1(this.j,2,jt$1(512)),me$1(this.u,1,2,0),Ie$1(this.u,2,40),me$1(this.u,3,Ot$1(1),0),ce$1(this.u,5,Nt$1(0)),me$1(this.u,4,Ot$1(.8),0),ce$1(this.j,5,jt$1(1));}K(t){if(this.l)throw Error("Cannot set options while loading or processing.");if(this.l=!0,t.baseOptions?.gpuOptions?.device&&(this.v&&this.v.removeEventListener("uncapturederror",this.I),this.v=t.baseOptions.gpuOptions.device,this.i.V(this.v),this.v.addEventListener("uncapturederror",this.I)),"maxTokens"in t&&ce$1(this.j,2,jt$1(t.maxTokens??512)),"topK"in t&&Ie$1(this.u,2,t.topK??40),"temperature"in t&&me$1(this.u,4,Ot$1(t.temperature??.8),0),"randomSeed"in t&&ce$1(this.u,5,Nt$1(t.randomSeed??0)),"loraRanks"in t&&function(t,e){ge$1(t,4,e);}(this.j,t.loraRanks??[]),"numResponses"in t){var e=t.numResponses??1;if(e<1)throw Error("'numResponses' must be at least 1.");ce$1(this.j,5,jt$1(e));var n=ye$1(this.j,Pr$1,3);e>1&&n&&(Te$1(kt$1(se$1(n,2)))<=1||Te$1(function(t){t=t.m;let e=K$1(t);const n=ue$1(t,e,4),r=Lt$1(n);return null!=r&&r!==n&&le$1(t,e,4,r),r}(n))<=0)&&console.warn("To generate multiple responses, it is expected topK > 1 and temperature > 0; otherwise, all the generated responses may be the same.");}let r;if(e=new Promise((t=>{r=t;})),t.baseOptions?.modelAssetPath||t.baseOptions?.modelAssetBuffer){if(t.baseOptions.modelAssetPath&&t.baseOptions.modelAssetBuffer)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");n=!1,t.baseOptions.modelAssetPath?this.J=function(t,e){const n=fetch(t.toString()).then((t=>t?.body?.getReader()));return new Nr$1([],(async()=>{let e;try{e=await n;}catch(e){throw Error(`Error loading model from "${t.toString()}": ${e}`)}const{value:r,done:i}=await e.read();return i?void 0:r}),e)}(t.baseOptions.modelAssetPath,r):t.baseOptions.modelAssetBuffer instanceof Uint8Array?(this.J=function(t,e){return new Nr$1([new xr$1(t)],(()=>Promise.resolve(void 0)),e)}(t.baseOptions.modelAssetBuffer,r),n=!0):t.baseOptions.modelAssetBuffer?(this.J=function(t,e){return new Nr$1([],(async()=>{const{value:e,done:n}=await t.read();return n?void 0:e}),e)}(t.baseOptions.modelAssetBuffer,r),n=!0):r(),n&&(t.baseOptions.modelAssetBuffer=void 0);}return t=Qr$1(this).then((()=>{})),Promise.all([e,t]).then((()=>{this.l=!1,ti$1(this);}))}get baseOptions(){return ye$1(this.j,ur$1,1)}set baseOptions(t){Or$1(this.j,t);}T(t,e,n){return Ee$1(this.j,5)>1&&console.warn("'numResponses' is set larger than 1 and this function only returns the first response, so we recommend either using 'generateResponses()' to obtain multiple responses, or else setting 'numResponses' to 1 for better performance."),this.F=!1,ei$1(this,t,e,n).then((t=>t[0]))}U(t,e,n){return this.F=!0,ei$1(this,t,e,n)}aa(t){if(this.l)throw Error("Previous invocation or loading is still ongoing.");return this.l=!0,this.M=void 0,this.i.addStringToStream(t,"token_cost_in",this.G+1),this.finishProcessing(),this.l=!1,this.M}async X(t){if(this.l)throw Error("Cannot load LoRA model while loading or processing.");if(this.l=!0,t instanceof Uint8Array){var e=new jr$1(this.i.h,t.length);e.set(t),t=e;}else t=await async function(t,e){var n=await fetch(e.toString());e=Number(n.headers.get("content-length")),t=new jr$1(t,e);let r=0;for(n=n?.body?.getReader();;){const{value:e,done:i}=await n.read();if(i)break;t.set(e,r),r+=e.byteLength;}if(e!==r)throw kr$1(t),Error(`File could not be fully loaded to memory, so was not retained. Loaded ${r}/${e} bytes before failure`);return t}(this.i.h,t);return e=new Kr$1(this),this.i.P(t,this.G+1),this.i.addUintToStream(e.i,"lora_model_id_to_load_in",this.G+1),this.finishProcessing(),kr$1(t),this.l=!1,e}close(){this.v?.removeEventListener("uncapturederror",this.I),super.close();}};ni$1.prototype.loadLoraModel=ni$1.prototype.X,ni$1.prototype.sizeInTokens=ni$1.prototype.aa,ni$1.prototype.generateResponses=ni$1.prototype.U,ni$1.prototype.generateResponse=ni$1.prototype.T,ni$1.prototype.setOptions=ni$1.prototype.K,ni$1.createWebGpuDevice=Zr$1,ni$1.createFromModelPath=async function(t,e){return Ar$1(t,e={baseOptions:{gpuOptions:{device:await Zr$1()},modelAssetPath:e}})},ni$1.createFromModelBuffer=async function(t,e){return Ar$1(t,e={baseOptions:{gpuOptions:{device:await Zr$1()},modelAssetBuffer:e}})},ni$1.createFromOptions=async function(t,e){if(!e.baseOptions?.gpuOptions?.device){const t=await Zr$1();e.baseOptions=e.baseOptions??{},e.baseOptions.gpuOptions=e?.baseOptions?.gpuOptions??{},e.baseOptions.gpuOptions.device=t;}return Ar$1(t,e)};

  //import KeyboardInput from 'node_modules/../KeyboardInput'
  class OTTAvatar extends KeyboardInput {
    static get __componentName() {
      return 'OTTAvatar';
    }
    static get properties() {
      return [...super.properties, 'additionalProperty'];
    }
    static _template() {
      return {
        //...super._template(),
        //Content:{ x: 100, y:100,
        ScrollWrapper: {
          type: ScrollWrapper,
          x: 300,
          y: 50,
          h: 300,
          w: 996,
          scrollStep: 2,
          autoResizeWidth: true,
          autoResizeHeight: true,
          autoScroll: false,
          autoScrollDelay: 2000,
          autoScrollSpeed: 10,
          showScrollBar: true,
          rect: true,
          color: 0x4c505050,
          //light black background color               
          content: [{
            text: 'Initiallizing....',
            style: {
              fontStyle: 'italic',
              textAlign: 'center',
              textColor: 0xffffffff,
              fontSize: fontsizes.searchPageToastMessage
            }
          }
          // Add more content here as needed
          ],
          signals: {
            scrollChanged: true
          }
        },
        Wrapper: {
          x: 300,
          y: 380,
          //h: 200,
          //w: 996,
          type: Column,
          neverScroll: true,
          w: this.w,
          items: [{
            type: Input,
            ref: 'Input'
          }, {
            type: KeyboardQwerty,
            ref: 'Keyboard',
            //keyboardType: KeyboardQwerty,
            passSignals: {
              keyboardWidthChanged: true
            }
          }]
        }
        //w: utils.getWidthByUpCount(context.theme, 1),
        //}
      };
    }
    static get tags() {
      return [...super.tags, {
        name: 'Wrapper',
        path: 'Wrapper'
      }, {
        name: 'Input',
        path: 'Wrapper.Input'
      }, {
        name: 'Keyboard',
        path: 'Wrapper.Keyboard'
      }];
    }
    _focus() {
      // Ensure state is set correctly
      Storage.set('state', 'OTTAvatar');
      this.patch({
        alpha: 1
      });
      this._setState('Keyboard');
      // Ensure widget visibility is handled
      if (this.widgets) {
        this.widgets.menu.alpha = 0;
        this.widgets.iconmenu.alpha = 1;
      } else {
        console.error('Widgets are not available during focus.');
      }
    }
    _init() {
      //super._init();  
      this._index = 2;
      this._updateKeyboardType();

      // Ensure widgets are properly initialized
      if (this.widgets) {
        this.widgets.menu.alpha = 0;
        this.widgets.iconmenu.alpha = 1;
      } else {
        console.error('Widgets are not initialized properly.');
      }
    }
    _update() {
      super._update();
      this._updateAdditionalComponent();
    }
    _updateAdditionalComponent() {
      const inputTag = this.tag('Input');
      if (inputTag) {
        console.log(inputTag);
        inputTag.patch({
          w: this.w,
          style: {
            ...this.style.additionalComponentStyle
          }
        });
      }
    }
    _updateKeyboardType() {
      if (!this.keyboardType || this._Keyboard.constructor !== this.keyboardType) {
        this._Wrapper._resetItems();
        this._Wrapper.items = [{
          type: Input,
          ref: 'Input'
        }, {
          type: this.keyboardType || KeyboardQwerty,
          ref: 'Keyboard',
          passSignals: {
            keyboardWidthChanged: true
          }
        }];
      }
    }
    $onSoftKey(_ref) {
      let {
        key = '',
        toggle
      } = _ref;
      if (toggle) {
        return;
      }
      console.log("Key pressed: ".concat(key)); // Capture and print the key
      super.$onSoftKey({
        key,
        toggle
      });
      switch (key.toLowerCase()) {
        case 'customkey':
          this._handleCustomKey();
          break;
        case 'done':
          this._handleDoneKey();
          break;
        // Handle other keys if necessary
      }
    }
    _handleCustomKey() {
      // Custom logic for handling the custom key
      console.log('Custom key pressed');
    }
    _handleDoneKey() {
      // Custom logic for handling the done key
      console.log('Done key pressed');
      const inputTag = this.tag('Wrapper').tag('Input');
      if (inputTag) {
        const inputText = inputTag.actualTitle;
        console.log('Input text:', inputText);
        this._llmInferenceFun(inputText);
      } else {
        console.error('Input tag not found');
      }
    }
    $keyboardFocused(focus) {
      super.$keyboardFocused(focus);
      // Additional logic when keyboard is focused/unfocused
    }

    // _enable() {
    //   if (categories && !this.widgets.menu.categories) {
    //     this.widgets.menu.data = categories
    //     this.widgets.iconmenu.data = categories
    //     this.widgets.menu.activeIndex = Storage.get(activeCategory) || null
    //     this.widgets.iconmenu.activeIndex = Storage.get(activeCategory) || null
    //   }
    // }

    _handleUp() {
      if (this._index > 0) {
        this._index--;
        if (this._index == 0) {
          this.focusItem = 'ScrollWrapper';
        }
      }
    }
    _handleDown() {
      if (this._index == 0) {
        this._index++;
        this.focusItem = 'Wrapper';
      }
    }
    _handleLeft() {
      if (this.focusItem === 'ScrollWrapper' || this.focusItem === 'Wrapper') {
        this.widgets.menu.alpha = 1;
        this.widgets.iconmenu.alpha = 0;
        Router.focusWidget('Menu');
      }
    }
    _getFocused() {
      if (this.focusItem == 'KeyBoardInput') return Router.focusWidget('KeyboardInput');
      if (this._index >= 0) {
        //&& !Storage.get('stateInfo')) {
        if (this.focusItem == 'ScrollWrapper') return this.tag('ScrollWrapper');
        if (this.focusItem == 'Wrapper') return this.tag('Wrapper');
      }
      //if (Storage.get('stateInfo')) return Router.focusWidget('OTTAvatar')
    }
    _handleBack() {
      Router.back();
    }

    // Update the global response and patch the ScrollWrapper text
    updateGlobalResponse(newResponse) {
      this.tag('ScrollWrapper').patch({
        content: [{
          text: newResponse,
          style: {
            fontStyle: 'italic',
            textAlign: 'center',
            textColor: 0xffffffff,
            fontSize: fontsizes.searchPageToastMessage
          }
        }]
      });
    }
    //Mediapipe task
    async _llmInferenceFun(inputText) {
      const llmInference = await ni$1.createFromOptions(
      //await FilesetResolver.forGenAiTasks('https://cdn.jsdelivr.net/npm/@mediapipe/tasks-genai@latest/wasm'),
      await dr$1.forGenAiTasks('./static/wasm'), {
        baseOptions: {
          modelAssetPath: './static/wasm/gemma-2b-it-gpu-int4.bin'
          //modelFileName
        },
        maxTokens: 500,
        topK: 40,
        temperature: 0.8,
        randomSeed: 51 //101
      });
      const response = await llmInference.generateResponse(inputText);
      console.log("Res:", response);
      this.updateGlobalResponse(response);
    }
    //media tasks ended
  }

  class Canvas extends Lightning.Component {
    static _template() {
      return {
        Example: {
          texture: Lightning.Tools.getCanvasTexture(() => this._createCanvas())
        }
      };
    }
    static _createCanvas() {
      const canvas = document.createElement('canvas'); // Create a new canvas element
      canvas.width = 100;
      canvas.height = 100;
      const ctx = canvas.getContext('2d');
      ctx.imageSmoothingEnabled = true;
      ctx.fillStyle = 'rgba(255, 0, 0, 1)'; // Red fill color
      ctx.fillRect(10, 10, 80, 80); // Draw a rectangle

      return canvas; // Return the canvas
    }
  }

  class OTTWebgpu extends Lightning.Component {
    static _template() {
      return {
        w: App.width,
        h: App.height,
        Background: {
          w: 1920,
          h: 1080,
          color: Colors('black').get(),
          rect: true
        },
        Main: {
          //type: CanvasTextureExample,
          x: 100,
          // Position X
          y: 100 // Position Y
        }
      };
    }
  }

  var routes = {
    boot: () => {
      Storage.remove(activeCategory);
      Storage.remove(stateInfo);
      Storage.remove(gridStateInfo);
      Storage.set('mainCategory', true);
    },
    root: 'home',
    routes: [{
      path: 'home',
      component: Home,
      before: async page => {
        if (Storage.get(stateInfo)) {
          const stateData = JSON.parse(Storage.get(stateInfo));
          if (stateData.home == 0) {
            Storage.remove(stateInfo);
          }
        }
        page.widgets.loader.alpha = 1;
        Storage.set(activeCategory, '0');
        return page.prepareData();
      },
      widgets: ['IconMenu', 'Menu', 'Banner', 'VideoSlider', 'Loader', 'EmptyPage', 'Popup', 'BannerItem']
    }, {
      path: 'category',
      component: Category,
      before: async (page, _ref) => {
        let {
          categoryId
        } = _ref;
        if (Storage.get(stateInfo)) {
          const stateData = JSON.parse(Storage.get(stateInfo));
          if (stateData.home == 1) {
            Storage.remove(stateInfo);
          }
        }
        page.widgets.loader.alpha = 1;
        Storage.set(activeCategory, 2);
        return page.prepareData(categoryId);
      },
      widgets: ['IconMenu', 'Menu', 'BannerItem', 'Banner', 'VideoSlider', 'Loader', 'EmptyPage', 'Popup']
    }, {
      path: 'details/:videoId',
      component: Details,
      before: async (page, _ref2) => {
        let {
          videoId
        } = _ref2;
        page.prepareData(videoId);
      },
      widgets: ['ButtonsList', 'Loader', 'Popup', 'DetailsBtns']
    }, {
      path: 'player',
      component: Player,
      before: async page => {
        return page.initializePlayback();
      },
      widgets: ['PlayerControls', 'Popup', 'ProgressBar', 'Loader']
    }, {
      path: 'search',
      component: Search,
      on: async page => {
        page.widgets.loader.alpha = 1;
        Storage.set(activeCategory, '1');
        page.widgets.menu.data = categories$1;
        page.widgets.iconmenu.data = categories$1;
        page.widgets.menu.activeIndex = Storage.get(activeCategory);
        page.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
      },
      widgets: ['IconMenu', 'Menu', 'Loader', 'Popup', 'Keyboard', 'SearchResults']
    }, {
      path: 'profile',
      component: UserProfile,
      before: async page => {
        page.widgets.loader.alpha = 1;
        page.widgets.profilebuttons.listVisibility = 0;
        page.prepareData();
        Storage.set(activeCategory, '3');
        page.widgets.menu.activeIndex = Storage.get(activeCategory);
        page.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
      },
      widgets: ['IconMenu', 'Menu', 'Loader', 'ProfileButtons', 'Popup', 'StaticData', 'ScrollList']
    }, {
      path: 'subcategory/:key',
      component: SubCategory,
      before: async (page, _ref3) => {
        let {
          key
        } = _ref3;
        return page.prepareData(key);
      },
      widgets: ['IconMenu', 'Menu', 'BannerItem', 'VideoGrid', 'Loader', 'EmptyPage']
    }, {
      // added this {}
      path: 'ottavatar',
      component: OTTAvatar,
      on: async page => {
        page.widgets.loader.alpha = 1;
        Storage.set(activeCategory, '4');
        page.widgets.menu.data = categories$1;
        page.widgets.iconmenu.data = categories$1;
        page.widgets.menu.activeIndex = Storage.get(activeCategory);
        page.widgets.iconmenu.activeIndex = Storage.get(activeCategory);
      },
      // widgets: ['IconMenu', 'Menu', 'Loader', 'Popup', 'ChatBox', 'SearchResults'],
      widgets: ['IconMenu', 'Menu']
    },
    // { 
    //   path: 'ottwebgpu',
    //   component: OTTWebgpu,
    //   on: async (page) => {
    //     page.widgets.loader.alpha = 1
    //     Storage.set(activeCategory, '5')
    //   },  
    //   widgets: ['Loader', ],
    // },
    {
      path: '$',
      component: Splash
    }],
    beforeEachRoute: async (from, to) => {
      if (from != undefined) {
        const fromRoute = from;
        const toRoute = to._hash;
        Storage.set('route', fromRoute);
        Storage.set('toroute', toRoute);
        if (fromRoute.includes('player')) {
          var _Router$getActivePage;
          VideoPlayer.close();
          (_Router$getActivePage = Router.getActivePage().dash) === null || _Router$getActivePage === void 0 || _Router$getActivePage.reset();
        }
        toRoute == 'home' || toRoute.includes('category') || toRoute == 'profile' || toRoute == 'search' ? Storage.set('mainCategory', true) : Storage.set('mainCategory', false);
        if (fromRoute.includes('details') && toRoute === 'search' || toRoute.includes('details/')) {
          return true;
        }
        if (Storage.get('prevsearchkey') && !toRoute.includes('player')) {
          Storage.set('prevsearchkey', '');
          return true;
        }
        return true;
      } else {
        Storage.set('prevsearchkey', '');
        return true;
      }
    }
  };

  class Menu extends Lightning.Component {
    static _template() {
      return {
        Logo: {
          zIndex: 9,
          x: 85,
          y: 70,
          mountY: 0.5,
          src: Utils.asset("images/menu_open.png")
        },
        TransparentBg: {
          zIndex: 8,
          rect: true,
          w: 360,
          h: 200,
          x: 0,
          y: 0,
          color: colors.background
        },
        MenuWrapper: {
          zIndex: 6,
          w: 360,
          h: App$1.height,
          color: colors.background,
          rect: true,
          clipping: true,
          Items: {
            x: 0,
            y: 280,
            h: App$1.height,
            flex: {
              direction: 'column'
            }
          }
        },
        Shadow: {
          zIndex: 5,
          color: colors.menuShadowColor,
          x: 303,
          y: -50,
          texture: Lightning.Tools.getShadowRect(40, 1100, 10, 16)
        }
      };
    }
    _init() {
      this._index = 0;
    }
    _getFocused() {
      return this.tag('Items').children[this._index];
    }
    _focus() {
      this.patch({
        alpha: 1
      });
    }
    _unfocus() {
      this.patch({
        alpha: 0
      });
    }
    set data(categoriesData) {
      this._items = [];
      if (this.tag('Items').children.length) this.tag('Items').children = [];
      if (!Array.isArray(this._items) || this._items && this._items.length === 0) {
        this._items = [];
      }
      this._items = categoriesData || [];
      this._items = this._items.filter(function (navitem) {
        var _navitem$items;
        let emptyAfterFilter = false;
        if ((_navitem$items = navitem.items) !== null && _navitem$items !== void 0 && _navitem$items.length) {
          navitem.items = navitem.items.filter(function (item) {
            return (item === null || item === void 0 ? void 0 : item.category_id) !== undefined && item.category_id !== '';
          });
          emptyAfterFilter = navitem.items.length === 0;
        }
        return (navitem === null || navitem === void 0 ? void 0 : navitem.category_id) !== undefined && navitem.category_id !== '' && !emptyAfterFilter;
      });
      this.tag('Items').children = this._items.map(item => {
        return {
          type: MenuItem,
          item,
          flexItem: {
            marginBottom: 30
          }
        };
      });
      this._height = App$1.height + this.tag('Items').children.length * 82;
      this.wrapperHeight = this._height;
    }
    set wrapperHeight(height) {
      this.tag('MenuWrapper').patch({
        h: height
      });
    }
    setIndex(index) {
      this._index = index;
    }
    _handleRight() {
      Router.focusPage();
    }
    _handleEnter() {
      if (!Storage.get('mainCategory') || this._index != Storage.get(activeCategory)) {
        Storage.remove(stateInfo);
        this.selectedId = this._index;
        Storage.set(activeCategory, this._index);
        switch (this._items[this._index].slug) {
          case 'home':
            {
              Router.navigate('home');
              break;
            }
          case 'search':
            {
              Router.navigate('search');
              break;
            }
          case 'profile':
            {
              Router.navigate('profile');
              break;
            }
          case 'movies':
            {
              Router.navigate('category');
              break;
            }
          //added newly
          case 'ottavatar':
            {
              Router.navigate('ottavatar');
              break;
            }
        }
        Router.getActivePage().widgets.loader.alpha = 1;
        this._refocus();
      } else {
        Router.focusPage();
      }
    }
    _handleDown() {
      this.setNext();
    }
    _handleUp() {
      this.setPrevious();
    }
    setPrevious() {
      if (this.tag('Items').children[this._index - 1] && this.tag('Items').children[this._index - 1].visible === false) {
        this.setIndex(this._index - 1);
      }
      if (this._index != 0) {
        this.setIndex(this._index - 1);
      }
      this.scroll('up');
      Router.getActivePage().widgets.iconmenu.scroll();
    }
    setNext() {
      if (this._index < this._items.length - 1) {
        this._index++;
        this.scroll('down');
        Router.getActivePage().widgets.iconmenu.scroll();
      }
    }
    scroll(dir) {
      if (this._items.length > 6) {
        if (this._index > 5 || this._index === 5 && dir === 'up') {
          const i = this._index - 5;
          this.tag('MenuWrapper').patch({
            smooth: {
              y: -(i * 83)
            }
          });
          setScroll(-(i * 83));
        }
      }
    }
    scrollToSpecificItem() {
      if (this._index == this._items.length) {
        Router.getActivePage().widgets.iconmenu.scroll();
        return;
      } // this is for signIn/profile menuItem

      if (this._items.length > 6) {
        if (this._index > 5) {
          const i = this._index - 5;
          this.tag('MenuWrapper').patch({
            smooth: {
              y: -(i * 83)
            }
          });
          setScroll(-(i * 83));
        } else {
          //settingToZero
          this.tag('MenuWrapper').patch({
            smooth: {
              y: 0
            }
          });
          setScroll(0);
        }
      }
      Router.getActivePage().widgets.iconmenu.scroll();
    }
    removeActiveindex() {
      const items = this.tag('Items').children;
      for (const item of items) {
        item.patch({
          Focus: {
            texture: Lightning.Tools.getRoundRect(390, 60, 15, 0, colors.focusBorderColor, false)
          },
          Title: {
            ImageHome: {
              color: colors.fontColor
            }
          }
        });
      }
    }
    updateIndex(position) {
      this.tag('Items').children[position].patch({
        Focus: {
          texture: Lightning.Tools.getRoundRect(390, 60, 1, 3, colors.focusBorderColor, true, colors.focusFillColor)
        },
        Title: {
          ImageHome: {
            color: colors.focusBorderColor
          }
        }
      });
    }
    set activeIndex(index) {
      this._index = index;
      this.scrollToSpecificItem();
      this.removeActiveindex();
      for (const _item of this.tag('Items').children) {
        this.updateIndex(this._index);
      }
      this._refocus();
    }
    _handleLeft() {
      return;
    }
    _handleKey() {
      return;
    }
    _handleBack() {
      Router.getActivePage().widgets.popup.prompt = {
        action: 'exit',
        h: 660,
        w: 550,
        bh: 660,
        text: Language.translate('exit_alert'),
        button: {
          ok: Language.translate('alert_yes'),
          no: Language.translate('alert_no')
        }
      };
      Router.focusWidget('Popup');
    }
  }
  class MenuItem extends Lightning.Component {
    static _template() {
      return {
        h: 60,
        Focus: {
          texture: Lightning.Tools.getRoundRect(360, 60, 0, 0, colors.menuItemFocusColor, false),
          h: 60,
          w: 360,
          y: 0,
          x: 0
        },
        ImageHome: {
          x: 40,
          y: 10,
          paddingLeft: 20,
          verticalAlign: 'middle',
          alpha: 1
        },
        Label: {
          y: 13,
          text: {
            fontFace: 'Regular',
            fontSize: fontsizes.menuItemText,
            textColor: colors.fontColor,
            textAlign: 'center',
            verticalAlign: 'middle',
            paddingLeft: 120,
            wordWrapWidth: 200,
            maxLines: 1,
            maxLinesSuffix: '...'
          }
        }
      };
    }
    set item(label) {
      this.patch({
        ImageHome: {
          w: label.slug == 'movies' ? 34 : 36,
          h: label.slug == 'movies' ? 34 : 36,
          src: Utils.asset(label.icon)
        },
        Label: {
          text: {
            text: label.title
          }
        }
      });
    }
    _focus() {
      this.tag('Focus').patch({
        texture: Lightning.Tools.getRoundRect(360, 60, 1, 3, colors.focusBorderColor, true, colors.focusFillColor)
      });
    }
    _unfocus() {
      this.tag('Focus').patch({
        texture: Lightning.Tools.getRoundRect(325, 60, 0, 0, colors.menuItemFocusColor, false)
      });
    }
  }

  class Loader extends Lightning.Component {
    static _template() {
      return {
        alpha: 0,
        zIndex: 9,
        Spinner: {
          mount: 0.5,
          x: 960,
          y: 540,
          w: 140,
          h: 140,
          src: Utils.asset('images/spinner.png')
        }
      };
    }
    _init() {
      this._spin = this.tag('Spinner').animation({
        duration: 2,
        repeat: -1,
        actions: [{
          p: 'rotation',
          v: {
            0: 0,
            1: Math.PI * 2
          }
        }]
      });
    }
    _enable() {
      this._spin.start();
    }
    set positions(v) {
      if (v) {
        this.tag("Spinner").patch({
          x: 1200,
          y: 540
        });
      }
    }
    _disable() {
      this.tag("Spinner").patch({
        x: 960,
        y: 540
      });
    }
    finish() {
      this.setSmooth('alpha', 0, {
        duration: 0.6
      });
      setTimeout(() => this._spin.stop(), 400);
    }
  }

  class IconMenu extends Lightning.Component {
    static _template() {
      return {
        Logo: {
          zIndex: 7,
          x: 80,
          y: App$1.height * 0.13 * 0.5,
          mount: 0.5,
          src: Utils.asset('images/logo.png')
        },
        TransparentBg: {
          zIndex: 6,
          rect: true,
          w: 160,
          h: 200,
          x: 0,
          y: 0,
          color: colors.background
        },
        TransparentBg2: {
          zIndex: 6,
          rect: true,
          w: 160,
          h: 400,
          x: 0,
          y: 910,
          color: colors.background
        },
        MenuWrapper: {
          zIndex: 5,
          w: 160,
          h: App$1.height,
          color: colors.background,
          rect: true,
          clipping: true,
          Items: {
            x: 0,
            y: 280,
            h: App$1.height,
            flex: {
              direction: 'column'
            }
          }
        },
        Shadow: {
          zIndex: 4,
          color: colors.popupBlurColor,
          x: 102,
          y: -25,
          texture: Lightning.Tools.getShadowRect(40, 1080, 10, 16)
        }
      };
    }
    _init() {
      this.selectedPosition = 0;
      this.focusItem = '';
    }
    _getFocused() {
      if (this.selectedPosition == -1 || this.selectedPosition == this._items.length) return;
      return this.tag('Items').children[this.selectedPosition];
    }
    set data(data) {
      this._items = [];
      if (this.tag('Items').children.length) this.tag('Items').children = [];
      if (!Array.isArray(this._items) || this._items && this._items.length === 0) {
        this._items = [];
      }
      this._items = data;
      this._items = this._items.filter(function (navitem) {
        var _navitem$items;
        let emptyAfterFilter = false;
        if ((_navitem$items = navitem.items) !== null && _navitem$items !== void 0 && _navitem$items.length) {
          navitem.items = navitem.items.filter(function (item) {
            return (item === null || item === void 0 ? void 0 : item.category_id) !== undefined && item.category_id !== '';
          });
          emptyAfterFilter = navitem.items.length === 0;
        }
        return (navitem === null || navitem === void 0 ? void 0 : navitem.category_id) !== undefined && navitem.category_id !== '' && !emptyAfterFilter;
      });
      this.tag('Items').children = this._items.map(item => {
        return {
          type: IconsItem,
          item,
          flexItem: {
            marginBottom: 30
          }
        };
      });
      this._height = App$1.height + this.tag('Items').children.length * 82;
      this.wrapperHeight = this._height;
    }
    set wrapperHeight(height) {
      this.tag('MenuWrapper').patch({
        h: height
      });
    }
    setIndex(index) {
      this.selectedPosition = index;
    }
    _handleRight() {
      Router.focusPage();
    }
    _handleLeft() {
      Router.focusWidget('Menu');
    }
    set activeIndex(selectedPosition) {
      this.selectedPosition = selectedPosition;
      this.removeIndicators();
      this.updateCategories(selectedPosition);
    }
    _handleDown() {
      this.setNext();
    }
    _handleUp() {
      this.setPrevious();
    }
    _handleKey() {
      return;
    }
    setPrevious() {
      if (this.selectedPosition >= 1) {
        if (this.tag('Items').children[this.selectedPosition - 1] && this.tag('Items').children[this.selectedPosition - 1].visible === false) {
          this.setIndex(this.selectedPosition - 1);
        }
        this.setIndex(this.selectedPosition - 1);
        this.scroll('up');
      }
    }
    setNext() {
      if (this.selectedPosition === this._items.length - 1) {
        this.selectedPosition = this._items.length - 1;
      } else if (this.selectedPosition < this._items.length) {
        this.selectedPosition++;
        this.scroll('down');
      }
    }
    scroll() {
      this.tag('MenuWrapper').patch({
        smooth: {
          y: scroll
        }
      });
    }
    removeIndicators() {
      if (this._items.length > 0) {
        const items = this.tag('Items').children;
        for (const item of items) {
          item.patch({
            ImageHome: {
              color: colors.fontColor
            }
          });
        }
      }
    }
    updateCategories(position) {
      var _this$tag$children$po;
      (_this$tag$children$po = this.tag('Items').children[position]) === null || _this$tag$children$po === void 0 || _this$tag$children$po.patch({
        ImageHome: {
          color: colors.focusBorderColor
        }
      });
    }
  }
  class IconsItem extends Lightning.Component {
    static _template() {
      return {
        h: 60,
        ImageHome: {
          w: 35,
          h: 35,
          x: 80,
          mountX: 0.5,
          y: 33,
          mountY: 0.5,
          alpha: 1
        }
      };
    }
    set item(data) {
      this.tag('ImageHome').patch({
        src: Utils.asset(data.icon)
      });
    }
  }

  class CircleIndicator extends Lightning.Component {
    static _template() {
      return {
        RoundRectangle: {
          texture: Lightning.Tools.getRoundRect(24, 24, 12, 2, colors.fontColor, true, colors.fontColor)
        }
      };
    }
  }

  class DynamicButton extends Lightning.Component {
    static _template() {
      return {
        h: h => h,
        w: w => w,
        Background: {
          rect: true,
          texture: Lightning.Tools.getRoundRect(300, 80, 8, 2, colors.focusBorderColor, true, colors.focusFillColor)
        },
        Label: {
          color: colors.dynamicBtnLabel,
          mountY: 0.5,
          text: {
            fontFace: 'Bold',
            fontSize: 26,
            textAlign: 'center',
            wordWrap: true,
            wordWrapWidth: 480,
            maxLines: 1,
            maxLinesSuffix: '...'
          }
        },
        UnderLine: {
          x: 40,
          y: 47,
          alpha: 0
        }
      };
    }
    _init() {
      if (this.w && !isNaN(this.w)) {
        return;
      }
      this.tag('Label').on('txLoaded', () => {
        this.tag('UnderLine').patch({
          texture: Lightning.Tools.getRoundRect(this.tag('Label').finalW, 2, 0, 0, colors.fontColor, true, colors.fontColor)
        });
        this.patch({
          w: this.tag('Label').finalW + this._textPadding * 2
        });
        this.setButtonStyles();
      });
    }
    set action(action) {
      this._action = action;
    }
    get action() {
      return this._action;
    }
    set textPadding(padding) {
      this._textPadding = padding;
    }
    set withoutTexture(bool) {
      this._withoutTexture = bool;
    }
    set btnId(id) {
      this.default_id = id;
    }
    set label(label) {
      this._label = label;
      if (!this.dynamicWidth && this.w && !isNaN(this.w)) {
        this._textPadding = 0;
        this.patch({
          w: this.w,
          Label: {
            w: this.w,
            text: {
              w: this.w
            }
          }
        });
        this.setButtonStyles();
      }
      this.tag('Label').text.text = label;
    }
    get label() {
      return this._label;
    }
    set borderRadius(radius) {
      this._borderRadius = radius;
    }
    set color(color) {
      this._color = color;
      this.tag('Background').patch({
        texture: Lightning.Tools.getRoundRect(this.w, this.h, this._borderRadius, 2, colors.focusBorderColor, true, colors.focusBorderColor)
      });
    }
    get color() {
      return this._color;
    }
    setButtonStyles() {
      if (this.hasFocus()) {
        this.onButtonFocus();
      } else {
        this.patch({
          Background: {
            texture: !this._withoutTexture ? Lightning.Tools.getRoundRect(this.w, this.h, this._borderRadius, 2, colors.fontColor, false) : undefined
          }
        });
      }
      this.patch({
        Label: {
          x: this._textPadding,
          y: this.h / 2 + 2
        }
      });
    }
    _focus() {
      this.toggleFocus(true);
    }
    _unfocus() {
      this.toggleFocus(false);
    }
    updateBtn() {
      this.toggleFocus(false);
    }
    toggleFocus(focus) {
      if (focus) {
        this.onButtonFocus();
      } else {
        const selectedBtnId = Storage.get('selectedBtn') || 1;
        selectedBtnId === this.default_id ? this.patch({
          Background: {
            texture: Lightning.Tools.getRoundRect(this.w, this.h, this._borderRadius, 2, colors.lightHighlight, true, colors.lightHighlight)
          }
        }) : this.patch({
          Background: {
            texture: Lightning.Tools.getRoundRect(this.w, this.h, this._borderRadius, 2, colors.fontColor, false)
          }
        });
        if (this._withoutTexture) this.tag('Background').texture = undefined;
      }
    }
    onButtonFocus() {
      this.patch({
        Background: {
          texture: !this._withoutTexture ? Lightning.Tools.getRoundRect(this.w, this.h, this._borderRadius, 2, colors.focusBorderColor, true, colors.focusFillColor) : Lightning.Tools.getRoundRect(this.w, this.h, this._borderRadius, 2, colors.focusBorderColor, false)
        }
      });
    }
    static get width() {
      return this.w;
    }
    static get height() {
      return this.h;
    }
  }

  class BannerItem extends Lightning.Component {
    static _template() {
      return {
        BannerBgImage: {
          x: 761.7,
          w: 1158.3,
          h: 625,
          y: 0,
          zIndex: 2
        },
        TopGradient: {
          zIndex: 1,
          x: 160,
          y: 0,
          w: 1920,
          h: 654,
          rect: true,
          color: colors.background
        },
        BottomGradient: {
          x: 160,
          y: 618,
          w: App$1.width,
          h: 640,
          rect: true,
          color: colors.background
        },
        TopLeftGradient: {
          zIndex: 2,
          x: 761.7,
          y: 0,
          w: 800,
          h: 654,
          rect: true,
          colorRight: colors.bannerImgGradient,
          colorLeft: colors.background
        },
        ContentContainer: {
          x: 250,
          y: 200,
          zIndex: 3,
          flex: {
            direction: 'column'
          },
          Title: {
            text: {
              fontSize: fontsizes.bannerItemTitle,
              textColor: colors.fontColor,
              maxLines: 1,
              maxLinesSuffix: '...',
              wordWrapWidth: 700,
              fontFace: 'Bold'
            },
            flexItem: {
              marginBottom: 10
            }
          },
          TitleEN: {
            text: {
              fontSize: 40,
              textColor: colors.fontColor,
              maxLines: 1,
              maxLinesSuffix: '...',
              wordWrapWidth: 700,
              fontFace: 'Bold'
            },
            flexItem: {
              marginBottom: 10
            }
          },
          TagsData: {
            type: InlineContent,
            justify: 'flex-start',
            content: [],
            customStyleMappings: {
              textStyle: {
                fontSize: fontsizes.bannerItemMetaContainer,
                textColor: colors.fontColor,
                textAlign: 'left',
                fontFace: 'Regular'
              }
            },
            flexItem: {
              marginBottom: 30
            }
          },
          Description: {
            text: {
              wordWrapWidth: 750,
              textColor: colors.fontColor,
              fontSize: fontsizes.bannerItemMetaContainer,
              lineHeight: 30,
              maxLines: 3,
              maxLinesSuffix: '...'
            },
            flexItem: {
              marginBottom: 10
            }
          },
          MoreDetails: {}
        }
      };
    }
    _getFocused() {
      return this.tag('MoreDetails').children[this._index];
    }
    set item(data) {
      var _data$tags;
      if (data.showMoreInfo) {
        this._index = 0;
        this.bData = [{
          height: 64,
          width: 186,
          radius: 10,
          text: Language.translate('view_more'),
          color: colors.fontColor,
          layout: 'rect'
        }];
        this.tag('MoreDetails').children = this.bData.map(button => {
          return {
            type: DynamicButton,
            h: 55,
            borderRadius: 2,
            textPadding: 30,
            label: button.text,
            withoutTexture: false,
            flexItem: {
              margin: 20,
              alignSelf: 'stretch',
              maxHeight: 100
            }
          };
        });
      }
      const slicedTags = (_data$tags = data.tags) === null || _data$tags === void 0 ? void 0 : _data$tags.split(',').slice(0, 3).join(',');
      const tagsData = data.tags ? commaSeparatedwithSpaces(slicedTags) : '';
      this.patch({
        BannerBgImage: {
          src: data.banner_image ? Utils.asset(contentImagesFolder + data.banner_image) : Utils.asset(fallBackBanner)
        },
        ContentContainer: {
          Title: {
            visible: data.title ? true : false,
            text: {
              text: data.title || '',
              wordWrapWidth: 700
            }
          },
          TitleEN: {
            visible: data.title_en ? true : false,
            text: {
              text: data.title_en || '',
              wordWrapWidth: 700
            }
          },
          TagsData: {
            content: [{
              text: data.publish_time,
              style: 'textStyle'
            }, {
              text: tagsData ? " |  ".concat(tagsData) : '',
              style: 'textStyle'
            }, {
              text: data.duration ? " |  ".concat(data.duration) : '',
              style: 'textStyle'
            }]
          },
          Description: {
            visible: data.description && data.is_livechannel ? true : false,
            text: {
              text: data.description
            }
          }
        }
      });
    }
  }

  class Banner extends Lightning.Component {
    static _template() {
      return {
        signals: {
          exitBanner: '_exitBanner'
        },
        Items: {
          w: App$1.width,
          h: 400,
          rect: true,
          color: colors.background
        },
        IndicatorBox: {
          x: 180,
          w: App$1.width - 180,
          h: 50,
          y: 480,
          Indicators: {
            zIndex: 2
          }
        }
      };
    }
    set data(data) {
      let xPosition = (App$1.width - 180) / 2 - data.list.length / 2 * 60;
      xPosition = 20;
      this.banneritems = data.list;
      data.list.forEach(item => item.showMoreInfo = true);
      this.tag('Items').children = data.list.map(item => {
        return {
          type: BannerItem,
          alpha: 0,
          item
        };
      });
      this.tag('Indicators').children = data.list.map(item => {
        xPosition = xPosition + 50;
        return {
          type: CircleIndicator,
          alpha: 1,
          x: xPosition,
          item
        };
      });
      if (Storage.get('stateInfo')) {
        this.stateInfo = JSON.parse(Storage.get('stateInfo'));
        this.index = this.stateInfo.banner ? this.stateInfo.card : 0;
      } else {
        this.index = 0;
      }
      this.totalIndex = 0;
      this.tag('Indicators').alpha = data.list.length <= 1 ? 0 : 1;
      this.previousItem = this.tag('Items').children[this.index];
      this.previousItem.alpha = 1;
      this.updateIndicator(this.index);
    }
    _getFocused() {
      return this.tag('Items').children[this.index];
    }
    _handleLeft() {
      if (this.index == 0) {
        Router.focusWidget('Menu');
        this.index = 0;
        this.tag('Items').children[this.index].alpha = 1;
        this.previousItem = this.tag('Items').children[this.index];
      } else if (this.index <= this.banneritems.length) {
        this.index--;
        this.previousItem.patch({
          alpha: 0
        });
        this.tag('Items').children[this.index].patch({
          alpha: 1
        });
        this.previousItem = this.tag('Items').children[this.index];
      }
      this.updateIndicator(this.index, 'left');
    }
    _handleRight() {
      if (this.index == this.banneritems.length - 1) {
        this.index = this.banneritems.length - 1;
        this.tag('Items').children[this.index].alpha = 1;
        this.previousItem = this.tag('Items').children[this.index];
      } else if (this.index < this.banneritems.length - 1) {
        this.index++;
        this.previousItem.alpha = 0;
        this.tag('Items').children[this.index].alpha = 1;
        this.previousItem = this.tag('Items').children[this.index];
      }
      this.updateIndicator(this.index, 'right');
    }
    _handleEnter() {
      this.storeStateInfo();
      Router.navigate("details/".concat(this.banneritems[this.index].content_id));
      Router.getActivePage().widgets.loader.alpha = 1;
    }
    storeStateInfo() {
      Storage.set('stateInfo', JSON.stringify({
        card: this.index,
        banner: 1,
        home: Router.getActiveHash().includes('home') ? 1 : 0,
        carouselYPosition: 0
      }));
    }
    updateIndicator(index, direction) {
      const orgIndex = index - this.totalIndex;
      this.tag('Indicators').children[orgIndex].patch({
        RoundRectangle: {
          texture: Lightning.Tools.getRoundRect(24, 24, 12, 2, colors.focusBorderColor, true, colors.focusBorderColor)
        }
      });
      if (this.previousIndex == 0 && direction === 'right') {
        this.previousIndex = 0;
        this.tag('Indicators').children[this.previousIndex].patch({
          RoundRectangle: {
            texture: Lightning.Tools.getRoundRect(24, 24, 12, 2, colors.fontColor, true, colors.fontColor)
          }
        });
      } else if (this.previousIndex == this.totalIndex && direction === 'left') {
        this.previousIndex = this.totalIndex;
      } else if (this.previousIndex >= 0) {
        this.tag('Indicators').children[this.previousIndex].patch({
          RoundRectangle: {
            texture: Lightning.Tools.getRoundRect(24, 24, 12, 2, colors.fontColor, true, colors.fontColor)
          }
        });
      }
      this.previousIndex = orgIndex;
      this.tag('Indicators').children[orgIndex].patch({
        RoundRectangle: {
          texture: Lightning.Tools.getRoundRect(24, 24, 12, 2, colors.focusBorderColor, true, colors.focusBorderColor)
        }
      });
    }
    _handleUp() {
      return;
    }
    _handleDown() {
      this.patch({
        alpha: 0
      });
      Router.getActivePage().widgets.banneritem.alpha = 1;
      Router.focusWidget('VideoSlider');
    }
    _handleBack() {
      Router.getActivePage().widgets.popup.showExitPopUp();
      Router.focusWidget('Popup');
    }
  }

  class Item extends Lightning.Component {
    static _template() {
      return {
        w: Item.width,
        h: Item.height,
        Background: {
          alpha: 0,
          texture: Lightning.Tools.getRoundRect(Item.width, Item.height, 0, 3, colors.focusBorderColor, true, colors.focusFillColor)
        },
        LazyBackground: {
          w: w => w - 14,
          x: 12,
          y: 12,
          h: h => h - 14,
          rect: true,
          color: colors.focusBorderColor
        },
        Poster: {
          zIndex: 3,
          w: w => w - 14,
          x: 12,
          y: 12,
          h: h => h - 14
        },
        Title: {
          y: 210,
          x: 65,
          alpha: 0,
          text: {
            fontFace: 'Bold',
            lineHeight: 48,
            fontSize: fontsizes.viewMore,
            textColor: colors.itemTitle,
            maxLines: 1,
            wordWrapWidth: w => w - 30,
            textAlign: 'center'
          }
        },
        ViewAllImg: {
          alpha: 0,
          src: Utils.asset(viewMoreImage),
          x: 90,
          y: 120
        }
      };
    }
    set item(itemInfo) {
      this._item = itemInfo;
      this.width = 215;
      this.height = 322.5;
      this.patch({
        w: this.width,
        h: this.height,
        Background: {
          alpha: 0,
          texture: Lightning.Tools.getRoundRect(this.width, this.height, 0, 0, colors.itemBackground, true, colors.itemBackground)
        },
        LazyBackground: {
          w: w => w,
          x: 12,
          y: 12.4,
          h: h => h,
          rect: true,
          color: colors.seeAllCardColor
        },
        Poster: {
          w: w => w,
          x: 12,
          y: 12.4,
          h: h => h
        }
      });
      if (itemInfo.content_id == 'see-all') {
        return this.patch({
          Title: {
            alpha: 1,
            text: {
              text: itemInfo.title
            }
          },
          ViewAllImg: {
            alpha: 1
          }
        });
      }
      this.patchPoster(itemInfo);
    }
    patchPoster(data) {
      const checkForPoster = data.poster_image || data.item.poster_image;
      const src = checkForPoster ? Utils.asset(contentImagesFolder + checkForPoster) : Utils.asset(fallBackBanner);
      this.tag('Poster').texture = Img(src).original();
    }
    get item() {
      return this._item;
    }
    _focus() {
      this.tag('Background').patch({
        alpha: 1,
        texture: Lightning.Tools.getRoundRect(this.width + 20, this.height + 20, 0, 3, colors.focusBorderColor, true, colors.focusFillColor)
      });
      this.fireAncestors('$onItemFocus', {
        item: this._item
      });
    }
    _unfocus() {
      this.tag('Background').alpha = 0;
    }
    static get width() {
      return 215;
    }
    static get height() {
      return 322.5;
    }
  }

  class ListComponent extends Lightning.components.ListComponent {
    _init() {
      this._roll = true;
      this._rollMax = 1;
    }
    set activeItem(item) {
      this._activeItem = item;
      this._restorePosition = item.x;
      this._setState('Expanded');
    }
    forceState(state) {
      this._setState(state);
    }
  }

  class EndlessList extends Lightning.Component {
    static _template() {
      return {
        Title: {
          zIndex: 5,
          x: 22,
          height: 30,
          y: 18,
          mountY: 0.5,
          text: {
            fontFace: 'Bold',
            fontSize: fontsizes.videoSliderTitle,
            fontWeight: 700,
            textColor: colors.fontColor
          }
        },
        Slider: {
          clipbox: false,
          zIndex: 5,
          y: 45,
          x: 10,
          type: ListComponent,
          w: 1735,
          itemSize: 355,
          clipping: true,
          horizontal: true,
          visible: true
        }
      };
    }
    set items(carouselData) {
      this.traverseIndex = 0;
      this.sliderIndex = carouselData.sliderIndex;
      this.tag('Title').text.text = carouselData.title || '';
      if (carouselData.x) {
        this.patch({
          x: carouselData.x,
          y: carouselData.y
        });
      }
      if (carouselData.w) {
        this.tag('Slider').patch({
          w: carouselData.w
        });
      }

      // changing height and width

      this.width = 215;
      this.height = 322.5;
      this.tag('Slider').patch({
        h: this.height + 100,
        itemSize: this.width + 25
      });
      const viewMore = {
        content_id: 'see-all',
        orentitation: 1,
        key: carouselData.key,
        title: Language.translate('view_more')
      };
      this.videos = carouselData.videos.length > 10 ? carouselData.videos.slice(0, 10).concat(viewMore) : carouselData.videos;
      const children = this.videos.map((item, index) => {
        item.id = index + 1;
        item.orientation = carouselData.orientation;
        return {
          type: Item,
          item
        };
      });
      this.tag('Slider').items = children;
      this.setStateManagement();
    }
    setStateManagement() {
      const stateData = Storage.get(stateInfo);
      if (stateData) {
        const parsedStateInfo = JSON.parse(stateData);
        this._index = parsedStateInfo.card;
        if (!parsedStateInfo.banner && this.sliderIndex === parsedStateInfo.slider && this.videos.length > this._index) {
          this.focusCarouselByIndex(this._index, this.sliderIndex);
          return;
        }
      }
      this.tag('Slider').setIndex(0);
    }
    focusCarouselByIndex(cardIndex, sliderIndex) {
      this.traverseIndex = cardIndex;
      this.setGridYPos(sliderIndex);
    }
    setGridYPos(indexValue) {
      const stateData = JSON.parse(Storage.get(stateInfo));
      if (stateData.seeAll) {
        Router.getActivePage().widgets.videoslider.select({
          index: indexValue
        });
      }
    }
    get slider() {
      return this.tag('Slider');
    }
    get active() {
      return this.tag('Slider').getElement(this.traverseIndex);
    }
    get tiles() {
      return this._items.tiles;
    }
    _handleLeft() {
      if (this.traverseIndex > 0) {
        this.traverseIndex--;
        this.tag('Slider').setPrevious();
      } else if (this.traverseIndex == 0) {
        Router.focusWidget('Menu');
      }
      if (Router.getActiveHash().includes('home')) Storage.remove(stateInfo);
    }
    _handleRight() {
      if (this.traverseIndex < this.videos.length - 1) {
        this.traverseIndex++;
        this.tag('Slider').setNext();
      }
      if (Router.getActiveHash().includes('home')) Storage.remove(stateInfo);
    }
    _handleEnter() {
      const item = this.videos[this.traverseIndex];
      item.index = this.traverseIndex;
      Router.getActivePage().widgets.videoslider.$onItemSelect({
        item
      });
    }
    _handleDown() {
      this.removeStateInfo();
      Router.getActivePage().widgets.videoslider._handleDown();
    }
    removeStateInfo() {
      if (Storage.get(stateInfo)) {
        const stateData = JSON.parse(Storage.get(stateInfo));
        !stateData.banner && !stateData.railbanner ? Storage.remove(stateInfo) : '';
      }
    }
    _handleUp() {
      this.removeStateInfo();
      Router.getActivePage().widgets.videoslider._handleUp();
    }
    _getFocused() {
      this.fireAncestors('$onVideoHovered', {
        item: this.videos[this.traverseIndex]
      });
      if (Storage.get(stateInfo) && (Router.getActiveHash().includes('home') || Router.getActiveHash().includes('category'))) {
        this.tag('Slider').reload();
        this.tag('Slider').setIndex(this.traverseIndex);
      }
      return this.active;
    }
    _handleBack() {
      Router.getActiveHash().includes('home') ? Router.getActivePage()._handleBack() : Router.back();
    }
    calculateHeightOfCarousel() {
      let height = 0;
      height = 400;
      return height;
    }
  }

  class VideoSlider extends Lightning.Component {
    static _template() {
      return {
        alpha: 1,
        zIndex: 5,
        clipping: true,
        forceZIndexContext: true,
        x: 170,
        y: 660,
        h: App$1.height - 500,
        w: 1755,
        signals: {
          exitList: '_exitList'
        },
        Grid: {
          alpha: 1,
          zIndex: 5,
          forceZIndexContext: true,
          type: EndlessList
        }
      };
    }
    _init() {
      this._index = 0;
      this._previousIndex = 0;
    }
    _focus() {
      Storage.set('state', 'Videos');
      this.patch({
        alpha: 1
      });
    }
    set data(data) {
      this._index = 0;
      this._previousIndex = 0;
      this.tag('Grid').y = 0;
      const content = [];
      let listIdx = 0;
      let carouselYPos = 0;
      this.CategoryVideos = data.filter(obj => {
        var _obj$list;
        return ((_obj$list = obj.list) === null || _obj$list === void 0 ? void 0 : _obj$list.length) > 0;
      });
      this.CategoryVideos.map(d => {
        content.push({
          items: {
            sliderIndex: listIdx,
            orientation: d.orientation || 2,
            videos: d.list || d.videos,
            title: d.title || d.category_title,
            key: d.slug || d.key
          },
          type: EndlessList,
          y: carouselYPos,
          sliderIndex: listIdx
        });
        listIdx++;
        carouselYPos += Router.getActivePage().widgets.listendless.calculateHeightOfCarousel() + 80;
      });
      this.tag('Grid').children = content;
      if (Storage.get(stateInfo)) {
        const stateData = JSON.parse(Storage.get(stateInfo));
        this._index = stateData.slider || 0;
        this.tag('Grid').y = stateData.carouselYPosition;
      }
    }
    get list() {
      return this.tag('Grid').children;
    }
    get active() {
      return this.list[this._index];
    }
    get previousIndex() {
      return this._previousIndex;
    }
    set previousIndex(index) {
      this._previousIndex = index;
    }
    resetGridIndex() {
      this._index = 0;
    }
    get focusedItem() {
      return this.tag('Grid').children[this.index].focusedItem;
    }
    _getFocused() {
      return this.active;
    }
    _handleUp() {
      this._previousIndex = this._index;
      this._index > 0 ? this.fire('select', {
        index: this._index - 1
      }) : Router.getActivePage()._handleUp();
      return false;
    }
    _handleDown() {
      this._previousIndex = this._index;
      if (this._index < this.list.length - 1) {
        this.fire('select', {
          index: this._index + 1
        });
      } else return false;
    }
    select(_ref) {
      let {
        index
      } = _ref;
      this._index = index;
      const listStartingYPos = this.list[this._index].y;
      this.tag('Grid').setSmooth('y', index === 0 ? 0 : -listStartingYPos, {
        duration: 0.5,
        timingFunction: 'ease'
      });
    }
    $onReachedZeroIndex() {
      Router.focusWidget('Menu');
    }
    $onVideoHovered(item) {
      Router.getActivePage().widgets.banneritem.item = item.item;
    }
    _handleBack() {
      Router.getActivePage()._handleBack();
    }
    async $onItemSelect(_ref2) {
      let {
        item
      } = _ref2;
      const gridYPos = this.tag('Grid').y;
      Storage.set(stateInfo, JSON.stringify({
        slider: this._index,
        card: item.index,
        banner: 0,
        home: Router.getActiveHash().includes('home') ? 1 : 0,
        carouselYPosition: gridYPos
      }));
      item.content_id === 'see-all' ? Router.navigate("subcategory/".concat(item.key)) : Router.navigate("details/".concat(item.content_id));
      Router.getActivePage().widgets.loader.alpha = 1;
    }
  }

  class IconDynamicButton extends Lightning.Component {
    static _template() {
      return {
        h: h => h,
        w: w => w,
        Background: {
          w: w => w,
          h: 62,
          rect: true,
          texture: Lightning.Tools.getRoundRect(150, 40, 0, 1, colors.fontColor, false),
          Label: {
            color: colors.iconDynamicBtnLabel,
            y: 40,
            x: 20,
            mountY: 0.7,
            text: {
              fontFace: 'Bold',
              fontSize: fontsizes.iconDynamicbuttonText,
              textAlign: 'center',
              wordWrap: true,
              wordWrapWidth: 1000,
              maxLines: 1,
              maxLinesSuffix: '...'
            }
          },
          Image: {
            w: 32,
            h: 28,
            x: 10,
            y: 40,
            mountX: 0.5,
            mountY: 0.9
          }
        },
        IconImage: {
          w: 35,
          h: 35,
          x: 40,
          y: 40,
          mountX: 0.5,
          mountY: 0.9
        }
      };
    }
    _init() {
      if (this.w && !isNaN(this.w)) {
        return;
      }
      this.tag('Label').on('txLoaded', () => {
        if (this._isBtnVertical) {
          // vertical btnList
          this.tag('Image').x = 30;
          this.tag('Image').mountY = 0.83;
          this.tag('Label').x = this.tag('Image').finalW + 40;
          this.tag('Label').y = 40;
          this.tag('Image').y = 40;
          this.tag('Label').on('txLoaded', () => {
            this.calculateWidth = this.tag('Label').finalW + 100;
            this.tag('Background').patch({
              w: this.calculateWidth
            });
          });
        } else {
          // only horizontal btnList

          if (this._btntype) {
            this.calculateWidth = this._iconImage ? this.tag('Label').finalW + this._textPadding * 2 + 40 : this.tag('Label').finalW + this._textPadding + 10;
          } else {
            this.calculateWidth = this.tag('Label').finalW + this._textPadding * 2;
          }
          this.patch({
            w: this.calculateWidth
          });
          // setting width to label and x pos image
          this.tag('Label').w = this.tag('Label').finalW;
          this.tag('Image').x = this.tag('Label').finalW + 20 + 20 + 20;
        }
        this.setButtonStyles();
      });
    }

    // using the below lifecycle event to solve the verticalBtn prob
    // that causes not updating of focus[i.e the rectangle border] when wishlist label is changed
    _active() {
      if (this._isBtnVertical) {
        // vertical btnList
        this.tag('Image').x = 30;
        this.tag('Image').mountY = 0.83;
        this.tag('Label').x = this.tag('Image').finalW + 40;
        this.tag('Background').texture = undefined;
        this.tag('Label').on('txLoaded', () => {
          this.calculateWidth = this.tag('Label').finalW + 100;
          this.tag('Background').patch({
            w: this.calculateWidth,
            h: this.tag('Label').finalY + 22
          });
        });
      }
    }
    set isVerticalBtn(val) {
      // either true or false
      this._isBtnVertical = val;
    }
    set isHorizontalBtn(val) {
      this._isHorizontalBtn = val;
    }
    set action(action) {
      this._action = action;
    }
    get action() {
      return this._action;
    }
    set textPadding(padding) {
      this._textPadding = padding;
    }
    set iconWithText(btnType) {
      this._btntype = btnType;
    }
    set iconImage(Img) {
      this._iconImage = Img;
    }
    set pageBtns(type) {
      this._btnsPage = type;
    }
    set iconCheck(type) {
      this._checkIconStatus = type;
    }
    set label(label) {
      this._label = label;
      if (!this.dynamicWidth && this.w && !isNaN(this.w)) {
        this._textPadding = 0;
        this.patch({
          w: this.w,
          Label: {
            w: this.w,
            text: {
              w: this.w
            }
          }
        });
        this.setButtonStyles();
      }
      this.tag('Label').text.text = label;
    }
    get label() {
      return this._label;
    }
    set borderRadius(radius) {
      this._borderRadius = radius;
    }
    set color(color) {
      this._color = color;
    }
    get color() {
      return this._color;
    }
    setButtonStyles() {
      const width = Router.getActiveHash().includes('details') || Router.getActiveHash().includes('series') ? 381 : 178;
      !this._btntype ? this.patch({
        Background: {
          Image: {
            alpha: 0
          }
        },
        Label: {
          x: this._textPadding,
          y: this.h / 2 + 2
        }
      }) : this.patch({
        Label: {
          x: this._textPadding + 40,
          y: this.h / 2 + 2
        }
      });
      // Display Only Label without Image fn end

      // Display Image with Label start
      this.hasFocus() ? this.patch({
        Background: {
          texture: Lightning.Tools.getRoundRect(this.calculateWidth || width, 40, 2, 2, colors.focusBorderColor, true, colors.focusFillColor),
          Image: {
            color: colors.fontColor,
            src: this._iconImage
          }
        },
        Label: {
          text: {
            textColor: colors.fontColor
          }
        }
      }) : this.patch({
        Background: {
          texture: this._isHorizontalBtn ? Lightning.Tools.getRoundRect(this.calculateWidth, 40, 2, 1, colors.fontColor, false) : undefined,
          Image: {
            color: colors.fontColor,
            src: this._iconImage
          }
        },
        Label: {
          text: {
            textColor: colors.fontColor
          }
        }
      });
    }
    _focus() {
      this.toggleFocus(true); // here we set focus into true.
    }
    _unfocus() {
      this.toggleFocus(false); // here we set focus as false.
    }
    toggleFocus(focus) {
      if (focus) {
        this.patch({
          Background: {
            texture: Lightning.Tools.getRoundRect(this.calculateWidth, 40, 2, 2, colors.focusBorderColor, true, colors.focusFillColor),
            Image: {
              color: colors.fontColor
            }
          },
          Label: {
            text: {
              textColor: colors.fontColor
            }
          }
        });
      } else {
        this.patch({
          Background: {
            texture: Lightning.Tools.getRoundRect(this.calculateWidth, 40, 2, 1, colors.fontColor, false),
            Image: {
              color: colors.fontColor
            }
          },
          Label: {
            text: {
              textColor: colors.fontColor
            }
          }
        });
        if (this._isBtnVertical && !this.isHorizontalBtn) {
          this.tag('Background').texture = undefined;
        }
      }
    }
  }

  class ButtonsList extends Lightning.Component {
    static _template() {
      return {
        signals: {
          focusSuggestions: '_focusSuggestions'
        },
        Wrapper: {
          ButtonList: {
            x: 176,
            y: 600,
            h: 56,
            flex: {
              direction: 'row'
            }
          }
        }
      };
    }
    set data(inputData) {
      this._index = 0;
      this.buttonsData = inputData[0];
      this._item = inputData[1];
      this.tag('ButtonList').children = this.buttonsData.map(button => {
        return {
          type: IconDynamicButton,
          h: 60,
          textPadding: 30,
          label: button.text,
          iconWithText: true,
          iconImage: button.Icon,
          flexItem: {
            marginRight: 30,
            maxHeight: 100
          },
          isHorizontalBtn: true
        };
      });
    }
    _inactive() {
      this.tag('ButtonList').children = [];
    }
    _handleLeft() {
      if (this._index > 0) {
        this._index--;
      }
    }
    _handleRight() {
      if (this._index < this.buttonsData.length - 1) {
        this._index++;
      }
    }
    _handleEnter() {
      Router.navigate('player');
      Router.getActivePage().widgets.loader.alpha = 1;
    }
    _handleDown() {
      Router.getActivePage().widgets.detailsbtns.index = 0;
      Router.focusWidget('DetailsBtns');
    }
    _handleUp() {
      return;
    }
    _getFocused() {
      return this.tag('ButtonList').children[this._index];
    }
    _handleBack() {
      Router.getActivePage()._handleBack();
    }
  }

  class PlayerControls extends Lightning.Component {
    static _template() {
      return {
        zIndex: 5,
        x: 25,
        Background: {
          alpha: 0,
          w: 300,
          h: 100
        },
        PlayerButtons: {
          y: 980
        },
        Play: {
          x: 650,
          y: 450,
          flex: {
            direction: 'row'
          }
        },
        ContentTitle: {
          x: 30,
          y: 40,
          text: {
            fontSize: 36,
            textColor: colors.fontColor,
            wordWrapWidth: 700,
            fontFace: 'Bold',
            maxLines: 1,
            maxLinesSuffix: '...'
          }
        }
      };
    }
    _init() {
      this.btnActionArray = null;
    }
    set data(playerButtons) {
      this.updateControls(playerButtons);
      const playButton = playerButtons.data.filter(obj => obj.action === 'centerButtons');
      this.tag('Play').children = playButton.map(button => {
        return {
          type: PlayButton,
          button,
          flexItem: {
            marginRight: 200
          },
          alpha: 1
        };
      });
    }
    set patchTitle(title) {
      this.tag('ContentTitle').patch({
        text: {
          text: title
        }
      });
    }
    set updateBtns(controls) {
      this.updateControls(controls);
    }
    setIndexToDefault() {
      this._index = 0;
    }
    updateControls(playerControls) {
      this.tag('Background').alpha = 1;
      this.tag('PlayerButtons').alpha = 1;
      this.tag('Play').alpha = 1;
      this._index = this._index > 0 ? this._index : 0;
      this.isPlaying = true;
      this.buttonsData = playerControls.data.filter(obj => obj.action !== 'centerButtons');
      this.btnActionArray = this.buttonsData.map(obj => obj.action);
      let x = 80;
      this.tag('PlayerButtons').children = this.buttonsData.map((button, index) => {
        if (index != 0) x = x + 100;
        if (button.action == playerControls.action) this._index = index;
        button.x = x;
        return {
          type: PlayerButton,
          button
        };
      });
      this.tag('Background').patch({
        w: this.buttonsData.length * 100,
        alpha: 1
      });
      this.tag('PlayerButtons').patch({
        w: this.buttonsData.length * 100,
        alpha: 1
      });
    }
    _focus() {
      this.patch({
        alpha: 1
      });
      Router.getActivePage().widgets.progressbar.setSmooth('alpha', 1);
    }
    _unfocus() {
      Router.getActiveHash().includes('player') && Router.getActivePage().iconChangeOnFocusedFunc(this.btnActionArray[null]);
    }
    _handleStop() {
      this._handleBack();
    }

    // keeping handleEnter for testing purposes
    _handleEnter() {
      this.$handleFunctionality('enter');
    }
    $handleFunctionality(checkFunction) {
      if (Router.getActivePage().widgets.playercontrols.alpha) {
        switch (checkFunction) {
          case 'enter':
            {
              Router.getActivePage().$playPause(this.buttonsData[this._index].action);
              break;
            }
          case 'left':
            {
              clearTimeout(this.timer);
              this.patch({
                alpha: 1
              });
              Router.getActivePage().widgets.progressbar.setSmooth('alpha', 1);
              if (this._index > 0) this._index--;
              this.hideProgressBar();
              break;
            }
          case 'right':
            {
              clearTimeout(this.timer);
              this.patch({
                alpha: 1
              });
              Router.getActivePage().widgets.progressbar.setSmooth('alpha', 1);
              if (this._index < this.buttonsData.length - 1) this._index++;
              this.hideProgressBar();
              break;
            }
          case 'show|hide':
            {
              clearTimeout(this.timer);
              this.hideProgressBar();
              break;
            }
        }
      } else {
        clearTimeout(this.timer);
        this.patch({
          alpha: 1
        });
        Router.getActivePage().widgets.progressbar.setSmooth('alpha', 1);
        this.hideProgressBar();
      }
    }
    hideProgressBar() {
      this.timer = setTimeout(() => {
        this.patch({
          alpha: 0
        });
        Router.getActivePage().widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _handleLeft() {
      this.$handleFunctionality('left');
    }
    _handleRight() {
      this.$handleFunctionality('right');
    }
    _play() {
      clearTimeout(this.timer);
      this.isPlaying = true;
      this.timer = setTimeout(() => {
        this.patch({
          alpha: 0
        });
        Router.getActivePage().widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _pause() {
      clearTimeout(this.timer);
      this.isPlaying = false;
      this.timer = setTimeout(() => {
        this.patch({
          alpha: 0
        });
        Router.getActivePage().widgets.progressbar.setSmooth('alpha', 0);
      }, 5000);
    }
    _handlePlayPause() {
      Router.getActivePage().$playPause('play');
    }
    _handleForward() {
      Router.getActivePage().$playPause('forward');
    }
    _handleRewind() {
      Router.getActivePage().$playPause('rewind');
    }
    _handlePlay() {
      Router.getActivePage()._handlePlay();
    }
    _handlePause() {
      Router.getActivePage()._handlePause();
    }
    _handleBack() {
      Router.getActivePage()._handleBack();
    }
    _getFocused() {
      Router.getActiveHash().includes('player') && Router.getActivePage().iconChangeOnFocusedFunc(this.btnActionArray[this._index]);
      if (this.buttonsData.length != 0) return this.tag('PlayerButtons').children[this._index];
    }
    _handleKey() {
      this.showOrHideButtons();
    }
    _handleUp() {
      this.showOrHideButtons();
      Router.focusWidget('ProgressBar');
    }
    _handleDown() {
      this.showOrHideButtons();
    }
    showOrHideButtons() {
      this.$handleFunctionality('show|hide');
    }
  }
  class PlayerButton extends Lightning.Component {
    static _template() {
      return {
        Image: {
          mount: 0.5
        }
      };
    }
    set button(button) {
      this.buttonData = button;
      this.patch({
        Image: {
          x: this.buttonData.x,
          y: this.buttonData.y,
          mountX: this.buttonData.mountX,
          mountY: this.buttonData.mountY,
          src: Utils.asset(this.buttonData.src)
        }
      });
    }
  }
  class PlayButton extends Lightning.Component {
    static _template() {
      return {
        Icon: {}
      };
    }
    set button(button) {
      this.patch({
        Icon: {
          alpha: button.alpha,
          src: Utils.asset(button.src)
        }
      });
    }
  }

  class EmptyPage extends Lightning.Component {
    static _template() {
      return {
        zIndex: 3,
        alpha: 1,
        Background: {
          w: App$1.width,
          h: App$1.height,
          Image: {
            x: 0,
            w: App$1.width,
            h: App$1.height,
            y: 0,
            filter: {
              blur: 5
            },
            shader: {
              type: Lightning.shaders.RoundedRectangle,
              radius: 16
            }
          },
          TopToBottomGradient: {
            x: 0,
            y: 0,
            w: App$1.width,
            h: App$1.height,
            rect: true,
            color: colors.background
          },
          WishlistIcon: {
            w: 100,
            h: 100,
            x: 1920 / 2,
            y: 1080 / 2,
            mountX: 0.5,
            mountY: 0.5
          },
          Label: {
            w: App$1.width,
            h: App$1.height,
            x: 965,
            y: 1080 / 2 + 70,
            mountX: 0.5,
            alpha: 1,
            text: {
              fontFace: 'Bold',
              fontSize: fontsizes.emptyPageText,
              fontWeight: 400,
              textColor: colors.fontColor,
              textAlign: 'center'
            }
          }
        }
      };
    }
    _focus() {
      this.patch({
        alpha: 1
      });
    }
    _handleLeft() {
      return Router.focusWidget('Menu');
    }
    set data(data) {
      if (data.status) {
        this.tag('Background').patch({
          WishlistIcon: {
            src: Utils.asset(imagesFolder + data.Image)
          },
          Label: {
            text: {
              text: data.Message
            }
          }
        });
      }
    }
    _handleBack() {
      Router.back();
    }
  }

  class ProfileButtons extends Lightning.Component {
    static _template() {
      return {
        zIndex: 1,
        Wrapper: {
          w: 1600,
          paddingLeft: 200,
          ButtonList: {
            x: 185,
            y: 90,
            w: 1600,
            h: 200,
            flex: {
              direction: 'row',
              wrap: true,
              padding: 30,
              justifyContent: 'flex-start',
              alignContent: 'space-between'
            }
          }
        }
      };
    }
    _init() {
      Storage.remove('selectedBtn');
    }
    set data(buttons) {
      this.buttonData = buttons;
      this.tag('ButtonList').children = this.buttonData.map((item, index) => {
        return {
          type: DynamicButton,
          h: 66,
          borderRadius: 2,
          textPadding: 30,
          btnId: index + 1,
          withoutTexture: false,
          label: item.heading,
          flexItem: {
            marginRight: 40,
            alignSelf: 'stretch',
            maxHeight: 100
          }
        };
      });
      this.index = Storage.get('setting_index') || 0;
    }
    set listVisibility(value) {
      this.tag('ButtonList').alpha = value;
    }
    _handleRight() {
      if (this.index < this.buttonData.length - 1) {
        this.index++;
      }
    }
    _handleLeft() {
      this.index > 0 ? this.index-- : Router.focusWidget('Menu');
    }
    _handleEnter() {
      const buttonType = this.buttonData[this.index].type;
      const buttonLength = this.tag('ButtonList').children.length;
      Storage.set('selectedBtn', this.index + 1);
      for (let index = 0; index < buttonLength; index++) {
        if (index !== this.index) {
          this.tag('ButtonList').children[index].updateBtn();
        }
      }
      Router.getActivePage().getButtonSelection(buttonType, this.index);
    }
    _getFocused() {
      return this.tag('ButtonList').children[this.index];
    }
    _handleUp() {
      return;
    }
    _handleDown() {
      Router.getActivePage().widgets.staticdata.onHandleDown();
    }
    _handleBack() {
      Router.back();
    }
  }

  class Button extends Lightning.Component {
    static _template() {
      return {
        texture: Lightning.Tools.getRoundRect(740, 63, 4, 2, colors.profileBtnItem, false, colors.profileBtnItem),
        Label: {
          type: InlineContent,
          content: []
        },
        Icon: {
          alpha: 0
        }
      };
    }
    set button(data) {
      this.buttonData = data;
      this.highlight = this.buttonData.buttonColor ? this.buttonData.buttonColor : colors.profileBtnItem;
      this.y = this.buttonData.y;
      this.h = this.buttonData.h;
      this.w = this.buttonData.w;
      this.x = this.buttonData.x;
      this.buttonData.radius ? this.radius = this.buttonData.radius : this.radius = 8;
      this.patch({
        texture: this.buttonData.layout == 'border' ? Lightning.Tools.getRoundRect(this.w - 2, this.h - 2, 4, 2, colors.fontColor, false, colors.focusFillColor) : Lightning.Tools.getRoundRect(this.w - 2, this.h - 2, 4, 2, colors.fontColor, false, this.highlight),
        Label: {
          y: this.buttonData.h * 0.46,
          x: this.buttonData.buttonWithIcon ? this.buttonData.inputx : this.buttonData.w * 0.5,
          mount: 0.5,
          content: this.buttonData.title ? [{
            text: this.buttonData.title,
            style: {
              fontSize: this.buttonData.highlightOnlyBorder ? this.buttonData.fontSize : fontsizes.popupButtonsText,
              fontFace: this.buttonData.buttonWithIcon ? 'Regular' : 'Bold',
              textColor: colors.fontColor
            }
          }] : [{
            text: this.buttonData.title1,
            style: {
              fontSize: this.buttonData.highlightOnlyBorder ? this.buttonData.fontSize : fontsizes.popupButtonsText,
              fontFace: 'Regular',
              textColor: colors.fontColor
            }
          }, {
            text: this.buttonData.title2,
            style: {
              fontSize: this.buttonData.highlightOnlyBorder ? this.buttonData.fontSize : fontsizes.popupButtonsText,
              fontFace: 'Bold',
              textColor: colors.fontColor
            }
          }]
        },
        Icon: {
          x: this.buttonData.iconX,
          y: this.buttonData.iconY,
          w: this.buttonData.iconW,
          h: this.buttonData.iconH,
          alpha: this.buttonData.buttonWithIcon ? 1 : 0,
          src: Utils.asset('images/Angle_Right.png')
        }
      });
    }
    _focus() {
      this.highlight = colors.focusBorderColor;
      this.texture = this.buttonData.highlightOnlyBorder ? Lightning.Tools.getRoundRect(this.w, this.h, 4, 2, this.highlight, false) : Lightning.Tools.getRoundRect(this.w, this.h, 4, 2, this.highlight, true, colors.focusFillColor);
    }
    _unfocus() {
      this.highlight = this.buttonData.buttonColor ? this.buttonData.buttonColor : colors.buttonUnfocusColor;
      this.patch({
        texture: this.buttonData.layout == 'border' ? Lightning.Tools.getRoundRect(this.w - 2, this.h - 2, 4, 2, colors.fontColor, false) : Lightning.Tools.getRoundRect(this.w - 2, this.h - 2, 4, 2, colors.fontColor, false, this.highlight)
      });
    }
  }

  class Popup extends Lightning.Component {
    static _template() {
      return {
        zIndex: 7,
        alpha: 0,
        signals: {
          closePopUp: 'closePopUp'
        },
        x: App$1.width * 0.5 - 550 * 0.5,
        y: App$1.height * 0.5 - 660 * 0.5,
        Blur: {
          color: colors.popupBlurColor,
          rect: true,
          w: App$1.width + (App$1.width * 0.5 - 250),
          h: App$1.height + (App$1.height * 0.5 - 175),
          x: -(App$1.width * 0.5 - 550 * 0.5),
          y: -(App$1.height * 0.5 - 660 * 0.5),
          zIndex: -1
        },
        Background: {
          texture: Lightning.Tools.getRoundRect(550, 660, 1, 2, colors.focusBorderColor, true, colors.background)
        },
        AlertImg: {
          w: 120,
          h: 120,
          y: 260,
          x: 225,
          src: Utils.asset('images/tv-app-alert-icon.png')
        },
        Line1: {
          y: 45,
          w: 700,
          x: 275,
          mountX: 0.5,
          zIndex: 1,
          text: {
            text: Language.translate('tv_alert'),
            fontFace: 'Bold',
            textColor: colors.fontColor,
            fontSize: fontsizes.popUpAlertText,
            textAlign: 'center',
            lineHeight: 35,
            wordWrap: true,
            maxLinesSuffix: '...'
          }
        },
        Line2: {
          y: 140,
          text: {
            text: Language.translate('exit_alert'),
            paddingLeft: 30,
            fontFace: 'Regular',
            textColor: colors.fontColor,
            fontSize: fontsizes.popUpAlertSubtext,
            textAlign: 'center',
            wordWrap: true,
            wordWrapWidth: 700,
            lineHeight: 40,
            maxLines: 3,
            maxLinesSuffix: '...'
          }
        },
        ButtonList: {}
      };
    }
    _init() {
      this.exitApp = false;
    }
    _focus() {
      this.patch({
        alpha: 1
      });
    }
    _unfocus() {
      this.patch({
        alpha: 0
      });
    }
    showExitPopUp() {
      this._index = 0;
      this.bData = [{
        h: 80,
        y: 460,
        x: 25,
        w: 500,
        radius: 40,
        title: Language.translate('alert_yes'),
        color: colors.fontColor,
        layout: 'border',
        buttonColor: colors.background
      }, {
        h: 80,
        y: 560,
        x: 25,
        w: 500,
        radius: 40,
        title: Language.translate('alert_no'),
        layout: 'border',
        color: colors.fontColor,
        buttonColor: colors.background
      }];
      this.tag('ButtonList').children = this.bData.map(button => {
        return {
          type: Button,
          button
        };
      });
    }
    get exitKey() {
      return this.exitApp;
    }
    _handleDown() {
      if (this._index == 0 && this.bData.length - 1 > this._index) this._index++;
    }
    _handleUp() {
      if (this._index == 1) this._index--;
    }
    _handleEnter() {
      this._index == 0 ? this.application.closeApp() : Router.focusPage();
      this.setSmooth('alpha', 0);
    }
    _getFocused() {
      return this.tag('ButtonList').children[this._index];
    }
    _handleRight() {
      return;
    }
    _handleLeft() {
      return;
    }
    _handleBack() {
      return;
    }
    _handleKey() {
      return;
    }
  }

  const template = {
    keyWidth: 70,
    keyHeight: 70,
    horizontalSpacing: 12,
    verticalSpacing: 28,
    layouts: {
      search: {
        rows: [{
          keys: [{
            c: 'a'
          }, {
            c: 'b'
          }, {
            c: 'c'
          }, {
            c: 'd'
          }, {
            c: 'e'
          }, {
            c: 'f'
          }]
        }, {
          keys: [{
            c: 'g'
          }, {
            c: 'h'
          }, {
            c: 'i'
          }, {
            c: 'j'
          }, {
            c: 'k'
          }, {
            c: 'l'
          }]
        }, {
          keys: [{
            c: 'm'
          }, {
            c: 'n'
          }, {
            c: 'o'
          }, {
            c: 'p'
          }, {
            c: 'q'
          }, {
            c: 'r'
          }]
        }, {
          keys: [{
            c: 's'
          }, {
            c: 't'
          }, {
            c: 'u'
          }, {
            c: 'v'
          }, {
            c: 'w'
          }, {
            c: 'x'
          }]
        }, {
          keys: [{
            c: 'y'
          }, {
            c: 'z'
          }, {
            c: '1'
          }, {
            c: '2'
          }, {
            c: '3'
          }, {
            c: '4'
          }]
        }, {
          keys: [{
            c: '5'
          }, {
            c: '6'
          }, {
            c: '7'
          }, {
            c: '8'
          }, {
            c: '9'
          }, {
            c: '0'
          }]
        }, {
          keys: [{
            action: 'backspace',
            w: 140,
            source: 'images/backspace.png'
          }, {
            action: 'space',
            source: 'images/space.png',
            w: 140
          }, {
            action: 'delete',
            w: 120,
            source: 'images/trash.png'
          }]
        }]
      }
    }
  };
  var KeyboardTemplate = template;

  class KeyboardButton extends Lightning.Component {
    static _template() {
      return {
        Background: {
          zIndex: 4
        },
        Content: {
          zIndex: 5
        }
      };
    }
    set action(action) {
      this._action = action;
    }
    get action() {
      return this._action;
    }
    get c() {
      return this.key.c;
    }
    set key(keyVal) {
      this._key = keyVal;
      this.firstFocus = true;
      if (this.active) {
        this._update();
      }
    }
    _update() {
      const key = this._key;
      if (this._key.source) {
        this.content = {
          w: this._key.source == 'images/space.png' ? 126 : 54,
          h: 54,
          y: 32,
          x: this._key.source == 'images/space.png' ? 104 : this._key.source == 'images/backspace.png' ? 80 : 110,
          src: this._key.source ? Utils.asset(this._key.source) : ''
        };
      } else {
        this.content = {
          text: {
            text: key.c || '',
            fontFace: 'Regular',
            textAlign: 'center',
            textColor: colors.keyboardButtonColor,
            fontSize: fontsizes.keyboardButton
          }
        };
        // setting firstfocus to false in the the first time
        if (this.key.c === 'a' && this.firstFocus) {
          this.firstFocus = false;
        }
      }
      this.patch({
        Content: {
          w: this.w,
          h: this.h,
          mountX: 0.5,
          mountY: 0.35,
          x: this.w / 2,
          y: this.h / 2,
          ...this.content
        }
      });
    }
    get key() {
      return this._key;
    }
    _getFocused() {
      return this._focus();
    }
    _focus() {
      this.patch({
        Background: {
          texture: Lightning.Tools.getRoundRect(this.w - 3, this.h - 3, 0, 3, colors.focusBorderColor, true, colors.searchKeyFocusColor)
        }
      });
      const content = this._key.source ? {
        w: this._key.source == 'images/space.png' ? 126 : 54,
        h: 54,
        y: 32,
        x: this._key.source == 'images/space.png' ? 104 : this._key.source == 'images/backspace.png' ? 80 : 110,
        src: this._key.source === 'images/space.png' ? Utils.asset('images/spaceHighlight.png') : this._key.source == 'images/backspace.png' ? Utils.asset('images/backspaceHighlight.png') : Utils.asset('images/trashHighlight.png')
      } : {
        text: {
          text: this._key.c || '',
          fontFace: 'Regular',
          textAlign: 'center',
          textColor: colors.fontColor,
          fontSize: fontsizes.keyboardButton
        }
      };
      this.tag('Content').patch({
        w: this.w,
        h: this.h,
        mountX: 0.5,
        mountY: 0.35,
        x: this.w / 2,
        y: this.h / 2,
        ...content
      });
      if (this._key.source) this.alignToCenter();
    }
    alignToCenter() {
      switch (this._key.source) {
        case 'images/space.png':
          {
            this.patch({
              Background: {
                y: 5,
                x: 27,
                texture: Lightning.Tools.getRoundRect(148, 70, 0, 3, colors.focusBorderColor, true, colors.searchKeyFocusColor)
              }
            });
            break;
          }
        case 'images/backspace.png':
          {
            this.patch({
              Background: {
                y: 5,
                x: 38,
                texture: Lightning.Tools.getRoundRect(80, 70, 0, 3, colors.focusBorderColor, true, colors.searchKeyFocusColor)
              }
            });
            break;
          }
        default:
          {
            this.patch({
              Background: {
                y: 5,
                x: 66,
                texture: Lightning.Tools.getRoundRect(80, 70, 0, 3, colors.focusBorderColor, true, colors.searchKeyFocusColor)
              }
            });
            break;
          }
      }
    }
    _unfocus() {
      this._update();
      this.patch({
        Background: {
          texture: Lightning.Tools.getRoundRect(this.w - 3, this.h - 3, 0, 1, colors.searchKeyColor, true, colors.searchKeyColor)
        },
        Content: {
          w: this.w,
          h: this.h,
          mountX: 0.5,
          mountY: 0.35,
          x: this.w / 2,
          y: this.h / 2,
          text: {
            textColor: colors.keyboardButtonColor
          },
          ...this.content
        }
      });
    }
    _firstActive() {
      this._update();
    }
  }

  class Keyboard$1 extends Lightning.Component {
    static _template() {
      return {
        zIndex: 4,
        texture: Lightning.Tools.getRoundRect(1000, 428, 0, 3, colors.searchKeyColor, true, colors.searchKeyColor)
      };
    }
    get keyboardTemplate() {
      return KeyboardTemplate;
    }
    get keyboardButton() {
      return KeyboardButton;
    }
    get maxCharacters() {
      return this._layout == 'search' ? 16 : 32;
    }
    set value(val) {
      if (val.length <= this.maxCharacters) {
        this._value = val;
        this.signal('valueChanged', {
          value: val
        });
      }
    }
    get value() {
      return this._value;
    }
    get rows() {
      return this.children;
    }
    get rowLength() {
      return this.rows[this.rowIndex].children.length;
    }
    get currentKey() {
      const currentRow = this.children[this.rowIndex];
      return (currentRow === null || currentRow === void 0 ? void 0 : currentRow.children[this.colIndex]) || (currentRow === null || currentRow === void 0 ? void 0 : currentRow.children[--this.colIndex]);
    }
    set layout(layout) {
      this._layout = layout;
      this._update();
      this.fireAncestors('$keyboardLayoutUpdate');
    }
    set type(inputType) {
      this.inputType = inputType;
    }
    get layout() {
      return this._layout;
    }
    _getFocused() {
      // here generic method is used.
      return this.currentKey;
    }
    _navigate(dir, value) {
      dir = dir === 'up' || dir === 'down' ? 'vertical' : 'horizontal';
      if (dir === 'horizontal' && this.colIndex + value < this.rowLength && this.colIndex + value > -1) {
        this.previous = null;
        return this.colIndex += value;
      } else if (dir === 'vertical' && this.rowIndex + value < this.rows.length && this.rowIndex + value > -1) {
        const currentColIndex = this.colIndex;
        const targetRow = this.rowIndex + value;
        if (this.previous && this.previous.row === targetRow) {
          const tmp = this.previous.col;
          this.previous.col = this.colIndex;
          this.colIndex = tmp;
        } else {
          const targetRow = this.children[this.rowIndex + value];
          const targetItems = targetRow.children;
          const ck = this.currentKey;
          let target = 0;
          for (const targetItem of targetItems) {
            const ckx = this.children[this.rowIndex].x + ck.x;
            const tix = targetRow.x + targetItem.x;
            if (ckx >= tix && ckx <= tix + targetItem.w || tix >= ckx && tix <= ckx + ck.w) {
              target = targetItems.indexOf(targetItem);
              break;
            }
          }
          this.colIndex = target;
        }
        this.previous = {
          col: currentColIndex,
          row: this.rowIndex
        };
        return this.rowIndex += value;
      }
      return false;
    }
    _update() {
      if (this._layout && this.keyboardTemplate.layouts[this._layout] === undefined) {
        this._layout = null;
      }
      if (!this._layout) {
        this._layout = Object.keys(this.keyboardTemplate.layouts)[0];
      }
      const {
        keyWidth,
        keyHeight,
        horizontalSpacing = 0,
        verticalSpacing = 0,
        layouts
      } = this.keyboardTemplate;
      this.children = layouts[this._layout].rows.map((row, rowIndex) => {
        let keyOffset = 0;
        const {
          x = 0,
          rowVerticalSpacing = verticalSpacing,
          rowHorizontalSpacing = horizontalSpacing,
          keys = []
        } = row;
        return {
          y: keyHeight * rowIndex + rowIndex * rowVerticalSpacing + 40,
          x,
          children: keys.map(key => {
            key = Object.assign({
              action: 'input'
            }, key);
            const prevOffset = keyOffset;
            const {
              w = keyWidth,
              h = keyHeight,
              action,
              toLayout
            } = key;
            keyOffset += w + rowHorizontalSpacing;
            return {
              key,
              action,
              toLayout,
              x: prevOffset + 40,
              w,
              h,
              type: this.keyboardButton
            };
          })
        };
      });
    }
    reset() {
      this.colIndex = 0;
      this.rowIndex = 0;
      this._value = '';
      this.previous = null;
    }
    _active() {
      this.reset();
      this._update();
    }
    _handleRight() {
      if (Router.getActiveHash().includes('search') && this.colIndex == 5 || Router.getActiveHash().includes('search') && this.rowIndex == 6 && this.colIndex == 2) {
        Router.getActivePage()._handleRight();
      }
      return this._navigate('right', 1);
    }
    _handleLeft() {
      if (this.colIndex == 0 && Storage.get('mainCategory')) {
        Router.getActivePage().onkeyboardExitLeft();
      } else {
        return this._navigate('left', -1);
      }
    }
    _handleUp() {
      if (this.rowIndex == 0) return;
      return this._navigate('up', -1);
    }
    _handleDown() {
      if (this.layout === 'search' && this.rowIndex >= 6) {
        this.signal('onKeyboardExitDown');
      } else if (this.layout !== 'abc' && this.rowIndex >= 7) {
        this.signal('onKeyboardExitDown');
      } else {
        return this._navigate('down', 1);
      }
    }
    _handleEnter() {
      const key = this.currentKey;
      switch (key.action) {
        case 'input':
          if (this.value.length < this.maxCharacters - 1) this.value = key.c;
          break;
        case '.com':
        case '@gmail.com':
        case '@hotmail.com':
        case '@yahoo.com':
          this.value = key.c;
          break;
        case 'backspace':
          if (this.value.length > 0) {
            this.value = 'backspace';
          }
          break;
        case 'space':
          if (this.value.length > 0 && this.value.length < this.maxCharacters - 1) {
            this.value = ' ';
          }
          break;
        case 'delete':
          if (this.value.length > 0) {
            this.value = '';
          }
          break;
        case 'toggleToLayout':
          this.layout = key.toLayout;
          break;
        default:
          this.signal(key.action);
          break;
      }
      if (key.action != 'toggleToLayout') Router.getActivePage().onKeyboardInputUpdate(this.value, key.action);
      if (Router.getActiveHash().includes('authenticate')) {
        Router.getActivePage().onCodeUpdate(this.value);
      }
    }
    _disable() {
      this.reset();
    }
    set clearCode(_data) {
      this.value = '';
      Router.getActivePage().onCodeUpdate(this.value);
    }
    _handleBack() {
      Router.getActivePage()._handleBack();
    }
    _handleKey(key) {
      if (/^\d$/.test(key.key)) {
        this.value = key.key;
        Router.getActivePage().onKeyboardInputUpdate(this.value, 'keypadNum');
      }
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class CollectionWrapper extends Lightning.Component {
    static _template() {
      return {
        Wrapper: {}
      };
    }
    _construct() {
      this._direction = CollectionWrapper.DIRECTION.row;
      this._scrollTransitionSettings = this.stage.transitions.createSettings({});
      this._spacing = 0;
      this._autoResize = false;
      this._requestingItems = false;
      this._requestThreshold = 1;
      this._requestsEnabled = false;
      this._gcThreshold = 5;
      this._gcIncrement = 0;
      this._forceLoad = false;
      this.clear();
    }
    _setup() {
      this._updateScrollTransition();
    }
    _updateScrollTransition() {
      const axis = this._direction === 1 ? 'y' : 'x';
      this.wrapper.transition(axis, this._scrollTransitionSettings);
      this._scrollTransition = this.wrapper.transition(axis);
    }
    _indexChanged(obj) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      let {
        index: target,
        dataLength: max,
        mainIndex,
        previousMainIndex,
        lines
      } = obj;
      if (!isNaN(previousMainIndex) && !isNaN(mainIndex) && !isNaN(lines)) {
        target = mainIndex;
        max = lines;
      }
      if (this._requestsEnabled && !this._requestingItems) {
        if (target + this._requestThreshold >= max) {
          this.requestItems(false, obj);
        }
      }
      this._refocus();
      this.scrollCollectionWrapper(obj, options);
      if (obj.previousIndex !== obj.index) {
        this.signal('onIndexChanged', obj);
      }
    }
    requestItems() {
      let reload = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      let obj = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;
      if (obj === undefined) {
        obj = {
          previousIndex: 0,
          index: this._index,
          mainIndex: this._mainIndex || 0,
          previousMainIndex: this._mainIndex || 0,
          crossIndex: this._crossIndex || 0,
          previousCrossIndex: this._crossIndex || 0,
          lines: this._lines && this._lines.length || 0,
          dataLength: this._items && this._items.length || 0
        };
      }
      this._requestingItems = true;
      this._request(obj).then(response => {
        this._requestingItems = false;
        if (reload) {
          this.clear();
        }
        const type = typeof response;
        if (Array.isArray(response) && response.length > 0 || type === 'object' || type === 'string' || type === 'number') {
          this.add(response);
          obj.dataLength = this._items && this._items.length || 0;
          this.signal('onRequestItemsAdded', obj);
        }
      });
    }
    _request(obj) {
      return new Promise(resolve => {
        this.signal('onRequestItems', obj).then(response => {
          if (response === undefined || response === false || Array.isArray(response) && response.length === 0) {
            this.enableRequests = false;
          }
          resolve(response);
        });
      });
    }
    _requestMore(index) {
      var _this = this;
      let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      let options = arguments.length > 2 ? arguments[2] : undefined;
      const obj = {
        previousIndex: this._index,
        index,
        mainIndex: this._mainIndex || 0,
        previousMainIndex: this._previous && this._previous.mainIndex || 0,
        crossIndex: this._crossIndex || 0,
        previousCrossIndex: this._previous && this._previous.crossIndex || 0,
        lines: this._lines && this._lines.length || 0,
        dataLength: data.length + (this._items && this._items.length || 0)
      };
      this._requestingItems = true;
      return new Promise(resolve => {
        this._request(obj).then(function () {
          let response = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          if (response) {
            const newData = [...data, ...response];
            if (index > _this._items.length + newData.length) {
              _this._requestMore(index, newData).then(resolve);
            } else {
              _this.add(newData);
              obj.dataLength = _this._items && _this._items.length || 0;
              _this.signal('onRequestItemsAdded', obj);
              _this._requestingItems = false;
              _this.setIndex(index, options);
              resolve(true);
            }
          } else {
            _this._requestingItems = false;
            resolve(false);
          }
        });
      });
    }
    setIndex(index) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      if (this._requestsEnabled && index > this._items.length - 1) {
        if (!this._requestingItems) {
          this._requestMore(index, [], options);
        }
        return true;
      }
      if (this._items.length === 0) {
        this._index = 0;
        return false;
      }
      const targetIndex = limitWithinRange(index, 0, this._items.length - 1);
      const previousIndex = this._index;
      this._index = targetIndex;
      this._indexChanged({
        previousIndex,
        index: targetIndex,
        dataLength: this._items.length
      }, options);
      return previousIndex !== targetIndex;
    }
    clear() {
      this._uids = [];
      this._items = [];
      this._index = 0;
      if (this._scrollTransition && this._scrollTransition.isRunning()) {
        this._scrollTransition.reset(0, 1);
      }
      if (this.wrapper) {
        const hadChildren = this.wrapper.children.length > 0;
        this.wrapper.patch({
          x: 0,
          y: 0,
          children: []
        });
        if (hadChildren) {
          this._collectGarbage(true);
        }
      }
    }
    add(item) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      this.addAt(item, this._items.length, options);
    }
    addAt(item) {
      let index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._items.length;
      let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      if (index >= 0 && index <= this._items.length) {
        if (!Array.isArray(item)) {
          item = [item];
        }
        const items = this._normalizeDataItems(item);
        this._items.splice(index, 0, ...items);
        this.plotItems(options);
        const targetIndex = index < this._index ? this._index + items.length : this._index;
        this.setIndex(targetIndex, options);
      } else {
        throw new Error('addAt: The index ' + index + ' is out of bounds ' + this._items.length);
      }
    }
    remove(target) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      if (this.hasItems && target.assignedID) {
        for (let i = 0; i < this._items.length; i++) {
          let item = this._items[i];
          if (target.assignedID === item.assignedID) {
            if (i === this._items.length - 1 && this._index === this._items.length - 1) {
              this._index = this._index - 1;
            }
            return this.removeAt(i, 1, options);
          }
        }
      } else {
        throw new Error('remove: item not found');
      }
    }
    removeAt(index) {
      let amount = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      if (index < 0 && index >= this._items.length) {
        throw new Error('removeAt: The index ' + index + ' is out of bounds ' + this._items.length);
      }
      const item = this._items[index];
      this._items.splice(index, amount);
      if (this._items.length > 0) {
        this.plotItems(options);
      }
      this.setIndex(this.index);
      return item;
    }
    reload(item) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      this.clear();
      this.add(item, options);
    }
    plotItems() {
    } //placeholder
    reposition() {
      let time = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 70;
      if (this._repositionDebounce) {
        clearTimeout(this._repositionDebounce);
      }
      this._repositionDebounce = setTimeout(() => {
        this.repositionItems();
      }, time);
    }
    repositionItems() {
      //placeHolder
      this.signal('onItemsRepositioned');
    }
    up() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this._attemptNavigation(-1, 1, options);
    }
    down() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this._attemptNavigation(1, 1, options);
    }
    left() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this._attemptNavigation(-1, 0, options);
    }
    right() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this._attemptNavigation(1, 0, options);
    }
    first() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this.setIndex(0, options);
    }
    last() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this.setIndex(this._items.length - 1, options);
    }
    next() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this.setIndex(this._index + 1, options);
    }
    previous() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return this.setIndex(this._index - 1, options);
    }
    _attemptNavigation(shift, direction) {
      let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      if (this.hasItems) {
        return this.navigate(shift, direction, options);
      }
      return false;
    }
    navigate(shift) {
      let direction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._direction;
      let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      if (direction !== this._direction) {
        return false;
      }
      return this.setIndex(this._index + shift, options);
    }
    scrollCollectionWrapper(obj) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      const {
        immediate = false
      } = options;
      let {
        previousIndex: previous,
        index: target,
        dataLength: max,
        mainIndex,
        previousMainIndex,
        lines
      } = obj;
      if (!isNaN(previousMainIndex) && !isNaN(mainIndex) && !isNaN(lines)) {
        previous = previousMainIndex;
        target = mainIndex;
        max = lines;
      }
      const {
        directionIsRow,
        main,
        mainDim,
        mainMarginFrom,
        mainMarginTo
      } = this._getPlotProperties(this._direction);
      const cw = this.currentItemWrapper;
      let bound = this[mainDim];
      if (bound === 0) {
        bound = directionIsRow ? 1920 : 1080;
      }
      const offset = Math.min(this.wrapper[main], this._scrollTransition && this._scrollTransition.targetValue || 0);
      const sizes = this._getItemSizes(cw);
      const marginFrom = sizes[mainMarginFrom] || sizes.margin || 0;
      const marginTo = sizes[mainMarginTo] || sizes.margin || 0;
      let scroll = this._scroll;
      if (!isNaN(scroll)) {
        if (scroll >= 0 && scroll <= 1) {
          scroll = bound * scroll - (cw[main] + cw[mainDim] * scroll);
        } else {
          scroll = scroll - cw[main];
        }
      } else if (typeof scroll === 'function') {
        scroll = scroll.apply(this, [cw, obj]);
      } else if (typeof scroll === 'object') {
        const {
          jump = false,
          after = false,
          backward = 0.0,
          forward = 1.0
        } = scroll;
        if (jump) {
          let mod = target % jump;
          if (mod === 0) {
            scroll = marginFrom - cw[main];
          }
          if (mod === jump - 1) {
            const actualSize = marginFrom + cw[mainDim] + marginTo;
            scroll = mod * actualSize + marginFrom - cw[main];
          }
        } else if (after) {
          scroll = 0;
          if (target >= after - 1) {
            const actualSize = marginFrom + cw[mainDim] + marginTo;
            scroll = (after - 1) * actualSize + marginFrom - cw[main];
          }
        } else {
          const backwardBound = bound * this._normalizePixelToPercentage(backward, bound);
          const forwardBound = bound * this._normalizePixelToPercentage(forward, bound);
          if (target < max - 1 && previous < target && offset + cw[main] + cw[mainDim] > forwardBound) {
            scroll = forwardBound - (cw[main] + cw[mainDim]);
          } else if (target > 0 && target < previous && offset + cw[main] < backwardBound) {
            scroll = backwardBound - cw[main];
          } else if (target === max - 1) {
            scroll = bound - (cw[main] + cw[mainDim]);
          } else if (target === 0) {
            scroll = marginFrom - cw[main];
          }
        }
      } else if (isNaN(scroll)) {
        if (previous < target && offset + cw[main] + cw[mainDim] > bound) {
          scroll = bound - (cw[main] + cw[mainDim]);
        } else if (target < previous && offset + cw[main] < 0) {
          scroll = marginFrom - cw[main];
        }
      }
      if (this.active && !isNaN(scroll) && this._scrollTransition) {
        if (immediate) {
          this._scrollTransition.reset(scroll, 1);
        } else {
          if (this._scrollTransition.isRunning()) {
            this._scrollTransition.reset(scroll, 0.05);
          } else {
            this._scrollTransition.start(scroll);
          }
        }
      } else if (!isNaN(scroll)) {
        this.wrapper[main] = scroll;
        if (this._scrollTransition) {
          this._scrollTransition.reset(scroll, 1);
        }
      }
    }
    $childInactive(_ref) {
      let {
        child
      } = _ref;
      if (typeof child === 'object') {
        const index = child.componentIndex;
        for (let key in this._items[index]) {
          if (child.component[key] !== undefined) {
            this._items[index][key] = child.component[key];
          }
        }
      }
      this._collectGarbage();
    }
    $getChildComponent(_ref2) {
      let {
        index
      } = _ref2;
      return this._items[index];
    }
    _resizeWrapper(crossSize) {
      let obj = crossSize;
      if (!isNaN(crossSize)) {
        const {
          main,
          mainDim,
          crossDim
        } = this._getPlotProperties(this._direction);
        const lastItem = this.wrapper.childList.last;
        obj = {
          [mainDim]: lastItem[main] + lastItem[mainDim],
          [crossDim]: crossSize
        };
      }
      this.wrapper.patch(obj);
      if (this._autoResize) {
        this.patch(obj);
      }
    }
    _generateUniqueID() {
      let id = '';
      while (this._uids[id] || id === '') {
        id = Math.random().toString(36).substring(2, 9);
      }
      this._uids[id] = true;
      return id;
    }
    _getPlotProperties(direction) {
      const directionIsRow = direction === 0;
      return {
        directionIsRow: directionIsRow ? true : false,
        mainDirection: directionIsRow ? 'rows' : 'columns',
        main: directionIsRow ? 'x' : 'y',
        mainDim: directionIsRow ? 'w' : 'h',
        mainMarginTo: directionIsRow ? 'marginRight' : 'marginBottom',
        mainMarginFrom: directionIsRow ? 'marginLeft' : 'marginTop',
        crossDirection: !directionIsRow ? 'columns' : 'rows',
        cross: directionIsRow ? 'y' : 'x',
        crossDim: directionIsRow ? 'h' : 'w',
        crossMarginTo: directionIsRow ? 'marginBottom' : 'marginRight',
        crossMarginFrom: directionIsRow ? 'marginTop' : 'marginLeft'
      };
    }
    _getItemSizes(item) {
      const itemType = item.type;
      if (item.component && item.component.__attached) {
        item = item.component;
      }
      return {
        w: item.w || itemType && itemType['width'],
        h: item.h || itemType && itemType['height'],
        margin: item.margin || itemType && itemType['margin'] || 0,
        marginLeft: item.marginLeft || itemType && itemType['marginLeft'],
        marginRight: item.marginRight || itemType && itemType['marginRight'],
        marginTop: item.marginTop || itemType && itemType['marginTop'],
        marginBottom: item.marginBottom || itemType && itemType['marginBottom']
      };
    }
    _collectGarbage(immediate) {
      this._gcIncrement++;
      if (immediate || this.active && this._gcThreshold !== 0 && this._gcIncrement >= this._gcThreshold) {
        this._gcIncrement = 0;
        this.stage.gc();
      }
    }
    _normalizeDataItems(array) {
      return array.map((item, index) => {
        return this._normalizeDataItem(item) || index;
      }).filter(item => {
        if (!isNaN(item)) {
          console.warn("Item at index: ".concat(item, ", is not a valid item. Removing it from dataset"));
          return false;
        }
        return true;
      });
    }
    _normalizeDataItem(item, index) {
      if (typeof item === 'string' || typeof item === 'number') {
        item = {
          label: item.toString()
        };
      }
      if (typeof item === 'object') {
        let id = this._generateUniqueID();
        return {
          assignedID: id,
          type: this.itemType,
          collectionWrapper: this,
          isAlive: false,
          ...item
        };
      }
      return index;
    }
    _normalizePixelToPercentage(value, max) {
      if (value && value > 1) {
        return value / max;
      }
      return value || 0;
    }
    _getFocused() {
      if (this.hasItems) {
        return this.currentItemWrapper;
      }
      return this;
    }
    _handleRight() {
      return this.right();
    }
    _handleLeft() {
      return this.left();
    }
    _handleUp() {
      return this.up();
    }
    _handleDown() {
      return this.down();
    }
    _inactive() {
      if (this._repositionDebounce) {
        clearTimeout(this._repositionDebounce);
      }
      this._collectGarbage(true);
    }
    static get itemType() {
      return undefined;
    }
    set forceLoad(bool) {
      this._forceLoad = bool;
    }
    get forceLoad() {
      return this._forceLoad;
    }
    get requestingItems() {
      return this._requestingItems;
    }
    set requestThreshold(num) {
      this._requestThreshold = num;
    }
    get requestThreshold() {
      return this._requestThreshold;
    }
    set enableRequests(bool) {
      this._requestsEnabled = bool;
    }
    get enableRequests() {
      return this._requestsEnabled;
    }
    set gcThreshold(num) {
      this._gcThreshold = num;
    }
    get gcThreshold() {
      return this._gcThreshold;
    }
    get wrapper() {
      return this.tag('Wrapper');
    }
    get hasItems() {
      return this.wrapper && this.wrapper.children && this.wrapper.children.length > 0;
    }
    get currentItemWrapper() {
      return this.wrapper.children[this._index];
    }
    get currentItem() {
      return this.currentItemWrapper && this.currentItemWrapper.component || undefined;
    }
    set direction(string) {
      this._direction = CollectionWrapper.DIRECTION[string] || CollectionWrapper.DIRECTION.row;
    }
    get direction() {
      return Object.keys(CollectionWrapper.DIRECTION)[this._direction];
    }
    set items(array) {
      this.clear();
      this.add(array);
    }
    get items() {
      const itemWrappers = this.itemWrappers;
      return this._items.map((item, index) => {
        if (itemWrappers[index] && itemWrappers[index].component.isAlive) {
          return itemWrappers[index].component;
        }
        return item;
      });
    }
    get length() {
      return this._items.length;
    }
    set index(index) {
      this.setIndex(index);
    }
    get itemWrappers() {
      return this.wrapper.children;
    }
    get index() {
      return this._index;
    }
    set scrollTransition(obj) {
      this._scrollTransitionSettings.patch(obj);
      if (this.active) {
        this._updateScrollTransition();
      }
    }
    get scrollTransition() {
      return this._scrollTransition;
    }
    set scroll(value) {
      this._scroll = value;
    }
    get scroll() {
      return this._scroll;
    }
    set autoResize(bool) {
      this._autoResize = bool;
    }
    get autoResize() {
      return this._autoResize;
    }
    set spacing(num) {
      this._spacing = num;
    }
    get spacing() {
      return this._spacing;
    }
  }
  CollectionWrapper.DIRECTION = {
    row: 0,
    column: 1
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class Cursor extends Lightning.Component {
    static _template() {
      return {
        alpha: 0
      };
    }
    _construct() {
      this._blink = true;
    }
    _init() {
      this._blinkAnimation = this.animation({
        duration: 1,
        repeat: -1,
        actions: [{
          p: 'alpha',
          v: {
            0: 0,
            0.5: 1,
            1: 0
          }
        }]
      });
    }
    show() {
      if (this._blink) {
        this._blinkAnimation.start();
      } else {
        this.alpha = 1;
      }
    }
    hide() {
      if (this._blink) {
        this._blinkAnimation.stop();
      } else {
        this.alpha = 0;
      }
    }
    set blink(bool) {
      this._blink = bool;
      if (this.active) {
        if (bool) {
          this.show();
        } else {
          this.hide();
        }
      }
    }
    get blink() {
      return this._blink;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class ItemWrapper extends Lightning.Component {
    static _template() {
      return {
        clipbox: true
      };
    }
    create() {
      if (this.children.length > 0) {
        return;
      }
      const component = this.fireAncestors('$getChildComponent', {
        index: this.componentIndex
      });
      component.isAlive = true;
      const {
        w,
        h,
        margin,
        marginTop,
        marginBottom,
        marginRight,
        marginLeft
      } = this;
      this.children = [{
        ...component,
        w,
        h,
        margin,
        marginTop,
        marginRight,
        marginLeft,
        marginBottom
      }];
      if (this.hasFocus()) {
        this._refocus();
      }
    }
    get component() {
      return this.children[0] || this.fireAncestors('$getChildComponent', {
        index: this.componentIndex
      });
    }
    _setup() {
      if (this.forceLoad) {
        this.create();
      }
    }
    _active() {
      this.create();
    }
    _inactive() {
      if (!this.forceLoad) {
        this.children[0].isAlive = false;
        this.fireAncestors('$childInactive', {
          child: this
        });
        this.childList.clear();
      }
    }
    _getFocused() {
      return this.children && this.children[0] || this;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class KeyWrapper extends Lightning.Component {
    static _template() {
      return {
        clipbox: true
      };
    }
    _update() {
      let currentKey = this.children && this.children[0];
      if (currentKey && currentKey.action === this._key.data.action) {
        currentKey.patch({
          ...this._key
        });
      } else {
        this.children = [{
          type: this._key.keyType,
          ...this._key
        }];
      }
      if (this.hasFocus()) {
        this._refocus();
      }
    }
    set key(obj) {
      this._key = obj;
      if (this.active) {
        this._update();
      }
    }
    get key() {
      return this._key;
    }
    _active() {
      this._update();
    }
    _inactive() {
      this.childList.clear();
    }
    _getFocused() {
      return this.children && this.children[0] || this;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const limitWithinRange = (num, min, max) => {
    return Math.min(Math.max(num, min), max);
  };
  const defineProperties = (component, props) => {
    props.forEach(prop => {
      Object.defineProperty(component, prop, {
        set: function (value) {
          component["_".concat(prop)] = value;
        },
        get: function () {
          return component["_".concat(prop)];
        }
      });
    });
  };
  const findIndexOfObject = (array, search, targetProp) => {
    for (let i = 0; i < array.length; i++) {
      if (array[i][targetProp] === search) {
        return i;
      }
    }
    return -1;
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class Grid extends CollectionWrapper {
    _construct() {
      this._crossSpacing = 5;
      this._mainSpacing = 5;
      this._rows = 0;
      this._columns = 0;
      super._construct();
    }
    clear() {
      super.clear();
      this._mainIndex = 0;
      this._crossIndex = 0;
      this._previous = undefined;
    }
    setIndex(index) {
      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      if (this._requestsEnabled && index > this._items.length - 1) {
        if (!this._requestingItems) {
          this._requestMore(index, [], options);
        }
        return true;
      }
      if (this._items.length === 0) {
        this._mainIndex = 0;
        this._crossIndex = 0;
        this._index = 0;
        return false;
      }
      const targetIndex = limitWithinRange(index, 0, this._items.length - 1);
      const previousIndex = this._index;
      const {
        mainIndex: previousMainIndex,
        crossIndex: previousCrossIndex
      } = this._findLocationOfIndex(previousIndex);
      const {
        mainIndex,
        crossIndex
      } = this._findLocationOfIndex(targetIndex);
      this._mainIndex = mainIndex;
      this._crossIndex = crossIndex;
      this._previous = {
        mainIndex,
        crossIndex,
        realIndex: previousIndex
      };
      this._index = targetIndex;
      this._indexChanged({
        previousIndex,
        index: targetIndex,
        mainIndex,
        previousMainIndex,
        crossIndex,
        previousCrossIndex,
        lines: this._lines.length,
        dataLength: this._items.length
      }, options);
      return previousIndex !== targetIndex;
    }
    _findLocationOfIndex(index) {
      for (let i = 0; i < this._lines.length; i++) {
        if (this._lines[i].includes(index)) {
          return {
            mainIndex: i,
            crossIndex: this._lines[i].indexOf(index)
          };
        }
      }
      return {
        mainIndex: -1,
        crossIndex: -1
      };
    }
    plotItems() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      const {
        immediate = false
      } = options;
      const items = this._items;
      const wrapper = this.wrapper;
      const {
        directionIsRow,
        mainDirection,
        main,
        mainDim,
        mainMarginTo,
        mainMarginFrom,
        cross,
        crossDim,
        crossMarginTo,
        crossMarginFrom
      } = this._getPlotProperties(this._direction);
      const crossSize = this[crossDim];
      let mainPos = 0,
        crossPos = 0,
        lineIndex = 0;
      const animateItems = [];
      const viewboundMain = directionIsRow ? 1920 : 1080;
      const viewboundCross = directionIsRow ? 1080 : 1920;
      const renderContext = this.core.renderContext;
      this._lines = [[]];
      //create empty line array
      let cl = [];
      const newChildren = items.map((item, index) => {
        const sizes = this._getItemSizes(item);
        const targetCrossFromMargin = sizes[crossMarginFrom] || sizes.margin || 0;
        if (index === 0) {
          mainPos += sizes[mainMarginFrom] || sizes.margin || 0;
        }
        if (cl.length > 0 && (this[mainDirection] > 0 && this[mainDirection] === cl.length || this[mainDirection] === 0 && crossPos + targetCrossFromMargin + sizes[crossDim] > crossSize)) {
          const bil = this._getBiggestInLine(cl);
          mainPos = bil[main] + bil[mainDim] + (bil[mainMarginTo] || bil.margin || this._mainSpacing);
          crossPos = targetCrossFromMargin;
          this._lines.push([]);
          cl = [];
          lineIndex++;
        } else {
          crossPos += targetCrossFromMargin;
        }
        const ref = "IW-".concat(item.assignedID);
        let tmp = mainPos;
        let tcp = crossPos;
        const existingItemWrapper = wrapper.tag(ref);
        if (existingItemWrapper && (existingItemWrapper.active && (crossPos !== existingItemWrapper[cross] || mainPos !== existingItemWrapper[main]) || !existingItemWrapper.active && (renderContext["p".concat(main)] + wrapper[main] + mainPos <= viewboundMain || renderContext["p".concat(cross)] + wrapper[cross] + crossPos <= viewboundCross))) {
          tmp = existingItemWrapper[main];
          tcp = existingItemWrapper[cross];
          animateItems.push(index);
        }
        const newItem = {
          ref,
          type: ItemWrapper,
          componentIndex: index,
          forceLoad: this._forceLoad,
          ...sizes,
          ["assigned".concat(main.toUpperCase())]: mainPos,
          ["assigned".concat(cross.toUpperCase())]: crossPos,
          [main]: tmp,
          [cross]: tcp
        };
        crossPos += sizes[crossDim] + (sizes[crossMarginTo] || sizes.margin || this._crossSpacing);
        this._lines[lineIndex].push(index);
        cl.push(newItem);
        return newItem;
      });
      wrapper.children = newChildren;
      animateItems.forEach(index => {
        const item = wrapper.children[index];
        if (immediate) {
          item.patch({
            x: item.assignedX,
            y: item.assignedY
          });
        } else {
          item.patch({
            smooth: {
              x: item.assignedX,
              y: item.assignedY
            }
          });
        }
      });
      const biggestInLastLine = this._getBiggestInLine(cl);
      this._resizeWrapper({
        [mainDim]: biggestInLastLine[main] + biggestInLastLine[mainDim],
        [crossDim]: crossSize
      });
    }
    repositionItems() {
      const wrapper = this.wrapper;
      if (!wrapper && wrapper.children.length) {
        return true;
      }
      const {
        main,
        mainDim,
        mainMarginTo,
        mainMarginFrom,
        cross,
        crossDim,
        crossMarginTo,
        crossMarginFrom
      } = this._getPlotProperties(this._direction);
      const crossSize = this[crossDim];
      let mainPos = 0,
        crossPos = 0,
        lineIndex = 0;

      //create empty line array
      let cl = [];
      this.lines = [[]];
      wrapper.children.forEach((item, index) => {
        const sizes = this._getItemSizes(item);
        const targetCrossFromMargin = sizes[crossMarginFrom] || sizes.margin || 0;
        if (index === 0) {
          mainPos += sizes[mainMarginFrom] || sizes.margin || 0;
        }
        if (cl.length > 0 && (this[mainDirection] > 0 && this[mainDirection] === cl.length || this[mainDirection] === 0 && crossPos + targetCrossFromMargin + sizes[crossDim] > crossSize)) {
          const bil = this._getBiggestInLine(cl);
          mainPos = bil[main] + bil[mainDim] + (bil[mainMarginTo] || bil.margin || this._mainSpacing);
          crossPos = targetCrossFromMargin;
          this._lines.push([]);
          cl = [];
          lineIndex++;
        } else {
          crossPos += targetCrossFromMargin;
        }
        item.patch({
          ["assigned".concat(main.toUpperCase())]: mainPos,
          ["assigned".concat(cross.toUpperCase())]: crossPos,
          [main]: mainPos,
          [cross]: crossPos
        });
        crossPos += sizes[crossDim] + (sizes[crossMarginTo] || sizes.margin || this._crossSpacing);
        this._lines[lineIndex].push(index);
        cl.push(item);
      });
      const biggestInLastLine = this._getBiggestInLine(cl);
      this._resizeWrapper({
        [mainDim]: biggestInLastLine[main] + biggestInLastLine[mainDim],
        [crossDim]: crossSize
      });
      super.repositionItems();
    }
    _getBiggestInLine(line) {
      const {
        mainDim
      } = this._getPlotProperties(this._direction);
      return line.reduce((biggestItem, newItem) => {
        if (newItem[mainDim] > biggestItem[mainDim]) {
          return newItem;
        }
        return biggestItem;
      });
    }
    navigate(shift, direction) {
      let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      const {
        directionIsRow,
        cross,
        crossDim
      } = this._getPlotProperties(this._direction);
      const overCross = directionIsRow && direction === CollectionWrapper.DIRECTION.column || !directionIsRow && direction === CollectionWrapper.DIRECTION.row;
      let targetMainIndex = this._mainIndex + !!!overCross * shift;
      let targetCrossIndex = this._crossIndex + !!overCross * shift;
      let targetIndex = this._index;
      if (overCross && targetCrossIndex > -1 && targetCrossIndex <= this._lines[targetMainIndex].length) {
        if (this._lines[targetMainIndex][targetCrossIndex] !== undefined) {
          targetIndex = this._lines[targetMainIndex][targetCrossIndex];
          this._previous = undefined;
        }
      } else if (!overCross && targetMainIndex < this._lines.length && targetMainIndex > -1) {
        const targetLine = this._lines[targetMainIndex];
        if (this._previous && this._previous.mainIndex === targetMainIndex) {
          targetIndex = this._previous.realIndex;
          targetCrossIndex = this._previous.crossIndex;
        } else if (targetLine) {
          const currentItem = this.currentItemWrapper;
          const m = targetLine.map(item => {
            const targetItem = this.wrapper.children[item];
            if (targetItem[cross] <= currentItem[cross] && currentItem[cross] <= targetItem[cross] + targetItem[crossDim]) {
              return targetItem[cross] + targetItem[crossDim] - currentItem[cross];
            }
            if (targetItem[cross] >= currentItem[cross] && targetItem[cross] <= currentItem[cross] + currentItem[crossDim]) {
              return currentItem[cross] + currentItem[crossDim] - targetItem[cross];
            }
            return -1;
          });
          let acc = -1;
          let t = -1;
          for (let i = 0; i < m.length; i++) {
            if (m[i] === -1 && acc > -1) {
              break;
            }
            if (m[i] > acc) {
              acc = m[i];
              t = i;
            }
          }
          if (t > -1) {
            targetCrossIndex = t;
            targetIndex = targetLine[t];
          }
        }
        this._previous = {
          mainIndex: this._mainIndex,
          crossIndex: this._crossIndex,
          realIndex: this._index
        };
      }
      if (this._index !== targetIndex) {
        this.setIndex(targetIndex, options);
        return true;
      }
      return false;
    }
    set rows(num) {
      this._rows = num;
      this.direction = 'row';
    }
    get rows() {
      return this._rows;
    }
    set columns(num) {
      this._columns = num;
      this.direction = 'column';
    }
    get columns() {
      return this._columns;
    }
    set crossSpacing(num) {
      this._crossSpacing = num;
    }
    get crossSpacing() {
      return this._crossSpacing;
    }
    set mainSpacing(num) {
      this._mainSpacing = num;
    }
    get mainSpacing() {
      return this._mainSpacing;
    }
    set spacing(num) {
      this._spacing = num;
      this._mainSpacing = num;
      this._crossSpacing = num;
    }
    get spacing() {
      return this._spacing;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class InputField extends Lightning.Component {
    static _template() {
      return {
        PreLabel: {
          renderOffscreen: true
        },
        PostLabel: {
          renderOffscreen: true
        },
        Cursor: {
          type: Cursor,
          rect: true,
          w: 4,
          h: 54,
          x: 0,
          y: 0
        }
      };
    }
    _construct() {
      this._input = '';
      this._previousInput = '';
      this._description = '';
      this._cursorX = 0;
      this._cursorIndex = 0;
      this._passwordMask = '*';
      this._passwordMode = false;
      this._autoHideCursor = true;
      this._labelPositionStatic = true;
      this._maxLabelWidth = 0;
    }
    _init() {
      this.tag('PreLabel').on('txLoaded', () => {
        this._labelTxLoaded();
      });
      this.tag('PostLabel').on('txLoaded', () => {
        this._labelTxLoaded;
      });
    }
    onInputChanged(_ref) {
      let {
        input = ''
      } = _ref;
      let targetIndex = Math.max(input.length - this._input.length + this._cursorIndex, 0);
      this._input = input;
      this._update(targetIndex);
    }
    toggleCursor() {
      let bool = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !this._cursorVisible;
      this._cursorVisible = bool;
      this.cursor[bool ? 'show' : 'hide']();
    }
    _labelTxLoaded() {
      const preLabel = this.tag('PreLabel');
      const cursor = this.tag('Cursor');
      const postLabel = this.tag('PostLabel');
      this.h = preLabel.renderHeight || postLabel.renderHeight;
      cursor.x = preLabel.renderWidth + this._cursorX;
      postLabel.x = cursor.x + cursor.w * (1 - cursor.mountX);
      this.setSmooth('x', this._labelOffset);
      if (!this.autoHideCursor) {
        this.toggleCursor(true);
      }
    }
    _update() {
      let index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      const hasInput = this._input.length > 0;
      let pre = this._description + '';
      let post = '';
      if (hasInput) {
        pre = this._input.substring(0, index);
        post = this._input.substring(index, this._input.length);
        if (this._passwordMode) {
          pre = this._passwordMask.repeat(pre.length);
          post = this._passwordMask.repeat(post.length);
        }
        this.toggleCursor(true);
      } else if (this._autoHideCursor) {
        this.toggleCursor(false);
      }
      this.patch({
        PreLabel: {
          text: {
            text: pre
          }
        },
        PostLabel: {
          text: {
            text: post
          }
        }
      });
      if (this.h === 0) {
        this.tag('PreLabel').loadTexture();
        this.h = this.tag('PreLabel').renderHeight;
      }
      this._cursorIndex = index;
    }
    _handleRight() {
      this._update(Math.min(this._input.length, this._cursorIndex + 1));
    }
    _handleLeft() {
      this._update(Math.max(0, this._cursorIndex - 1));
    }
    _firstActive() {
      this._labelTxLoaded();
      this._update();
    }
    get input() {
      return this._input;
    }
    get hasInput() {
      return this._input.length > 0;
    }
    get cursorIndex() {
      return this._cursorIndex;
    }
    set inputText(obj) {
      this._inputText = obj;
      this.tag('PreLabel').patch({
        text: obj
      });
      this.tag('PostLabel').patch({
        text: obj
      });
    }
    get inputText() {
      return this._inputText;
    }
    set description(str) {
      this._description = str;
    }
    get description() {
      return this._description;
    }
    set cursor(obj) {
      if (obj.x) {
        this._cursorX = obj.x;
        delete obj.x;
      }
      this.tag('Cursor').patch(obj);
    }
    get cursor() {
      return this.tag('Cursor');
    }
    get cursorVisible() {
      return this._cursorVisible;
    }
    set autoHideCursor(bool) {
      this._autoHideCursor = bool;
    }
    get autoHideCursor() {
      return this._autoHideCursor;
    }
    set passwordMode(val) {
      this._passwordMode = val;
    }
    get passwordMode() {
      return this._passwordMode;
    }
    set passwordMask(str) {
      this._passwordMask = str;
    }
    get passwordmask() {
      return this._passwordMask;
    }

    // the width at which the text start scrolling
    set maxLabelWidth(val) {
      this._maxLabelWidth = val;
    }
    get maxLabelWidth() {
      return this._maxLabelWidth;
    }
    set labelPositionStatic(val) {
      this._labelPositionStatic = val;
    }
    get labelPositionStatic() {
      return this._labelPositionStatic;
    }
    get _labelOffset() {
      if (this._labelPositionStatic) return 0;
      let offset = this.maxLabelWidth - this.tag('Cursor').x;
      return offset < 0 ? offset : 0;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class Key$1 extends Lightning.Component {
    static _template() {
      return {
        Background: {
          w: w => w,
          h: h => h,
          rect: true
        },
        Label: {
          mount: 0.5,
          x: w => w / 2,
          y: h => h / 2
        }
      };
    }
    _construct() {
      this._backgroundColors = {};
      this._labelColors = {};
    }
    set data(obj) {
      this._data = obj;
      this._update();
    }
    get data() {
      return this._data;
    }
    set labelText(obj) {
      this._labelText = obj;
      this.tag('Label').patch({
        text: obj
      });
    }
    get labelText() {
      return this._labelText;
    }
    set label(obj) {
      this.tag('Label').patch(obj);
    }
    get label() {
      return this.tag('Label');
    }
    set labelColors(obj) {
      this._labelColors = obj;
      this._update();
    }
    get labelColors() {
      return this._labelColors;
    }
    set backgroundColors(obj) {
      this._backgroundColors = obj;
      this._update();
    }
    get backgroundColors() {
      return this._backgroundColors;
    }
    set background(obj) {
      this.tag('Background').patch(obj);
    }
    get background() {
      return this.tag('Background');
    }
    _update() {
      if (!this.active) {
        return;
      }
      const {
        label = ''
      } = this._data;
      const hasFocus = this.hasFocus();
      let {
        focused,
        unfocused = 0xff000000
      } = this._backgroundColors;
      let {
        focused: labelFocused,
        unfocused: labelUnfocused = 0xffffffff
      } = this._labelColors;
      this.patch({
        Background: {
          color: hasFocus && focused ? focused : unfocused
        },
        Label: {
          text: {
            text: label
          },
          color: hasFocus && labelFocused ? labelFocused : labelUnfocused
        }
      });
    }
    _firstActive() {
      this._update();
    }
    _focus() {
      let {
        focused,
        unfocused = 0xff000000
      } = this._backgroundColors;
      let {
        focused: labelFocused,
        unfocused: labelUnfocused = 0xffffffff
      } = this._labelColors;
      this.patch({
        Background: {
          smooth: {
            color: focused || unfocused
          }
        },
        Label: {
          smooth: {
            color: labelFocused || labelUnfocused
          }
        }
      });
    }
    _unfocus() {
      let {
        unfocused = 0xff000000
      } = this._backgroundColors;
      let {
        unfocused: labelUnfocused = 0xffffffff
      } = this._labelColors;
      this.patch({
        Background: {
          smooth: {
            color: unfocused
          }
        },
        Label: {
          smooth: {
            color: labelUnfocused
          }
        }
      });
    }
    static get width() {
      return 80;
    }
    static get height() {
      return 80;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class Keyboard extends Lightning.Component {
    static _template() {
      return {
        Keys: {
          w: w => w
        }
      };
    }
    _construct() {
      this._input = '';
      this._inputField = undefined;
      this._maxCharacters = 56;
      this.navigationWrapAround = false;
      this._snapToRow = false;
      this.resetFocus();
    }
    resetFocus() {
      this._columnIndex = 0;
      this._rowIndex = 0;
      this._previousKey = null;
    }
    _setup() {
      this._keys = this.tag('Keys');
      this._update();
    }
    _update() {
      const {
        layouts,
        buttonTypes = {},
        styling = {}
      } = this._config;
      if (!this._layout || this._layout && layouts[this._layout] === undefined) {
        console.error("Configured layout \"".concat(this._layout, "\" does not exist. Picking first available: \"").concat(Object.keys(layouts)[0], "\""));
        this._layout = Object.keys(layouts)[0];
      }
      const {
        horizontalSpacing = 0,
        verticalSpacing = 0,
        align = 'left'
      } = styling;
      let rowPosition = 0;
      const isEvent = /^[A-Z][A-Za-z0-9]{1}/;
      const hasLabel = /\:/;
      if (buttonTypes.default === undefined) {
        buttonTypes.default = Key$1;
      }
      this._keys.children = layouts[this._layout].map((row, rowIndex) => {
        const {
          x = 0,
          margin = 0,
          marginRight,
          marginLeft,
          marginTop,
          marginBottom,
          spacing: rowHorizontalSpacing = horizontalSpacing || 0,
          align: rowAlign = align
        } = styling["Row".concat(rowIndex + 1)] || {};
        let keyPosition = 0;
        let rowHeight = 0;
        const rowKeys = row.map((key, keyIndex) => {
          const origin = key;
          let keyType = buttonTypes.default;
          let action = 'Input';
          let label = key;
          if (isEvent.test(key)) {
            if (hasLabel.test(key)) {
              key = key.split(':');
              label = key[1].toString();
              key = key[0];
            }
            if (buttonTypes[key]) {
              keyType = buttonTypes[key];
              action = key.action || key;
            }
          }
          let keySpacing = keyType && keyType.margin || 0;
          let w = 0;
          let h = 0;
          let marginLeft = 0;
          let marginRight = rowHorizontalSpacing;
          if (keyType.type) {
            keySpacing = keyType.type.margin || keySpacing;
            w = keyType.type.width || w;
            h = keyType.type.height || h;
            marginLeft = keyType.type.marginLeft || marginLeft;
            marginRight = keyType.type.marginRight || marginRight;
          }
          w = keyType.w || w;
          h = keyType.h || h;
          rowHeight = h > rowHeight ? h : rowHeight;
          const currentPosition = keyPosition + marginLeft;
          keyPosition += marginLeft + w + marginRight;
          return {
            ref: "Key-{".concat(keyIndex + 1, "}"),
            type: KeyWrapper,
            keyboard: this,
            x: currentPosition,
            w,
            h,
            key: {
              data: {
                origin,
                key,
                label,
                action
              },
              w,
              h,
              ...keyType
            }
          };
        });
        let rowOffset = x + (marginLeft || margin);
        let rowMount = 0;
        if (this.w && rowAlign === 'center') {
          rowOffset = this.w / 2;
          rowMount = 0.5;
        }
        if (this.w && rowAlign === 'right') {
          rowOffset = this.w - (marginRight || margin);
          rowMount = 1;
        }
        const currentPosition = rowPosition + (marginTop || margin);
        rowPosition = currentPosition + rowHeight + (marginBottom || margin || verticalSpacing);
        return {
          ref: "Row-".concat(rowIndex + 1),
          x: rowOffset,
          mountX: rowMount,
          w: keyPosition,
          y: currentPosition,
          children: rowKeys
        };
      });
      this._refocus();
    }
    _getFocused() {
      return this.currentKeyWrapper || this;
    }
    _handleRight() {
      return this.navigate('row', 1);
    }
    _handleLeft() {
      return this.navigate('row', -1);
    }
    _handleUp() {
      return this.navigate('column', -1);
    }
    _handleDown() {
      return this.navigate('column', 1);
    }
    _handleKey(_ref) {
      let {
        key,
        code = 'CustomKey'
      } = _ref;
      if (code === 'Backspace' && this._input.length === 0) {
        return false;
      }
      if (key === ' ') {
        key = 'Space';
      }
      const targetFound = this._findKey(key);
      if (targetFound) {
        this._handleEnter();
      }
      return targetFound;
    }
    _findKey(str) {
      const rows = this._config.layouts[this._layout];
      let i = 0,
        j = 0;
      for (; i < rows.length; i++) {
        for (j = 0; j < rows[i].length; j++) {
          let key = rows[i][j];
          if (str.length > 1 && key.indexOf(str) > -1 || key.toUpperCase() === str.toUpperCase()) {
            this._rowIndex = i;
            this._columnIndex = j;
            return true;
          }
        }
      }
      return false;
    }
    _handleEnter() {
      const {
        origin,
        action
      } = this.currentKey.data;
      const event = {
        index: this._input.length,
        key: origin
      };
      if (this._inputField && this._inputField.cursorIndex) {
        event.index = this._inputField.cursorIndex;
      }
      if (action !== 'Input') {
        const split = event.key.split(':');
        const call = "on".concat(split[0]);
        const eventFunction = this[call];
        event.key = split[1];
        if (eventFunction && eventFunction.apply && eventFunction.call) {
          eventFunction.call(this, event);
        }
        this.signal(call, {
          input: this._input,
          keyboard: this,
          ...event
        });
      } else {
        this.addAt(event.key, event.index);
      }
    }
    _changeInput(input) {
      if (input.length > this._maxCharacters) {
        return;
      }
      const eventData = {
        previousInput: this._input,
        input: this._input = input
      };
      if (this._inputField && this._inputField.onInputChanged) {
        this._inputField.onInputChanged(eventData);
      }
      this.signal('onInputChanged', eventData);
    }
    focus(str) {
      this._findKey(str);
    }
    add(str) {
      this._changeInput(this._input + str);
    }
    addAt(str, index) {
      if (index > this._input.length - 1) {
        this.add(str);
      } else if (index > -1) {
        this._changeInput(this._input.substring(0, index) + str + this._input.substring(index, this._input.length));
      }
    }
    remove() {
      this._changeInput(this._input.substring(0, this._input.length - 1));
    }
    removeAt(index) {
      if (index > this._input.length - 1) {
        this.remove();
      } else if (index > -1) {
        this._changeInput(this._input.substring(0, index - 1) + this._input.substring(index, this._input.length));
      }
    }
    clear() {
      this._changeInput('');
    }
    layout(key) {
      if (key === this._layout) {
        return;
      }
      this._layout = key;
      if (this.attached) {
        this.resetFocus();
        this._update();
      }
    }
    inputField(component) {
      if (component && component.isComponent) {
        this._rowIndex = 0;
        this._columnIndex = 0;
        this._input = component.input !== undefined ? component.input : '';
        this._inputField = component;
      } else {
        this._rowIndex = 0;
        this._columnIndex = 0;
        this._input = '';
        this._inputField = undefined;
      }
    }
    _findKeyInRow(currentKey, currentRow, targetRow) {
      const currentX = currentRow.x - currentRow.w * currentRow.mountX + currentKey.x;
      const m = targetRow.children.map(key => {
        const keyX = targetRow.x - targetRow.w * targetRow.mountX + key.x;
        if (keyX <= currentX && (this._snapToRow || currentX < keyX + key.w)) {
          return keyX + key.w - currentX;
        }
        if (keyX >= currentX && (this._snapToRow || keyX < currentX + currentKey.w)) {
          return currentX + currentKey.w - keyX;
        }
        return -1;
      });
      if (!this._snapToRow) {
        let acc = -1;
        let t = -1;
        for (let i = 0; i < m.length; i++) {
          if (m[i] === -1 && acc > -1) {
            break;
          }
          if (m[i] > acc) {
            acc = m[i];
            t = i;
          }
        }
        return t;
      }
      let t = m.indexOf(currentKey.w);
      if (t === -1 && m.length > 0) {
        let acc = this.w;
        for (let i = 0; i < m.length; i++) {
          if (m[i] >= 0) {
            const cutoff = currentX + currentKey.w - currentX - m[i];
            if (cutoff < acc) {
              acc = cutoff;
              t = i;
            }
          }
        }
        if (t === -1) {
          acc = this.w;
          for (let i = 0; i < m.length; i++) {
            if (Math.abs(m[i]) < acc) {
              acc = Math.abs(m[i]);
              t = i;
            }
          }
        }
      }
      return t;
    }
    navigate(direction, shift) {
      const targetIndex = (direction === 'row' ? this._columnIndex : this._rowIndex) + shift;
      const currentRow = this.rows[this._rowIndex];
      if (direction === 'row' && targetIndex > -1 && targetIndex < currentRow.children.length) {
        this._previous = null;
        return this._columnIndex = targetIndex;
      } else if (direction === 'row' && this.navigationWrapAround) {
        this._previous = null;
        let rowLen = currentRow.children.length;
        return this._columnIndex = (targetIndex % rowLen + rowLen) % rowLen;
      }
      if (direction === 'column' && targetIndex > -1 && targetIndex < this.rows.length) {
        const currentRowIndex = this._rowIndex;
        const currentColumnIndex = this._columnIndex;
        if (this._previous && this._previous.row === targetIndex) {
          const tmp = this._previous.column;
          this._previous.column = this._columnIndex;
          this._columnIndex = tmp;
          this._rowIndex = this._previous.row;
        } else {
          const targetRow = this.rows[targetIndex];
          const currentKey = this.currentKeyWrapper;
          const currentRow = this.rows[this._rowIndex];
          let t = this._findKeyInRow(currentKey, currentRow, targetRow);
          if (t > -1) {
            this._rowIndex = targetIndex;
            this._columnIndex = t;
          } // if no next row found and wraparound is on, loop back to first row
          else if (this.navigationWrapAround) {
            t = this._findKeyInRow(currentKey, currentRow, this.rows[0]);
            this._columnIndex = t > -1 ? t : Math.min(this.rows[0].children.length - 1, this._columnIndex);
            return this._rowIndex = 0;
          }
        }
        if (this._rowIndex !== currentRowIndex) {
          this._previous = {
            column: currentColumnIndex,
            row: currentRowIndex
          };
          return this._rowIndex = targetIndex;
        }
      } else if (direction === 'column' && this.navigationWrapAround) {
        this._previous = {
          column: this._columnIndex,
          row: this._rowIndex
        };
        let nrRows = this.rows.length;
        this._rowIndex = (targetIndex % nrRows + nrRows) % nrRows;
        this._columnIndex = Math.min(this.rows[this._rowIndex].children.length - 1, this._columnIndex);
      }
      return false;
    }
    onSpace(_ref2) {
      let {
        index
      } = _ref2;
      this.addAt(' ', index);
    }
    onBackspace(_ref3) {
      let {
        index
      } = _ref3;
      this.removeAt(index);
    }
    onClear() {
      this.clear();
    }
    onLayout(_ref4) {
      let {
        key
      } = _ref4;
      this.layout(key);
    }
    set config(obj) {
      this._config = obj;
      if (this.active) {
        this._update();
      }
    }
    get config() {
      return this._config;
    }
    set currentInputField(component) {
      this.inputField(component);
    }
    get currentInputField() {
      return this._inputField;
    }
    set currentLayout(str) {
      this.layout(str);
    }
    get currentLayout() {
      return this._layout;
    }
    set maxCharacters(num) {
      this._maxCharacters = num;
    }
    get maxCharacters() {
      return this._maxCharacters;
    }
    set snapToRow(bool) {
      this._snapToRow = bool;
    }
    get snapToRow() {
      return true;
    }
    get rows() {
      return this._keys && this._keys.children;
    }
    get currentKeyWrapper() {
      return this.rows && this.rows[this._rowIndex] && this.rows[this._rowIndex].children[this._columnIndex];
    }
    get currentKey() {
      return this.currentKeyWrapper && this.currentKeyWrapper.key;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class List extends CollectionWrapper {
    plotItems() {
      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      const {
        immediate = false
      } = options;
      const items = this._items;
      const wrapper = this.wrapper;
      const {
        directionIsRow,
        main,
        mainDim,
        mainMarginTo,
        mainMarginFrom,
        cross,
        crossDim
      } = this._getPlotProperties(this._direction);
      let crossPos = 0,
        crossSize = 0,
        position = 0;
      const animateItems = [];
      const viewboundMain = directionIsRow ? 1920 : 1080;
      const viewboundCross = directionIsRow ? 1080 : 1920;
      const renderContext = this.core.renderContext;
      const newChildren = items.map((item, index) => {
        const sizes = this._getItemSizes(item);
        position += sizes[mainMarginFrom] || sizes.margin || 0;
        if (crossSize < sizes[crossDim]) {
          crossSize = sizes[crossDim];
        }
        const ref = "IW-".concat(item.assignedID);
        let mainPos = position;
        crossPos = item[cross] || crossPos;
        let tmp = mainPos;
        let tcp = crossPos;
        const existingItemWrapper = wrapper.tag(ref);
        if (existingItemWrapper && (existingItemWrapper.active && (crossPos !== existingItemWrapper[cross] || mainPos !== existingItemWrapper[main]) || !existingItemWrapper.active && (renderContext["p".concat(main)] + wrapper[main] + mainPos <= viewboundMain || renderContext["p".concat(cross)] + wrapper[cross] + crossPos <= viewboundCross))) {
          tmp = existingItemWrapper[main];
          tcp = existingItemWrapper[cross];
          animateItems.push(index);
        }
        position += sizes[mainDim] + (sizes[mainMarginTo] || sizes.margin || this._spacing);
        return {
          ref,
          type: ItemWrapper,
          componentIndex: index,
          forceLoad: this._forceLoad,
          ...sizes,
          ["assigned".concat(main.toUpperCase())]: mainPos,
          ["assigned".concat(cross.toUpperCase())]: crossPos,
          [main]: tmp,
          [cross]: tcp
        };
      });
      wrapper.children = newChildren;
      animateItems.forEach(index => {
        const item = wrapper.children[index];
        if (immediate) {
          item.patch({
            x: item.assignedX,
            y: item.assignedY
          });
        } else {
          item.patch({
            smooth: {
              x: item.assignedX,
              y: item.assignedY
            }
          });
        }
      });
      this._resizeWrapper(crossSize);
    }
    repositionItems() {
      const wrapper = this.wrapper;
      if (!wrapper && wrapper.children.length) {
        return true;
      }
      const {
        main,
        mainDim,
        mainMarginTo,
        mainMarginFrom,
        cross,
        crossDim
      } = this._getPlotProperties(this._direction);
      let crossPos = 0,
        crossSize = 0,
        position = 0;
      wrapper.children.forEach(item => {
        const sizes = this._getItemSizes(item);
        position += sizes[mainMarginFrom] || sizes.margin || 0;
        crossPos = item[cross] || crossPos;
        if (crossSize < sizes[crossDim]) {
          crossSize = sizes[crossDim];
        }
        const mainPos = position;
        position += sizes[mainDim] + (sizes[mainMarginTo] || sizes.margin || this.spacing);
        item.patch({
          ["assigned".concat(main.toUpperCase())]: mainPos,
          ["assigned".concat(cross.toUpperCase())]: 0,
          [main]: mainPos,
          [cross]: crossPos,
          ...sizes
        });
      });
      this._resizeWrapper(crossSize);
      super.repositionItems();
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class ScrollingLabel extends Lightning.Component {
    static _template() {
      return {
        LabelClipper: {
          w: w => w,
          rtt: true,
          shader: {
            type: Lightning.shaders.FadeOut
          },
          LabelWrapper: {
            Label: {
              renderOffscreen: true
            },
            LabelCopy: {
              renderOffscreen: true
            }
          }
        }
      };
    }
    _construct() {
      this._autoStart = true;
      this._scrollAnimation = false;
      this._fade = 30;
      this._spacing = 30;
      this._label = {};
      this._align = 'left';
      this._animationSettings = {
        delay: 0.7,
        repeat: -1,
        stopMethod: 'immediate'
      };
    }
    _init() {
      const label = this.tag('Label');
      label.on('txLoaded', () => {
        this._update(label);
        this._updateAnimation(label);
        if (this._autoStart) {
          this.start();
        }
      });
    }
    _update() {
      let label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.tag('Label');
      const renderWidth = label.renderWidth;
      const noScroll = renderWidth <= this.renderWidth;
      let labelPos = 0;
      if (noScroll && this._align !== 'left') {
        labelPos = (this.renderWidth - renderWidth) * ScrollingLabel.ALIGN[this._align];
      }
      this.tag('LabelClipper').patch({
        h: label.renderHeight,
        shader: {
          right: noScroll ? 0 : this._fade
        },
        LabelWrapper: {
          x: 0,
          Label: {
            x: labelPos
          },
          LabelCopy: {
            x: renderWidth + this._spacing
          }
        }
      });
    }
    _updateAnimation() {
      let label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.tag('Label');
      if (this._scrollAnimation) {
        this._scrollAnimation.stopNow();
      }
      if (label.renderWidth > this.renderWidth) {
        if (!this._animationSettings.duration) {
          this._animationSettings.duration = label.renderWidth / 50;
        }
        this._scrollAnimation = this.animation({
          ...this._animationSettings,
          actions: [{
            t: 'LabelWrapper',
            p: 'x',
            v: {
              sm: 0,
              0: 0,
              1.0: -(label.renderWidth + this._spacing)
            }
          }, {
            t: 'LabelClipper',
            p: 'shader.left',
            v: {
              0: 0,
              0.2: this._fade,
              0.8: this._fade,
              1.0: 0
            }
          }]
        });
      }
    }
    start() {
      if (this._scrollAnimation) {
        this._scrollAnimation.stopNow();
        this.tag('LabelCopy').patch({
          text: this._label
        });
        this._scrollAnimation.start();
      }
    }
    stop() {
      if (this._scrollAnimation) {
        this._scrollAnimation.stopNow();
        this.tag('LabelCopy').text = '';
      }
    }
    set label(obj) {
      if (typeof obj === 'string') {
        obj = {
          text: obj
        };
      }
      this._label = {
        ...this._label,
        ...obj
      };
      this.tag('Label').patch({
        text: obj
      });
    }
    get label() {
      return this.tag('Label');
    }
    set align(pos) {
      this._align = pos;
    }
    get align() {
      return this._align;
    }
    set autoStart(bool) {
      this._autoStart = bool;
    }
    get autoStart() {
      return this._autoStart;
    }
    set repeat(num) {
      this.animationSettings = {
        repeat: num
      };
    }
    get repeat() {
      return this._animationSettings.repeat;
    }
    set delay(num) {
      this.animationSettings = {
        delay: num
      };
    }
    get delay() {
      return this._animationSettings.delay;
    }
    set duration(num) {
      this.animationSettings = {
        duration: num
      };
    }
    get duration() {
      return this._animationSettings.duration;
    }
    set animationSettings(obj) {
      this._animationSettings = {
        ...this._animationSettings,
        ...obj
      };
      if (this._scrollAnimation) {
        this._updateAnimation();
      }
    }
    get animationSettings() {
      return this._animationSettings;
    }
  }
  ScrollingLabel.ALIGN = {
    left: 0,
    center: 0.5,
    right: 1
  };

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  const calcCarouselNavigation = (dir, current, min, max) => {
    let target = current + dir;
    if (target < min) {
      target = max;
    }
    if (target > max) {
      target = min;
    }
    return target;
  };
  class Stepper extends Lightning.Component {
    static _template() {
      return {
        h: 80,
        w: 574,
        Focus: {
          alpha: 0,
          w: w => w,
          h: h => h,
          rect: true
        },
        Label: {
          x: 30,
          y: h => h * 0.5,
          mountY: 0.5,
          text: {
            text: '',
            fontSize: 22
          }
        },
        ValueWrapper: {
          x: w => w - 30,
          w: 200,
          h: h => h,
          mountX: 1,
          Value: {
            x: w => w * 0.5,
            y: h => h * 0.5,
            mountX: 0.5,
            mountY: 0.5,
            text: {
              text: '',
              fontSize: 22
            }
          }
        }
      };
    }
    _construct() {
      this._focusColor = 0xff009245;
      this._labelColor = 0xff9d9d9d;
      this._labelColorFocused = 0xffffffff;
      this._padding = 30;
      this._max = 100;
      this._min = 0;
      this._value = 50;
      this._options = undefined;
      this._label = 'label';
      this._focusAnimation = null;
      defineProperties(this, ['focusColor', 'labelColor', 'labelColorFocused', 'padding', 'max', 'min', 'focusAnimation']);
    }
    _update() {
      this.patch({
        Focus: {
          color: this._focusColor
        },
        Label: {
          x: this._padding,
          color: this._labelColor,
          text: {
            text: this._label
          }
        },
        ValueWrapper: {
          x: w => w - this._padding,
          Value: {
            color: this._labelColor,
            text: {
              text: this.optionValue || this.value
            }
          }
        }
      });
      if (this.hasFocus()) {
        this._focus();
      }
    }
    _createFocusAnimation() {
      this._focusAnimation = this.animation({
        duration: 0.2,
        stopMethod: 'reverse',
        actions: [{
          t: 'Focus',
          p: 'alpha',
          v: {
            0: 0,
            1: 1
          }
        }, {
          t: 'Label',
          p: 'color',
          v: {
            0: this._labelColor,
            1: this._labelColorFocused
          }
        }, {
          t: 'ValueWrapper.Value',
          p: 'color',
          v: {
            0: this._labelColor,
            1: this._labelColorFocused
          }
        }]
      });
    }
    _firstActive() {
      if (!this._focusAnimation) {
        this._createFocusAnimation();
      }
      this._update();
    }
    _navigate(dir) {
      this.value = calcCarouselNavigation(dir, this._value, this._min, this._max);
      const event = {
        value: this._value
      };
      if (this._options) {
        event.options = this._options;
      }
      this.fireAncestors('$onValueChanged', event);
      this.signal('onValueChanged', event);
    }
    _handleLeft() {
      this._navigate(-1);
    }
    _handleRight() {
      this._navigate(1);
    }
    _focus() {
      if (this._focusAnimation) {
        this._focusAnimation.start();
      }
    }
    _unfocus() {
      if (this._focusAnimation) {
        this._focusAnimation.stop();
      }
    }
    set label(str) {
      this._label = str;
      if (this.active) {
        this.tag('Label').text.text = str;
      }
    }
    get label() {
      return this._label;
    }
    set value(str) {
      this._value = str;
      if (this.active) {
        this.tag('Value').text.text = this.optionValue || this._value;
      }
    }
    get value() {
      return this._value;
    }
    get optionValue() {
      return this._options && this._options[this._value] && this._options[this._value].label || undefined;
    }
    set options(arr) {
      const refactor = arr.map(option => {
        if (typeof option === 'string') {
          return {
            label: option
          };
        }
        return option;
      });
      this._value = 0;
      this._options = refactor;
      this._max = refactor.length - 1;
      this._update();
    }
    get options() {
      return this._options;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class ArrowStepper extends Stepper {
    static _template() {
      return {
        ...super._template(),
        ValueWrapper: {
          x: w => w - 30,
          w: 200,
          h: h => h,
          mountX: 1,
          ArrowLeft: {
            y: h => h * 0.5,
            mountY: 0.5
          },
          Value: {
            x: w => w * 0.5,
            y: h => h * 0.5,
            mountX: 0.5,
            mountY: 0.5,
            text: {
              text: '',
              fontSize: 22
            }
          },
          ArrowRight: {
            y: h => h * 0.5,
            x: w => w,
            mountY: 0.5,
            mountX: 1
          }
        }
      };
    }
    _update() {
      this.patch({
        Focus: {
          color: this._focusColor
        },
        Label: {
          x: this._padding,
          color: this._labelColor,
          text: {
            text: this._label
          }
        },
        ValueWrapper: {
          x: w => w - this._padding,
          ArrowLeft: {
            color: this._labelColor
          },
          Value: {
            color: this._labelColor,
            text: {
              text: this.optionValue || this.value
            }
          },
          ArrowRight: {
            color: this._labelColor
          }
        }
      });
      if (this.hasFocus()) {
        this._focus();
      }
    }
    _createFocusAnimation() {
      this._focusAnimation = this.animation({
        duration: 0.2,
        stopMethod: 'reverse',
        actions: [{
          t: 'Focus',
          p: 'alpha',
          v: {
            0: 0,
            1: 1
          }
        }, {
          t: 'ValueWrapper.ArrowLeft',
          p: 'color',
          v: {
            0: this._labelColor,
            1: this._labelColorFocused
          }
        }, {
          t: 'ValueWrapper.Value',
          p: 'color',
          v: {
            0: this._labelColor,
            1: this._labelColorFocused
          }
        }, {
          t: 'ValueWrapper.ArrowRight',
          p: 'color',
          v: {
            0: this._labelColor,
            1: this._labelColorFocused
          }
        }]
      });
    }
    _firstActive() {
      if (!this._focusAnimation) {
        this._createFocusAnimation();
      }
      const arrowLeft = this.tag('ArrowLeft');
      const arrowRight = this.tag('ArrowRight');
      if (!(arrowLeft.src !== undefined && arrowLeft.text !== null)) {
        arrowLeft.text = {
          text: '\u25c0',
          fontSize: 18
        };
      }
      if (!(arrowRight.src !== undefined && arrowRight.text !== null)) {
        arrowRight.text = {
          text: '\u25b6',
          fontSize: 18
        };
      }
      this._update();
    }
  }

  class ColorShift extends Lightning.Component {
    static _template() {
      return {
        w: 574,
        h: 240,
        List: {
          type: List,
          w: w => w,
          h: h => h,
          forceLoad: true,
          spacing: 0,
          direction: 'column'
        }
      };
    }
    _construct() {
      this._autoColorShift = true;
      this._focusColor = 0xff009245;
      this._labelColor = 0xff9d9d9d;
      this._labelColorFocused = 0xffffffff;
      this._options = [{
        type: 'neutral',
        label: 'normal'
      }, {
        type: 'protanopia',
        label: 'Protanopia'
      }, {
        type: 'deuteranopia',
        label: 'Deuteranopia'
      }, {
        type: 'tritanopia',
        label: 'Tritanopia'
      }, {
        type: 'monochromacy',
        label: 'Achromatopsia'
      }];
      defineProperties(this, ['focusColor', 'labelColor', 'labelColorFocused', 'options', 'autoColorShift']);
    }
    _getFocused() {
      return this.tag('List');
    }
    _shiftColors() {
      if (this._autoColorShift && this.application && this.application.colorshift) {
        this.application.colorshift(this._settings.correction, this._settings);
      }
    }
    $onValueChanged() {
      const listItems = this.tag('List').items;
      const correction = listItems[0];
      this._settings = {
        correction: correction.options[correction.value].type,
        brightness: listItems[1].value,
        contrast: listItems[2].value,
        gamma: listItems[3].value
      };
      if (this._currentCorrection && this._settings.correction !== this._currentCorrection) {
        const steppers = listItems.slice(1);
        steppers.forEach(stepper => {
          stepper.value = 50;
        });
      }
      this._currentCorrection = this._settings.correction;
      this._shiftColors();
      this.signal('onColorShift', this._settings);
    }
    _update() {
      const list = this.tag('List');
      const steppers = ['Brightness', 'Contrast', 'Gamma'];
      const options = this._options;
      const settings = this._settings;
      const colors = {
        focusColor: this._focusColor,
        labelColor: this._labelColor,
        labelColorFocused: this._labelColorFocused
      };
      this._shiftColors();
      const settingItems = steppers.map(stepper => {
        const lowerC = stepper.toLocaleLowerCase();
        return {
          type: this["".concat(lowerC, "Component")],
          label: stepper,
          value: settings[lowerC],
          w: this.finalW,
          h: 80,
          ...colors
        };
      });
      settingItems.unshift({
        type: this.correctionComponent,
        options,
        value: findIndexOfObject(options, settings.correction, 'type'),
        label: 'Color adjustment',
        w: this.finalW,
        h: 80,
        ...colors
      });
      list.clear();
      list.add(settingItems);
    }
    _firstActive() {
      if (!this._settings) {
        this._settings = {
          correction: 'neutral',
          brightness: 50,
          contrast: 50,
          gamma: 50
        };
      }
      this._update();
    }
    set settings(obj) {
      this._settings = obj;
      if (this.active) {
        const listItems = this.tag('List').items;
        listItems[0] = findIndexOfObject(this._options, obj.correction, 'type');
        listItems[1] = obj.brightness || 50;
        listItems[2] = obj.contrast || 50;
        listItems[3] = obj.gamma || 50;
      }
    }
    get settings() {
      return this._settings;
    }
    get correctionTag() {
      return this.tag('List').items[0];
    }
    get brightnessTag() {
      return this.tag('List').items[1];
    }
    get contrastTag() {
      return this.tag('List').items[2];
    }
    get gammaTag() {
      return this.tag('List').items[3];
    }
    get adjustmentTags() {
      return this.tag('List').items;
    }
    set stepperComponent(component) {
      this._stepperComponent = component;
    }
    get stepperComponent() {
      return this._stepperComponent || ArrowStepper;
    }
    set correctionComponent(component) {
      this._correctionComponent = component;
    }
    get correctionComponent() {
      return this._correctionComponent || this.stepperComponent;
    }
    set brightnessComponent(component) {
      this._brightnessComponent = component;
    }
    get brightnessComponent() {
      return this._brightnessComponent || this.stepperComponent;
    }
    set contrastComponent(component) {
      this._contrastComponent = component;
    }
    get contrastComponent() {
      return this._contrastComponent || this.stepperComponent;
    }
    set gammaComponent(component) {
      this._gammaComponent = component;
    }
    get gammaComponent() {
      return this._gammaComponent || this.stepperComponent;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class CarouselItem extends Lightning.Component {
    static _template() {
      return {
        Focus: {
          alpha: 0,
          x: w => w * 0.5,
          y: h => h * 0.5,
          mount: 0.5,
          w: 120,
          h: 50,
          rect: true,
          shader: {
            type: Lightning.shaders.RoundedRectangle,
            radius: 25
          }
        },
        Label: {
          x: w => w * 0.5,
          y: h => h * 0.5,
          mount: 0.5,
          renderOffscreen: true,
          text: {
            text: '',
            fontSize: 22
          }
        }
      };
    }
    _construct() {
      this._focusColor = 0xff009245;
      this._labelColor = 0xff9d9d9d;
      this._labelColorFocused = 0xffffffff;
      this._padding = 40;
      defineProperties(this, ['focusColor', 'labelColor', 'labelColorFocused', 'padding']);
    }
    set label(str) {
      this.tag('Label').text.text = str;
      this._label = str;
    }
    get label() {
      return this._label;
    }
    _init() {
      const label = this.tag('Label');
      label.on('txLoaded', () => {
        this.patch({
          w: label.renderWidth,
          Focus: {
            w: label.renderWidth + this._padding * 2
          }
        });
        if (this.collectionWrapper) {
          this.collectionWrapper.reposition();
        }
      });
    }
    _focus() {
      this.patch({
        Focus: {
          smooth: {
            alpha: 1
          }
        },
        Label: {
          smooth: {
            color: this._labelColorFocused
          }
        }
      });
    }
    _unfocus(target) {
      if (target.isCarouselItem === true) {
        this.patch({
          Focus: {
            smooth: {
              alpha: 0
            }
          },
          Label: {
            smooth: {
              color: this._labelColor
            }
          }
        });
      }
    }
    _firstActive() {
      this.patch({
        Focus: {
          color: this._focusColor
        },
        Label: {
          color: this._labelColor
        }
      });
      if (this.cparent.componentIndex === this.collectionWrapper.currentItemWrapper.componentIndex) {
        this._focus();
      }
    }
    get isCarouselItem() {
      return true;
    }
    static get width() {
      return 120;
    }
    static get height() {
      return 50;
    }
  }

  /*
   * If not stated otherwise in this file or this component's LICENSE file the
   * following copyright and licenses apply:
   *
   * Copyright 2021 Metrological
   *
   * Licensed under the Apache License, Version 2.0 (the License);
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
  class ProgressBar$1 extends Lightning.Component {
    static _template() {
      return {
        w: 300,
        h: 10,
        Background: {
          w: w => w,
          h: h => h,
          rect: true,
          rtt: true,
          shader: {
            type: Lightning.shaders.RoundedRectangle,
            radius: 5
          },
          Progress: {
            h: h => h,
            w: 10,
            rect: true,
            shader: {
              type: Lightning.shaders.RoundedRectangle,
              radius: 0
            }
          }
        }
      };
    }
    _construct() {
      this._progressColor = 0xff009245;
      this._progressColorFocused = undefined;
      this._backgroundColor = 0xff9d9d9d;
      this._backgroundColorFocused = undefined;
      this._backgroundRadius = 5;
      this._progressRadius = 0;
      this.value = 0.5;
      defineProperties(this, ['progressColor', 'backgroundColor', 'progressColorFocused', 'backgroundColorFocused']);
    }
    progress(p) {
      if (p > 1) {
        p = p / 100;
      }
      this._value = p;
      this.tag('Progress').w = this.w * p;
    }
    _createFocusAnimation() {
      this._focusAnimation = this.animation({
        duration: 0.2,
        stopMethod: 'reverse',
        actions: [{
          t: 'Background',
          p: 'color',
          v: {
            0: this._backgroundColor,
            1: this._backgroundColorFocused || this._backgroundColor
          }
        }, {
          t: 'Background.Progress',
          p: 'color',
          v: {
            0: this._progressColor,
            1: this._progressColorFocused || this._progressColor
          }
        }]
      });
    }
    _firstActive() {
      if (!this._focusAnimation) {
        this._createFocusAnimation();
      }
      this.patch({
        Background: {
          color: this._backgroundColor,
          shader: {
            radius: this._backgroundRadius
          },
          Progress: {
            color: this._progressColor,
            shader: {
              radius: this._progressRadius
            }
          }
        }
      });
      this.progress(this._value);
      if (this.hasFocus()) {
        this._focus();
      }
    }
    _focus() {
      if (this._focusAnimation) {
        this._focusAnimation.start();
      }
    }
    _unfocus() {
      if (this._focusAnimation) {
        this._focusAnimation.stop();
      }
    }
    set value(p) {
      this._value = p;
      if (this.active) {
        this.progress(p);
      }
    }
    get value() {
      return this._value;
    }
    set backgroundRadius(num) {
      this._backgroundRadius = num;
      if (this.active) {
        this.tag('Background').shader.radius = num;
      }
    }
    get progressRadius() {
      return this._progressRadius;
    }
    set progressRadius(num) {
      this._progressRadius = num;
      if (this.active) {
        this.tag('Progress').shader.radius = num;
      }
    }
    get progressRadius() {
      return this._progressRadius;
    }
    get backgroundTag() {
      return this.tag('Background');
    }
    get progressTag() {
      return this.tag('Progress');
    }
  }

  class KeyboardText extends Lightning.Component {
    //Page
    static _template() {
      return {
        //...super._template(),
        //zIndex: 4,
        // Messages: {                   
        //     x: 20, y: 150, h: 550, w: 1160, rect: true,
        //     flex: { direction: "column", reverse: true, margin: 10 },
        //     color: Colors("black").lightness(0.3).get(),
        //     shader: { type: Lightning.shaders.Outline, width: 1, color: 0xffffffff, },
        //     //text:{fontFace: "Londrina", fontSize: 25 },
        // },
        Content: {
          InputFieldWrapper: {
            x: 200,
            y: 230,
            rect: true,
            h: 80,
            w: 960,
            InputField: {
              x: 50,
              y: 5,
              type: InputField,
              description: ' Type here...'
            }
          },
          Keyboard: {
            x: 200,
            y: 350,
            type: Keyboard,
            config: keyboardConfig,
            signals: {
              onInputChanged: true
            },
            currentLayout: 'abc',
            maxCharacters: 60
          }
        }
      };
    }
    _setup() {
      const inputField = this.tag('InputField');
      this.tag('Keyboard').inputField(inputField);
    }

    //onInputChanged(inputData) {
    onInputChanged(_ref) {
      let {
        input,
        previousInput
      } = _ref;
      //const { input, previousInput } = inputData;
      console.log('Current input:', input);
      console.log('Previous input:', previousInput);
      // Handle the input change here
      this.signal('onInputChanged', {
        input,
        previousInput
      });
    }
    _active() {
      //super._active();         
      //Text field for entering text background color       
      this.tag('InputFieldWrapper').color = Colors$1('black').lightness(0.3).get();
      // Colors(this.fireAncestors('$getThemeColor')).lightness(0.2).get();
    }
    _getFocused() {
      return this.tag('Keyboard');
    }
  }
  class Key extends Key$1 {
    _firstActive() {
      this.label = {
        mountY: 0.45
      };
      this.labelColors = {
        unfocused: Colors$1('white').get()
      };
      this.backgroundColors = {
        unfocused: Colors$1('white').alpha(0).get(),
        // white color // green
        focused: Colors$1('black').lightness(0.3).get() //blue
        //Colors(this.fireAncestors('$getThemeColor')).darker(0.5).get()
      };
      if (this.hasFocus()) {
        this._focus();
      }
    }
    static get width() {
      return 60;
    }
    static get height() {
      return 60;
    }
  }
  class ActionKey extends Key$1 {
    _active() {
      this.label = {
        mountY: 0.45
      };
      this.labelColors = {
        unfocused: Colors$1('black').get(),
        //black //yellow
        focused: Colors$1('white').get() //white //red
      };
      this.backgroundColors = {
        unfocused: Colors$1('white').get(),
        // white //red
        focused:
        //Colors('blue').get()
        Colors$1(this.fireAncestors('$getThemeColor')).darker(0.5).get()
      };
      if (this.hasFocus()) {
        this._focus();
      }
    }
    static get height() {
      return 60;
    }
    static get width() {
      return 120;
    }
  }
  class IconKey extends ActionKey {
    set icon(src) {
      this._icon = src;
      //call for _update
      this._update();
    }
    get icon() {
      return this._icon;
    }
    _update() {
      if (!this.active) {
        //blocking update if not active.
        return;
      }
      const hasFocus = this.hasFocus();
      let {
        focused,
        unfocused = 0xff000000
      } = this.backgroundColors;
      //Use labelColors and label to color the icon.
      let {
        focused: labelFocused,
        unfocused: labelUnfocused = 0xffffffff
      } = this.labelColors;
      this.patch({
        Background: {
          color: hasFocus && focused ? focused : unfocused
        },
        Label: {
          src: Utils.asset(this.icon),
          color: hasFocus && labelFocused ? labelFocused : labelUnfocused
        }
      });
    }
  }
  const keyboardConfig = {
    layouts: {
      'abc': [['Layout:123', 'Space', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k'],
      //'Enter', need to add after space
      ['l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'Backspace']],
      '123': [['Layout:abc', 'Space', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', 'Backspace'] //'Enter', need to add after space
      ]
    },
    styling: {
      align: 'left',
      horizontalSpacing: 2,
      verticalSpacing: 5,
      Row2: {
        spacing: 5
      }
    },
    buttonTypes: {
      default: {
        type: Key,
        w: 50
      },
      Backspace: {
        type: IconKey,
        w: 40,
        icon: 'images/backspace.png',
        shader: {
          type: Lightning.shaders.RoundedRectangle,
          radius: 10
        }
      },
      Layout: {
        type: ActionKey,
        w: 80,
        shader: {
          type: Lightning.shaders.RoundedRectangle,
          radius: 20
        }
      },
      Space: {
        type: ActionKey,
        w: 150,
        label: 'space',
        shader: {
          type: Lightning.shaders.RoundedRectangle,
          radius: 20
        }
      },
      Clear: {
        type: ActionKey,
        w: 120,
        label: 'clear',
        shader: {
          type: Lightning.shaders.RoundedRectangle,
          radius: 20
        }
      }
      // Enter: {
      //     type: ActionKey, w: 100, label: 'send', shader: { type: Lightning.shaders.RoundedRectangle, radius: 20 }
      // }
    }
  };

  /**
  * Copyright 2023 Comcast Cable Communications Management, LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  * http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *
  * SPDX-License-Identifier: Apache-2.0
  */
  class KeyboardAgent extends KeyboardInput {
    static get __componentName() {
      return 'KeyboardAgent';
    }
    static get properties() {
      return [...super.properties, 'additionalProperty'];
    }
    static _template() {
      return {
        ...super._template(),
        //Content:{ x: 100, y:100,
        ScrollWrapper: {
          type: ScrollWrapper,
          x: 50,
          y: 50,
          h: 300,
          w: 996,
          scrollStep: 2,
          autoResizeWidth: true,
          autoResizeHeight: true,
          autoScroll: false,
          autoScrollDelay: 2000,
          autoScrollSpeed: 10,
          showScrollBar: true,
          content: [{
            text: 'Initiallizing....',
            // 'Lorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit ametLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Id aliquet risus feugiat in ante metus dictum. Pretium fusce id velit ut tortor pretium viverra suspendisse. Pharetra convallis posuere morbi leo urna.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Id aliquet risus feugiat in ante metus dictum. Pretium fusce id velit ut tortor pretium viverra suspendisse. Pharetra convallis posuere morbi leo urna.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Id aliquet risus feugiat in ante metus dictum. Pretium fusce id velit ut tortor pretium viverra suspendisse. Pharetra convallis posuere morbi leo urna.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Id aliquet risus feugiat in ante metus dictum. Pretium fusce id velit ut tortor pretium viverra suspendisse. Pharetra convallis posuere morbi leo urna.',
            style: {
              fontStyle: 'italic',
              textAlign: 'center',
              textColor: 0xffffffff
            }
          }
          // Add more content here as needed
          ],
          signals: {
            scrollChanged: true
          }
        },
        Wrapper: {
          x: 100,
          y: 380,
          //h: 200,
          //w: 996,
          type: Column,
          neverScroll: true,
          w: this.w,
          items: [{
            type: Input,
            ref: 'Input'
          }, {
            type: KeyboardQwerty,
            ref: 'Keyboard',
            //keyboardType: KeyboardQwerty,
            passSignals: {
              keyboardWidthChanged: true
            }
          }]
        }
        //w: utils.getWidthByUpCount(context.theme, 1),
        //}
      };
    }
    static get tags() {
      return [...super.tags, {
        name: 'Wrapper',
        path: 'Wrapper'
      }, {
        name: 'Input',
        path: 'Wrapper.Input'
      }, {
        name: 'Keyboard',
        path: 'Wrapper.Keyboard'
      }];
    }
    _init() {
      super._init();
      this._focusIndex = 1;
      this._focusableElements = [this.tag('ScrollWrapper'), this.tag('Wrapper')];
    }
    _update() {
      super._update();
      this._updateAdditionalComponent();
    }
    _updateAdditionalComponent() {
      const inputTag = this.tag('Input');
      if (inputTag) {
        console.log(inputTag);
        inputTag.patch({
          w: this.w,
          style: {
            ...this.style.additionalComponentStyle
          }
        });
      }
    }
    _updateKeyboardType() {
      if (!this.keyboardType || this._Keyboard.constructor !== this.keyboardType) {
        this._Wrapper._resetItems();
        this._Wrapper.items = [{
          type: Input,
          ref: 'Input'
        }, {
          type: this.keyboardType || KeyboardQwerty,
          ref: 'Keyboard',
          passSignals: {
            keyboardWidthChanged: true
          }
        }];
      }
    }
    $onSoftKey(_ref) {
      let {
        key = '',
        toggle
      } = _ref;
      if (toggle) {
        return;
      }
      console.log("Key pressed: ".concat(key)); // Capture and print the key
      super.$onSoftKey({
        key,
        toggle
      });
      switch (key.toLowerCase()) {
        case 'customkey':
          this._handleCustomKey();
          break;
        case 'done':
          this._handleDoneKey();
          break;
        // Handle other keys if necessary
      }
    }
    _handleCustomKey() {
      // Custom logic for handling the custom key
      console.log('Custom key pressed');
    }
    _handleDoneKey() {
      // Custom logic for handling the done key
      console.log('Done key pressed');
      const inputTag = this.tag('Wrapper').tag('Input');
      if (inputTag) {
        const inputText = inputTag.actualTitle;
        console.log('Input text:', inputText);
        const parent = this.stage.cparent;
        if (parent && parent.handleDoneKeyInOTTAvatar) {
          parent.handleDoneKeyInOTTAvatar(inputText);
        }
        // this.tag('ScrollWrapper').patch({
        //   content: [
        //     {
        //       text: inputText,
        //       style: {
        //         fontStyle: 'italic',
        //         textAlign: 'center',
        //         textColor: 0xffffffff,
        //         fontSize: 16, //fontsizes.searchPageToastMessage,
        //       },
        //     },
        //   ],
        // })
      }
      //  else {
      //   console.error('Input tag not found')
      // }
    }
    $keyboardFocused(focus) {
      super.$keyboardFocused(focus);
      // Additional logic when keyboard is focused/unfocused
    }
    _handleDown() {
      this._focusIndex = (this._focusIndex + 1) % this._focusableElements.length;
      this._refocus();
    }
    _handleUp() {
      this._focusIndex = (this._focusIndex - 1 + this._focusableElements.length) % this._focusableElements.length;
      this._refocus();
    }
    _getFocused() {
      //return this._Wrapper || this
      return this._focusableElements[this._focusIndex];
    }
  }

  class ProgressBar extends Lightning.Component {
    static _template() {
      return {
        zIndex: 2,
        w: App$1.width,
        h: App$1.height,
        TopGradient: {
          rect: true,
          alpha: 1,
          y: 0,
          x: 0,
          w: App$1.width,
          h: 150,
          colorTop: colors.playerTopGradientColorUp,
          colorBottom: colors.playerTopGradientColorDown
        },
        BottomGradient: {
          alpha: 1,
          rect: true,
          x: 0,
          y: 930,
          w: App$1.width,
          h: 150,
          colorBottom: colors.playerBottomGradientColorDown,
          colorTop: colors.playerBottomGradientColorUp
        },
        RoundRectangleFirst: {
          x: 80.6,
          y: 969.8
        },
        RoundRectangleSecond: {
          x: 80.6,
          y: 969.8,
          w: 0
        },
        ProgressBarIndicator: {
          zIndex: 4,
          alpha: 0,
          mountY: 0.5,
          y: 973,
          texture: Lightning.Tools.getRoundRect(15, 15, 7.5),
          color: colors.fontColor
        },
        MiniProgressBarIndicator: {
          alpha: 0,
          zIndex: 3,
          mountY: 0.5,
          y: 973,
          x: 63,
          texture: Lightning.Tools.getRoundRect(15, 15, 7.5),
          color: colors.fontColor
        },
        RunningDuration: {
          x: 1560,
          y: 1007.2,
          text: {
            fontSize: 28,
            textColor: colors.fontColor,
            wordWrapWidth: 1060,
            lineHeight: 30,
            fontFace: 'Bold'
          }
        },
        TotalDuration: {
          x: 1675,
          y: 1007.2,
          text: {
            fontSize: 28,
            textColor: colors.fontColor,
            wordWrapWidth: 1060,
            lineHeight: 30,
            fontFace: 'Bold'
          }
        }
      };
    }
    placeDotToStart() {
      this.patch({
        MiniProgressBarIndicator: {
          x: 63
        }
      });
    }
    _focus() {
      this.tag('ProgressBarIndicator').patch({
        color: colors.focusBorderColor,
        alpha: 1,
        texture: Lightning.Tools.getRoundRect(20, 20, 10)
      });
      this.tag('MiniProgressBarIndicator').alpha = 0;
    }
    _unfocus() {
      this.tag('ProgressBarIndicator').patch({
        smooth: {
          texture: Lightning.Tools.getRoundRect(14, 14, 7),
          alpha: 0,
          color: colors.fontColor
        }
      });
      this.tag('MiniProgressBarIndicator').alpha = 1;
    }
    _handleEnter() {
      if (!Router.getActivePage().widgets.playercontrols.alpha) {
        clearTimeout(this.timer);
        this.patch({
          alpha: 1
        });
        Router.getActivePage().widgets.playercontrols.setSmooth('alpha', 1);
        this.timer = setTimeout(() => {
          this.patch({
            alpha: 0
          });
          Router.getActivePage().widgets.playercontrols.setSmooth('alpha', 0);
        }, 5000);
      }
    }
    _handlePlayPause() {
      Router.getActivePage().$playPause('play');
    }
    _handleForward() {
      Router.getActivePage().$playPause('forward');
    }
    _handleRewind() {
      Router.getActivePage().$playPause('rewind');
    }
    _handlePlay() {
      Router.getActivePage()._handlePlay();
    }
    _handlePause() {
      Router.getActivePage()._handlePause();
    }
    _handleLeft() {
      Router.getActivePage()._handleRewind();
    }
    _handleRight() {
      Router.getActivePage()._handleForward();
    }
    _handleUp() {
      Router.getActivePage().widgets.playercontrols.showOrHideButtons();
    }
    _handleDown() {
      Router.focusWidget('PlayerControls');
    }
    _handleKey() {
      /* TODO document why this method '_handleKey' is empty */
    }
    _handleBack() {
      Router.getActivePage()._handleBack();
    }
    set updatePosition(position) {
      this.patch({
        RoundRectangleFirst: {
          y: position
        },
        RoundRectangleSecond: {
          y: position
        },
        RunningDuration: {
          y: position + 50
        },
        TotalDuration: {
          y: position + 50
        }
      });
    }
    set dimensions(playerInfo) {
      this.playerWidth = playerInfo[0];
      this.playerHeight = playerInfo[1];
      this.tag('RoundRectangleFirst').patch({
        w: playerInfo[0],
        h: playerInfo[1],
        texture: Lightning.Tools.getRoundRect(playerInfo[0], playerInfo[1], 0, 0, true)
      });
      this.tag('RoundRectangleSecond').patch({
        h: playerInfo[1],
        texture: Lightning.Tools.getRoundRect(0, playerInfo[1], 0, 0, colors.focusBorderColor, true, colors.focusBorderColor)
      });
    }
    updateData(durationData) {
      let playedPercentage;
      const currentTimeFormated = this.getTimeFormat(Math.floor(durationData[1]));
      const totalDurationFormated = this.getTimeFormat(Math.floor(durationData[0]));
      this.tag('RoundRectangleFirst').setSmooth('alpha', 0);
      this.tag('RoundRectangleSecond').setSmooth('alpha', 0);
      if (Math.floor(durationData[0]) != 'Infinity') {
        this.tag('RoundRectangleFirst').setSmooth('alpha', 1);
        this.tag('RoundRectangleSecond').setSmooth('alpha', 1);
        this.tag('TotalDuration').patch({
          text: {
            text: ' / ' + totalDurationFormated
          }
        });
        this.tag('RunningDuration').patch({
          text: {
            text: currentTimeFormated
          }
        });
        const percentage = Math.floor(durationData[1]) / Math.floor(durationData[0]) * 100;
        playedPercentage = this.roundNumber(percentage / 100 * this.playerWidth, 2);
        this.tag('RoundRectangleSecond').patch({
          texture: Lightning.Tools.getRoundRect(playedPercentage - 3, this.playerHeight, 0, 0, colors.focusBorderColor, true, colors.focusBorderColor)
        });
        this.tag('ProgressBarIndicator').x = playedPercentage + 65;
        this.tag('MiniProgressBarIndicator').x = playedPercentage + 65;
      }
      this.tag('RunningDuration').alpha = 1;
      this.tag('TotalDuration').alpha = 1;
    }
    getTimeFormat(timeInSeconds) {
      const pad = function (num, size) {
        return ('000' + num).slice(size * -1);
      };
      const time = parseFloat(timeInSeconds).toFixed(3);
      const hours = Math.floor(time / 60 / 60);
      const minutes = Math.floor(time / 60) % 60;
      const seconds = Math.floor(time - minutes * 60);
      return pad(hours, 2) + ':' + pad(minutes, 2) + ':' + pad(seconds, 2);
    }
    roundNumber(num, scale) {
      if (!('' + num).includes('e')) {
        return +(Math.round(num + 'e+' + scale) + 'e-' + scale);
      } else {
        const arr = ('' + num).split('e');
        let sig = '';
        if (+arr[1] + scale > 0) {
          sig = '+';
        }
        const i = +arr[0] + 'e' + sig + (+arr[1] + scale);
        const j = Math.round(i);
        return +(j + 'e-' + scale);
      }
    }
    ClearTimeInterval() {
      this.tag('RunningDuration').patch({
        text: {
          text: ' '
        }
      });
      this.tag('TotalDuration').patch({
        text: {
          text: ' '
        }
      });
    }
    showOrHideProgressBarDot(value) {
      const dotValue = value ? 1 : 0;
      this.tag('MiniProgressBarIndicator').alpha = dotValue;
      this.tag('ProgressBarIndicator').alpha = dotValue;
    }
  }

  class SearchResults extends Lightning.Component {
    static _template() {
      return {
        w: App$1.width,
        h: 400,
        x: 550,
        y: 160,
        Header: {
          x: 355,
          y: 40,
          text: {
            fontFace: 'Regular',
            fontSize: 26,
            textColor: colors.fontColor,
            maxLines: 1
          }
        },
        SecondHeader: {
          x: 255,
          y: 70,
          text: {
            fontFace: 'Regular',
            fontSize: 26,
            textColor: colors.focusBorderColor,
            maxLines: 1
          }
        },
        visible: true,
        Grid: {
          alpha: 1,
          x: 340,
          y: 90,
          w: 1120,
          h: App$1.height - 210,
          clipping: true,
          direction: 'column',
          columns: 4,
          crossSpacing: 30,
          mainSpacing: 25,
          itemType: Item,
          type: Grid,
          requestThreshold: 3,
          signals: {
            onRequestItems: true
          }
        }
      };
    }
    _active() {
      this.tag('Grid').setSmooth('alpha', 1);
      this.index = 0;
    }
    _init() {
      this.tag('Grid').clear();
      this.index = 0;
      this.total_count = null;
    }
    set data(searchResults) {
      var _searchResults$res$;
      Router.getActivePage().widgets.loader.alpha = 0;
      this.values = searchResults;
      const index = 0;
      this.searchContentslength = (_searchResults$res$ = searchResults.res[0]) === null || _searchResults$res$ === void 0 ? void 0 : _searchResults$res$.total;
      this.totalvideos = searchResults.res[0].list;
      const children = this.totalvideos.map(item => {
        item.x = 1;
        item.y = 1;
        item.w = 320;
        item.h = 180;
        item.orientation = 1;
        return {
          type: Item,
          item
        };
      });
      this.tag('Grid').clear();
      this.tag('Grid').add(children);
      const stateStorage = Storage.get('stateInfo');
      if (stateStorage) {
        this.stateInfo = JSON.parse(stateStorage);
        this._index = this.stateInfo.card ? this.stateInfo.card : 0;
        this.tag('Grid').setIndex(this._index);
      } else {
        this.tag('Grid').setIndex(index);
      }
      this.tag('Header').patch({
        text: {
          text: Language.translate("search_results_part_1") + " " + this.searchContentslength + " " + Language.translate("search_results_part_2") + " " + " " + "\"" + searchResults.key + "\""
        }
      });
      this.tag('Grid').scroll = {
        after: 1
      };
    }
    async onRequestItems() {
      this.tag('Grid').requestThreshold = 3;
      this.tag('Grid').items.length;
      await searchVideo(Storage.get('prevsearchkey')).then(response => {
        const searchResultsArray = response.data.contents[0];
        const children = searchResultsArray.list.map(item => {
          this.totalvideos.push(item);
          item.x = 1;
          item.y = 1;
          item.w = 320;
          item.h = 180;
          item.orientation = 1;
          return {
            type: Item,
            item
          };
        });
        this.tag('Grid').addAt(children, this.tag('Grid').items.length);
        return response.items;
      });
      this._refocus();
    }
    _getFocused() {
      return this.tag('Grid');
    }
    _handleEnter() {
      if (this.backSelected) {
        this.backSelected = false;
        this.fireAncestors('$backToHome', {
          exit: false
        });
      } else {
        this.selectedIndex = this.tag('Grid').index;
        this.currentItem = this.totalvideos[this.selectedIndex].item;
        Router.navigate("details/".concat(this.currentItem.content_id));
        Router.getActivePage().widgets.loader.alpha = 1;
      }
    }
    _handleLeft() {
      Storage.remove('stateInfo');
      Router.getActivePage().$focusKeyboard();
    }
    _handleRight() {
      this.tag('Grid').next();
    }
    _handleDown() {
      this.tag('Grid').next();
    }
    _handleBack() {
      Storage.remove('stateInfo');
      Router.back();
    }
  }

  class DetailsBtns extends Lightning.Component {
    static _template() {
      return {
        ScrollWrapper: {
          y: 680,
          h: 380,
          w: App$1.width,
          clipping: true,
          VerticalButtonList: {
            y: 1,
            x: 175,
            flex: {
              direction: 'column'
            }
          }
        }
      };
    }
    set data(_ref) {
      let {
        buttonData
      } = _ref;
      this._isSidePanelActive = true;
      this._index = 0;
      this.buttonsData = buttonData;
      this.tag('VerticalButtonList').children = this.buttonsData.map(button => {
        return {
          type: IconDynamicButton,
          h: 46,
          textPadding: 30,
          label: button.label,
          iconImage: Utils.asset("images/".concat(button.iconImage)),
          iconWithText: true,
          flexItem: {
            marginTop: 24,
            alignSelf: 'stretch',
            maxHeight: 100
          },
          isVerticalBtn: true
        };
      });
      this._refocus();
    }
    _inactive() {
      this.tag('VerticalButtonList').children = [];
    }
    _getFocused() {
      return this.tag('VerticalButtonList').children[this._index];
    }
    _handleUp() {
      Router.focusWidget('ButtonsList');
    }
    _handleDown() {
      return;
    }
    _handleRight() {
      return;
    }
    _handleLeft() {
      return;
    }
    _handleEnter() {
      Router.getActivePage()._handleBack();
    }
    _handleBack() {
      this._handleEnter();
    }
    _handleKey() {
      return;
    }
  }

  class ScrollList extends Lightning.Component {
    static _template() {
      return {
        zIndex: 2,
        x: 220,
        y: 260,
        w: App$1.width - 100 - App$1.sideMargin * 2,
        h: App$1.height - 210 - 50,
        ScrollContainer: {
          x: 0,
          y: 0,
          Lines: {
            flex: {
              direction: 'column'
            },
            flexItem: {
              maxWidth: App$1.width - 200 - App$1.sideMargin * 2,
              grow: 1,
              shrink: 1
            }
          },
          h: App$1.height - 240 - 50,
          w: App$1.width - 100 - App$1.sideMargin * 2,
          clipping: true
        }
      };
    }
    set items(staticPageData) {
      this.offsetYposition = 0;
      this.lines = staticPageData;
      this._index = 0;
      let newlines = [];
      for (let index = 0; index < this.lines.length; index++) {
        const nextIndex = index + 1;
        if (this.lines[index] == "" && this.lines[nextIndex]) {
          newlines.push("\r");
        } else if (this.lines[index]) {
          newlines.push(this.lines[index]);
        }
      }
      this.lines = newlines;
      const children = this.lines.map(item => {
        let item1 = item;
        if (item.length > 0) {
          item1 = this.rtrim(item1);
          item1 = this.ltrim(item1);
        }
        if (item1.length > 0) {
          item = item1;
        }
        return {
          text: {
            text: item,
            textColor: colors.fontColor,
            wordWrapWidth: 1650,
            fontSize: 25,
            lineHeight: 28,
            fontFace: 'Regular'
          }
        };
      });
      this.tag('Lines').patch({
        children: children,
        y: this.offsetYposition
      });
      this.tag('Lines').loadTexture();
    }
    rtrim(str) {
      if (!str) return str;
      return str.replace(/\s+$/g, '');
    }
    ltrim(str) {
      if (!str) return str;
      return str.replace(/^\s+/, '');
    }
    _handleUp() {
      if (this.lines.length > this._index && this._index > 0) {
        this._index--;
        this.offsetYposition = this.offsetYposition + this.tag('Lines').children[this._index].finalH;
        this.tag('Lines').children[this._index].alpha = 1;
      } else if (this._index === 0) {
        this.tag('Lines').children[this._index].alpha = 1;
        this.offsetYposition = 0;
        Router.focusWidget('ProfileButtons');
      }
      this.tag('Lines').patch({
        y: this.offsetYposition
      });
    }
    _handleDown() {
      if (this.lines.length - 1 > this._index && -(this.tag('Lines').finalY - 800) <= this.tag('Lines').finalH) {
        this.offsetYposition = this.offsetYposition - this.tag('Lines').children[this._index].finalH;
        this.tag('Lines').patch({
          y: this.offsetYposition
        });
        this.tag('Lines').children[this._index].alpha = 0;
        this._index++;
      }
    }
    _handleLeft() {
      Router.focusWidget('Menu');
    }
    _handleBack() {
      Router.back();
    }
    _handleKey() {
      return;
    }
  }

  class StaticData extends Lightning.Component {
    static _template() {
      return {
        alpha: 0,
        zIndex: 3,
        w: App$1.width,
        h: App$1.height,
        Background: {
          alpha: 1,
          w: 1920,
          h: 1080,
          color: colors.background
        },
        Heading: {
          y: 271,
          x: 176 + App$1.sideMargin,
          w: App$1.width - 200,
          alpha: 0,
          text: {
            textColor: colors.fontColor,
            fontSize: 30,
            lineHeight: 35,
            fontFace: 'Bold',
            paddingBottom: 50
          }
        }
      };
    }
    set data(data) {
      this._data = data;
      Router.getActivePage().widgets.loader.alpha = 0;
      this.tag('Heading').patch({
        text: {
          text: this._data.data.heading
        }
      });
      Router.getActivePage().widgets.scrolllist.items = this._data.data.page_array;
      this.patch({
        alpha: 1
      });
    }
    onHandleDown() {
      if (this._data.data.page_array.length > 13) Router.focusWidget('ScrollList');
    }
    _handleBack() {
      Router.back();
    }
    _getFocused() {
      Router.focusWidget('ProfileButtons');
    }
  }

  class ViewMoreGrid extends Lightning.Component {
    static _template() {
      return {
        visible: true,
        ViewMore: {
          zIndex: 4,
          x: 135 + App$1.sideMargin,
          y: 580,
          Title: {
            color: colors.fontColor,
            text: {
              fontSize: 50,
              fontFace: 'Bold'
            }
          },
          Grid: {
            alpha: 1,
            y: 80,
            w: 1730,
            h: 420,
            clipping: true,
            direction: 'column',
            columns: 7,
            crossSpacing: 30,
            mainSpacing: 35,
            itemType: Item,
            type: Grid
          }
        }
      };
    }
    _active() {
      this.tag('Grid').setSmooth('alpha', 1);
      this._refocus();
    }
    _init() {
      this.tag('Grid').clear();
      this._refocus();
    }
    set data(viewMoreData) {
      Router.getActivePage().widgets.loader.alpha = 0;
      this.totalvideos = [];
      this.keyword = viewMoreData.key;
      const index = Storage.get(gridStateInfo) || 0;
      this.totalCount = viewMoreData.total_count;
      this.totalvideos.push(...viewMoreData.list);
      const children = this.totalvideos.map(item => {
        item.orientation = 2;
        return {
          type: Item,
          item
        };
      });
      this.tag('Title').text.text = viewMoreData.title;
      this.tag('Grid').clear();
      this.tag('Grid').add(children);
      this.tag('Grid').setIndex(index);
      Router.getActivePage().widgets.loader.alpha = 0;
      this.tag('Grid').scroll = {
        after: 1
      };
    }
    _getFocused() {
      Router.getActivePage().widgets.banneritem.item = this.totalvideos[this.tag('Grid').index];
      return this.tag('Grid');
    }
    _handleDown() {
      var _this$tag$_lines;
      if ((_this$tag$_lines = this.tag('Grid')._lines) !== null && _this$tag$_lines !== void 0 && _this$tag$_lines[this.tag('Grid')._lines.length - 1].includes(this.tag('Grid')._index)) return;
      this.tag('Grid').last();
    }
    _handleEnter() {
      this.selectedIndex = this.tag('Grid').index;
      Storage.set(gridStateInfo, this.selectedIndex);
      this.currentItem = this.totalvideos[this.selectedIndex];
      Router.navigate("details/".concat(this.currentItem.content_id));
      Router.getActivePage().widgets.loader.alpha = 1;
    }
    _handleLeft() {
      Router.focusWidget('Menu');
    }
    _handleBack() {
      if (Router.getActivePage().widgets.loader.alpha == 0) {
        Storage.remove(gridStateInfo);
        Router.getActivePage().widgets.loader.alpha = 1;
        Router.back();
      }
    }
    _handleKey() {
      return;
    }
    _handleUp() {
      return;
    }
    _handleRight() {
      this.tag('Grid').next();
    }
  }

  var t="undefined"!=typeof self?self:{};function e(){throw Error("Invalid UTF8")}function n(t,e){return e=String.fromCharCode.apply(null,e),null==t?e:t+e}let r,i;const o="undefined"!=typeof TextDecoder;let s$1;const a$1="undefined"!=typeof TextEncoder;function u(t){if(a$1)t=(s$1||=new TextEncoder).encode(t);else {let n=0;const r=new Uint8Array(3*t.length);for(let i=0;i<t.length;i++){var e=t.charCodeAt(i);if(e<128)r[n++]=e;else {if(e<2048)r[n++]=e>>6|192;else {if(e>=55296&&e<=57343){if(e<=56319&&i<t.length){const o=t.charCodeAt(++i);if(o>=56320&&o<=57343){e=1024*(e-55296)+o-56320+65536,r[n++]=e>>18|240,r[n++]=e>>12&63|128,r[n++]=e>>6&63|128,r[n++]=63&e|128;continue}i--;}e=65533;}r[n++]=e>>12|224,r[n++]=e>>6&63|128;}r[n++]=63&e|128;}}t=n===r.length?r:r.subarray(0,n);}return t}var c,l;t:{for(var h=["CLOSURE_FLAGS"],f=t,d=0;d<h.length;d++)if(null==(f=f[h[d]])){l=null;break t}l=f;}var g,p=l&&l[610401301];c=null!=p&&p;const m=t.navigator;function y(t){return !!c&&(!!g&&g.brands.some((({brand:e})=>e&&-1!=e.indexOf(t))))}function b(e){var n;return (n=t.navigator)&&(n=n.userAgent)||(n=""),-1!=n.indexOf(e)}function v(){return !!c&&(!!g&&g.brands.length>0)}function w(){return v()?y("Chromium"):(b("Chrome")||b("CriOS"))&&!(!v()&&b("Edge"))||b("Silk")}g=m&&m.userAgentData||null;var _=!v()&&(b("Trident")||b("MSIE"));!b("Android")||w(),w(),b("Safari")&&(w()||!v()&&b("Coast")||!v()&&b("Opera")||!v()&&b("Edge")||(v()?y("Microsoft Edge"):b("Edg/"))||v()&&y("Opera"));var S={},A=null;function E(t){const e=t.length;let n=3*e/4;n%3?n=Math.floor(n):-1!="=.".indexOf(t[e-1])&&(n=-1!="=.".indexOf(t[e-2])?n-2:n-1);const r=new Uint8Array(n);let i=0;return function(t,e){function n(e){for(;r<t.length;){const e=t.charAt(r++),n=A[e];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(e))throw Error("Unknown base64 encoding at char: "+e)}return e}I();let r=0;for(;;){const t=n(-1),r=n(0),i=n(64),o=n(64);if(64===o&&-1===t)break;e(t<<2|r>>4),64!=i&&(e(r<<4&240|i>>2),64!=o&&e(i<<6&192|o));}}(t,(function(t){r[i++]=t;})),i!==n?r.subarray(0,i):r}function I(){if(!A){A={};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=t.concat(e[n].split(""));S[n]=r;for(let t=0;t<r.length;t++){const e=r[t];void 0===A[e]&&(A[e]=t);}}}}var T="undefined"!=typeof Uint8Array,x=!_&&"function"==typeof btoa;function P(t){if(!x){var e;void 0===e&&(e=0),I(),e=S[e];var n=Array(Math.floor(t.length/3)),r=e[64]||"";let u=0,c=0;for(;u<t.length-2;u+=3){var i=t[u],o=t[u+1],s=t[u+2],a=e[i>>2];i=e[(3&i)<<4|o>>4],o=e[(15&o)<<2|s>>6],s=e[63&s],n[c++]=a+i+o+s;}switch(a=0,s=r,t.length-u){case 2:s=e[(15&(a=t[u+1]))<<2]||r;case 1:t=t[u],n[c]=e[t>>2]+e[(3&t)<<4|a>>4]+s+r;}return n.join("")}for(e="",n=0,r=t.length-10240;n<r;)e+=String.fromCharCode.apply(null,t.subarray(n,n+=10240));return e+=String.fromCharCode.apply(null,n?t.subarray(n):t),btoa(e)}const U=/[-_.]/g,B={"-":"+",_:"/",".":"="};function O(t){return B[t]||""}function L(t){if(!x)return E(t);U.test(t)&&(t=t.replace(U,O)),t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function N(t){return T&&null!=t&&t instanceof Uint8Array}var F={};function k(){return C||=new j(null,F)}function V(t){G(F);var e=t.g;return null==(e=null==e||N(e)?e:"string"==typeof e?L(e):null)?e:t.g=e}var j=class{i(){return new Uint8Array(V(this)||0)}constructor(t,e){if(G(e),this.g=t,null!=t&&0===t.length)throw Error("ByteString should be constructed with non-empty values")}};let C,M;function G(t){if(t!==F)throw Error("illegal external caller")}function D(t,e){t.__closure__error__context__984382||(t.__closure__error__context__984382={}),t.__closure__error__context__984382.severity=e;}function $(){const e=Error();D(e,"incident"),function(e){t.setTimeout((()=>{throw e}),0);}(e);}function z(){const t=Error("int32");return D(t,"warning"),t}function R(){return "function"==typeof BigInt}function W(t){return Array.prototype.slice.call(t)}var H="function"==typeof Symbol&&"symbol"==typeof Symbol();function q(t){return "function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():t}var J=q(),K=q("2ex"),X=q("1oa"),Y=H?(t,e)=>{t[J]|=e;}:(t,e)=>{void 0!==t.s?t.s|=e:Object.defineProperties(t,{s:{value:e,configurable:!0,writable:!0,enumerable:!1}});},Q=H?(t,e)=>{t[J]&=~e;}:(t,e)=>{void 0!==t.s&&(t.s&=~e);},Z=H?t=>0|t[J]:t=>0|t.s,tt=H?t=>t[J]:t=>t.s,et=H?(t,e)=>{t[J]=e;}:(t,e)=>{void 0!==t.s?t.s=e:Object.defineProperties(t,{s:{value:e,configurable:!0,writable:!0,enumerable:!1}});};function nt(t,e){et(e,-30975&(0|t));}function rt(t,e){et(e,-30941&(34|t));}var it,ot={},st={};function at(t){return !(!t||"object"!=typeof t||t.g!==st)}function ut(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}function ct(t,e){if(null!=t)if("string"==typeof t)t=t?new j(t,F):k();else if(t.constructor!==j)if(N(t))t=t.length?new j(new Uint8Array(t),F):k();else {if(!e)throw Error();t=void 0;}return t}function lt(t){return !(!Array.isArray(t)||t.length)&&!!(1&Z(t))}const ht=[];function ft(t){if(2&t)throw Error()}let dt;function gt(t,e){(e=dt?e[dt]:void 0)&&(t[dt]=W(e));}et(ht,55),it=Object.freeze(ht);var pt=Object.freeze({}),mt="function"==typeof t.BigInt&&"bigint"==typeof t.BigInt(0),yt=t=>mt?t>=vt&&t<=_t:"-"===t[0]?St(t,bt):St(t,wt);const bt=Number.MIN_SAFE_INTEGER.toString(),vt=mt?BigInt(Number.MIN_SAFE_INTEGER):void 0,wt=Number.MAX_SAFE_INTEGER.toString(),_t=mt?BigInt(Number.MAX_SAFE_INTEGER):void 0;function St(t,e){if(t.length>e.length)return !1;if(t.length<e.length||t===e)return !0;for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(r>i)return !1;if(r<i)return !0}}const At="function"==typeof Uint8Array.prototype.slice;let Et,It=0,Tt=0;function xt(t){const e=t>>>0;It=e,Tt=(t-e)/4294967296>>>0;}function Pt(t){if(t<0){xt(-t);const[e,n]=kt(It,Tt);It=e>>>0,Tt=n>>>0;}else xt(t);}function Ut(t){const e=Et||=new DataView(new ArrayBuffer(8));e.setFloat32(0,+t,!0),Tt=0,It=e.getUint32(0,!0);}function Bt(t,e){const n=4294967296*e+(t>>>0);return Number.isSafeInteger(n)?n:Lt(t,e)}function Ot(t,e){const n=2147483648&e;return n&&(e=~e>>>0,0==(t=1+~t>>>0)&&(e=e+1>>>0)),"number"==typeof(t=Bt(t,e))?n?-t:t:n?"-"+t:t}function Lt(t,e){if(t>>>=0,(e>>>=0)<=2097151)var n=""+(4294967296*e+t);else R()?n=""+(BigInt(e)<<BigInt(32)|BigInt(t)):(t=(16777215&t)+6777216*(n=16777215&(t>>>24|e<<8))+6710656*(e=e>>16&65535),n+=8147497*e,e*=2,t>=1e7&&(n+=t/1e7>>>0,t%=1e7),n>=1e7&&(e+=n/1e7>>>0,n%=1e7),n=e+Nt(n)+Nt(t));return n}function Nt(t){return t=String(t),"0000000".slice(t.length)+t}function Ft(t){if(t.length<16)Pt(Number(t));else if(R())t=BigInt(t),It=Number(t&BigInt(4294967295))>>>0,Tt=Number(t>>BigInt(32)&BigInt(4294967295));else {const e=+("-"===t[0]);Tt=It=0;const n=t.length;for(let r=e,i=(n-e)%6+e;i<=n;r=i,i+=6){const e=Number(t.slice(r,i));Tt*=1e6,It=1e6*It+e,It>=4294967296&&(Tt+=Math.trunc(It/4294967296),Tt>>>=0,It>>>=0);}if(e){const[t,e]=kt(It,Tt);It=t,Tt=e;}}}function kt(t,e){return e=~e,t?t=1+~t:e+=1,[t,e]}function Vt(t){return null==t||"number"==typeof t?t:"NaN"===t||"Infinity"===t||"-Infinity"===t?Number(t):void 0}function jt(t){if(null!=t&&"boolean"!=typeof t){var e=typeof t;throw Error(`Expected boolean but got ${"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}: ${t}`)}return t}const Ct=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Mt(t){const e=typeof t;switch(e){case"bigint":return !0;case"number":return Number.isFinite(t)}return "string"===e&&Ct.test(t)}function Gt(t){if(null==t)return t;if("string"==typeof t){if(!t)return;t=+t;}return "number"==typeof t&&Number.isFinite(t)?0|t:void 0}function Dt(t){return "-"!==t[0]&&(t.length<20||20===t.length&&Number(t.substring(0,6))<184467)}function $t(t){return t=Math.trunc(t),Number.isSafeInteger(t)||(Pt(t),t=Ot(It,Tt)),t}function zt(t){var e=Math.trunc(Number(t));if(Number.isSafeInteger(e))return String(e);if(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),!("-"===t[0]?t.length<20||20===t.length&&Number(t.substring(0,7))>-922337:t.length<19||19===t.length&&Number(t.substring(0,6))<922337))if(Ft(t),t=It,2147483648&(e=Tt))if(R())t=""+(BigInt(0|e)<<BigInt(32)|BigInt(t>>>0));else {const[n,r]=kt(t,e);t="-"+Lt(n,r);}else t=Lt(t,e);return t}function Rt(t){return null==t?t:"bigint"==typeof t?(yt(t)?t=Number(t):(t=BigInt.asIntN(64,t),t=yt(t)?Number(t):String(t)),t):Mt(t)?"number"==typeof t?$t(t):zt(t):void 0}function Wt(t){if(null==t)return t;var e=typeof t;if("bigint"===e)return String(BigInt.asUintN(64,t));if(Mt(t)){if("string"===e)return e=Math.trunc(Number(t)),Number.isSafeInteger(e)&&e>=0?t=String(e):(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),Dt(t)||(Ft(t),t=Lt(It,Tt))),t;if("number"===e)return (t=Math.trunc(t))>=0&&Number.isSafeInteger(t)?t:function(t){if(t<0){Pt(t);var e=Lt(It,Tt);return t=Number(e),Number.isSafeInteger(t)?t:e}return Dt(e=String(t))?e:(Pt(t),Bt(It,Tt))}(t)}}function Ht(t){if("string"!=typeof t)throw Error();return t}function qt(t){if(null!=t&&"string"!=typeof t)throw Error();return t}function Jt(t){return null==t||"string"==typeof t?t:void 0}function Kt(t,e,n){if(null!=t&&"object"==typeof t&&t.C===ot)return t;if(Array.isArray(t)){var r=Z(t),i=r;return 0===i&&(i|=32&n),(i|=2&n)!==r&&et(t,i),new e(t)}}function Xt(t){var e;return void 0===Zt&&(Zt="function"==typeof Proxy?oe(Proxy):null),(e=!Zt)||(void 0===te&&(te="function"==typeof WeakMap?oe(WeakMap):null),e=!te),e?t:(e=Yt?.get(t))?e:Math.random()>.01?t:(function(t){if(void 0===ee){const t=new Zt([],{});ee=1===Array.prototype.concat.call([],t).length;}ee&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(t[Symbol.isConcatSpreadable]=!0);}(t),function(t,e){(Yt||=new te).set(t,e),(Qt||=new te).set(e,t);}(t,e=new Zt(t,{set:(t,e,n)=>($(),t[e]=n,!0)})),e)}let Yt,Qt,Zt,te,ee,ne,re,ie;function oe(t){try{return -1!==t.toString().indexOf("[native code]")?t:null}catch{return null}}function se(t,e,n){return t=ae(t,e[0],e[1],n?1:2),e!==re&&n&&Y(t,16384),t}function ae(t,e,n,r){if(r=r??0,null==t&&(t=ne),ne=void 0,null==t){var i=96;n?(t=[n],i|=512):t=[],e&&(i=-33521665&i|(1023&e)<<15);}else {if(!Array.isArray(t))throw Error("narr");if(2048&(i=Z(t)))throw Error("farr");if(64&i)return t;if(1===r||2===r||(i|=64),n&&(i|=512,n!==t[0]))throw Error("mid");t:{if(r=(n=t).length){const t=r-1;if(ut(n[t])){if((e=t-(+!!(512&(i|=256))-1))>=1024)throw Error("pvtlmt");i=-33521665&i|(1023&e)<<15;break t}}if(e){if((e=Math.max(e,r-(+!!(512&i)-1)))>1024)throw Error("spvt");i=-33521665&i|(1023&e)<<15;}}}return et(t,i),t}function ue(t,e,n,r,i){if(null!=t){if(Array.isArray(t))t=lt(t)?void 0:i&&2&Z(t)?t:ce(t,e,n,void 0!==r,i);else if(ut(t)){const o={};for(let s in t)o[s]=ue(t[s],e,n,r,i);t=o;}else t=e(t,r);return t}}function ce(t,e,n,r,i){const o=r||n?Z(t):0;r=r?!!(32&o):void 0;const s=W(t);for(let t=0;t<s.length;t++)s[t]=ue(s[t],e,n,r,i);return n&&(gt(s,t),n(o,s)),s}function le(t){return t.C===ot?t.toJSON():function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return yt(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(lt(t))return}else {if(N(t))return P(t);if(t instanceof j){const e=t.g;return null==e?"":"string"==typeof e?e:t.g=P(e)}}}return t}(t)}function he(t,e,n=rt){if(null!=t){if(T&&t instanceof Uint8Array)return e?t:new Uint8Array(t);if(Array.isArray(t)){var r=Z(t);return 2&r?t:(e&&=0===r||!!(32&r)&&!(64&r||!(16&r)),e?(et(t,-12293&(34|r)),t):ce(t,he,4&r?rt:n,!0,!0))}return t.C===ot&&(n=t.l,t=2&(r=tt(n))?t:de(t,n,r,!0)),t}}function fe(t){const e=t.l;return de(t,e,tt(e),!1)}function de(t,e,n,r){return t=t.constructor,ne=e=ge(e,n,r),e=new t(e),ne=void 0,e}function ge(t,e,n){const r=n||2&e?rt:nt,i=!!(32&e);return t=function(t,e,n){const r=W(t);var i=r.length;const o=256&e?r[i-1]:void 0;for(i+=o?-1:0,e=512&e?1:0;e<i;e++)r[e]=n(r[e]);if(o){e=r[e]={};for(const t in o)e[t]=n(o[t]);}return gt(r,t),r}(t,e,(t=>he(t,i,r))),Y(t,32|(n?2:0)),t}function pe(t){const e=t.l,n=tt(e);return 2&n?de(t,e,n,!1):t}function me(t,e){return be(t=t.l,tt(t),e)}function ye(t,e,n,r){if(!((e=r+(+!!(512&e)-1))<0||e>=t.length||e>=n))return t[e]}function be(t,e,n,r){if(-1===n)return null;const i=e>>15&1023||536870912;if(!(n>=i)){var o=t.length;return r&&256&e&&null!=(r=t[o-1][n])?(ye(t,e,i,n)&&null!=K&&((e=(t=M??={})[K]||0)>=4||(t[K]=e+1,$())),r):ye(t,e,i,n)}return 256&e?t[t.length-1][n]:void 0}function ve(t,e,n){const r=t.l;let i=tt(r);return ft(i),we(r,i,e,n),t}function we(t,e,n,r){const i=e>>15&1023||536870912;if(n>=i){let o,s=e;if(256&e)o=t[t.length-1];else {if(null==r)return s;o=t[i+(+!!(512&e)-1)]={},s|=256;}return o[n]=r,n<i&&(t[n+(+!!(512&e)-1)]=void 0),s!==e&&et(t,s),s}return t[n+(+!!(512&e)-1)]=r,256&e&&(n in(t=t[t.length-1])&&delete t[n]),e}function _e(t){t=t.l;let e=tt(t);const n=be(t,e,1),r=ct(n,!0);return null!=r&&r!==n&&we(t,e,1,r),r}function Se(t,e,n,r,i){const o=t.l,s=2&(t=tt(o))?1:r;i=!!i,r=Ae(o,t,e);var a=Z(r);if(!(4&a)){4&a&&(r=W(r),a=Ge(a,t),t=we(o,t,e,r));let i=0,s=0;for(;i<r.length;i++){const t=n(r[i]);null!=t&&(r[s++]=t);}s<i&&(r.length=s),a=-4097&(20|(a=Ee(a,t))),et(r,a&=-8193),2&a&&Object.freeze(r);}let u;return 1===s||4===s&&32&a?Ie(a)||(i=a,(a|=2)!==i&&et(r,a),Object.freeze(r)):(n=5===s&&(!!(32&a)||Ie(a)||!!Yt?.get(r)),(2===s||n)&&Ie(a)&&(r=W(r),a=De(a=Ge(a,t),t,i),et(r,a),t=we(o,t,e,r)),Ie(a)||(e=a,(a=De(a,t,i))!==e&&et(r,a)),n?u=Xt(r):2!==s||i||Yt?.delete(r)),u||r}function Ae(t,e,n,r){return t=be(t,e,n,r),Array.isArray(t)?t:it}function Ee(t,e){return 0===t&&(t=Ge(t,e)),1|t}function Ie(t){return !!(2&t)&&!!(4&t)||!!(2048&t)}function Te(t,e,n){t=t.l;let r=tt(t);if(ft(r),null==n)we(t,r,e);else {n=Qt?.get(n)||n;var i=Z(n),o=i,s=Ie(i),a=s||Object.isFrozen(n);for(s||(i=0),a||(n=W(n),o=0,i=De(i=Ge(i,r),r,!0),a=!1),i|=21,s=0;s<n.length;s++){const t=n[s],e=Ht(t);Object.is(t,e)||(a&&(n=W(n),o=0,i=De(i=Ge(i,r),r,!0),a=!1),n[s]=e);}i!==o&&(a&&(n=W(n),i=De(i=Ge(i,r),r,!0)),et(n,i)),we(t,r,e,n);}}function xe(t,e){t=t.l;let n=tt(t);ft(n),we(t,n,2,""===e?void 0:e);}function Pe(t,e,n,r,i){ft(e);var o=!(!(64&e)&&16384&e);const s=(i=Ae(t,e,n,i))!==it;if(o||!s){let a=o=s?Z(i):0;(!s||2&a||Ie(a)||4&a&&!(32&a))&&(i=W(i),a=Ge(a,e),e=we(t,e,n,i)),a=-13&Ee(a,e),a=De(r?-17&a:16|a,e,!0),a!==o&&et(i,a);}return i}function Ue(t,e){var n=mi;return Le(Be(t=t.l),t,tt(t),n)===e?e:-1}function Be(t){if(H)return t[X]??(t[X]=new Map);if(X in t)return t[X];const e=new Map;return Object.defineProperty(t,X,{value:e}),e}function Oe(t,e,n,r){const i=Be(t),o=Le(i,t,e,n);return o!==r&&(o&&(e=we(t,e,o)),i.set(n,r)),e}function Le(t,e,n,r){let i=t.get(r);if(null!=i)return i;i=0;for(let t=0;t<r.length;t++){const o=r[t];null!=be(e,n,o)&&(0!==i&&(n=we(e,n,i)),i=o);}return t.set(r,i),i}function Ne(t,e,n,r){let i,o=tt(t);if(null!=(r=be(t,o,n,r))&&r.C===ot)return (e=pe(r))!==r&&we(t,o,n,e),e.l;if(Array.isArray(r)){const t=Z(r);i=2&t?se(ge(r,t,!1),e,!0):64&t?r:se(i,e,!0);}else i=se(void 0,e,!0);return i!==r&&we(t,o,n,i),i}function Fe(t,e,n,r){t=t.l;let i=tt(t);return (e=Kt(r=be(t,i,n,r),e,i))!==r&&null!=e&&we(t,i,n,e),e}function ke(t,e,n){if(null==(e=Fe(t,e,n,!1)))return e;t=t.l;let r=tt(t);if(!(2&r)){const i=pe(e);i!==e&&we(t,r,n,e=i);}return e}function Ve(t,e,n,r,i,o){t=t.l;var s=!!(2&e);r=s?1:r,i=!!i,o&&=!s,s=Ae(t,e,1);var a=Z(s),u=!!(4&a);if(!u){var c=s,l=e;const t=!!(2&(a=Ee(a,e)));t&&(l|=2);let r=!t,i=!0,o=0,u=0;for(;o<c.length;o++){const e=Kt(c[o],n,l);if(e instanceof n){if(!t){const t=!!(2&Z(e.l));r&&=!t,i&&=t;}c[u++]=e;}}u<o&&(c.length=u),a|=4,a=i?16|a:-17&a,et(c,a=r?8|a:-9&a),t&&Object.freeze(c);}if(o&&!(8&a||!s.length&&(1===r||4===r&&32&a))){for(Ie(a)&&(s=W(s),a=Ge(a,e),e=we(t,e,1,s)),n=s,o=a,c=0;c<n.length;c++)(a=n[c])!==(l=pe(a))&&(n[c]=l);o|=8,o=n.length?-17&o:16|o,et(n,o),a=o;}let h;return 1===r||4===r&&32&a?Ie(a)||(e=a,(a|=!s.length||16&a&&(!u||32&a)?2:2048)!==e&&et(s,a),Object.freeze(s)):(u=5===r&&(!!(32&a)||Ie(a)||!!Yt?.get(s)),(2===r||u)&&Ie(a)&&(s=W(s),a=De(a=Ge(a,e),e,i),et(s,a),e=we(t,e,1,s)),Ie(a)||(t=a,(a=De(a,e,i))!==t&&et(s,a)),u?h=Xt(s):2!==r||i||Yt?.delete(s)),h||s}function je(t,e){const n=tt(t.l);return Ve(t,n,e,void 0===pt?2:4,!1,!(2&n))}function Ce(t,e,n,r){return null==r&&(r=void 0),ve(t,n,r)}function Me(t,e,n){var r=Si;null==n&&(n=void 0);t:{t=t.l;let i=tt(t);if(ft(i),null==n){const n=Be(t);if(Le(n,t,i,r)!==e)break t;n.set(r,0);}else i=Oe(t,i,r,e);we(t,i,e,n);}}function Ge(t,e){return -2049&(t=32|(2&e?2|t:-3&t))}function De(t,e,n){return 32&e&&n||(t&=-33),t}function $e(t,e){var n=ni;const r=tt(t.l);ft(r),t=Ve(t,r,n,2,!0),e=null!=e?e:new n,t.push(e),2&Z(e.l)?Q(t,8):Q(t,16);}function ze(t,e){return t??e}function Re(t,e,n){ft(tt(t.l)),Se(t,e,Jt,2,!0).push(Ht(n));}function We(t,e){return Error(`Invalid wire type: ${t} (at position ${e})`)}function He(){return Error("Failed to read varint, encoding is invalid.")}function qe(t,e){return Error(`Tried to read past the end of the data ${e} > ${t}`)}function Je(t){if("string"==typeof t)return {buffer:L(t),A:!1};if(Array.isArray(t))return {buffer:new Uint8Array(t),A:!1};if(t.constructor===Uint8Array)return {buffer:t,A:!1};if(t.constructor===ArrayBuffer)return {buffer:new Uint8Array(t),A:!1};if(t.constructor===j)return {buffer:V(t)||new Uint8Array(0),A:!0};if(t instanceof Uint8Array)return {buffer:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),A:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Ke(t,e){let n,r=0,i=0,o=0;const s=t.i;let a=t.g;do{n=s[a++],r|=(127&n)<<o,o+=7;}while(o<32&&128&n);for(o>32&&(i|=(127&n)>>4),o=3;o<32&&128&n;o+=7)n=s[a++],i|=(127&n)<<o;if(en(t,a),n<128)return e(r>>>0,i>>>0);throw He()}function Xe(t){let e=0,n=t.g;const r=n+10,i=t.i;for(;n<r;){const r=i[n++];if(e|=r,0==(128&r))return en(t,n),!!(127&e)}throw He()}function Ye(t){const e=t.i;let n=t.g,r=e[n++],i=127&r;if(128&r&&(r=e[n++],i|=(127&r)<<7,128&r&&(r=e[n++],i|=(127&r)<<14,128&r&&(r=e[n++],i|=(127&r)<<21,128&r&&(r=e[n++],i|=r<<28,128&r&&128&e[n++]&&128&e[n++]&&128&e[n++]&&128&e[n++]&&128&e[n++])))))throw He();return en(t,n),i}function Qe(t){var e=t.i;const n=t.g;var r=e[n],i=e[n+1];const o=e[n+2];return e=e[n+3],en(t,t.g+4),t=2*((i=(r<<0|i<<8|o<<16|e<<24)>>>0)>>31)+1,r=i>>>23&255,i&=8388607,255==r?i?NaN:t*(1/0):0==r?1401298464324817e-60*t*i:t*Math.pow(2,r-150)*(i+8388608)}function Ze(t){return Ye(t)}function tn(t,e,{D:n=!1}={}){t.D=n,e&&(e=Je(e),t.i=e.buffer,t.m=e.A,t.v=0,t.j=t.i.length,t.g=t.v);}function en(t,e){if(t.g=e,e>t.j)throw qe(t.j,e)}function nn(t,e){if(e<0)throw Error(`Tried to read a negative byte length: ${e}`);const n=t.g,r=n+e;if(r>t.j)throw qe(e,t.j-n);return t.g=r,n}function rn(t,e){if(0==e)return k();var n=nn(t,e);return t.D&&t.m?n=t.i.subarray(n,n+e):(t=t.i,n=n===(e=n+e)?new Uint8Array(0):At?t.slice(n,e):new Uint8Array(t.subarray(n,e))),0==n.length?k():new j(n,F)}var on=[];function sn(t){var e=t.g;if(e.g==e.j)return !1;t.j=t.g.g;var n=Ye(t.g)>>>0;if(e=n>>>3,!((n&=7)>=0&&n<=5))throw We(n,t.j);if(e<1)throw Error(`Invalid field number: ${e} (at position ${t.j})`);return t.m=e,t.i=n,!0}function an(t){switch(t.i){case 0:0!=t.i?an(t):Xe(t.g);break;case 1:en(t=t.g,t.g+8);break;case 2:if(2!=t.i)an(t);else {var e=Ye(t.g)>>>0;en(t=t.g,t.g+e);}break;case 5:en(t=t.g,t.g+4);break;case 3:for(e=t.m;;){if(!sn(t))throw Error("Unmatched start-group tag: stream EOF");if(4==t.i){if(t.m!=e)throw Error("Unmatched end-group tag");break}an(t);}break;default:throw We(t.i,t.j)}}function un(t,e,n){const r=t.g.j,i=Ye(t.g)>>>0,o=t.g.g+i;let s=o-r;if(s<=0&&(t.g.j=o,n(e,t,void 0,void 0,void 0),s=o-t.g.g),s)throw Error(`Message parsing ended unexpectedly. Expected to read ${i} bytes, instead read ${i-s} bytes, either the data ended unexpectedly or the message misreported its own length`);t.g.g=o,t.g.j=r;}function cn(t){var s=Ye(t.g)>>>0,a=nn(t=t.g,s);if(t=t.i,o){var u,c=t;(u=i)||(u=i=new TextDecoder("utf-8",{fatal:!0})),s=a+s,c=0===a&&s===c.length?c:c.subarray(a,s);try{var l=u.decode(c);}catch(t){if(void 0===r){try{u.decode(new Uint8Array([128]));}catch(t){}try{u.decode(new Uint8Array([97])),r=!0;}catch(t){r=!1;}}throw !r&&(i=void 0),t}}else {s=(l=a)+s,a=[];let r,i=null;for(;l<s;){var h=t[l++];h<128?a.push(h):h<224?l>=s?e():(r=t[l++],h<194||128!=(192&r)?(l--,e()):a.push((31&h)<<6|63&r)):h<240?l>=s-1?e():(r=t[l++],128!=(192&r)||224===h&&r<160||237===h&&r>=160||128!=(192&(u=t[l++]))?(l--,e()):a.push((15&h)<<12|(63&r)<<6|63&u)):h<=244?l>=s-2?e():(r=t[l++],128!=(192&r)||r-144+(h<<28)>>30!=0||128!=(192&(u=t[l++]))||128!=(192&(c=t[l++]))?(l--,e()):(h=(7&h)<<18|(63&r)<<12|(63&u)<<6|63&c,h-=65536,a.push(55296+(h>>10&1023),56320+(1023&h)))):e(),a.length>=8192&&(i=n(i,a),a.length=0);}l=n(i,a);}return l}function ln(t){const e=Ye(t.g)>>>0;return rn(t.g,e)}function hn(t,e,n){var r=Ye(t.g)>>>0;for(r=t.g.g+r;t.g.g<r;)n.push(e(t.g));}var fn=[];let dn;function gn(t,e,n){e.g?e.j(t,e.g,e.i,n,!0):e.j(t,e.i,n,!0);}var pn=class{constructor(t,e){this.l=ae(t,e);}toJSON(){return mn(this)}A(){return !!(2&Z(this.l))}};function mn(t){t=t.l,t=dn?t:ce(t,le,void 0,void 0,!1);{var e=!dn;let c=t.length;if(c){var n=t[c-1],r=ut(n);r?c--:n=void 0;var i=t;if(r){t:{var o,s=n,a=!1;if(s)for(let t in s)isNaN(+t)?(o??={})[t]=s[t]:(r=s[t],Array.isArray(r)&&(lt(r)||at(r)&&0===r.size)&&(r=null),null==r&&(a=!0),null!=r&&((o??={})[t]=r));if(a||(o=s),o)for(let t in o){a=o;break t}a=null;}s=null==a?null!=n:a!==n;}for(;c>0&&(null==(o=i[c-1])||lt(o)||at(o)&&0===o.size);c--)var u=!0;(i!==t||s||u)&&(e?(u||s||a)&&(i.length=c):i=Array.prototype.slice.call(i,0,c),a&&i.push(a)),u=i;}else u=t;}return u}function yn(t){return t?/^\d+$/.test(t)?(Ft(t),new bn(It,Tt)):null:vn||=new bn(0,0)}pn.prototype.C=ot,pn.prototype.toString=function(){try{return dn=!0,mn(this).toString()}finally{dn=!1;}};var bn=class{constructor(t,e){this.i=t>>>0,this.g=e>>>0;}};let vn;function wn(t){return t?/^-?\d+$/.test(t)?(Ft(t),new _n(It,Tt)):null:Sn||=new _n(0,0)}var _n=class{constructor(t,e){this.i=t>>>0,this.g=e>>>0;}};let Sn;function An(t,e,n){for(;n>0||e>127;)t.g.push(127&e|128),e=(e>>>7|n<<25)>>>0,n>>>=7;t.g.push(e);}function En(t,e){for(;e>127;)t.g.push(127&e|128),e>>>=7;t.g.push(e);}function In(t,e){if(e>=0)En(t,e);else {for(let n=0;n<9;n++)t.g.push(127&e|128),e>>=7;t.g.push(1);}}function Tn(t){var e=It;t.g.push(e>>>0&255),t.g.push(e>>>8&255),t.g.push(e>>>16&255),t.g.push(e>>>24&255);}function xn(t,e){0!==e.length&&(t.j.push(e),t.i+=e.length);}function Pn(t,e,n){En(t.g,8*e+n);}function Un(t,e){return Pn(t,e,2),e=t.g.end(),xn(t,e),e.push(t.i),e}function Bn(t,e){var n=e.pop();for(n=t.i+t.g.length()-n;n>127;)e.push(127&n|128),n>>>=7,t.i++;e.push(n),t.i++;}function On(t,e,n){Pn(t,e,2),En(t.g,n.length),xn(t,t.g.end()),xn(t,n);}function Ln(){const t=class{constructor(){throw Error()}};return Object.setPrototypeOf(t,t.prototype),t}var Nn=Ln(),Fn=Ln(),kn=Ln(),Vn=Ln(),jn=Ln(),Cn=Ln(),Mn=Ln(),Gn=Ln(),Dn=class{constructor(t,e,n){this.g=t,this.i=e,t=Nn,this.j=!!t&&n===t||!1;}};function $n(t,e){return new Dn(t,e,Nn)}function zn(t,e,n,r,i){null!=(e=tr(e,r))&&(n=Un(t,n),i(e,t),Bn(t,n));}const Rn=$n((function(t,e,n,r,i){return 2===t.i&&(un(t,Ne(e,r,n),i),!0)}),zn),Wn=$n((function(t,e,n,r,i){return 2===t.i&&(un(t,Ne(e,r,n,!0),i),!0)}),zn);var Hn=Symbol(),qn=Symbol(),Jn=Symbol(),Kn=Symbol();let Xn,Yn;function Qn(t,e,n,r){var i=r[t];if(i)return i;(i={}).B=function(t){switch(typeof t){case"boolean":return re||=[0,void 0,!0];case"number":return t>0?void 0:0===t?ie||=[0,void 0]:[-t,void 0];case"string":return [0,t];case"object":return t}}(r[0]);var o=r[1];let s=1;o&&o.constructor===Object&&(i.G=o,"function"==typeof(o=r[++s])&&(i.H=!0,Xn??=o,Yn??=r[s+1],o=r[s+=2]));const a={};for(;o&&Array.isArray(o)&&o.length&&"number"==typeof o[0]&&o[0]>0;){for(var u=0;u<o.length;u++)a[o[u]]=o;o=r[++s];}for(u=1;void 0!==o;){let t;"number"==typeof o&&(u+=o,o=r[++s]);var c=void 0;if(o instanceof Dn?t=o:(t=Rn,s--),t?.j){o=r[++s],c=r;var l=s;"function"==typeof o&&(o=o(),c[l]=o),c=o;}for(l=u+1,"number"==typeof(o=r[++s])&&o<0&&(l-=o,o=r[++s]);u<l;u++){const r=a[u];c?n(i,u,t,c,r):e(i,u,t,r);}}return r[t]=i}function Zn(t){return Array.isArray(t)?t[0]instanceof Dn?t:[Wn,t]:[t,void 0]}function tr(t,e){return t instanceof pn?t.l:Array.isArray(t)?se(t,e,!1):void 0}function er(t,e,n,r){const i=n.g;t[e]=r?(t,e,n)=>i(t,e,n,r):i;}function nr(t,e,n,r,i){const o=n.g;let s,a;t[e]=(t,e,n)=>o(t,e,n,a||=Qn(qn,er,nr,r).B,s||=rr(r),i);}function rr(t){let e=t[Jn];if(null!=e)return e;const n=Qn(qn,er,nr,t);return e=n.H?(t,e)=>Xn(t,e,n):(t,e)=>{const r=tt(t);for(;sn(e)&&4!=e.i;){var i=e.m,o=n[i];if(null==o){var s=n.G;s&&(s=s[i])&&(null!=(s=ir(s))&&(o=n[i]=s));}null!=o&&o(e,t,i)||(i=(o=e).j,an(o),o.F?o=void 0:(s=o.g.g-i,o.g.g=i,o=rn(o.g,s)),i=t,o&&(dt||=Symbol(),(s=i[dt])?s.push(o):i[dt]=[o]));}return 16384&r&&Y(t,34),!0},t[Jn]=e}function ir(t){const e=(t=Zn(t))[0].g;if(t=t[1]){const n=rr(t),r=Qn(qn,er,nr,t).B;return (t,i,o)=>e(t,i,o,r,n)}return e}function or(t,e,n){t[e]=n.i;}function sr(t,e,n,r){let i,o;const s=n.i;t[e]=(t,e,n)=>s(t,e,n,o||=Qn(Hn,or,sr,r).B,i||=ar(r));}function ar(t){let e=t[Kn];if(!e){const n=Qn(Hn,or,sr,t);e=(t,e)=>ur(t,e,n),t[Kn]=e;}return e}function ur(t,e,n){for(var r=Z(t),i=+!!(512&r)-1,o=t.length,s=512&r?1:0,a=o+(256&r?-1:0);s<a;s++){const r=t[s];if(null==r)continue;const o=s-i,a=cr(n,o);a&&a(e,r,o);}if(256&r){r=t[o-1];for(const t in r)i=+t,Number.isNaN(i)||null!=(o=r[i])&&(a=cr(n,i))&&a(e,o,i);}if(t=dt?t[dt]:void 0)for(xn(e,e.g.end()),n=0;n<t.length;n++)xn(e,V(t[n])||new Uint8Array(0));}function cr(t,e){var n=t[e];if(n)return n;if((n=t.G)&&(n=n[e])){var r=(n=Zn(n))[0].i;if(n=n[1]){const e=ar(n),i=Qn(Hn,or,sr,n).B;n=t.H?Yn(i,e):(t,n,o)=>r(t,n,o,i,e);}else n=r;return t[e]=n}}function lr(t,e){if(Array.isArray(e)){var n=Z(e);if(4&n)return e;for(var r=0,i=0;r<e.length;r++){const n=t(e[r]);null!=n&&(e[i++]=n);}return i<r&&(e.length=i),et(e,-12289&(5|n)),2&n&&Object.freeze(e),e}}function hr(t,e,n){return new Dn(t,e,n)}function fr(t,e,n){return new Dn(t,e,n)}function dr(t,e,n){we(t,tt(t),e,n);}function gr(t,e,n){if(e=function(t){if(null==t)return t;const e=typeof t;if("bigint"===e)return String(BigInt.asIntN(64,t));if(Mt(t)){if("string"===e)return zt(t);if("number"===e)return $t(t)}}(e),null!=e){if("string"==typeof e)wn(e);if(null!=e)switch(Pn(t,n,0),typeof e){case"number":t=t.g,Pt(e),An(t,It,Tt);break;case"bigint":n=BigInt.asUintN(64,e),n=new _n(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),An(t.g,n.i,n.g);break;default:n=wn(e),An(t.g,n.i,n.g);}}}function pr(t,e,n){null!=(e=Gt(e))&&null!=e&&(Pn(t,n,0),In(t.g,e));}function mr(t,e,n){null!=(e=null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0)&&(Pn(t,n,0),t.g.g.push(e?1:0));}function yr(t,e,n){null!=(e=Jt(e))&&On(t,n,u(e));}function br(t,e,n,r,i){null!=(e=tr(e,r))&&(n=Un(t,n),i(e,t),Bn(t,n));}function vr(t,e,n){null!=(e=null==e||"string"==typeof e||N(e)||e instanceof j?e:void 0)&&On(t,n,Je(e).buffer);}var wr=hr((function(t,e,n){return 5===t.i&&(dr(e,n,Qe(t.g)),!0)}),(function(t,e,n){null!=(e=Vt(e))&&(Pn(t,n,5),t=t.g,Ut(e),Tn(t));}),Cn),_r=fr((function(t,e,n){return (5===t.i||2===t.i)&&(e=Pe(e,tt(e),n,!1,!1),2==t.i?hn(t,Qe,e):e.push(Qe(t.g)),!0)}),(function(t,e,n){if(null!=(e=lr(Vt,e))&&e.length){Pn(t,n,2),En(t.g,4*e.length);for(let r=0;r<e.length;r++)n=t.g,Ut(e[r]),Tn(n);}}),Cn),Sr=hr((function(t,e,n){return 0===t.i&&(dr(e,n,Ke(t.g,Ot)),!0)}),gr,jn),Ar=hr((function(t,e,n){return 0===t.i&&(dr(e,n,0===(t=Ke(t.g,Ot))?void 0:t),!0)}),gr,jn),Er=hr((function(t,e,n){return 0===t.i&&(dr(e,n,Ke(t.g,Bt)),!0)}),(function(t,e,n){if(null!=(e=Wt(e))){if("string"==typeof e)yn(e);if(null!=e)switch(Pn(t,n,0),typeof e){case"number":t=t.g,Pt(e),An(t,It,Tt);break;case"bigint":n=BigInt.asUintN(64,e),n=new bn(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),An(t.g,n.i,n.g);break;default:n=yn(e),An(t.g,n.i,n.g);}}}),Ln()),Ir=hr((function(t,e,n){return 0===t.i&&(dr(e,n,Ye(t.g)),!0)}),pr,Vn),Tr=fr((function(t,e,n){return (0===t.i||2===t.i)&&(e=Pe(e,tt(e),n,!1,!1),2==t.i?hn(t,Ye,e):e.push(Ye(t.g)),!0)}),(function(t,e,n){if(null!=(e=lr(Gt,e))&&e.length){n=Un(t,n);for(let n=0;n<e.length;n++)In(t.g,e[n]);Bn(t,n);}}),Vn),xr=hr((function(t,e,n){return 0===t.i&&(dr(e,n,0===(t=Ye(t.g))?void 0:t),!0)}),pr,Vn),Pr=hr((function(t,e,n){return 0===t.i&&(dr(e,n,Xe(t.g)),!0)}),mr,Fn),Ur=hr((function(t,e,n){return 0===t.i&&(dr(e,n,!1===(t=Xe(t.g))?void 0:t),!0)}),mr,Fn),Br=fr((function(t,e,n){return 2===t.i&&(t=cn(t),Pe(e,tt(e),n,!1).push(t),!0)}),(function(t,e,n){if(null!=(e=lr(Jt,e)))for(let s=0;s<e.length;s++){var r=t,i=n,o=e[s];null!=o&&On(r,i,u(o));}}),kn),Or=hr((function(t,e,n){return 2===t.i&&(dr(e,n,""===(t=cn(t))?void 0:t),!0)}),yr,kn),Lr=hr((function(t,e,n){return 2===t.i&&(dr(e,n,cn(t)),!0)}),yr,kn),Nr=function(t,e,n=Nn){return new Dn(t,e,n)}((function(t,e,n,r,i){return 2===t.i&&(r=se(void 0,r,!0),Pe(e,tt(e),n,!0).push(r),un(t,r,i),!0)}),(function(t,e,n,r,i){if(Array.isArray(e))for(let o=0;o<e.length;o++)br(t,e[o],n,r,i);})),Fr=$n((function(t,e,n,r,i,o){return 2===t.i&&(Oe(e,Z(e),o,n),un(t,e=Ne(e,r,n),i),!0)}),br),kr=hr((function(t,e,n){return 2===t.i&&(dr(e,n,ln(t)),!0)}),vr,Mn),Vr=hr((function(t,e,n){return 0===t.i&&(dr(e,n,0===(t=Ye(t.g)>>>0)?void 0:t),!0)}),(function(t,e,n){e=function(t){if(null==t)return t;if("string"==typeof t){if(!t)return;t=+t;}return "number"==typeof t&&Number.isFinite(t)?t>>>0:void 0}(e),null!=e&&null!=e&&(Pn(t,n,0),En(t.g,e));}),Ln()),jr=hr((function(t,e,n){return 0===t.i&&(dr(e,n,Ye(t.g)),!0)}),(function(t,e,n){null!=(e=Gt(e))&&(e=parseInt(e,10),Pn(t,n,0),In(t.g,e));}),Gn);class Cr{constructor(t,e){this.i=t,this.g=e,this.j=Ce,this.defaultValue=void 0;}}function Mr(t,e){return (n,r)=>{if(fn.length){const t=fn.pop();t.o(r),tn(t.g,n,r),n=t;}else n=new class{constructor(t,e){if(on.length){const n=on.pop();tn(n,t,e),t=n;}else t=new class{constructor(t,e){this.i=null,this.m=!1,this.g=this.j=this.v=0,tn(this,t,e);}clear(){this.i=null,this.m=!1,this.g=this.j=this.v=0,this.D=!1;}}(t,e);this.g=t,this.j=this.g.g,this.i=this.m=-1,this.o(e);}o({F:t=!1}={}){this.F=t;}}(n,r);try{const r=new t,o=r.l;rr(e)(o,n);var i=r;}finally{n.g.clear(),n.m=-1,n.i=-1,fn.length<100&&fn.push(n);}return i}}var Gr=[0,Or,hr((function(t,e,n){return 2===t.i&&(dr(e,n,(t=ln(t))===k()?void 0:t),!0)}),(function(t,e,n){if(null!=e){if(e instanceof pn){const r=e.N;return void(r&&(e=r(e),null!=e&&On(t,n,Je(e).buffer)))}if(Array.isArray(e))return}vr(t,e,n);}),Mn)];let Dr,$r=globalThis.trustedTypes;function zr(t){void 0===Dr&&(Dr=function(){let t=null;if(!$r)return t;try{const e=t=>t;t=$r.createPolicy("goog#html",{createHTML:e,createScript:e,createScriptURL:e});}catch(t){}return t}());var e=Dr;return new class{constructor(t){this.g=t;}toString(){return this.g+""}}(e?e.createScriptURL(t):t)}function Rr(t,...e){if(0===e.length)return zr(t[0]);let n=t[0];for(let r=0;r<e.length;r++)n+=encodeURIComponent(e[r])+t[r+1];return zr(n)}var Wr=[0,Ir,jr,Pr,-1,Tr,jr,-1],Hr=class extends pn{constructor(){super();}},qr=[0,Pr,Lr,Pr,jr,-1,fr((function(t,e,n){return (0===t.i||2===t.i)&&(e=Pe(e,tt(e),n,!1,!1),2==t.i?hn(t,Ze,e):e.push(Ye(t.g)),!0)}),(function(t,e,n){if(null!=(e=lr(Gt,e))&&e.length){n=Un(t,n);for(let n=0;n<e.length;n++)In(t.g,e[n]);Bn(t,n);}}),Gn),Lr,-1,[0,Pr,-1],jr,Pr,-1],Jr=[0,Lr,-2],Kr=class extends pn{constructor(){super();}},Xr=[0],Yr=[0,Ir,Pr,1,Pr,-3],Qr=class extends pn{constructor(t){super(t,2);}},Zr={};Zr[336783863]=[0,Lr,Pr,-1,Ir,[0,[1,2,3,4,5,6,7],Fr,Xr,Fr,qr,Fr,Jr,Fr,Yr,Fr,Wr,Fr,[0,Lr,-2],Fr,[0,Lr,jr]],[0,Lr],Pr,[0,[1,3],[2,4],Fr,[0,Tr],-1,Fr,[0,Br],-1,Nr,[0,Lr,-1]],Lr];var ti=[0,Ar,-1,Ur,-3,Ar,Tr,Or,xr,Ar,-1,Ur,xr,Ur,-2,Or];function ei(t){Re(t,3,"TEXT:text_in");}var ni=class extends pn{constructor(t){super(t,500);}o(t){return Ce(this,0,7,t)}},ri=[-1,{}],ii=[0,Lr,1,ri],oi=[0,Lr,Br,ri];function si(t){Re(t,10,"text_in");}var ai,ui=class extends pn{constructor(){super(void 0,500);}o(t){return Ce(this,0,1001,t)}};ui.prototype.g=(ai=[-500,Nr,[-500,Or,-1,Br,-3,[-2,Zr,Pr],Nr,Gr,xr,-1,ii,oi,Nr,[0,Or,Ur],Or,ti,xr,Br,987,Br],4,Nr,[-500,Lr,-1,[-1,{}],998,Lr],Nr,[-500,Lr,Br,-1,[-2,{},Pr],997,Br,-1],xr,Nr,[-500,Lr,Br,ri,998,Br],Br,xr,ii,oi,Nr,[0,Or,-1,ri],Br,-2,ti,Or,-1,Ur,[0,Ur,Vr],978,ri,Nr,Gr],function(){const t=new class{constructor(){this.j=[],this.i=0,this.g=new class{constructor(){this.g=[];}length(){return this.g.length}end(){const t=this.g;return this.g=[],t}};}};ur(this.l,t,Qn(Hn,or,sr,ai)),xn(t,t.g.end());const e=new Uint8Array(t.i),n=t.j,r=n.length;let i=0;for(let t=0;t<r;t++){const r=n[t];e.set(r,i),i+=r.length;}return t.j=[e],e});var ci=class extends pn{constructor(t){super(t);}},li=class extends pn{constructor(t){super(t);}g(){return je(this,ci)}},hi=class extends pn{constructor(t){super(t);}},fi=Mr(class extends pn{constructor(t){super(t);}},[0,Nr,[0,1,Ir,Lr,[0,Nr,[0,Ir,wr,Lr,-1]]],Sr]),di=class extends pn{constructor(t){super(t);}},gi=class extends pn{constructor(t){super(t);}I(){const t=_e(this);return null==t?k():t}},pi=class extends pn{constructor(t){super(t);}},mi=[1,2],yi=Mr(class extends pn{constructor(t){super(t);}},[0,Nr,[0,mi,Fr,[0,_r],Fr,[0,kr],Ir,Lr],Sr]),bi=class extends pn{constructor(t){super(t);}},vi=class extends pn{constructor(t){super(t);}},wi=[0,Pr,-1],_i=class extends pn{constructor(t){super(t);}},Si=[1,2,3,4,5],Ai=class extends pn{constructor(t){super(t);}g(){return null!=_e(this)}i(){return null!=Jt(me(this,2))}},Ei=class extends pn{constructor(t){super(t);}},Ii=[0,[0,kr,Lr,[0,Ir,Sr,-1],[0,Er,Sr]],Pr,[0,Si,Fr,Yr,Fr,qr,Fr,Wr,Fr,Xr,Fr,Jr],jr],Ti=class extends pn{constructor(t){super(t);}},xi=new Cr(462704549,Ti);Zr[462704549]=[0,Ii,[0,Lr,Ir,wr,Br,-1]];var Pi=class extends pn{constructor(t){super(t);}},Ui=new Cr(477589892,Pi);function Bi(t,e){if(e=e?fe(e):new bi,void 0!==t.displayNamesLocale?ve(e,1,qt(t.displayNamesLocale)):void 0===t.displayNamesLocale&&ve(e,1),void 0!==t.maxResults){var n=t.maxResults;if(null!=n){if("number"!=typeof n)throw z();if(!Number.isFinite(n))throw z();n|=0;}ve(e,2,n);}else "maxResults"in t&&ve(e,2);if(void 0!==t.scoreThreshold){if(null!=(n=t.scoreThreshold)&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ve(e,3,n);}else "scoreThreshold"in t&&ve(e,3);return void 0!==t.categoryAllowlist?Te(e,4,t.categoryAllowlist):"categoryAllowlist"in t&&ve(e,4),void 0!==t.categoryDenylist?Te(e,5,t.categoryDenylist):"categoryDenylist"in t&&ve(e,5),e}function Oi(t){const e={classifications:je(t,hi).map((t=>function(t,e=-1,n=""){return {categories:t.map((t=>{var e=ze(Gt(me(t,1)),0)??-1;const n=t.l;let r=tt(n);const i=be(n,r,2),o=Vt(i);return null!=o&&o!==i&&we(n,r,2,o),{index:e,score:o??0??0,categoryName:ze(Jt(me(t,3)),"")??"",displayName:ze(Jt(me(t,4)),"")??""}})),headIndex:e,headName:n}}(ke(t,li,4)?.g()??[],ze(Gt(me(t,2)),0),ze(Jt(me(t,3)),""))))};return null!=Rt(me(t,2))&&(e.timestampMs=ze(Rt(me(t,2)),0)),e}function Li(t){return Array.from(t,(t=>t>127?t-256:t))}function Ni(t,e){if(t.length!==e.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${t.length} vs. ${e.length}).`);let n=0,r=0,i=0;for(let o=0;o<t.length;o++)n+=t[o]*e[o],r+=t[o]*t[o],i+=e[o]*e[o];if(r<=0||i<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*i)}let Fi;Zr[477589892]=[0,Ii,wi];const ki=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Vi(){if(void 0===Fi)try{await WebAssembly.instantiate(ki),Fi=!0;}catch{Fi=!1;}return Fi}async function ji(t,e=Rr``){const n=await Vi()?"wasm_internal":"wasm_nosimd_internal";return {wasmLoaderPath:`${e}/${t}_${n}.js`,wasmBinaryPath:`${e}/${t}_${n}.wasm`}}var Ci=class{};function Mi(){var t=navigator;return "undefined"!=typeof OffscreenCanvas&&(!function(t=navigator){return (t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(t)||!!((t=t.userAgent.match(/Version\/([\d]+).*Safari/))&&t.length>=1&&Number(t[1])>=17))}async function Gi(t){if("function"!=typeof importScripts){const e=document.createElement("script");return e.src=t.toString(),e.crossOrigin="anonymous",new Promise(((t,n)=>{e.addEventListener("load",(()=>{t();}),!1),e.addEventListener("error",(t=>{n(t);}),!1),document.body.appendChild(e);}))}importScripts(t.toString());}Ci.forVisionTasks=function(t){return ji("vision",t)},Ci.forTextTasks=function(t){return ji("text",t)},Ci.forGenAiExperimentalTasks=function(t){return ji("genai_experimental",t)},Ci.forGenAiTasks=function(t){return ji("genai",t)},Ci.forAudioTasks=function(t){return ji("audio",t)},Ci.isSimdSupported=function(){return Vi()};function Di(t,e,n){t.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(e=t.h.stringToNewUTF8(e)),t.h._free(e);}function $i(t,e,n){t.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(e.length);for(let n=0;n<e.length;n++)r[n]=t.h.stringToNewUTF8(e[n]);e=t.h._malloc(4*r.length),t.h.HEAPU32.set(r,e>>2),n(e);for(const e of r)t.h._free(e);t.h._free(e);}function zi(t,e,n){t.h.simpleListeners=t.h.simpleListeners||{},t.h.simpleListeners[e]=n;}function Ri(t,e,n){let r=[];t.h.simpleListeners=t.h.simpleListeners||{},t.h.simpleListeners[e]=(t,e,i)=>{e?(n(r,i),r=[]):r.push(t);};}const Wi=function(t){return class extends t{M(){this.h._registerModelResourcesGraphService();}}}(class{constructor(t,e){this.j=!0,this.h=t,this.g=null,this.i=0,this.m="function"==typeof this.h._addIntToInputStream,void 0!==e?this.h.canvas=e:Mi()?this.h.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.h.canvas=document.createElement("canvas"));}async initializeGraph(t){const e=await(await fetch(t)).arrayBuffer();t=!(t.endsWith(".pbtxt")||t.endsWith(".textproto")),this.setGraph(new Uint8Array(e),t);}setGraphFromString(t){this.setGraph((new TextEncoder).encode(t),!1);}setGraph(t,e){const n=t.length,r=this.h._malloc(n);this.h.HEAPU8.set(t,r),e?this.h._changeBinaryGraph(n,r):this.h._changeTextGraph(n,r),this.h._free(r);}configureAudio(t,e,n,r,i){this.h._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Di(this,r||"input_audio",(r=>{Di(this,i=i||"audio_header",(i=>{this.h._configureAudio(r,i,t,e??0,n);}));}));}setAutoResizeCanvas(t){this.j=t;}setAutoRenderToScreen(t){this.h._setAutoRenderToScreen(t);}setGpuBufferVerticalFlip(t){this.h.gpuOriginForWebTexturesIsBottomLeft=t;}attachErrorListener(t){this.h.errorListener=t;}attachEmptyPacketListener(t,e){this.h.emptyPacketListeners=this.h.emptyPacketListeners||{},this.h.emptyPacketListeners[t]=e;}addAudioToStream(t,e,n){this.addAudioToStreamWithShape(t,0,0,e,n);}addAudioToStreamWithShape(t,e,n,r,i){const o=4*t.length;this.i!==o&&(this.g&&this.h._free(this.g),this.g=this.h._malloc(o),this.i=o),this.h.HEAPF32.set(t,this.g/4),Di(this,r,(t=>{this.h._addAudioToInputStream(this.g,e,n,t,i);}));}addGpuBufferToStream(t,e,n){Di(this,e,(e=>{if(!this.h.canvas)throw Error("No OpenGL canvas configured.");e?this.h._bindTextureToStream(e):this.h._bindTextureToCanvas();const r=this.h.canvas.getContext("webgl2")||this.h.canvas.getContext("webgl");if(!r)throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);const[i,o]=void 0!==t.videoWidth?[t.videoWidth,t.videoHeight]:void 0!==t.naturalWidth?[t.naturalWidth,t.naturalHeight]:void 0!==t.displayWidth?[t.displayWidth,t.displayHeight]:[t.width,t.height];!this.j||i===this.h.canvas.width&&o===this.h.canvas.height||(this.h.canvas.width=i,this.h.canvas.height=o);const[s,a]=[i,o];this.h._addBoundTextureToStream(e,s,a,n);}));}addBoolToStream(t,e,n){Di(this,e,(e=>{this.h._addBoolToInputStream(t,e,n);}));}addDoubleToStream(t,e,n){Di(this,e,(e=>{this.h._addDoubleToInputStream(t,e,n);}));}addFloatToStream(t,e,n){Di(this,e,(e=>{this.h._addFloatToInputStream(t,e,n);}));}addIntToStream(t,e,n){Di(this,e,(e=>{this.h._addIntToInputStream(t,e,n);}));}addUintToStream(t,e,n){Di(this,e,(e=>{this.h._addUintToInputStream(t,e,n);}));}addStringToStream(t,e,n){Di(this,e,(e=>{Di(this,t,(t=>{this.h._addStringToInputStream(t,e,n);}));}));}addStringRecordToStream(t,e,n){Di(this,e,(e=>{$i(this,Object.keys(t),(r=>{$i(this,Object.values(t),(i=>{this.h._addFlatHashMapToInputStream(r,i,Object.keys(t).length,e,n);}));}));}));}addProtoToStream(t,e,n,r){Di(this,n,(n=>{Di(this,e,(e=>{const i=this.h._malloc(t.length);this.h.HEAPU8.set(t,i),this.h._addProtoToInputStream(i,t.length,e,n,r),this.h._free(i);}));}));}addEmptyPacketToStream(t,e){Di(this,t,(t=>{this.h._addEmptyPacketToInputStream(t,e);}));}addBoolVectorToStream(t,e,n){Di(this,e,(e=>{const r=this.h._allocateBoolVector(t.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const e of t)this.h._addBoolVectorEntry(r,e);this.h._addBoolVectorToInputStream(r,e,n);}));}addDoubleVectorToStream(t,e,n){Di(this,e,(e=>{const r=this.h._allocateDoubleVector(t.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const e of t)this.h._addDoubleVectorEntry(r,e);this.h._addDoubleVectorToInputStream(r,e,n);}));}addFloatVectorToStream(t,e,n){Di(this,e,(e=>{const r=this.h._allocateFloatVector(t.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const e of t)this.h._addFloatVectorEntry(r,e);this.h._addFloatVectorToInputStream(r,e,n);}));}addIntVectorToStream(t,e,n){Di(this,e,(e=>{const r=this.h._allocateIntVector(t.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const e of t)this.h._addIntVectorEntry(r,e);this.h._addIntVectorToInputStream(r,e,n);}));}addUintVectorToStream(t,e,n){Di(this,e,(e=>{const r=this.h._allocateUintVector(t.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const e of t)this.h._addUintVectorEntry(r,e);this.h._addUintVectorToInputStream(r,e,n);}));}addStringVectorToStream(t,e,n){Di(this,e,(e=>{const r=this.h._allocateStringVector(t.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const e of t)Di(this,e,(t=>{this.h._addStringVectorEntry(r,t);}));this.h._addStringVectorToInputStream(r,e,n);}));}addBoolToInputSidePacket(t,e){Di(this,e,(e=>{this.h._addBoolToInputSidePacket(t,e);}));}addDoubleToInputSidePacket(t,e){Di(this,e,(e=>{this.h._addDoubleToInputSidePacket(t,e);}));}addFloatToInputSidePacket(t,e){Di(this,e,(e=>{this.h._addFloatToInputSidePacket(t,e);}));}addIntToInputSidePacket(t,e){Di(this,e,(e=>{this.h._addIntToInputSidePacket(t,e);}));}addUintToInputSidePacket(t,e){Di(this,e,(e=>{this.h._addUintToInputSidePacket(t,e);}));}addStringToInputSidePacket(t,e){Di(this,e,(e=>{Di(this,t,(t=>{this.h._addStringToInputSidePacket(t,e);}));}));}addProtoToInputSidePacket(t,e,n){Di(this,n,(n=>{Di(this,e,(e=>{const r=this.h._malloc(t.length);this.h.HEAPU8.set(t,r),this.h._addProtoToInputSidePacket(r,t.length,e,n),this.h._free(r);}));}));}addBoolVectorToInputSidePacket(t,e){Di(this,e,(e=>{const n=this.h._allocateBoolVector(t.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(const e of t)this.h._addBoolVectorEntry(n,e);this.h._addBoolVectorToInputSidePacket(n,e);}));}addDoubleVectorToInputSidePacket(t,e){Di(this,e,(e=>{const n=this.h._allocateDoubleVector(t.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(const e of t)this.h._addDoubleVectorEntry(n,e);this.h._addDoubleVectorToInputSidePacket(n,e);}));}addFloatVectorToInputSidePacket(t,e){Di(this,e,(e=>{const n=this.h._allocateFloatVector(t.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(const e of t)this.h._addFloatVectorEntry(n,e);this.h._addFloatVectorToInputSidePacket(n,e);}));}addIntVectorToInputSidePacket(t,e){Di(this,e,(e=>{const n=this.h._allocateIntVector(t.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(const e of t)this.h._addIntVectorEntry(n,e);this.h._addIntVectorToInputSidePacket(n,e);}));}addUintVectorToInputSidePacket(t,e){Di(this,e,(e=>{const n=this.h._allocateUintVector(t.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(const e of t)this.h._addUintVectorEntry(n,e);this.h._addUintVectorToInputSidePacket(n,e);}));}addStringVectorToInputSidePacket(t,e){Di(this,e,(e=>{const n=this.h._allocateStringVector(t.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(const e of t)Di(this,e,(t=>{this.h._addStringVectorEntry(n,t);}));this.h._addStringVectorToInputSidePacket(n,e);}));}attachBoolListener(t,e){zi(this,t,e),Di(this,t,(t=>{this.h._attachBoolListener(t);}));}attachBoolVectorListener(t,e){Ri(this,t,e),Di(this,t,(t=>{this.h._attachBoolVectorListener(t);}));}attachIntListener(t,e){zi(this,t,e),Di(this,t,(t=>{this.h._attachIntListener(t);}));}attachIntVectorListener(t,e){Ri(this,t,e),Di(this,t,(t=>{this.h._attachIntVectorListener(t);}));}attachUintListener(t,e){zi(this,t,e),Di(this,t,(t=>{this.h._attachUintListener(t);}));}attachUintVectorListener(t,e){Ri(this,t,e),Di(this,t,(t=>{this.h._attachUintVectorListener(t);}));}attachDoubleListener(t,e){zi(this,t,e),Di(this,t,(t=>{this.h._attachDoubleListener(t);}));}attachDoubleVectorListener(t,e){Ri(this,t,e),Di(this,t,(t=>{this.h._attachDoubleVectorListener(t);}));}attachFloatListener(t,e){zi(this,t,e),Di(this,t,(t=>{this.h._attachFloatListener(t);}));}attachFloatVectorListener(t,e){Ri(this,t,e),Di(this,t,(t=>{this.h._attachFloatVectorListener(t);}));}attachStringListener(t,e){zi(this,t,e),Di(this,t,(t=>{this.h._attachStringListener(t);}));}attachStringVectorListener(t,e){Ri(this,t,e),Di(this,t,(t=>{this.h._attachStringVectorListener(t);}));}attachProtoListener(t,e,n){zi(this,t,e),Di(this,t,(t=>{this.h._attachProtoListener(t,n||!1);}));}attachProtoVectorListener(t,e,n){Ri(this,t,e),Di(this,t,(t=>{this.h._attachProtoVectorListener(t,n||!1);}));}attachAudioListener(t,e,n){this.h._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),zi(this,t,((t,n)=>{t=new Float32Array(t.buffer,t.byteOffset,t.length/4),e(t,n);})),Di(this,t,(t=>{this.h._attachAudioListener(t,n||!1);}));}finishProcessing(){this.h._waitUntilIdle();}closeGraph(){this.h._closeGraph(),this.h.simpleListeners=void 0,this.h.emptyPacketListeners=void 0;}});var Hi=class extends Wi{};async function qi(t,e,n){return t=await(async(t,e,n,r)=>{if(e&&await Gi(e),!self.ModuleFactory)throw Error("ModuleFactory not set.");if(n&&(await Gi(n),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&r&&((e=self.Module).locateFile=r.locateFile,r.mainScriptUrlOrBlob&&(e.mainScriptUrlOrBlob=r.mainScriptUrlOrBlob)),r=await self.ModuleFactory(self.Module||r),self.ModuleFactory=self.Module=void 0,new t(r,null)})(t,e.wasmLoaderPath,e.assetLoaderPath,{locateFile:t=>t.endsWith(".wasm")?e.wasmBinaryPath.toString():e.assetBinaryPath&&t.endsWith(".data")?e.assetBinaryPath.toString():t}),await t.o(n),t}async function Ji(t,e,n){return qi(t,e,n)}function Ki(t,e){const n=ke(t.baseOptions,Ai,1)||new Ai;"string"==typeof e?(ve(n,2,qt(e)),ve(n,1)):e instanceof Uint8Array&&(ve(n,1,ct(e,!1)),ve(n,2)),Ce(t.baseOptions,0,1,n);}function Xi(t,e){const n=e.baseOptions||{};if(e.baseOptions?.modelAssetBuffer&&e.baseOptions?.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!(ke(t.baseOptions,Ai,1)?.g()||ke(t.baseOptions,Ai,1)?.i()||e.baseOptions?.modelAssetBuffer||e.baseOptions?.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(t,e){let n=ke(t.baseOptions,_i,3);if(!n){var r=n=new _i;Me(r,4,new Kr);}"delegate"in e&&("GPU"===e.delegate?Me(e=n,2,r=new Hr):Me(e=n,4,r=new Kr)),Ce(t.baseOptions,0,3,n);}(t,n),n.modelAssetPath)return fetch(n.modelAssetPath.toString()).then((t=>{if(t.ok)return t.arrayBuffer();throw Error(`Failed to fetch model: ${n.modelAssetPath} (${t.status})`)})).then((e=>{try{t.g.h.FS_unlink("/model.dat");}catch{}t.g.h.FS_createDataFile("/","model.dat",new Uint8Array(e),!0,!1,!1),Ki(t,"/model.dat"),t.v();}));if(n.modelAssetBuffer instanceof Uint8Array)Ki(t,n.modelAssetBuffer);else if(n.modelAssetBuffer)return async function(t){const e=[];for(var n=0;;){const{done:r,value:i}=await t.read();if(r)break;e.push(i),n+=i.length;}if(0===e.length)return new Uint8Array(0);if(1===e.length)return e[0];t=new Uint8Array(n),n=0;for(const r of e)t.set(r,n),n+=r.length;return t}(n.modelAssetBuffer).then((e=>{Ki(t,e),t.v();}));return t.v(),Promise.resolve()}function Yi(t){try{const e=t.m.length;if(1===e)throw Error(t.m[0].message);if(e>1)throw Error("Encountered multiple errors: "+t.m.map((t=>t.message)).join(", "))}finally{t.m=[];}}function Qi(t,e){t.j=Math.max(t.j,e);}var Zi=class{constructor(t){this.g=t,this.m=[],this.j=0,this.g.setAutoRenderToScreen(!1);}setGraph(t,e){this.g.attachErrorListener(((t,e)=>{this.m.push(Error(e));})),this.g.M(),this.g.setGraph(t,e),Yi(this);}finishProcessing(){this.g.finishProcessing(),Yi(this);}close(){this.g.closeGraph();}};Zi.prototype.close=Zi.prototype.close,function(e,n){e=e.split(".");var r,i=t;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(r=e.shift());)e.length||void 0===n?i=i[r]&&i[r]!==Object.prototype[r]?i[r]:i[r]={}:i[r]=n;}("TaskRunner",Zi);var to=class extends Zi{constructor(t,e){super(new Hi(t,e)),this.u={languages:[]},Ce(t=this.i=new Ti,0,1,e=new Ei);}o(t){return Ce(this.i,0,2,Bi(t,ke(this.i,bi,2))),Xi(this,t)}get baseOptions(){return ke(this.i,Ei,1)}set baseOptions(t){Ce(this.i,0,1,t);}K(t){return this.u={languages:[]},this.g.addStringToStream(t,"text_in",this.j+1),this.finishProcessing(),this.u}v(){var t=new ui;si(t),Re(t,15,"classifications_out");const e=new Qr;gn(e,xi,this.i);const n=new ni;xe(n,qt("mediapipe.tasks.text.text_classifier.TextClassifierGraph")),ei(n),Re(n,4,"CLASSIFICATIONS:classifications_out"),n.o(e),$e(t,n),this.g.attachProtoListener("classifications_out",((t,e)=>{if(({classifications:t}=Oi(fi(t))),1!==t.length)throw Error(`Expected 1 classification head, got ${t.length}`);this.u.languages=t[0].categories.map((t=>({languageCode:t.categoryName,probability:t.score}))),Qi(this,e);})),this.g.attachEmptyPacketListener("classifications_out",(t=>{Qi(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};to.prototype.detect=to.prototype.K,to.prototype.setOptions=to.prototype.o,to.createFromModelPath=function(t,e){return Ji(to,t,{baseOptions:{modelAssetPath:e}})},to.createFromModelBuffer=function(t,e){return Ji(to,t,{baseOptions:{modelAssetBuffer:e}})},to.createFromOptions=function(t,e){return Ji(to,t,e)};var eo=class extends Zi{constructor(t,e){super(new Hi(t,e)),this.u={classifications:[]},Ce(t=this.i=new Ti,0,1,e=new Ei);}o(t){return Ce(this.i,0,2,Bi(t,ke(this.i,bi,2))),Xi(this,t)}get baseOptions(){return ke(this.i,Ei,1)}set baseOptions(t){Ce(this.i,0,1,t);}J(t){return this.u={classifications:[]},this.g.addStringToStream(t,"text_in",this.j+1),this.finishProcessing(),this.u}v(){var t=new ui;si(t),Re(t,15,"classifications_out");const e=new Qr;gn(e,xi,this.i);const n=new ni;xe(n,qt("mediapipe.tasks.text.text_classifier.TextClassifierGraph")),ei(n),Re(n,4,"CLASSIFICATIONS:classifications_out"),n.o(e),$e(t,n),this.g.attachProtoListener("classifications_out",((t,e)=>{this.u=Oi(fi(t)),Qi(this,e);})),this.g.attachEmptyPacketListener("classifications_out",(t=>{Qi(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};eo.prototype.classify=eo.prototype.J,eo.prototype.setOptions=eo.prototype.o,eo.createFromModelPath=function(t,e){return Ji(eo,t,{baseOptions:{modelAssetPath:e}})},eo.createFromModelBuffer=function(t,e){return Ji(eo,t,{baseOptions:{modelAssetBuffer:e}})},eo.createFromOptions=function(t,e){return Ji(eo,t,e)};var no=class extends Zi{constructor(t,e){super(new Hi(t,e)),this.u={embeddings:[]},Ce(t=this.i=new Pi,0,1,e=new Ei);}o(t){var e=this.i,n=ke(this.i,vi,2);return n=n?fe(n):new vi,void 0!==t.l2Normalize?ve(n,1,jt(t.l2Normalize)):"l2Normalize"in t&&ve(n,1),void 0!==t.quantize?ve(n,2,jt(t.quantize)):"quantize"in t&&ve(n,2),Ce(e,0,2,n),Xi(this,t)}get baseOptions(){return ke(this.i,Ei,1)}set baseOptions(t){Ce(this.i,0,1,t);}L(t){return this.g.addStringToStream(t,"text_in",this.j+1),this.finishProcessing(),this.u}v(){var t=new ui;si(t),Re(t,15,"embeddings_out");const e=new Qr;gn(e,Ui,this.i);const n=new ni;xe(n,qt("mediapipe.tasks.text.text_embedder.TextEmbedderGraph")),ei(n),Re(n,4,"EMBEDDINGS:embeddings_out"),n.o(e),$e(t,n),this.g.attachProtoListener("embeddings_out",((t,e)=>{t=yi(t),this.u=function(t){return {embeddings:je(t,pi).map((t=>{const e={headIndex:ze(Gt(me(t,3)),0)??-1,headName:ze(Jt(me(t,4)),"")??""};if(void 0!==Fe(t,di,Ue(t,1)))e.floatEmbedding=Se(ke(t,di,Ue(t,1)),1,Vt,void 0===pt?2:4).slice();else {const n=new Uint8Array(0);e.quantizedEmbedding=ke(t,gi,Ue(t,2))?.I()?.i()??n;}return e})),timestampMs:ze(Rt(me(t,2)),0)}}(t),Qi(this,e);})),this.g.attachEmptyPacketListener("embeddings_out",(t=>{Qi(this,t);})),t=t.g(),this.setGraph(new Uint8Array(t),!0);}};no.cosineSimilarity=function(t,e){if(t.floatEmbedding&&e.floatEmbedding)t=Ni(t.floatEmbedding,e.floatEmbedding);else {if(!t.quantizedEmbedding||!e.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");t=Ni(Li(t.quantizedEmbedding),Li(e.quantizedEmbedding));}return t},no.prototype.embed=no.prototype.L,no.prototype.setOptions=no.prototype.o,no.createFromModelPath=function(t,e){return Ji(no,t,{baseOptions:{modelAssetPath:e}})},no.createFromModelBuffer=function(t,e){return Ji(no,t,{baseOptions:{modelAssetBuffer:e}})},no.createFromOptions=function(t,e){return Ji(no,t,e)};

  class ChatBox extends Lightning.Component {
    static _template() {
      return {
        w: w => w - 500,
        h: h => h - 100,
        x: 100,
        y: 50,
        rect: true,
        color: 0xFF2D2D2D,
        // LabelGrid: {
        //     x: 20, y: 50, h: 80, w: 350, type: Item,
        //     //item: { 
        //     //  } 
        // },
        Messages: {
          //type: ScrollWrapper,
          x: 20,
          y: 150,
          h: 550,
          w: 1160,
          rect: true,
          flex: {
            direction: "column",
            reverse: true,
            margin: 10
          },
          color: Colors$1("black").lightness(0.3).get(),
          shader: {
            type: Lightning.shaders.Outline,
            width: 1,
            color: 0xffffffff
          }
          //text:{fontFace: "Londrina", fontSize: 25 },
        },
        Keyboard: {
          y: 480,
          type: KeyboardText,
          signals: {
            onInputChanged: true
          }
        }
      };
    }
    _init() {
      super._init();
    }
    _active() {
      //this.tag('Messages').color = Colors("black").lightness(0.3).get();        
    }
    _handleEnter() {
      console.log('hello');
      //this.startVoiceRecognition();
      //alert('hi');       
    }

    //Keyboard event
    onInputChanged(keyboardInputData) {
      const {
        input,
        previousInput
      } = keyboardInputData;
      console.log('Current input:', input);
      console.log('Previous input:', previousInput);
      // Handle the input change here
      console.log("I am in chabox onInputChanged event");

      //Media Pipe Tasks
      //Text tasks
      this._classifyText(keyboardInputData);
      //this._textEmbedder(keyboardInputData);
      //this._langDetector(keyboardInputData);
      //Audio task
      //this._classifyAudio();
      //Vision tasks
      //this._classifyImage();
    }

    //start the mediapipe code    
    //async _classifyText(inputText) {
    //Text classification code for mediapipe
    async _classifyText(keyboardInputText) {
      const textClassifier = await eo.createFromOptions(await Ci.forTextTasks('https://cdn.jsdelivr.net/npm/@mediapipe/tasks-text@0.10.0/wasm'),
      //await FilesetResolver.forTextTasks('http://127.0.0.1:8081'),
      {
        baseOptions: {
          modelAssetPath: "https://storage.googleapis.com/mediapipe-models/text_classifier/bert_classifier/float32/1/bert_classifier.tflite"
          // modelAssetPath: `./assets/bert_classifier.tflite`
        },
        maxResults: 10
      });

      //const result: TextClassifierResult = _await textClassifier.classify(inputText);
      //const result = textClassifier.classify(inputText);
      const result = textClassifier.classify(keyboardInputText);

      // Access the classification results
      const classifications = result.classifications;
      let classificationResults = [];
      for (const classification of classifications) {
        const categories = classification.categories;
        console.log("TextClassificationResult:\n classification #0 (single classification head):\n ClassificationEntry #0:");

        // Iterate over the categories 
        for (const category of categories) {
          classificationResults.push({
            categoryName: category.categoryName,
            score: category.score,
            index: category.index
          });

          // Process the category name and score
          // console.log(`Category #:\n Category name: "${categoryName}"\n Score: ${score}\n Index: ${index}`);

          //this.tag("Messages").text = `Category #:\n Category name: "${categoryName}"\n Score: ${score}\n Index: ${index}`;
        }
        console.log('Classification Results:', classificationResults);
        //this.tag("Messages").text = `Category #:\n Category name: "${categoryName}"\n Score: ${score}\n Index: ${index}`;
      }
      //this.tag("Messages").text = `Category #:\n Category name: "${categoryName}"\n Score: ${score}\n Index: ${index}`;
      this.tag("Messages").text = classificationResults.map((result, idx) => "Category #".concat(idx + 1, ":\nCategory name: \"").concat(result.categoryName, "\"\nScore: ").concat(result.score, "\nIndex: ").concat(result.index)).join("\n\n");
    }
    //end of the mediapipe code

    static get width() {
      return 1080;
    }
    static get height() {
      return 920;
    }
    static get margin() {
      return 20;
    }
    _getFocused() {
      return this.tag('Keyboard');
    }
  }

  class App$1 extends Router.App {
    static getFonts() {
      return [{
        family: 'Bold',
        url: Utils.asset('fonts/Catamaran-Bold.ttf')
      }, {
        family: 'Regular',
        url: Utils.asset('fonts/Catamaran-Regular.ttf')
      }];
    }
    static language() {
      return {
        file: Utils.asset('locale/Translations.json'),
        language: 'en-US'
      };
    }
    _setup() {
      Router.startRouter(routes, this);
    }
    _construct() {
      this.height = App$1.height;
      this.width = App$1.width;
    }
    static get width() {
      return 1920;
    }
    static get height() {
      return 1080;
    }
    static get sideMargin() {
      return 60;
    }
    static _template() {
      return {
        w: App$1.width,
        h: App$1.height,
        Pages: {
          forceZIndexContext: true
        },
        ...super._template(),
        Widgets: {
          Menu: {
            type: Menu
          },
          Banner: {
            type: Banner
          },
          IconMenu: {
            type: IconMenu
          },
          VideoSlider: {
            type: VideoSlider
          },
          BannerItem: {
            type: BannerItem
          },
          ButtonsList: {
            type: ButtonsList
          },
          PlayerControls: {
            type: PlayerControls
          },
          Loader: {
            type: Loader
          },
          Popup: {
            type: Popup
          },
          EmptyPage: {
            type: EmptyPage
          },
          ListEndless: {
            type: EndlessList
          },
          ProfileButtons: {
            type: ProfileButtons
          },
          Keyboard: {
            type: Keyboard$1
          },
          //added
          KeyboardText: {
            type: KeyboardText
          },
          KeyboardAgent: {
            type: KeyboardAgent
          },
          ChatBox: {
            type: ChatBox
          },
          // Canvas:{
          //   type: Canvas
          // },
          //end
          ProgressBar: {
            type: ProgressBar
          },
          SearchResults: {
            type: SearchResults
          },
          DetailsBtns: {
            type: DetailsBtns
          },
          StaticData: {
            type: StaticData
          },
          ScrollList: {
            type: ScrollList
          },
          VideoGrid: {
            type: ViewMoreGrid
          }
        }
      };
    }
    _handleAppClose() {
      Router.focusPage();
    }
    static get widgets() {
      return this.tag('Widgets');
    }
  }

  //import App from './pages/OTTAvatar2.js'
  //import App from './pages/OTTWebgpu.js'

  //import App from './widgets/Banner/index.js' // horizontal  top banner displays
  //import App from './widgets/Banner/BannerItem.js'   //vertical rightfull banner displays
  //import App from './widgets/Banner/CircleIndicator.js' //no o/p

  //import App from './widgets/ButtonsList/index.js'   //no o/p
  //import App from './widgaets/IconDynamicButton.js' //no o/p

  //import App from './widgets/DetailsBtns/index.js' //no o/p

  //import App from './widgets/EmptyPage/index.js'  // empty page displays

  //import App from './widgets/IconMenu/index.js'  //vertical left small banner menu page displays

  //import App from './widgets/Keyboard/KeyboardButton.js' //error displays
  //import App from './widgets/Keyboard/KeyboardInputDisplay.js' // no o/p
  //import App from './widgets/Keyboard/KeyboardTemplate.js' //error displays
  //import App from './widgets/Keyboard/index.js' //keyboard displays

  //import App from './widgets/List/Item.js'  //displays a blue rectangle box left top 
  //import App from './widgets/List/ListComponent.js' //no o/p
  //import App from './widgets/List/ListEndless.js' // error displays

  //import App from './widgets/Loader/index.js' //no o/p

  //import App from './widgets/Menu/index.js' // vertical left big banner for menu page displays

  //import App from './widgets/PlayerControls/ProgressBar.js' //no o/p
  //import App from './widgets/PlayerControls/index.js' //error displays

  //import App from './widgets/Popup/index.js' //displays error popup window

  //import App from './widgets/ProfileButtons/Button.js' //error displays
  //import App from './widgets/ProfileButtons/DynamicButton.js'//no o/p
  //import App from './widgets/ProfileButtons/index.js' // no o/p

  //import App from './widgets/ScrollList/index.js' //no o/p

  //import App from './widgets/SearchResults/index.js' //no o/p

  //import App from './widgets/StaticData/index.js' //error displays

  //import App from './widgets/VideoGrid/index.js' // error displays

  //import App from './widgets/VideoSlider/index.js' // error displays

  function index () {
    return Launch(App$1, ...arguments);
  }

  return index;

})();
//# sourceMappingURL=appBundle.js.map
